var Prototype={Version:"1.6.1",Browser:(function(){var c=navigator.userAgent;var a=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!a,Opera:a,WebKit:c.indexOf("AppleWebKit/")>-1,Gecko:c.indexOf("Gecko")>-1&&c.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(c)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var a=window.Element||window.HTMLElement;return !!(a&&a.prototype)})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=="undefined"){return true}var d=document.createElement("div");var c=document.createElement("form");var a=false;if(d.__proto__&&(d.__proto__!==c.__proto__)){a=true}d=c=null;return a})()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false}var Abstract={};var Try={these:function(){var d;for(var c=0,f=arguments.length;c<f;c++){var a=arguments[c];try{d=a();break}catch(g){}}return d}};var Class=(function(){function a(){}function c(){var h=null,g=$A(arguments);if(Object.isFunction(g[0])){h=g.shift()}function e(){this.initialize.apply(this,arguments)}Object.extend(e,Class.Methods);e.superclass=h;e.subclasses=[];if(h){a.prototype=h.prototype;e.prototype=new a;h.subclasses.push(e)}for(var f=0;f<g.length;f++){e.addMethods(g[f])}if(!e.prototype.initialize){e.prototype.initialize=Prototype.emptyFunction}e.prototype.constructor=e;return e}function d(l){var g=this.superclass&&this.superclass.prototype;var f=Object.keys(l);if(!Object.keys({toString:true}).length){if(l.toString!=Object.prototype.toString){f.push("toString")}if(l.valueOf!=Object.prototype.valueOf){f.push("valueOf")}}for(var e=0,h=f.length;e<h;e++){var k=f[e],j=l[k];if(g&&Object.isFunction(j)&&j.argumentNames().first()=="$super"){var m=j;j=(function(n){return function(){return g[n].apply(this,arguments)}})(k).wrap(m);j.valueOf=m.valueOf.bind(m);j.toString=m.toString.bind(m)}this.prototype[k]=j}return this}return{create:c,Methods:{addMethods:d}}})();(function(){var e=Object.prototype.toString;function k(s,u){for(var t in u){s[t]=u[t]}return s}function n(s){try{if(f(s)){return"undefined"}if(s===null){return"null"}return s.inspect?s.inspect():String(s)}catch(t){if(t instanceof RangeError){return"..."}throw t}}function m(s){var u=typeof s;switch(u){case"undefined":case"function":case"unknown":return;case"boolean":return s.toString()}if(s===null){return"null"}if(s.toJSON){return s.toJSON()}if(j(s)){return}var t=[];for(var w in s){var v=m(s[w]);if(!f(v)){t.push(w.toJSON()+": "+v)}}return"{"+t.join(", ")+"}"}function d(s){return $H(s).toQueryString()}function g(s){return s&&s.toHTML?s.toHTML():String.interpret(s)}function q(s){var t=[];for(var u in s){t.push(u)}return t}function o(s){var t=[];for(var u in s){t.push(s[u])}return t}function l(s){return k({},s)}function j(s){return !!(s&&s.nodeType==1)}function h(s){return e.call(s)=="[object Array]"}function r(s){return s instanceof Hash}function c(s){return typeof s==="function"}function a(s){return e.call(s)=="[object String]"}function p(s){return e.call(s)=="[object Number]"}function f(s){return typeof s==="undefined"}k(Object,{extend:k,inspect:n,toJSON:m,toQueryString:d,toHTML:g,keys:q,values:o,clone:l,isElement:j,isArray:h,isHash:r,isFunction:c,isString:a,isNumber:p,isUndefined:f})})();Object.extend(Function.prototype,(function(){var m=Array.prototype.slice;function e(q,n){var p=q.length,o=n.length;while(o--){q[p+o]=n[o]}return q}function k(o,n){o=m.call(o,0);return e(o,n)}function h(){var n=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return n.length==1&&!n[0]?[]:n}function j(p){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this}var n=this,o=m.call(arguments,1);return function(){var q=k(o,arguments);return n.apply(p,q)}}function g(p){var n=this,o=m.call(arguments,1);return function(r){var q=e([r||window.event],o);return n.apply(p,q)}}function l(){if(!arguments.length){return this}var n=this,o=m.call(arguments,0);return function(){var p=k(o,arguments);return n.apply(this,p)}}function f(p){var n=this,o=m.call(arguments,1);p=p*1000;return window.setTimeout(function(){return n.apply(n,o)},p)}function a(){var n=e([0.01],arguments);return this.delay.apply(this,n)}function d(o){var n=this;return function(){var p=e([n.bind(this)],arguments);return o.apply(this,p)}}function c(){if(this._methodized){return this._methodized}var n=this;return this._methodized=function(){var o=e([this],arguments);return n.apply(null,o)}}return{argumentNames:h,bind:j,bindAsEventListener:g,curry:l,delay:f,defer:a,wrap:d,methodize:c}})());Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(c,a){this.callback=c;this.frequency=a;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},execute:function(){this.callback(this)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=false;throw a}}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,(function(){function prepareReplacement(replacement){if(Object.isFunction(replacement)){return replacement}var template=new Template(replacement);return function(match){return template.evaluate(match)}}function gsub(pattern,replacement){var result="",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern)){pattern=RegExp.escape(pattern)}if(!(pattern.length||pattern.source)){replacement=replacement("");return replacement+source.split("").join(replacement)+replacement}while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0){return match[0]}return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?"...":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,"img");var matchOne=new RegExp(Prototype.ScriptFragment,"im");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match){return{}}return match[1].split(separator||"&").inject({},function(hash,pair){if((pair=pair.split("="))[0]){var key=decodeURIComponent(pair.shift());var value=pair.length>1?pair.join("="):pair[0];if(value!=undefined){value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key])){hash[key]=[hash[key]]}hash[key].push(value)}else{hash[key]=value}}return hash})}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?"":new Array(count+1).join(this)}function camelize(){var parts=this.split("-"),len=parts.length;if(len==1){return parts[0]}var camelized=this.charAt(0)=="-"?parts[0].charAt(0).toUpperCase()+parts[0].substring(1):parts[0];for(var i=1;i<len;i++){camelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1)}return camelized}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return"\\u00"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'"'+escapedString.replace(/"/g,'\\"')+'"'}return"'"+escapedString.replace(/'/g,"\\'")+"'"}function toJSON(){return this.inspect(true)}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,"$1")}function isJSON(){var str=this;if(str.blank()){return false}str=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str)}function evalJSON(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON()){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern){return this.indexOf(pattern)===0}function endsWith(pattern){var d=this.length-pattern.length;return d>=0&&this.lastIndexOf(pattern)===d}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim?String.prototype.trim:strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,toJSON:toJSON,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}})());var Template=Class.create({initialize:function(a,c){this.template=a.toString();this.pattern=c||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements)){a=a.toTemplateReplacements()}return this.template.gsub(this.pattern,function(e){if(a==null){return(e[1]+"")}var g=e[1]||"";if(g=="\\"){return e[2]}var c=a,h=e[3];var f=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;e=f.exec(h);if(e==null){return g}while(e!=null){var d=e[1].startsWith("[")?e[2].replace(/\\\\]/g,"]"):e[1];c=c[d];if(null==c||""==e[3]){break}h=h.substring("["==e[3]?e[1].length:e[0].length);e=f.exec(h)}return g+String.interpret(c)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function d(B,A){var z=0;try{this._each(function(D){B.call(A,D,z++)})}catch(C){if(C!=$break){throw C}}return this}function t(C,B,A){var z=-C,D=[],E=this.toArray();if(C<1){return E}while((z+=C)<E.length){D.push(E.slice(z,z+C))}return D.collect(B,A)}function c(B,A){B=B||Prototype.K;var z=true;this.each(function(D,C){z=z&&!!B.call(A,D,C);if(!z){throw $break}});return z}function k(B,A){B=B||Prototype.K;var z=false;this.each(function(D,C){if(z=!!B.call(A,D,C)){throw $break}});return z}function l(B,A){B=B||Prototype.K;var z=[];this.each(function(D,C){z.push(B.call(A,D,C))});return z}function v(B,A){var z;this.each(function(D,C){if(B.call(A,D,C)){z=D;throw $break}});return z}function j(B,A){var z=[];this.each(function(D,C){if(B.call(A,D,C)){z.push(D)}});return z}function h(C,B,A){B=B||Prototype.K;var z=[];if(Object.isString(C)){C=new RegExp(RegExp.escape(C))}this.each(function(E,D){if(C.match(E)){z.push(B.call(A,E,D))}});return z}function a(z){if(Object.isFunction(this.indexOf)){if(this.indexOf(z)!=-1){return true}}var A=false;this.each(function(B){if(B==z){A=true;throw $break}});return A}function s(A,z){z=Object.isUndefined(z)?null:z;return this.eachSlice(A,function(B){while(B.length<A){B.push(z)}return B})}function n(z,B,A){this.each(function(D,C){z=B.call(A,z,D,C)});return z}function y(A){var z=$A(arguments).slice(1);return this.map(function(B){return B[A].apply(B,z)})}function r(B,A){B=B||Prototype.K;var z;this.each(function(D,C){D=B.call(A,D,C);if(z==null||D>=z){z=D}});return z}function p(B,A){B=B||Prototype.K;var z;this.each(function(D,C){D=B.call(A,D,C);if(z==null||D<z){z=D}});return z}function f(C,A){C=C||Prototype.K;var B=[],z=[];this.each(function(E,D){(C.call(A,E,D)?B:z).push(E)});return[B,z]}function g(A){var z=[];this.each(function(B){z.push(B[A])});return z}function e(B,A){var z=[];this.each(function(D,C){if(!B.call(A,D,C)){z.push(D)}});return z}function o(A,z){return this.map(function(C,B){return{value:C,criteria:A.call(z,C,B)}}).sort(function(E,D){var C=E.criteria,B=D.criteria;return C<B?-1:C>B?1:0}).pluck("value")}function q(){return this.map()}function u(){var A=Prototype.K,z=$A(arguments);if(Object.isFunction(z.last())){A=z.pop()}var B=[this].concat(z).map($A);return this.map(function(D,C){return A(B.pluck(C))})}function m(){return this.toArray().length}function w(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:d,eachSlice:t,all:c,every:c,any:k,some:k,collect:l,map:l,detect:v,findAll:j,select:j,filter:j,grep:h,include:a,member:a,inGroupsOf:s,inject:n,invoke:y,max:r,min:p,partition:f,pluck:g,reject:e,sortBy:o,toArray:q,entries:q,zip:u,size:m,inspect:w,find:v}})();function $A(d){if(!d){return[]}if("toArray" in Object(d)){return d.toArray()}var c=d.length||0,a=new Array(c);while(c--){a[c]=d[c]}return a}function $w(a){if(!Object.isString(a)){return[]}a=a.strip();return a?a.split(/\s+/):[]}Array.from=$A;(function(){var u=Array.prototype,o=u.slice,q=u.forEach;function c(z){for(var y=0,A=this.length;y<A;y++){z(this[y])}}if(!q){q=c}function n(){this.length=0;return this}function e(){return this[0]}function h(){return this[this.length-1]}function k(){return this.select(function(y){return y!=null})}function w(){return this.inject([],function(z,y){if(Object.isArray(y)){return z.concat(y.flatten())}z.push(y);return z})}function j(){var y=o.call(arguments,0);return this.select(function(z){return !y.include(z)})}function g(y){return(y!==false?this:this.toArray())._reverse()}function m(y){return this.inject([],function(B,A,z){if(0==z||(y?B.last()!=A:!B.include(A))){B.push(A)}return B})}function r(y){return this.uniq().findAll(function(z){return y.detect(function(A){return z===A})})}function s(){return o.call(this,0)}function l(){return this.length}function v(){return"["+this.map(Object.inspect).join(", ")+"]"}function t(){var y=[];this.each(function(z){var A=Object.toJSON(z);if(!Object.isUndefined(A)){y.push(A)}});return"["+y.join(", ")+"]"}function a(A,y){y||(y=0);var z=this.length;if(y<0){y=z+y}for(;y<z;y++){if(this[y]===A){return y}}return -1}function p(z,y){y=isNaN(y)?this.length:(y<0?this.length+y:y)+1;var A=this.slice(0,y).reverse().indexOf(z);return(A<0)?A:y-A-1}function d(){var D=o.call(this,0),B;for(var z=0,A=arguments.length;z<A;z++){B=arguments[z];if(Object.isArray(B)&&!("callee" in B)){for(var y=0,C=B.length;y<C;y++){D.push(B[y])}}else{D.push(B)}}return D}Object.extend(u,Enumerable);if(!u._reverse){u._reverse=u.reverse}Object.extend(u,{_each:q,clear:n,first:e,last:h,compact:k,flatten:w,without:j,reverse:g,uniq:m,intersect:r,clone:s,toArray:s,size:l,inspect:v,toJSON:t});var f=(function(){return[].concat(arguments)[0][0]!==1})(1,2);if(f){u.concat=d}if(!u.indexOf){u.indexOf=a}if(!u.lastIndexOf){u.lastIndexOf=p}})();function $H(a){return new Hash(a)}var Hash=Class.create(Enumerable,(function(){function f(s){this._object=Object.isHash(s)?s.toObject():Object.clone(s)}function g(t){for(var s in this._object){var u=this._object[s],v=[s,u];v.key=s;v.value=u;t(v)}}function m(s,t){return this._object[s]=t}function d(s){if(this._object[s]!==Object.prototype[s]){return this._object[s]}}function p(s){var t=this._object[s];delete this._object[s];return t}function r(){return Object.clone(this._object)}function q(){return this.pluck("key")}function o(){return this.pluck("value")}function h(t){var s=this.detect(function(u){return u.value===t});return s&&s.key}function k(s){return this.clone().update(s)}function e(s){return new Hash(s).inject(this,function(t,u){t.set(u.key,u.value);return t})}function c(s,t){if(Object.isUndefined(t)){return s}return s+"="+encodeURIComponent(String.interpret(t))}function a(){return this.inject([],function(u,v){var t=encodeURIComponent(v.key),s=v.value;if(s&&typeof s=="object"){if(Object.isArray(s)){return u.concat(s.map(c.curry(t)))}}else{u.push(c(t,s))}return u}).join("&")}function n(){return"#<Hash:{"+this.map(function(s){return s.map(Object.inspect).join(": ")}).join(", ")+"}>"}function l(){return Object.toJSON(this.toObject())}function j(){return new Hash(this)}return{initialize:f,_each:g,set:m,get:d,unset:p,toObject:r,toTemplateReplacements:r,keys:q,values:o,index:h,merge:k,update:e,toQueryString:a,inspect:n,toJSON:l,clone:j}})());Hash.from=$H;Object.extend(Number.prototype,(function(){function e(){return this.toPaddedString(2,16)}function f(){return this+1}function a(m,l){$R(0,this,true).each(m,l);return this}function c(n,m){var l=this.toString(m||10);return"0".times(n-l.length)+l}function g(){return isFinite(this)?this.toString():"null"}function k(){return Math.abs(this)}function j(){return Math.round(this)}function h(){return Math.ceil(this)}function d(){return Math.floor(this)}return{toColorPart:e,succ:f,times:a,toPaddedString:c,toJSON:g,abs:k,round:j,ceil:h,floor:d}})());function $R(d,a,c){return new ObjectRange(d,a,c)}var ObjectRange=Class.create(Enumerable,(function(){function c(g,e,f){this.start=g;this.end=e;this.exclusive=f}function d(e){var f=this.start;while(this.include(f)){e(f);f=f.succ()}}function a(e){if(e<this.start){return false}if(this.exclusive){return e<this.end}return e<=this.end}return{initialize:c,_each:d,include:a}})());var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){if(!this.include(a)){this.responders.push(a)}},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(e,c,d,a){this.each(function(f){if(Object.isFunction(f[e])){try{f[e].apply(f,[c,d,a])}catch(g){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters)){this.options.parameters=this.options.parameters.toQueryParams()}else{if(Object.isHash(this.options.parameters)){this.options.parameters=this.options.parameters.toObject()}}}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,c,a){$super(a);this.transport=Ajax.getTransport();this.request(c)},request:function(c){this.url=c;this.method=this.options.method;var f=Object.clone(this.options.parameters);if(!["get","post"].include(this.method)){f._method=this.method;this.method="post"}this.parameters=f;if(f=Object.toQueryString(f)){if(this.method=="get"){this.url+=(this.url.include("?")?"&":"?")+f}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){f+="&_="}}}try{var a=new Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(a)}Ajax.Responders.dispatch("onCreate",this,a);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){this.respondToReadyState.bind(this).defer(1)}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||f):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(d){this.dispatchException(d)}},onStateChange:function(){var a=this.transport.readyState;if(a>1&&!((a==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var f={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){f["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){f.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var d=this.options.requestHeaders;if(Object.isFunction(d.push)){for(var c=0,e=d.length;c<e;c+=2){f[d[c]]=d[c+1]}}else{$H(d).each(function(g){f[g.key]=g.value})}}for(var a in f){this.transport.setRequestHeader(a,f[a])}},success:function(){var a=this.getStatus();return !a||(a>=200&&a<300)},getStatus:function(){try{return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){var d=Ajax.Request.Events[a],c=new Ajax.Response(this);if(d=="Complete"){try{this._complete=true;(this.options["on"+c.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(c,c.headerJSON)}catch(f){this.dispatchException(f)}var g=c.getHeader("Content-type");if(this.options.evalJS=="force"||(this.options.evalJS&&this.isSameOrigin()&&g&&g.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))){this.evalResponse()}}try{(this.options["on"+d]||Prototype.emptyFunction)(c,c.headerJSON);Ajax.Responders.dispatch("on"+d,this,c,c.headerJSON)}catch(f){this.dispatchException(f)}if(d=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction}},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return !a||(a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""}))},getHeader:function(a){try{return this.transport.getResponseHeader(a)||null}catch(c){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Response=Class.create({initialize:function(d){this.request=d;var e=this.transport=d.transport,a=this.readyState=e.readyState;if((a>2&&!Prototype.Browser.IE)||a==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(e.responseText);this.headerJSON=this._getHeaderJSON()}if(a==4){var c=e.responseXML;this.responseXML=Object.isUndefined(c)?null:c;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a){return null}a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(c){this.request.dispatchException(c)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||(a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json"))||this.responseText.blank()){return null}try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(c){this.request.dispatchException(c)}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,a,d,c){this.container={success:(a.success||a),failure:(a.failure||(a.success?null:a))};c=Object.clone(c);var e=c.onComplete;c.onComplete=(function(f,g){this.updateContent(f.responseText);if(Object.isFunction(e)){e(f,g)}}).bind(this);$super(d,c)},updateContent:function(e){var d=this.container[this.success()?"success":"failure"],a=this.options;if(!a.evalScripts){e=e.stripScripts()}if(d=$(d)){if(a.insertion){if(Object.isString(a.insertion)){var c={};c[a.insertion]=e;d.insert(c)}else{a.insertion(d,e)}}else{d.update(e)}}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,a,d,c){$super(c);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=a;this.url=d;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(a){if(this.options.decay){this.decay=(a.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});function $(c){if(arguments.length>1){for(var a=0,e=[],d=arguments.length;a<d;a++){e.push($(arguments[a]))}return e}if(Object.isString(c)){c=document.getElementById(c)}return Element.extend(c)}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(g,a){var d=[];var f=document.evaluate(g,$(a)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var c=0,e=f.snapshotLength;c<e;c++){d.push(Element.extend(f.snapshotItem(c)))}return d}}if(!window.Node){var Node={}}if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}(function(d){var c=(function(){var g=document.createElement("form");var f=document.createElement("input");var e=document.documentElement;f.setAttribute("name","test");g.appendChild(f);e.appendChild(g);var h=g.elements?(typeof g.elements.test=="undefined"):null;e.removeChild(g);g=f=null;return h})();var a=d.Element;d.Element=function(g,f){f=f||{};g=g.toLowerCase();var e=Element.cache;if(c&&f.name){g="<"+g+' name="'+f.name+'">';delete f.name;return Element.writeAttribute(document.createElement(g),f)}if(!e[g]){e[g]=Element.extend(document.createElement(g))}return Element.writeAttribute(e[g].cloneNode(false),f)};Object.extend(d.Element,a||{});if(a){d.Element.prototype=a.prototype}})(this);Element.cache={};Element.idCounter=1;Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:(function(){var c=(function(){var f=document.createElement("select"),g=true;f.innerHTML='<option value="test">test</option>';if(f.options&&f.options[0]){g=f.options[0].nodeName.toUpperCase()!=="OPTION"}f=null;return g})();var a=(function(){try{var f=document.createElement("table");if(f&&f.tBodies){f.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var h=typeof f.tBodies[0]=="undefined";f=null;return h}}catch(g){return true}})();var e=(function(){var f=document.createElement("script"),h=false;try{f.appendChild(document.createTextNode(""));h=!f.firstChild||f.firstChild&&f.firstChild.nodeType!==3}catch(g){h=true}f=null;return h})();function d(g,h){g=$(g);if(h&&h.toElement){h=h.toElement()}if(Object.isElement(h)){return g.update().insert(h)}h=Object.toHTML(h);var f=g.tagName.toUpperCase();if(f==="SCRIPT"&&e){g.text=h;return g}if(c||a){if(f in Element._insertionTranslations.tags){while(g.firstChild){g.removeChild(g.firstChild)}Element._getContentFromAnonymousElement(f,h.stripScripts()).each(function(j){g.appendChild(j)})}else{g.innerHTML=h.stripScripts()}}else{g.innerHTML=h.stripScripts()}h.evalScripts.bind(h).defer();return g}return d})(),replace:function(c,d){c=$(c);if(d&&d.toElement){d=d.toElement()}else{if(!Object.isElement(d)){d=Object.toHTML(d);var a=c.ownerDocument.createRange();a.selectNode(c);d.evalScripts.bind(d).defer();d=a.createContextualFragment(d.stripScripts())}}c.parentNode.replaceChild(d,c);return c},insert:function(d,f){d=$(d);if(Object.isString(f)||Object.isNumber(f)||Object.isElement(f)||(f&&(f.toElement||f.toHTML))){f={bottom:f}}var e,g,c,h;for(var a in f){e=f[a];a=a.toLowerCase();g=Element._insertionTranslations[a];if(e&&e.toElement){e=e.toElement()}if(Object.isElement(e)){g(d,e);continue}e=Object.toHTML(e);c=((a=="before"||a=="after")?d.parentNode:d).tagName.toUpperCase();h=Element._getContentFromAnonymousElement(c,e.stripScripts());if(a=="top"||a=="after"){h.reverse()}h.each(g.curry(d));e.evalScripts.bind(e).defer()}return d},wrap:function(c,d,a){c=$(c);if(Object.isElement(d)){$(d).writeAttribute(a||{})}else{if(Object.isString(d)){d=new Element(d,a)}else{d=new Element("div",d)}}if(c.parentNode){c.parentNode.replaceChild(d,c)}d.appendChild(c);return d},inspect:function(c){c=$(c);var a="<"+c.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(g){var f=g.first(),d=g.last();var e=(c[f]||"").toString();if(e){a+=" "+d+"="+e.inspect(true)}});return a+">"},recursivelyCollect:function(a,d){a=$(a);var c=[];while(a=a[d]){if(a.nodeType==1){c.push(Element.extend(a))}}return c},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){a=$(a).firstChild;while(a&&a.nodeType!=1){a=a.nextSibling}return $(a)},immediateDescendants:function(a){if(!(a=$(a).firstChild)){return[]}while(a&&a.nodeType!=1){a=a.nextSibling}if(a){return[a].concat($(a).nextSiblings())}return[]},previousSiblings:function(a){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(c,a){if(Object.isString(a)){a=new Selector(a)}return a.match($(c))},up:function(c,e,a){c=$(c);if(arguments.length==1){return $(c.parentNode)}var d=Element.ancestors(c);return Object.isNumber(e)?d[e]:Selector.findElement(d,e,a)},down:function(c,d,a){c=$(c);if(arguments.length==1){return Element.firstDescendant(c)}return Object.isNumber(d)?Element.descendants(c)[d]:Element.select(c,d)[a||0]},previous:function(c,e,a){c=$(c);if(arguments.length==1){return $(Selector.handlers.previousElementSibling(c))}var d=Element.previousSiblings(c);return Object.isNumber(e)?d[e]:Selector.findElement(d,e,a)},next:function(d,e,c){d=$(d);if(arguments.length==1){return $(Selector.handlers.nextElementSibling(d))}var a=Element.nextSiblings(d);return Object.isNumber(e)?a[e]:Selector.findElement(a,e,c)},select:function(c){var a=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(c,a)},adjacent:function(c){var a=Array.prototype.slice.call(arguments,1);return Selector.findChildElements(c.parentNode,a).without(c)},identify:function(a){a=$(a);var c=Element.readAttribute(a,"id");if(c){return c}do{c="anonymous_element_"+Element.idCounter++}while($(c));Element.writeAttribute(a,"id",c);return c},readAttribute:function(d,a){d=$(d);if(Prototype.Browser.IE){var c=Element._attributeTranslations.read;if(c.values[a]){return c.values[a](d,a)}if(c.names[a]){a=c.names[a]}if(a.include(":")){return(!d.attributes||!d.attributes[a])?null:d.attributes[a].value}}return d.getAttribute(a)},writeAttribute:function(f,d,g){f=$(f);var c={},e=Element._attributeTranslations.write;if(typeof d=="object"){c=d}else{c[d]=Object.isUndefined(g)?true:g}for(var a in c){d=e.names[a]||a;g=c[a];if(e.values[a]){d=e.values[a](f,g)}if(g===false||g===null){f.removeAttribute(d)}else{if(g===true){f.setAttribute(d,d)}else{f.setAttribute(d,g)}}}return f},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,c){if(!(a=$(a))){return}var d=a.className;return(d.length>0&&(d==c||new RegExp("(^|\\s)"+c+"(\\s|$)").test(d)))},addClassName:function(a,c){if(!(a=$(a))){return}if(!Element.hasClassName(a,c)){a.className+=(a.className?" ":"")+c}return a},removeClassName:function(a,c){if(!(a=$(a))){return}a.className=a.className.replace(new RegExp("(^|\\s+)"+c+"(\\s+|$)")," ").strip();return a},toggleClassName:function(a,c){if(!(a=$(a))){return}return Element[Element.hasClassName(a,c)?"removeClassName":"addClassName"](a,c)},cleanWhitespace:function(c){c=$(c);var d=c.firstChild;while(d){var a=d.nextSibling;if(d.nodeType==3&&!/\S/.test(d.nodeValue)){c.removeChild(d)}d=a}return c},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(c,a){c=$(c),a=$(a);if(c.compareDocumentPosition){return(c.compareDocumentPosition(a)&8)===8}if(a.contains){return a.contains(c)&&a!==c}while(c=c.parentNode){if(c==a){return true}}return false},scrollTo:function(a){a=$(a);var c=Element.cumulativeOffset(a);window.scrollTo(c[0],c[1]);return a},getStyle:function(c,d){c=$(c);d=d=="float"?"cssFloat":d.camelize();var e=c.style[d];if(!e||e=="auto"){var a=document.defaultView.getComputedStyle(c,null);e=a?a[d]:null}if(d=="opacity"){return e?parseFloat(e):1}return e=="auto"?null:e},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(c,d){c=$(c);var f=c.style,a;if(Object.isString(d)){c.style.cssText+=";"+d;return d.include("opacity")?c.setOpacity(d.match(/opacity:\s*(\d?\.?\d*)/)[1]):c}for(var e in d){if(e=="opacity"){c.setOpacity(d[e])}else{f[(e=="float"||e=="cssFloat")?(Object.isUndefined(f.styleFloat)?"cssFloat":"styleFloat"):e]=d[e]}}return c},setOpacity:function(a,c){a=$(a);a.style.opacity=(c==1||c==="")?"":(c<0.00001)?0:c;return a},getDimensions:function(d){d=$(d);var h=Element.getStyle(d,"display");if(h!="none"&&h!=null){return{width:d.offsetWidth,height:d.offsetHeight}}var c=d.style;var g=c.visibility;var e=c.position;var a=c.display;c.visibility="hidden";if(e!="fixed"){c.position="absolute"}c.display="block";var j=d.clientWidth;var f=d.clientHeight;c.display=a;c.position=e;c.visibility=g;return{width:j,height:f}},makePositioned:function(a){a=$(a);var c=Element.getStyle(a,"position");if(c=="static"||!c){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow){return a}a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden"){a.style.overflow="hidden"}return a},undoClipping:function(a){a=$(a);if(!a._overflow){return a}a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},cumulativeOffset:function(c){var a=0,d=0;do{a+=c.offsetTop||0;d+=c.offsetLeft||0;c=c.offsetParent}while(c);return Element._returnOffset(d,a)},positionedOffset:function(c){var a=0,e=0;do{a+=c.offsetTop||0;e+=c.offsetLeft||0;c=c.offsetParent;if(c){if(c.tagName.toUpperCase()=="BODY"){break}var d=Element.getStyle(c,"position");if(d!=="static"){break}}}while(c);return Element._returnOffset(e,a)},absolutize:function(c){c=$(c);if(Element.getStyle(c,"position")=="absolute"){return c}var e=Element.positionedOffset(c);var g=e[1];var f=e[0];var d=c.clientWidth;var a=c.clientHeight;c._originalLeft=f-parseFloat(c.style.left||0);c._originalTop=g-parseFloat(c.style.top||0);c._originalWidth=c.style.width;c._originalHeight=c.style.height;c.style.position="absolute";c.style.top=g+"px";c.style.left=f+"px";c.style.width=d+"px";c.style.height=a+"px";return c},relativize:function(a){a=$(a);if(Element.getStyle(a,"position")=="relative"){return a}a.style.position="relative";var d=parseFloat(a.style.top||0)-(a._originalTop||0);var c=parseFloat(a.style.left||0)-(a._originalLeft||0);a.style.top=d+"px";a.style.left=c+"px";a.style.height=a._originalHeight;a.style.width=a._originalWidth;return a},cumulativeScrollOffset:function(c){var a=0,d=0;do{a+=c.scrollTop||0;d+=c.scrollLeft||0;c=c.parentNode}while(c);return Element._returnOffset(d,a)},getOffsetParent:function(a){if(a.offsetParent){return $(a.offsetParent)}if(a==document.body){return $(a)}while((a=a.parentNode)&&a!=document.body){if(Element.getStyle(a,"position")!="static"){return $(a)}}return $(document.body)},viewportOffset:function(e){var a=0,d=0;var c=e;do{a+=c.offsetTop||0;d+=c.offsetLeft||0;if(c.offsetParent==document.body&&Element.getStyle(c,"position")=="absolute"){break}}while(c=c.offsetParent);c=e;do{if(!Prototype.Browser.Opera||(c.tagName&&(c.tagName.toUpperCase()=="BODY"))){a-=c.scrollTop||0;d-=c.scrollLeft||0}}while(c=c.parentNode);return Element._returnOffset(d,a)},clonePosition:function(c,e){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});e=$(e);var f=Element.viewportOffset(e);c=$(c);var g=[0,0];var d=null;if(Element.getStyle(c,"position")=="absolute"){d=Element.getOffsetParent(c);g=Element.viewportOffset(d)}if(d==document.body){g[0]-=document.body.offsetLeft;g[1]-=document.body.offsetTop}if(a.setLeft){c.style.left=(f[0]-g[0]+a.offsetLeft)+"px"}if(a.setTop){c.style.top=(f[1]-g[1]+a.offsetTop)+"px"}if(a.setWidth){c.style.width=e.offsetWidth+"px"}if(a.setHeight){c.style.height=e.offsetHeight+"px"}return c}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(e,c,d){switch(d){case"left":case"top":case"right":case"bottom":if(e(c,"position")==="static"){return null}case"height":case"width":if(!Element.visible(c)){return null}var f=parseInt(e(c,d),10);if(f!==c["offset"+d.capitalize()]){return f+"px"}var a;if(d==="height"){a=["border-top-width","padding-top","padding-bottom","border-bottom-width"]}else{a=["border-left-width","padding-left","padding-right","border-right-width"]}return a.inject(f,function(g,h){var j=e(c,h);return j===null?g:g-parseInt(j,10)})+"px";default:return e(c,d)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(d,a,c){if(c==="title"){return a.title}return d(a,c)})}else{if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(d,c){c=$(c);try{c.offsetParent}catch(g){return $(document.body)}var a=c.getStyle("position");if(a!=="static"){return d(c)}c.setStyle({position:"relative"});var f=d(c);c.setStyle({position:a});return f});$w("positionedOffset viewportOffset").each(function(a){Element.Methods[a]=Element.Methods[a].wrap(function(g,d){d=$(d);try{d.offsetParent}catch(j){return Element._returnOffset(0,0)}var c=d.getStyle("position");if(c!=="static"){return g(d)}var f=d.getOffsetParent();if(f&&f.getStyle("position")==="fixed"){f.setStyle({zoom:1})}d.setStyle({position:"relative"});var h=g(d);d.setStyle({position:c});return h})});Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(c,a){try{a.offsetParent}catch(d){return Element._returnOffset(0,0)}return c(a)});Element.Methods.getStyle=function(a,c){a=$(a);c=(c=="float"||c=="cssFloat")?"styleFloat":c.camelize();var d=a.style[c];if(!d&&a.currentStyle){d=a.currentStyle[c]}if(c=="opacity"){if(d=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/)){if(d[1]){return parseFloat(d[1])/100}}return 1}if(d=="auto"){if((c=="width"||c=="height")&&(a.getStyle("display")!="none")){return a["offset"+c.capitalize()]+"px"}return null}return d};Element.Methods.setOpacity=function(c,f){function g(h){return h.replace(/alpha\([^\)]*\)/gi,"")}c=$(c);var a=c.currentStyle;if((a&&!a.hasLayout)||(!a&&c.style.zoom=="normal")){c.style.zoom=1}var e=c.getStyle("filter"),d=c.style;if(f==1||f===""){(e=g(e))?d.filter=e:d.removeAttribute("filter");return c}else{if(f<0.00001){f=0}}d.filter=g(e)+"alpha(opacity="+(f*100)+")";return c};Element._attributeTranslations=(function(){var c="className";var a="for";var d=document.createElement("div");d.setAttribute(c,"x");if(d.className!=="x"){d.setAttribute("class","x");if(d.className==="x"){c="class"}}d=null;d=document.createElement("label");d.setAttribute(a,"x");if(d.htmlFor!=="x"){d.setAttribute("htmlFor","x");if(d.htmlFor==="x"){a="htmlFor"}}d=null;return{read:{names:{"class":c,className:c,"for":a,htmlFor:a},values:{_getAttr:function(e,f){return e.getAttribute(f)},_getAttr2:function(e,f){return e.getAttribute(f,2)},_getAttrNode:function(e,g){var f=e.getAttributeNode(g);return f?f.value:""},_getEv:(function(){var e=document.createElement("div");e.onclick=Prototype.emptyFunction;var h=e.getAttribute("onclick");var g;if(String(h).indexOf("{")>-1){g=function(f,j){j=f.getAttribute(j);if(!j){return null}j=j.toString();j=j.split("{")[1];j=j.split("}")[0];return j.strip()}}else{if(h===""){g=function(f,j){j=f.getAttribute(j);if(!j){return null}return j.strip()}}}e=null;return g})(),_flag:function(e,f){return $(e).hasAttribute(f)?f:null},style:function(e){return e.style.cssText.toLowerCase()},title:function(e){return e.title}}}}})();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,c){a.checked=!!c},style:function(a,c){a.style.cssText=c?c:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);if(Prototype.BrowserFeatures.ElementExtensions){(function(){function a(f){var c=f.getElementsByTagName("*"),e=[];for(var d=0,g;g=c[d];d++){if(g.tagName!=="!"){e.push(g)}}return e}Element.Methods.down=function(d,e,c){d=$(d);if(arguments.length==1){return d.firstDescendant()}return Object.isNumber(e)?a(d)[e]:Element.select(d,e)[c||0]}})()}}else{if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(a,c){a=$(a);a.style.opacity=(c==1)?0.999999:(c==="")?"":(c<0.00001)?0:c;return a}}else{if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,c){a=$(a);a.style.opacity=(c==1||c==="")?"":(c<0.00001)?0:c;if(c==1){if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else{try{var f=document.createTextNode(" ");a.appendChild(f);a.removeChild(f)}catch(d){}}}return a};Element.Methods.cumulativeOffset=function(c){var a=0,d=0;do{a+=c.offsetTop||0;d+=c.offsetLeft||0;if(c.offsetParent==document.body){if(Element.getStyle(c,"position")=="absolute"){break}}c=c.offsetParent}while(c);return Element._returnOffset(d,a)}}}}}if("outerHTML" in document.documentElement){Element.Methods.replace=function(d,f){d=$(d);if(f&&f.toElement){f=f.toElement()}if(Object.isElement(f)){d.parentNode.replaceChild(f,d);return d}f=Object.toHTML(f);var e=d.parentNode,c=e.tagName.toUpperCase();if(Element._insertionTranslations.tags[c]){var g=d.next();var a=Element._getContentFromAnonymousElement(c,f.stripScripts());e.removeChild(d);if(g){a.each(function(h){e.insertBefore(h,g)})}else{a.each(function(h){e.appendChild(h)})}}else{d.outerHTML=f.stripScripts()}f.evalScripts.bind(f).defer();return d}}Element._returnOffset=function(c,d){var a=[c,d];a.left=c;a.top=d;return a};Element._getContentFromAnonymousElement=function(d,c){var e=new Element("div"),a=Element._insertionTranslations.tags[d];if(a){e.innerHTML=a[0]+c+a[1];a[2].times(function(){e=e.firstChild})}else{e.innerHTML=c}return $A(e.childNodes)};Element._insertionTranslations={before:function(a,c){a.parentNode.insertBefore(c,a)},top:function(a,c){a.insertBefore(c,a.firstChild)},bottom:function(a,c){a.appendChild(c)},after:function(a,c){a.parentNode.insertBefore(c,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,d){d=Element._attributeTranslations.has[d]||d;var c=$(a).getAttributeNode(d);return !!(c&&c.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}a=null})(document.createElement("div"));Element.extend=(function(){function d(h){if(typeof window.Element!="undefined"){var k=window.Element.prototype;if(k){var m="_"+(Math.random()+"").slice(2);var j=document.createElement(h);k[m]="x";var l=(j[m]!=="x");delete k[m];j=null;return l}}return false}function c(j,h){for(var l in h){var k=h[l];if(Object.isFunction(k)&&!(l in j)){j[l]=k.methodize()}}}var e=d("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(e){return function(j){if(j&&typeof j._extendedByPrototype=="undefined"){var h=j.tagName;if(h&&(/^(?:object|applet|embed)$/i.test(h))){c(j,Element.Methods);c(j,Element.Methods.Simulated);c(j,Element.Methods.ByTag[h.toUpperCase()])}}return j}}return Prototype.K}var a={},f=Element.Methods.ByTag;var g=Object.extend(function(k){if(!k||typeof k._extendedByPrototype!="undefined"||k.nodeType!=1||k==window){return k}var h=Object.clone(a),j=k.tagName.toUpperCase();if(f[j]){Object.extend(h,f[j])}c(k,h);k._extendedByPrototype=Prototype.emptyFunction;return k},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(a,Element.Methods);Object.extend(a,Element.Methods.Simulated)}}});g.refresh();return g})();Element.hasAttribute=function(a,c){if(a.hasAttribute){return a.hasAttribute(c)}return Element.Methods.Simulated.hasAttribute(a,c)};Element.addMethods=function(d){var k=Prototype.BrowserFeatures,e=Element.Methods.ByTag;if(!d){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var c=d;d=arguments[1]}if(!c){Object.extend(Element.Methods,d||{})}else{if(Object.isArray(c)){c.each(h)}else{h(c)}}function h(m){m=m.toUpperCase();if(!Element.Methods.ByTag[m]){Element.Methods.ByTag[m]={}}Object.extend(Element.Methods.ByTag[m],d)}function a(o,n,m){m=m||false;for(var q in o){var p=o[q];if(!Object.isFunction(p)){continue}if(!m||!(q in n)){n[q]=p.methodize()}}}function f(p){var m;var o={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(o[p]){m="HTML"+o[p]+"Element"}if(window[m]){return window[m]}m="HTML"+p+"Element";if(window[m]){return window[m]}m="HTML"+p.capitalize()+"Element";if(window[m]){return window[m]}var n=document.createElement(p);var q=n.__proto__||n.constructor.prototype;n=null;return q}var j=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(k.ElementExtensions){a(Element.Methods,j);a(Element.Methods.Simulated,j,true)}if(k.SpecificElementExtensions){for(var l in Element.Methods.ByTag){var g=f(l);if(Object.isUndefined(g)){continue}a(e[l],g.prototype)}}Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh){Element.extend.refresh()}Element.cache={}};document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};(function(c){var h=Prototype.Browser,f=document,d,e={};function a(){if(h.WebKit&&!f.evaluate){return document}if(h.Opera&&window.parseFloat(window.opera.version())<9.5){return document.body}return document.documentElement}function g(j){if(!d){d=a()}e[j]="client"+j;c["get"+j]=function(){return d[e[j]]};return c["get"+j]()}c.getWidth=g.curry("Width");c.getHeight=g.curry("Height")})(document.viewport);Element.Storage={UID:1};Element.addMethods({getStorage:function(c){if(!(c=$(c))){return}var a;if(c===window){a=0}else{if(typeof c._prototypeUID==="undefined"){c._prototypeUID=[Element.Storage.UID++]}a=c._prototypeUID[0]}if(!Element.Storage[a]){Element.Storage[a]=$H()}return Element.Storage[a]},store:function(c,a,d){if(!(c=$(c))){return}if(arguments.length===2){Element.getStorage(c).update(a)}else{Element.getStorage(c).set(a,d)}return c},retrieve:function(d,c,a){if(!(d=$(d))){return}var f=Element.getStorage(d),e=f.get(c);if(Object.isUndefined(e)){f.set(c,a);e=a}return e},clone:function(d,a){if(!(d=$(d))){return}var f=d.cloneNode(a);f._prototypeUID=void 0;if(a){var e=Element.select(f,"*"),c=e.length;while(c--){e[c]._prototypeUID=void 0}}return Element.extend(f)}});var Selector=Class.create({initialize:function(a){this.expression=a.strip();if(this.shouldUseSelectorsAPI()){this.mode="selectorsAPI"}else{if(this.shouldUseXPath()){this.mode="xpath";this.compileXPathMatcher()}else{this.mode="normal";this.compileMatcher()}}},shouldUseXPath:(function(){var a=(function(){var f=false;if(document.evaluate&&window.XPathResult){var e=document.createElement("div");e.innerHTML="<ul><li></li></ul><div><ul><li></li></ul></div>";var d=".//*[local-name()='ul' or local-name()='UL']//*[local-name()='li' or local-name()='LI']";var c=document.evaluate(d,e,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);f=(c.snapshotLength!==2);e=null}return f})();return function(){if(!Prototype.BrowserFeatures.XPath){return false}var c=this.expression;if(Prototype.Browser.WebKit&&(c.include("-of-type")||c.include(":empty"))){return false}if((/(\[[\w-]*?:|:checked)/).test(c)){return false}if(a){return false}return true}})(),shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI){return false}if(Selector.CASE_INSENSITIVE_CLASS_NAMES){return false}if(!Selector._div){Selector._div=new Element("div")}try{Selector._div.querySelector(this.expression)}catch(a){return false}return true},compileMatcher:function(){var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m,len=ps.length,name;if(Selector._cache[e]){this.matcher=Selector._cache[e];return}this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i=0;i<len;i++){p=ps[i].re;name=ps[i].name;if(m=e.match(p)){this.matcher.push(Object.isFunction(c[name])?c[name](m):new Template(c[name]).evaluate(m));e=e.replace(m[0],"");break}}}this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join("\n"));Selector._cache[this.expression]=this.matcher},compileXPathMatcher:function(){var j=this.expression,k=Selector.patterns,d=Selector.xpath,h,c,a=k.length,f;if(Selector._cache[j]){this.xpath=Selector._cache[j];return}this.matcher=[".//*"];while(j&&h!=j&&(/\S/).test(j)){h=j;for(var g=0;g<a;g++){f=k[g].name;if(c=j.match(k[g].re)){this.matcher.push(Object.isFunction(d[f])?d[f](c):new Template(d[f]).evaluate(c));j=j.replace(c[0],"");break}}}this.xpath=this.matcher.join("");Selector._cache[this.expression]=this.xpath},findElements:function(a){a=a||document;var d=this.expression,c;switch(this.mode){case"selectorsAPI":if(a!==document){var f=a.id,g=$(a).identify();g=g.replace(/([\.:])/g,"\\$1");d="#"+g+" "+d}c=$A(a.querySelectorAll(d)).map(Element.extend);a.id=f;return c;case"xpath":return document._getElementsByXPath(this.xpath,a);default:return this.matcher(a)}},match:function(l){this.tokens=[];var r=this.expression,a=Selector.patterns,g=Selector.assertions;var c,f,h,q=a.length,d;while(r&&c!==r&&(/\S/).test(r)){c=r;for(var k=0;k<q;k++){f=a[k].re;d=a[k].name;if(h=r.match(f)){if(g[d]){this.tokens.push([d,Object.clone(h)]);r=r.replace(h[0],"")}else{return this.findElements(document).include(l)}}}}var o=true,d,n;for(var k=0,j;j=this.tokens[k];k++){d=j[0],n=j[1];if(!Selector.assertions[d](l,n)){o=false;break}}return o},toString:function(){return this.expression},inspect:function(){return"#<Selector:"+this.expression.inspect()+">"}});if(Prototype.BrowserFeatures.SelectorsAPI&&document.compatMode==="BackCompat"){Selector.CASE_INSENSITIVE_CLASS_NAMES=(function(){var d=document.createElement("div"),a=document.createElement("span");d.id="prototype_test_id";a.className="Test";d.appendChild(a);var c=(d.querySelector("#prototype_test_id .test")!==null);d=a=null;return c})()}Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(a){if(a[1]=="*"){return""}return"[local-name()='"+a[1].toLowerCase()+"' or local-name()='"+a[1].toUpperCase()+"']"},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(a){a[1]=a[1].toLowerCase();return new Template("[@#{1}]").evaluate(a)},attr:function(a){a[1]=a[1].toLowerCase();a[3]=a[5]||a[6];return new Template(Selector.xpath.operators[a[2]]).evaluate(a)},pseudo:function(a){var c=Selector.xpath.pseudos[a[1]];if(!c){return""}if(Object.isFunction(c)){return c(a)}return new Template(Selector.xpath.pseudos[a[1]]).evaluate(a)},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]",empty:"[count(*) = 0 and (count(text()) = 0)]",checked:"[@checked]",disabled:"[(@disabled) and (@type!='hidden')]",enabled:"[not(@disabled) and (@type!='hidden')]",not:function(g){var k=g[6],d=Selector.patterns,l=Selector.xpath,a,n,j=d.length,c;var f=[];while(k&&a!=k&&(/\S/).test(k)){a=k;for(var h=0;h<j;h++){c=d[h].name;if(g=k.match(d[h].re)){n=Object.isFunction(l[c])?l[c](g):new Template(l[c]).evaluate(g);f.push("("+n.substring(1,n.length-1)+")");k=k.replace(g[0],"");break}}}return"[not("+f.join(" and ")+")]"},"nth-child":function(a){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",a)},"nth-last-child":function(a){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",a)},"nth-of-type":function(a){return Selector.xpath.pseudos.nth("position() ",a)},"nth-last-of-type":function(a){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",a)},"first-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-of-type"](a)},"last-of-type":function(a){a[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](a)},"only-of-type":function(a){var c=Selector.xpath.pseudos;return c["first-of-type"](a)+c["last-of-type"](a)},nth:function(g,e){var h,j=e[6],d;if(j=="even"){j="2n+0"}if(j=="odd"){j="2n+1"}if(h=j.match(/^(\d+)$/)){return"["+g+"= "+h[1]+"]"}if(h=j.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(h[1]=="-"){h[1]=-1}var f=h[1]?Number(h[1]):1;var c=h[2]?Number(h[2]):0;d="[((#{fragment} - #{b}) mod #{a} = 0) and ((#{fragment} - #{b}) div #{a} >= 0)]";return new Template(d).evaluate({fragment:g,a:f,b:c})}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(a){a[3]=(a[5]||a[6]);return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;').evaluate(a)},pseudo:function(a){if(a[6]){a[6]=a[6].replace(/"/g,'\\"')}return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(a)},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:[{name:"laterSibling",re:/^\s*~\s*/},{name:"child",re:/^\s*>\s*/},{name:"adjacent",re:/^\s*\+\s*/},{name:"descendant",re:/^\s/},{name:"tagName",re:/^\s*(\*|[\w\-]+)(\b|$)?/},{name:"id",re:/^#([\w\-\*]+)(\b|$)/},{name:"className",re:/^\.([\w\-\*]+)(\b|$)/},{name:"pseudo",re:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/},{name:"attrPresence",re:/^\[((?:[\w-]+:)?[\w-]+)\]/},{name:"attr",re:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/}],assertions:{tagName:function(a,c){return c[1].toUpperCase()==a.tagName.toUpperCase()},className:function(a,c){return Element.hasClassName(a,c[1])},id:function(a,c){return a.id===c[1]},attrPresence:function(a,c){return Element.hasAttribute(a,c[1])},attr:function(c,d){var a=Element.readAttribute(c,d[1]);return a&&Selector.operators[d[2]](a,d[5]||d[6])}},handlers:{concat:function(d,c){for(var e=0,f;f=c[e];e++){d.push(f)}return d},mark:function(a){var e=Prototype.emptyFunction;for(var c=0,d;d=a[c];c++){d._countedByPrototype=e}return a},unmark:(function(){var a=(function(){var c=document.createElement("div"),f=false,e="_countedByPrototype",d="x";c[e]=d;f=(c.getAttribute(e)===d);c=null;return f})();return a?function(c){for(var d=0,e;e=c[d];d++){e.removeAttribute("_countedByPrototype")}return c}:function(c){for(var d=0,e;e=c[d];d++){e._countedByPrototype=void 0}return c}})(),index:function(a,e,h){a._countedByPrototype=Prototype.emptyFunction;if(e){for(var c=a.childNodes,f=c.length-1,d=1;f>=0;f--){var g=c[f];if(g.nodeType==1&&(!h||g._countedByPrototype)){g.nodeIndex=d++}}}else{for(var f=0,d=1,c=a.childNodes;g=c[f];f++){if(g.nodeType==1&&(!h||g._countedByPrototype)){g.nodeIndex=d++}}}},unique:function(c){if(c.length==0){return c}var e=[],f;for(var d=0,a=c.length;d<a;d++){if(typeof(f=c[d])._countedByPrototype=="undefined"){f._countedByPrototype=Prototype.emptyFunction;e.push(Element.extend(f))}}return Selector.handlers.unmark(e)},descendant:function(a){var e=Selector.handlers;for(var d=0,c=[],f;f=a[d];d++){e.concat(c,f.getElementsByTagName("*"))}return c},child:function(a){var f=Selector.handlers;for(var e=0,d=[],g;g=a[e];e++){for(var c=0,k;k=g.childNodes[c];c++){if(k.nodeType==1&&k.tagName!="!"){d.push(k)}}}return d},adjacent:function(a){for(var d=0,c=[],f;f=a[d];d++){var e=this.nextElementSibling(f);if(e){c.push(e)}}return c},laterSibling:function(a){var e=Selector.handlers;for(var d=0,c=[],f;f=a[d];d++){e.concat(c,Element.nextSiblings(f))}return c},nextElementSibling:function(a){while(a=a.nextSibling){if(a.nodeType==1){return a}}return null},previousElementSibling:function(a){while(a=a.previousSibling){if(a.nodeType==1){return a}}return null},tagName:function(a,k,d,c){var l=d.toUpperCase();var f=[],j=Selector.handlers;if(a){if(c){if(c=="descendant"){for(var g=0,e;e=a[g];g++){j.concat(f,e.getElementsByTagName(d))}return f}else{a=this[c](a)}if(d=="*"){return a}}for(var g=0,e;e=a[g];g++){if(e.tagName.toUpperCase()===l){f.push(e)}}return f}else{return k.getElementsByTagName(d)}},id:function(a,m,c,d){var l=$(c),k=Selector.handlers;if(m==document){if(!l){return[]}if(!a){return[l]}}else{if(!m.sourceIndex||m.sourceIndex<1){var a=m.getElementsByTagName("*");for(var f=0,e;e=a[f];f++){if(e.id===c){return[e]}}}}if(a){if(d){if(d=="child"){for(var g=0,e;e=a[g];g++){if(l.parentNode==e){return[l]}}}else{if(d=="descendant"){for(var g=0,e;e=a[g];g++){if(Element.descendantOf(l,e)){return[l]}}}else{if(d=="adjacent"){for(var g=0,e;e=a[g];g++){if(Selector.handlers.previousElementSibling(l)==e){return[l]}}}else{a=k[d](a)}}}}for(var g=0,e;e=a[g];g++){if(e==l){return[l]}}return[]}return(l&&Element.descendantOf(l,m))?[l]:[]},className:function(c,a,d,e){if(c&&e){c=this[e](c)}return Selector.handlers.byClassName(c,a,d)},byClassName:function(d,c,g){if(!d){d=Selector.handlers.descendant([c])}var j=" "+g+" ";for(var f=0,e=[],h,a;h=d[f];f++){a=h.className;if(a.length==0){continue}if(a==g||(" "+a+" ").include(j)){e.push(h)}}return e},attrPresence:function(d,c,a,h){if(!d){d=c.getElementsByTagName("*")}if(d&&h){d=this[h](d)}var f=[];for(var e=0,g;g=d[e];e++){if(Element.hasAttribute(g,a)){f.push(g)}}return f},attr:function(a,k,j,l,d,c){if(!a){a=k.getElementsByTagName("*")}if(a&&c){a=this[c](a)}var m=Selector.operators[d],g=[];for(var f=0,e;e=a[f];f++){var h=Element.readAttribute(e,j);if(h===null){continue}if(m(h,l)){g.push(e)}}return g},pseudo:function(c,d,f,a,e){if(c&&e){c=this[e](c)}if(!c){c=a.getElementsByTagName("*")}return Selector.pseudos[d](c,f,a)}},pseudos:{"first-child":function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(Selector.handlers.previousElementSibling(f)){continue}d.push(f)}return d},"last-child":function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(Selector.handlers.nextElementSibling(f)){continue}d.push(f)}return d},"only-child":function(c,j,a){var f=Selector.handlers;for(var e=0,d=[],g;g=c[e];e++){if(!f.previousElementSibling(g)&&!f.nextElementSibling(g)){d.push(g)}}return d},"nth-child":function(c,d,a){return Selector.pseudos.nth(c,d,a)},"nth-last-child":function(c,d,a){return Selector.pseudos.nth(c,d,a,true)},"nth-of-type":function(c,d,a){return Selector.pseudos.nth(c,d,a,false,true)},"nth-last-of-type":function(c,d,a){return Selector.pseudos.nth(c,d,a,true,true)},"first-of-type":function(c,d,a){return Selector.pseudos.nth(c,"1",a,false,true)},"last-of-type":function(c,d,a){return Selector.pseudos.nth(c,"1",a,true,true)},"only-of-type":function(c,e,a){var d=Selector.pseudos;return d["last-of-type"](d["first-of-type"](c,e,a),e,a)},getIndices:function(d,c,e){if(d==0){return c>0?[c]:[]}return $R(1,e).inject([],function(a,f){if(0==(f-c)%d&&(f-c)/d>=0){a.push(f)}return a})},nth:function(c,s,u,r,e){if(c.length==0){return[]}if(s=="even"){s="2n+0"}if(s=="odd"){s="2n+1"}var q=Selector.handlers,p=[],d=[],g;q.mark(c);for(var o=0,f;f=c[o];o++){if(!f.parentNode._countedByPrototype){q.index(f.parentNode,r,e);d.push(f.parentNode)}}if(s.match(/^\d+$/)){s=Number(s);for(var o=0,f;f=c[o];o++){if(f.nodeIndex==s){p.push(f)}}}else{if(g=s.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(g[1]=="-"){g[1]=-1}var v=g[1]?Number(g[1]):1;var t=g[2]?Number(g[2]):0;var w=Selector.pseudos.getIndices(v,t,c.length);for(var o=0,f,k=w.length;f=c[o];o++){for(var n=0;n<k;n++){if(f.nodeIndex==w[n]){p.push(f)}}}}}q.unmark(c);q.unmark(d);return p},empty:function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(f.tagName=="!"||f.firstChild){continue}d.push(f)}return d},not:function(a,e,l){var j=Selector.handlers,n,d;var k=new Selector(e).findElements(l);j.mark(k);for(var g=0,f=[],c;c=a[g];g++){if(!c._countedByPrototype){f.push(c)}}j.unmark(k);return f},enabled:function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(!f.disabled&&(!f.type||f.type!=="hidden")){d.push(f)}}return d},disabled:function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(f.disabled){d.push(f)}}return d},checked:function(c,g,a){for(var e=0,d=[],f;f=c[e];e++){if(f.checked){d.push(f)}}return d}},operators:{"=":function(c,a){return c==a},"!=":function(c,a){return c!=a},"^=":function(c,a){return c==a||c&&c.startsWith(a)},"$=":function(c,a){return c==a||c&&c.endsWith(a)},"*=":function(c,a){return c==a||c&&c.include(a)},"~=":function(c,a){return(" "+c+" ").include(" "+a+" ")},"|=":function(c,a){return("-"+(c||"").toUpperCase()+"-").include("-"+(a||"").toUpperCase()+"-")}},split:function(c){var a=[];c.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(d){a.push(d[1].strip())});return a},matchElements:function(g,j){var f=$$(j),e=Selector.handlers;e.mark(f);for(var d=0,c=[],a;a=g[d];d++){if(a._countedByPrototype){c.push(a)}}e.unmark(f);return c},findElement:function(c,d,a){if(Object.isNumber(d)){a=d;d=false}return Selector.matchElements(c,d||"*")[a||0]},findChildElements:function(f,j){j=Selector.split(j.join(","));var e=[],g=Selector.handlers;for(var d=0,c=j.length,a;d<c;d++){a=new Selector(j[d].strip());g.concat(e,a.findElements(f))}return(c>1)?g.unique(e):e}});if(Prototype.Browser.IE){Object.extend(Selector.handlers,{concat:function(d,c){for(var e=0,f;f=c[e];e++){if(f.tagName!=="!"){d.push(f)}}return d}})}function $$(){return Selector.findChildElements(document,$A(arguments))}var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(h,c){if(typeof c!="object"){c={hash:!!c}}else{if(Object.isUndefined(c.hash)){c.hash=true}}var d,g,a=false,f=c.submit;var e=h.inject({},function(j,k){if(!k.disabled&&k.name){d=k.name;g=$(k).getValue();if(g!=null&&k.type!="file"&&(k.type!="submit"||(!a&&f!==false&&(!f||d==f)&&(a=true)))){if(d in j){if(!Object.isArray(j[d])){j[d]=[j[d]]}j[d].push(g)}else{j[d]=g}}}return j});return c.hash?e:Object.toQueryString(e)}};Form.Methods={serialize:function(c,a){return Form.serializeElements(Form.getElements(c),a)},getElements:function(f){var g=$(f).getElementsByTagName("*"),e,a=[],d=Form.Element.Serializers;for(var c=0;e=g[c];c++){a.push(e)}return a.inject([],function(h,j){if(d[j.tagName.toLowerCase()]){h.push(Element.extend(j))}return h})},getInputs:function(h,d,e){h=$(h);var a=h.getElementsByTagName("input");if(!d&&!e){return $A(a).map(Element.extend)}for(var f=0,j=[],g=a.length;f<g;f++){var c=a[f];if((d&&c.type!=d)||(e&&c.name!=e)){continue}j.push(Element.extend(c))}return j},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(c){var d=$(c).getElements().findAll(function(e){return"hidden"!=e.type&&!e.disabled});var a=d.findAll(function(e){return e.hasAttribute("tabIndex")&&e.tabIndex>=0}).sortBy(function(e){return e.tabIndex}).first();return a?a:d.find(function(e){return/^(?:input|select|textarea)$/i.test(e.tagName)})},focusFirstElement:function(a){a=$(a);a.findFirstElement().activate();return a},request:function(c,a){c=$(c),a=Object.clone(a||{});var e=a.parameters,d=c.readAttribute("action")||"";if(d.blank()){d=window.location.href}a.parameters=c.serialize(true);if(e){if(Object.isString(e)){e=e.toQueryParams()}Object.extend(a.parameters,e)}if(c.hasAttribute("method")&&!a.method){a.method=c.method}return new Ajax.Request(d,a)}};Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var c=a.getValue();if(c!=undefined){var d={};d[a.name]=c;return Object.toQueryString(d)}}return""},getValue:function(a){a=$(a);var c=a.tagName.toLowerCase();return Form.Element.Serializers[c](a)},setValue:function(a,c){a=$(a);var d=a.tagName.toLowerCase();Form.Element.Serializers[d](a,c);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();if(a.select&&(a.tagName.toLowerCase()!="input"||!(/^(?:button|reset|submit)$/i.test(a.type)))){a.select()}}catch(c){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(a,c){switch(a.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(a,c);default:return Form.Element.Serializers.textarea(a,c)}},inputSelector:function(a,c){if(Object.isUndefined(c)){return a.checked?a.value:null}else{a.checked=!!c}},textarea:function(a,c){if(Object.isUndefined(c)){return a.value}else{a.value=c}},select:function(d,g){if(Object.isUndefined(g)){return this[d.type=="select-one"?"selectOne":"selectMany"](d)}else{var c,e,h=!Object.isArray(g);for(var a=0,f=d.length;a<f;a++){c=d.options[a];e=this.optionValue(c);if(h){if(e==g){c.selected=true;return}}else{c.selected=g.include(e)}}}},selectOne:function(c){var a=c.selectedIndex;return a>=0?this.optionValue(c.options[a]):null},selectMany:function(e){var a,f=e.length;if(!f){return null}for(var d=0,a=[];d<f;d++){var c=e.options[d];if(c.selected){a.push(this.optionValue(c))}}return a},optionValue:function(a){return Element.extend(a).hasAttribute("value")?a.value:a.text}};Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,a,c,d){$super(d,c);this.element=$(a);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(a,c){this.element=$(a);this.callback=c;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type){switch(a.type.toLowerCase()){case"checkbox":case"radio":Event.observe(a,"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(){var y={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}};var f=document.documentElement;var z="onmouseenter" in f&&"onmouseleave" in f;var q;if(Prototype.Browser.IE){var j={0:1,1:4,2:2};q=function(B,A){return B.button===j[A]}}else{if(Prototype.Browser.WebKit){q=function(B,A){switch(A){case 0:return B.which==1&&!B.metaKey;case 1:return B.which==1&&B.metaKey;default:return false}}}else{q=function(B,A){return B.which?(B.which===A+1):(B.button===A)}}}function t(A){return q(A,0)}function s(A){return q(A,1)}function m(A){return q(A,2)}function d(C){C=y.extend(C);var B=C.target,A=C.type,D=C.currentTarget;if(D&&D.tagName){if(A==="load"||A==="error"||(A==="click"&&D.tagName.toLowerCase()==="input"&&D.type==="radio")){B=D}}if(B.nodeType==Node.TEXT_NODE){B=B.parentNode}return Element.extend(B)}function o(B,D){var A=y.element(B);if(!D){return A}var C=[A].concat(A.ancestors());return Selector.findElement(C,D,0)}function r(A){return{x:c(A),y:a(A)}}function c(C){var B=document.documentElement,A=document.body||{scrollLeft:0};return C.pageX||(C.clientX+(B.scrollLeft||A.scrollLeft)-(B.clientLeft||0))}function a(C){var B=document.documentElement,A=document.body||{scrollTop:0};return C.pageY||(C.clientY+(B.scrollTop||A.scrollTop)-(B.clientTop||0))}function p(A){y.extend(A);A.preventDefault();A.stopPropagation();A.stopped=true}y.Methods={isLeftClick:t,isMiddleClick:s,isRightClick:m,element:d,findElement:o,pointer:r,pointerX:c,pointerY:a,stop:p};var v=Object.keys(y.Methods).inject({},function(A,B){A[B]=y.Methods[B].methodize();return A});if(Prototype.Browser.IE){function h(B){var A;switch(B.type){case"mouseover":A=B.fromElement;break;case"mouseout":A=B.toElement;break;default:return null}return Element.extend(A)}Object.extend(v,{stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}});y.extend=function(B,A){if(!B){return false}if(B._extendedByPrototype){return B}B._extendedByPrototype=Prototype.emptyFunction;var C=y.pointer(B);Object.extend(B,{target:B.srcElement||A,relatedTarget:h(B),pageX:C.x,pageY:C.y});return Object.extend(B,v)}}else{y.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(y.prototype,v);y.extend=Prototype.K}function n(E,D,F){var C=Element.retrieve(E,"prototype_event_registry");if(Object.isUndefined(C)){e.push(E);C=Element.retrieve(E,"prototype_event_registry",$H())}var A=C.get(D);if(Object.isUndefined(A)){A=[];C.set(D,A)}if(A.pluck("handler").include(F)){return false}var B;if(D.include(":")){B=function(G){if(Object.isUndefined(G.eventName)){return false}if(G.eventName!==D){return false}y.extend(G,E);F.call(E,G)}}else{if(!z&&(D==="mouseenter"||D==="mouseleave")){if(D==="mouseenter"||D==="mouseleave"){B=function(H){y.extend(H,E);var G=H.relatedTarget;while(G&&G!==E){try{G=G.parentNode}catch(I){G=E}}if(G===E){return}F.call(E,H)}}}else{B=function(G){y.extend(G,E);F.call(E,G)}}}B.handler=F;A.push(B);return B}function g(){for(var A=0,B=e.length;A<B;A++){y.stopObserving(e[A]);e[A]=null}}var e=[];if(Prototype.Browser.IE){window.attachEvent("onunload",g)}if(Prototype.Browser.WebKit){window.addEventListener("unload",Prototype.emptyFunction,false)}var l=Prototype.K;if(!z){l=function(B){var A={mouseenter:"mouseover",mouseleave:"mouseout"};return B in A?A[B]:B}}function u(D,C,E){D=$(D);var B=n(D,C,E);if(!B){return D}if(C.include(":")){if(D.addEventListener){D.addEventListener("dataavailable",B,false)}else{D.attachEvent("ondataavailable",B);D.attachEvent("onfilterchange",B)}}else{var A=l(C);if(D.addEventListener){D.addEventListener(A,B,false)}else{D.attachEvent("on"+A,B)}}return D}function k(F,D,G){F=$(F);var C=Element.retrieve(F,"prototype_event_registry");if(Object.isUndefined(C)){return F}if(D&&!G){var E=C.get(D);if(Object.isUndefined(E)){return F}E.each(function(H){Element.stopObserving(F,D,H.handler)});return F}else{if(!D){C.each(function(J){var H=J.key,I=J.value;I.each(function(K){Element.stopObserving(F,H,K.handler)})});return F}}var E=C.get(D);if(!E){return}var B=E.find(function(H){return H.handler===G});if(!B){return F}var A=l(D);if(D.include(":")){if(F.removeEventListener){F.removeEventListener("dataavailable",B,false)}else{F.detachEvent("ondataavailable",B);F.detachEvent("onfilterchange",B)}}else{if(F.removeEventListener){F.removeEventListener(A,B,false)}else{F.detachEvent("on"+A,B)}}C.set(D,E.without(B));return F}function w(D,C,B,A){D=$(D);if(Object.isUndefined(A)){A=true}if(D==document&&document.createEvent&&!D.dispatchEvent){D=document.documentElement}var E;if(document.createEvent){E=document.createEvent("HTMLEvents");E.initEvent("dataavailable",true,true)}else{E=document.createEventObject();E.eventType=A?"ondataavailable":"onfilterchange"}E.eventName=C;E.memo=B||{};if(document.createEvent){D.dispatchEvent(E)}else{D.fireEvent(E.eventType,E)}return y.extend(E)}Object.extend(y,y.Methods);Object.extend(y,{fire:w,observe:u,stopObserving:k});Element.addMethods({fire:w,observe:u,stopObserving:k});Object.extend(document,{fire:w.methodize(),observe:u.methodize(),stopObserving:k.methodize(),loaded:false});if(window.Event){Object.extend(window.Event,y)}else{window.Event=y}})();(function(){var e;function a(){if(document.loaded){return}if(e){window.clearTimeout(e)}document.loaded=true;document.fire("dom:loaded")}function d(){if(document.readyState==="complete"){document.stopObserving("readystatechange",d);a()}}function c(){try{document.documentElement.doScroll("left")}catch(f){e=c.defer();return}a()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{document.observe("readystatechange",d);if(window==top){e=c.defer()}}Event.observe(window,"load",a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(a,c){return Element.insert(a,{before:c})},Top:function(a,c){return Element.insert(a,{top:c})},Bottom:function(a,c){return Element.insert(a,{bottom:c})},After:function(a,c){return Element.insert(a,{after:c})}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(c,a,d){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(c,a,d)}this.xcomp=a;this.ycomp=d;this.offset=Element.cumulativeOffset(c);return(d>=this.offset[1]&&d<this.offset[1]+c.offsetHeight&&a>=this.offset[0]&&a<this.offset[0]+c.offsetWidth)},withinIncludingScrolloffsets:function(c,a,e){var d=Element.cumulativeScrollOffset(c);this.xcomp=a+d[0]-this.deltaX;this.ycomp=e+d[1]-this.deltaY;this.offset=Element.cumulativeOffset(c);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+c.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+c.offsetWidth)},overlap:function(c,a){if(!c){return 0}if(c=="vertical"){return((this.offset[1]+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(c=="horizontal"){return((this.offset[0]+a.offsetWidth)-this.xcomp)/a.offsetWidth}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(c,d,a){a=a||{};return Element.clonePosition(d,c,a)}};if(!document.getElementsByClassName){document.getElementsByClassName=function(c){function a(d){return d.blank()?null:"[contains(concat(' ', @class, ' '), ' "+d+" ')]"}c.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(d,f){f=f.toString().strip();var e=/\s/.test(f)?$w(f).map(a).join(""):a(f);return e?document._getElementsByXPath(".//*"+e,d):[]}:function(f,g){g=g.toString().strip();var h=[],j=(/\s/.test(g)?$w(g):null);if(!j&&!g){return h}var d=$(f).getElementsByTagName("*");g=" "+g+" ";for(var e=0,l,k;l=d[e];e++){if(l.className&&(k=" "+l.className+" ")&&(k.include(g)||(j&&j.all(function(m){return !m.toString().blank()&&k.include(" "+m+" ")})))){h.push(Element.extend(l))}}return h};return function(e,d){return $(d||document.body).getElementsByClassName(e)}}(Element.Methods)}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(c){return c.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){if(this.include(a)){return}this.set($A(this).concat(a).join(" "))},remove:function(a){if(!this.include(a)){return}this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);var Scriptaculous={Version:"1.8.2",require:function(a){document.write('<script type="text/javascript" src="'+a+'"><\/script>')},REQUIRED_PROTOTYPE:"1.6.0.3",load:function(){function a(d){var e=d.replace(/_.*|\./g,"");e=parseInt(e+"0".times(4-e.length));return d.indexOf("_")>-1?e-1:e}if((typeof Prototype=="undefined")||(typeof Element=="undefined")||(typeof Element.Methods=="undefined")||(a(Prototype.Version)<a(Scriptaculous.REQUIRED_PROTOTYPE))){throw ("script.aculo.us requires the Prototype JavaScript framework >= "+Scriptaculous.REQUIRED_PROTOTYPE)}var c=/scriptaculous\.js(\?.*)?$/;$$("head script[src]").findAll(function(d){return d.src.match(c)}).each(function(e){var f=e.src.replace(c,""),d=e.src.match(/\?.*load=([a-z,]*)/);(d?d[1]:"builder,effects,dragdrop,controls,slider,sound").split(",").each(function(g){Scriptaculous.require(f+g+".js")})})}};Scriptaculous.load();String.prototype.parseColor=function(){var a="#";if(this.slice(0,4)=="rgb("){var d=this.slice(4,this.length-1).split(",");var c=0;do{a+=parseInt(d[c]).toColorPart()}while(++c<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var c=1;c<4;c++){a+=(this.charAt(c)+this.charAt(c)).toLowerCase()}}if(this.length==7){a=this.toLowerCase()}}}return(a.length==7?a:(arguments[0]||this))};Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(c){return(c.nodeType==3?c.nodeValue:(c.hasChildNodes()?Element.collectTextNodes(c):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,c){return $A($(a).childNodes).collect(function(d){return(d.nodeType==3?d.nodeValue:((d.hasChildNodes()&&!Element.hasClassName(d,c))?Element.collectTextNodesIgnoreClass(d,c):""))}).flatten().join("")};Element.setContentZoom=function(a,c){a=$(a);a.setStyle({fontSize:(c/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var d=document.createTextNode(" ");a.appendChild(d);a.removeChild(d)}catch(c){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return(-Math.cos(a*Math.PI)/2)+0.5},reverse:function(a){return 1-a},flicker:function(a){var a=((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4;return a>1?1:a},wobble:function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5},pulse:function(c,a){return(-Math.cos((c*((a||5)-0.5)*2)*Math.PI)/2)+0.5},spring:function(a){return 1-(Math.cos(a*4.5*Math.PI)*Math.exp(-a*6))},none:function(a){return 0},full:function(a){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var c="position:relative";if(Prototype.Browser.IE){c+=";zoom:1"}a=$(a);$A(a.childNodes).each(function(d){if(d.nodeType==3){d.nodeValue.toArray().each(function(e){a.insertBefore(new Element("span",{style:c}).update(e==" "?String.fromCharCode(160):e),d)});Element.remove(d)}})},multiple:function(c,d){var f;if(((typeof c=="object")||Object.isFunction(c))&&(c.length)){f=c}else{f=$(c).childNodes}var a=Object.extend({speed:0.1,delay:0},arguments[2]||{});var e=a.delay;$A(f).each(function(h,g){new d(h,Object.extend(a,{delay:g*a.speed+e}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(c,d){c=$(c);d=(d||"appear").toLowerCase();var a=Object.extend({queue:{position:"end",scope:(c.id||"global"),limit:1}},arguments[2]||{});Effect[c.visible()?Effect.PAIRS[d][1]:Effect.PAIRS[d][0]](c,a)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(c){var d=new Date().getTime();var a=Object.isString(c.options.queue)?c.options.queue:c.options.queue.position;switch(a){case"front":this.effects.findAll(function(f){return f.state=="idle"}).each(function(f){f.startOn+=c.finishOn;f.finishOn+=c.finishOn});break;case"with-last":d=this.effects.pluck("startOn").max()||d;break;case"end":d=this.effects.pluck("finishOn").max()||d;break}c.startOn+=d;c.finishOn+=d;if(!c.options.queue.limit||(this.effects.length<c.options.queue.limit)){this.effects.push(c)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(a){this.effects=this.effects.reject(function(c){return c==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var d=new Date().getTime();for(var c=0,a=this.effects.length;c<a;c++){this.effects[c]&&this.effects[c].loop(d)}}});Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a)){return a}return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(a){function c(e,d){return((e[d+"Internal"]?"this.options."+d+"Internal(this);":"")+(e[d]?"this.options."+d+"(this);":""))}if(a&&a.transition===false){a.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),a||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function d(f,e){if(f.options[e+"Internal"]){f.options[e+"Internal"](f)}if(f.options[e]){f.options[e](f)}}return function(e){if(this.state==="idle"){this.state="running";d(this,"beforeSetup");if(this.setup){this.setup()}d(this,"afterSetup")}if(this.state==="running"){e=(this.options.transition(e)*this.fromToDelta)+this.options.from;this.position=e;d(this,"beforeUpdate");if(this.update){this.update(e)}d(this,"afterUpdate")}}})();this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(d){if(d>=this.startOn){if(d>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}var c=(d-this.startOn)/this.totalTime,a=(c*this.totalFrames).round();if(a>this.currentFrame){this.render(c);this.currentFrame=a}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},inspect:function(){var a=$H();for(property in this){if(!Object.isFunction(this[property])){a.set(property,this[property])}}return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(a){this.effects=a||[];this.start(arguments[1])},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(c){c.render(1);c.cancel();c.event("beforeFinish");if(c.finish){c.finish(a)}c.event("afterFinish")})}});Effect.Tween=Class.create(Effect.Base,{initialize:function(d,g,f){d=Object.isString(d)?$(d):d;var c=$A(arguments),e=c.last(),a=c.length==5?c[3]:null;this.method=Object.isFunction(e)?e.bind(d):Object.isFunction(d[e])?d[e].bind(d):function(h){d[e]=h};this.start(Object.extend({from:g,to:f},a||{}))},update:function(a){this.method(a)}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(c){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var a=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(a)},update:function(a){this.element.setOpacity(a)}});Effect.Move=Class.create(Effect.Base,{initialize:function(c){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(a)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(a){this.element.setStyle({left:(this.options.x*a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}});Effect.MoveBy=function(c,a,d){return new Effect.Move(c,Object.extend({x:d,y:a},arguments[3]||{}))};Effect.Scale=Class.create(Effect.Base,{initialize:function(c,d){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:d},arguments[2]||{});this.start(a)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(c){this.originalStyle[c]=this.element.style[c]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(c){if(a.indexOf(c)>0){this.fontSize=parseFloat(a);this.fontSizeType=c}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}},update:function(a){var c=(this.options.scaleFrom/100)+(this.factor*a);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*c+this.fontSizeType})}this.setDimensions(this.dims[0]*c,this.dims[1]*c)},finish:function(a){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle)}},setDimensions:function(a,f){var g={};if(this.options.scaleX){g.width=f.round()+"px"}if(this.options.scaleY){g.height=a.round()+"px"}if(this.options.scaleFromCenter){var e=(a-this.dims[0])/2;var c=(f-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){g.top=this.originalTop-e+"px"}if(this.options.scaleX){g.left=this.originalLeft-c+"px"}}else{if(this.options.scaleY){g.top=-e+"px"}if(this.options.scaleX){g.left=-c+"px"}}}this.element.setStyle(g)}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(c){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(a)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color")}this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(c,d,e){return c+((this._base[e]+(this._delta[e]*a)).round().toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(d){var c=arguments[1]||{},a=document.viewport.getScrollOffsets(),e=$(d).cumulativeOffset();if(c.offset){e[1]+=c.offset}return new Effect.Tween(null,a.top,e[1],c,function(f){scrollTo(a.left,f.round())})};Effect.Fade=function(d){d=$(d);var a=d.getInlineOpacity();var c=Object.extend({from:d.getOpacity()||1,to:0,afterFinishInternal:function(e){if(e.options.to!=0){return}e.element.hide().setStyle({opacity:a})}},arguments[1]||{});return new Effect.Opacity(d,c)};Effect.Appear=function(c){c=$(c);var a=Object.extend({from:(c.getStyle("display")=="none"?0:c.getOpacity()||0),to:1,afterFinishInternal:function(d){d.element.forceRerendering()},beforeSetup:function(d){d.element.setOpacity(d.options.from).show()}},arguments[1]||{});return new Effect.Opacity(c,a)};Effect.Puff=function(c){c=$(c);var a={opacity:c.getInlineOpacity(),position:c.getStyle("position"),top:c.style.top,left:c.style.left,width:c.style.width,height:c.style.height};return new Effect.Parallel([new Effect.Scale(c,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(c,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(d){Position.absolutize(d.effects[0].element)},afterFinishInternal:function(d){d.effects[0].element.hide().setStyle(a)}},arguments[1]||{}))};Effect.BlindUp=function(a){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(c){c.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(c){c=$(c);var a=c.getDimensions();return new Effect.Scale(c,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:a.height,originalWidth:a.width},restoreAfterFinish:true,afterSetup:function(d){d.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(d){d.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(c){c=$(c);var a=c.getInlineOpacity();return new Effect.Appear(c,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(d){new Effect.Scale(d.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(e){e.element.makePositioned().makeClipping()},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned().setStyle({opacity:a})}})}},arguments[1]||{}))};Effect.DropOut=function(c){c=$(c);var a={top:c.getStyle("top"),left:c.getStyle("left"),opacity:c.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(c,{x:0,y:100,sync:true}),new Effect.Opacity(c,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(d){d.effects[0].element.makePositioned()},afterFinishInternal:function(d){d.effects[0].element.hide().undoPositioned().setStyle(a)}},arguments[1]||{}))};Effect.Shake=function(e){e=$(e);var c=Object.extend({distance:20,duration:0.5},arguments[1]||{});var f=parseFloat(c.distance);var d=parseFloat(c.duration)/10;var a={top:e.getStyle("top"),left:e.getStyle("left")};return new Effect.Move(e,{x:f,y:0,duration:d,afterFinishInternal:function(g){new Effect.Move(g.element,{x:-f*2,y:0,duration:d*2,afterFinishInternal:function(h){new Effect.Move(h.element,{x:f*2,y:0,duration:d*2,afterFinishInternal:function(j){new Effect.Move(j.element,{x:-f*2,y:0,duration:d*2,afterFinishInternal:function(k){new Effect.Move(k.element,{x:f*2,y:0,duration:d*2,afterFinishInternal:function(l){new Effect.Move(l.element,{x:-f,y:0,duration:d,afterFinishInternal:function(m){m.element.undoPositioned().setStyle(a)}})}})}})}})}})}})};Effect.SlideDown=function(d){d=$(d).cleanWhitespace();var a=d.down().getStyle("bottom");var c=d.getDimensions();return new Effect.Scale(d,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:c.height,originalWidth:c.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();if(window.opera){e.element.setStyle({top:""})}e.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:(e.dims[0]-e.element.clientHeight)+"px"})},afterFinishInternal:function(e){e.element.undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))};Effect.SlideUp=function(d){d=$(d).cleanWhitespace();var a=d.down().getStyle("bottom");var c=d.getDimensions();return new Effect.Scale(d,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:c.height,originalWidth:c.width},restoreAfterFinish:true,afterSetup:function(e){e.element.makePositioned();e.element.down().makePositioned();if(window.opera){e.element.setStyle({top:""})}e.element.makeClipping().show()},afterUpdateInternal:function(e){e.element.down().setStyle({bottom:(e.dims[0]-e.element.clientHeight)+"px"})},afterFinishInternal:function(e){e.element.hide().undoClipping().undoPositioned();e.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(c){c.element.makeClipping()},afterFinishInternal:function(c){c.element.hide().undoClipping()}})};Effect.Grow=function(d){d=$(d);var c=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var a={top:d.style.top,left:d.style.left,height:d.style.height,width:d.style.width,opacity:d.getInlineOpacity()};var h=d.getDimensions();var j,g;var f,e;switch(c.direction){case"top-left":j=g=f=e=0;break;case"top-right":j=h.width;g=e=0;f=-h.width;break;case"bottom-left":j=f=0;g=h.height;e=-h.height;break;case"bottom-right":j=h.width;g=h.height;f=-h.width;e=-h.height;break;case"center":j=h.width/2;g=h.height/2;f=-h.width/2;e=-h.height/2;break}return new Effect.Move(d,{x:j,y:g,duration:0.01,beforeSetup:function(k){k.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(k){new Effect.Parallel([new Effect.Opacity(k.element,{sync:true,to:1,from:0,transition:c.opacityTransition}),new Effect.Move(k.element,{x:f,y:e,sync:true,transition:c.moveTransition}),new Effect.Scale(k.element,100,{scaleMode:{originalHeight:h.height,originalWidth:h.width},sync:true,scaleFrom:window.opera?1:0,transition:c.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(l){l.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(l){l.effects[0].element.undoClipping().undoPositioned().setStyle(a)}},c))}})};Effect.Shrink=function(d){d=$(d);var c=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var a={top:d.style.top,left:d.style.left,height:d.style.height,width:d.style.width,opacity:d.getInlineOpacity()};var g=d.getDimensions();var f,e;switch(c.direction){case"top-left":f=e=0;break;case"top-right":f=g.width;e=0;break;case"bottom-left":f=0;e=g.height;break;case"bottom-right":f=g.width;e=g.height;break;case"center":f=g.width/2;e=g.height/2;break}return new Effect.Parallel([new Effect.Opacity(d,{sync:true,to:0,from:1,transition:c.opacityTransition}),new Effect.Scale(d,window.opera?1:0,{sync:true,transition:c.scaleTransition,restoreAfterFinish:true}),new Effect.Move(d,{x:f,y:e,sync:true,transition:c.moveTransition})],Object.extend({beforeStartInternal:function(h){h.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(h){h.effects[0].element.hide().undoClipping().undoPositioned().setStyle(a)}},c))};Effect.Pulsate=function(d){d=$(d);var c=arguments[1]||{},a=d.getInlineOpacity(),f=c.transition||Effect.Transitions.linear,e=function(g){return 1-f((-Math.cos((g*(c.pulses||5)*2)*Math.PI)/2)+0.5)};return new Effect.Opacity(d,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(g){g.element.setStyle({opacity:a})}},c),{transition:e}))};Effect.Fold=function(c){c=$(c);var a={top:c.style.top,left:c.style.left,width:c.style.width,height:c.style.height};c.makeClipping();return new Effect.Scale(c,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(d){new Effect.Scale(c,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(e){e.element.hide().undoClipping().setStyle(a)}})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(d){this.element=$(d);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(a.style)){this.style=$H(a.style)}else{if(a.style.include(":")){this.style=a.style.parseStyle()}else{this.element.addClassName(a.style);this.style=$H(this.element.getStyles());this.element.removeClassName(a.style);var c=this.element.getStyles();this.style=this.style.reject(function(e){return e.value==c[e.key]});a.afterFinishInternal=function(e){e.element.addClassName(e.options.style);e.transforms.each(function(f){e.element.style[f.style]=""})}}}this.start(a)},setup:function(){function a(c){if(!c||["rgba(0, 0, 0, 0)","transparent"].include(c)){c="#ffffff"}c=c.parseColor();return $R(0,2).map(function(d){return parseInt(c.slice(d*2+1,d*2+3),16)})}this.transforms=this.style.map(function(h){var g=h[0],f=h[1],e=null;if(f.parseColor("#zzzzzz")!="#zzzzzz"){f=f.parseColor();e="color"}else{if(g=="opacity"){f=parseFloat(f);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(f)){var d=f.match(/^([\+\-]?[0-9\.]+)(.*)$/);f=parseFloat(d[1]);e=(d.length==3)?d[2]:null}}}var c=this.element.getStyle(g);return{style:g.camelize(),originalValue:e=="color"?a(c):parseFloat(c||0),targetValue:e=="color"?a(f):f,unit:e}}.bind(this)).reject(function(c){return((c.originalValue==c.targetValue)||(c.unit!="color"&&(isNaN(c.originalValue)||isNaN(c.targetValue))))})},update:function(a){var e={},c,d=this.transforms.length;while(d--){e[(c=this.transforms[d]).style]=c.unit=="color"?"#"+(Math.round(c.originalValue[0]+(c.targetValue[0]-c.originalValue[0])*a)).toColorPart()+(Math.round(c.originalValue[1]+(c.targetValue[1]-c.originalValue[1])*a)).toColorPart()+(Math.round(c.originalValue[2]+(c.targetValue[2]-c.originalValue[2])*a)).toColorPart():(c.originalValue+(c.targetValue-c.originalValue)*a).toFixed(3)+(c.unit===null?"":c.unit)}this.element.setStyle(e,true)}});Effect.Transform=Class.create({initialize:function(a){this.tracks=[];this.options=arguments[1]||{};this.addTracks(a)},addTracks:function(a){a.each(function(c){c=$H(c);var d=c.values().first();this.tracks.push($H({ids:c.keys().first(),effect:Effect.Morph,options:{style:d}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var e=a.get("ids"),d=a.get("effect"),c=a.get("options");var f=[$(e)||$$(e)].flatten();return f.map(function(g){return new d(g,Object.extend({sync:true},c))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var c,a=$H();if(Prototype.Browser.WebKit){c=new Element("div",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';c=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(d){if(c[d]){a.set(d,c[d])}});if(Prototype.Browser.IE&&this.include("opacity")){a.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1])}return a};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(c){var a=document.defaultView.getComputedStyle($(c),null);return Element.CSS_PROPERTIES.inject({},function(d,e){d[e]=a[e];return d})}}else{Element.getStyles=function(c){c=$(c);var a=c.currentStyle,d;d=Element.CSS_PROPERTIES.inject({},function(e,f){e[f]=a[f];return e});if(!d.opacity){d.opacity=c.getOpacity()}return d}}Effect.Methods={morph:function(a,c){a=$(a);new Effect.Morph(a,Object.extend({style:c},arguments[2]||{}));return a},visualEffect:function(d,f,c){d=$(d);var e=f.dasherize().camelize(),a=e.charAt(0).toUpperCase()+e.substring(1);new Effect[a](d,c);return d},highlight:function(c,a){c=$(c);new Effect.Highlight(c,a);return c}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(d,c){d=$(d);Effect[a.charAt(0).toUpperCase()+a.substring(1)](d,c);return d}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);if(Object.isUndefined(Effect)){throw ("dragdrop.js requires including script.aculo.us' effects.js library")}var Droppables={drops:[],remove:function(a){this.drops=this.drops.reject(function(c){return c.element==$(a)})},add:function(c){c=$(c);var a=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(a.containment){a._containers=[];var d=a.containment;if(Object.isArray(d)){d.each(function(e){a._containers.push($(e))})}else{a._containers.push($(d))}}if(a.accept){a.accept=[a.accept].flatten()}Element.makePositioned(c);a.element=c;this.drops.push(a)},findDeepestChild:function(a){deepest=a[0];for(i=1;i<a.length;++i){if(Element.isParent(a[i].element,deepest.element)){deepest=a[i]}}return deepest},isContained:function(c,a){var d;if(a.tree){d=c.treeNode}else{d=c.parentNode}return a._containers.detect(function(e){return d==e})},isAffected:function(a,d,c){return((c.element!=d)&&((!c._containers)||this.isContained(d,c))&&((!c.accept)||(Element.classNames(d).detect(function(e){return c.accept.include(e)})))&&Position.within(c.element,a[0],a[1]))},deactivate:function(a){if(a.hoverclass){Element.removeClassName(a.element,a.hoverclass)}this.last_active=null},activate:function(a){if(a.hoverclass){Element.addClassName(a.element,a.hoverclass)}this.last_active=a},show:function(a,d){if(!this.drops.length){return}var c,e=[];this.drops.each(function(f){if(Droppables.isAffected(a,d,f)){e.push(f)}});if(e.length>0){c=Droppables.findDeepestChild(e)}if(this.last_active&&this.last_active!=c){this.deactivate(this.last_active)}if(c){Position.within(c.element,a[0],a[1]);if(c.onHover){c.onHover(d,c.element,Position.overlap(c.overlap,c.element))}if(c!=this.last_active){Droppables.activate(c)}}},fire:function(c,a){if(!this.last_active){return}Position.prepare();if(this.isAffected([Event.pointerX(c),Event.pointerY(c)],a,this.last_active)){if(this.last_active.onDrop){this.last_active.onDrop(a,this.last_active.element,c);return true}}},reset:function(){if(this.last_active){this.deactivate(this.last_active)}}};var Draggables={drags:[],observers:[],register:function(a){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(a)},unregister:function(a){this.drags=this.drags.reject(function(c){return c==a});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(a){if(a.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=a}.bind(this),a.options.delay)}else{window.focus();this.activeDraggable=a}},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(!this.activeDraggable){return}var c=[Event.pointerX(a),Event.pointerY(a)];if(this._lastPointer&&(this._lastPointer.inspect()==c.inspect())){return}this._lastPointer=c;this.activeDraggable.updateDrag(a,c)},endDrag:function(a){if(this._timeout){clearTimeout(this._timeout);this._timeout=null}if(!this.activeDraggable){return}this._lastPointer=null;this.activeDraggable.endDrag(a);this.activeDraggable=null},keyPress:function(a){if(this.activeDraggable){this.activeDraggable.keyPress(a)}},addObserver:function(a){this.observers.push(a);this._cacheObserverCallbacks()},removeObserver:function(a){this.observers=this.observers.reject(function(c){return c.element==a});this._cacheObserverCallbacks()},notify:function(c,a,d){if(this[c+"Count"]>0){this.observers.each(function(e){if(e[c]){e[c](c,a,d)}})}if(a.options[c]){a.options[c](a,d)}},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(a){Draggables[a+"Count"]=Draggables.observers.select(function(c){return c[a]}).length})}};var Draggable=Class.create({initialize:function(c){var d={handle:false,reverteffect:function(g,f,e){var h=Math.sqrt(Math.abs(f^2)+Math.abs(e^2))*0.02;new Effect.Move(g,{x:-e,y:-f,duration:h,queue:{scope:"_draggable",position:"end"}})},endeffect:function(f){var e=Object.isNumber(f._opacity)?f._opacity:1;new Effect.Opacity(f,{duration:0.2,from:0.7,to:e,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[f]=false}})},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect)){Object.extend(d,{starteffect:function(e){e._opacity=Element.getOpacity(e);Draggable._dragging[e]=true;new Effect.Opacity(e,{duration:0.2,from:e._opacity,to:0.7})}})}var a=Object.extend(d,arguments[1]||{});this.element=$(c);if(a.handle&&Object.isString(a.handle)){this.handle=this.element.down("."+a.handle,0)}if(!this.handle){this.handle=$(a.handle)}if(!this.handle){this.handle=this.element}if(a.scroll&&!a.scroll.scrollTo&&!a.scroll.outerHTML){a.scroll=$(a.scroll);this._isScrollChild=Element.childOf(this.element,a.scroll)}Element.makePositioned(this.element);this.options=a;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return([parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")])},initDrag:function(a){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]){return}if(Event.isLeftClick(a)){var d=Event.element(a);if((tag_name=d.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA")){return}var c=[Event.pointerX(a),Event.pointerY(a)];var e=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(f){return(c[f]-e[f])});Draggables.activate(this);Event.stop(a)}},startDrag:function(c){this.dragging=true;if(!this.delta){this.delta=this.currentDelta()}if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);this._originallyAbsolute=(this.element.getStyle("position")=="absolute");if(!this._originallyAbsolute){Position.absolutize(this.element)}this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll){if(this.options.scroll==window){var a=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=a.left;this.originalScrollTop=a.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}}Draggables.notify("onStart",this,c);if(this.options.starteffect){this.options.starteffect(this.element)}},updateDrag:function(event,pointer){if(!this.dragging){this.startDrag(event)}if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element)}Draggables.notify("onDrag",this,event);this.draw(pointer);if(this.options.change){this.options.change(this)}if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height]}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight)}var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)}if(pointer[1]<(p[1]+this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)}if(pointer[0]>(p[2]-this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)}if(pointer[1]>(p[3]-this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)}this.startScrolling(speed)}if(Prototype.Browser.WebKit){window.scrollBy(0,0)}Event.stop(event)},finishDrag:function(c,g){this.dragging=false;if(this.options.quiet){Position.prepare();var f=[Event.pointerX(c),Event.pointerY(c)];Droppables.show(f,this.element)}if(this.options.ghosting){if(!this._originallyAbsolute){Position.relativize(this.element)}delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null}var h=false;if(g){h=Droppables.fire(c,this.element);if(!h){h=false}}if(h&&this.options.onDropped){this.options.onDropped(this.element)}Draggables.notify("onEnd",this,c);var a=this.options.revert;if(a&&Object.isFunction(a)){a=a(this.element)}var e=this.currentDelta();if(a&&this.options.reverteffect){if(h==0||a!="failure"){this.options.reverteffect(this.element,e[1]-this.delta[1],e[0]-this.delta[0])}}else{this.delta=e}if(this.options.zindex){this.element.style.zIndex=this.originalZ}if(this.options.endeffect){this.options.endeffect(this.element)}Draggables.deactivate(this);Droppables.reset()},keyPress:function(a){if(a.keyCode!=Event.KEY_ESC){return}this.finishDrag(a,false);Event.stop(a)},endDrag:function(a){if(!this.dragging){return}this.stopScrolling();this.finishDrag(a,true);Event.stop(a)},draw:function(a){var h=Position.cumulativeOffset(this.element);if(this.options.ghosting){var e=Position.realOffset(this.element);h[0]+=e[0]-Position.deltaX;h[1]+=e[1]-Position.deltaY}var g=this.currentDelta();h[0]-=g[0];h[1]-=g[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){h[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;h[1]-=this.options.scroll.scrollTop-this.originalScrollTop}var f=[0,1].map(function(d){return(a[d]-h[d]-this.offset[d])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){f=this.options.snap(f[0],f[1],this)}else{if(Object.isArray(this.options.snap)){f=f.map(function(d,j){return(d/this.options.snap[j]).round()*this.options.snap[j]}.bind(this))}else{f=f.map(function(d){return(d/this.options.snap).round()*this.options.snap}.bind(this))}}}var c=this.element.style;if((!this.options.constraint)||(this.options.constraint=="horizontal")){c.left=f[0]+"px"}if((!this.options.constraint)||(this.options.constraint=="vertical")){c.top=f[1]+"px"}if(c.visibility=="hidden"){c.visibility=""}},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(a){if(!(a[0]||a[1])){return}this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10)},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0){Draggables._lastScrollPointer[0]=0}if(Draggables._lastScrollPointer[1]<0){Draggables._lastScrollPointer[1]=0}this.draw(Draggables._lastScrollPointer)}if(this.options.change){this.options.change(this)}},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}return{top:T,left:L,width:W,height:H}}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(c,a){this.element=$(c);this.observer=a;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element)){this.observer(this.element)}}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(a){while(a.tagName.toUpperCase()!="BODY"){if(a.id&&Sortable.sortables[a.id]){return a}a=a.parentNode}},options:function(a){a=Sortable._findRootElement($(a));if(!a){return}return Sortable.sortables[a.id]},destroy:function(a){a=$(a);var c=Sortable.sortables[a.id];if(c){Draggables.removeObserver(c.element);c.droppables.each(function(e){Droppables.remove(e)});c.draggables.invoke("destroy");delete Sortable.sortables[c.element.id]}},create:function(d){d=$(d);var c=Object.extend({element:d,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:d,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(d);var a={revert:true,quiet:c.quiet,scroll:c.scroll,scrollSpeed:c.scrollSpeed,scrollSensitivity:c.scrollSensitivity,delay:c.delay,ghosting:c.ghosting,constraint:c.constraint,handle:c.handle};if(c.starteffect){a.starteffect=c.starteffect}if(c.reverteffect){a.reverteffect=c.reverteffect}else{if(c.ghosting){a.reverteffect=function(g){g.style.top=0;g.style.left=0}}}if(c.endeffect){a.endeffect=c.endeffect}if(c.zindex){a.zindex=c.zindex}var e={overlap:c.overlap,containment:c.containment,tree:c.tree,hoverclass:c.hoverclass,onHover:Sortable.onHover};var f={onHover:Sortable.onEmptyHover,overlap:c.overlap,containment:c.containment,hoverclass:c.hoverclass};Element.cleanWhitespace(d);c.draggables=[];c.droppables=[];if(c.dropOnEmpty||c.tree){Droppables.add(d,f);c.droppables.push(d)}(c.elements||this.findElements(d,c)||[]).each(function(j,g){var h=c.handles?$(c.handles[g]):(c.handle?$(j).select("."+c.handle)[0]:j);c.draggables.push(new Draggable(j,Object.extend(a,{handle:h})));Droppables.add(j,e);if(c.tree){j.treeNode=d}c.droppables.push(j)});if(c.tree){(Sortable.findTreeElements(d,c)||[]).each(function(g){Droppables.add(g,f);g.treeNode=d;c.droppables.push(g)})}this.sortables[d.id]=c;Draggables.addObserver(new SortableObserver(d,c.onUpdate))},findElements:function(c,a){return Element.findChildren(c,a.only,a.tree?true:false,a.tag)},findTreeElements:function(c,a){return Element.findChildren(c,a.only,a.tree?true:false,a.treeTag)},onHover:function(f,e,a){if(Element.isParent(e,f)){return}if(a>0.33&&a<0.66&&Sortable.options(e).tree){return}else{if(a>0.5){Sortable.mark(e,"before");if(e.previousSibling!=f){var c=f.parentNode;f.style.visibility="hidden";e.parentNode.insertBefore(f,e);if(e.parentNode!=c){Sortable.options(c).onChange(f)}Sortable.options(e.parentNode).onChange(f)}}else{Sortable.mark(e,"after");var d=e.nextSibling||null;if(d!=f){var c=f.parentNode;f.style.visibility="hidden";e.parentNode.insertBefore(f,d);if(e.parentNode!=c){Sortable.options(c).onChange(f)}Sortable.options(e.parentNode).onChange(f)}}}},onEmptyHover:function(f,h,j){var k=f.parentNode;var a=Sortable.options(h);if(!Element.isParent(h,f)){var g;var d=Sortable.findElements(h,{tag:a.tag,only:a.only});var c=null;if(d){var e=Element.offsetSize(h,a.overlap)*(1-j);for(g=0;g<d.length;g+=1){if(e-Element.offsetSize(d[g],a.overlap)>=0){e-=Element.offsetSize(d[g],a.overlap)}else{if(e-(Element.offsetSize(d[g],a.overlap)/2)>=0){c=g+1<d.length?d[g+1]:null;break}else{c=d[g];break}}}}h.insertBefore(f,c);Sortable.options(k).onChange(f);a.onChange(f)}},unmark:function(){if(Sortable._marker){Sortable._marker.hide()}},mark:function(c,a){var e=Sortable.options(c.parentNode);if(e&&!e.ghosting){return}if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var d=Position.cumulativeOffset(c);Sortable._marker.setStyle({left:d[0]+"px",top:d[1]+"px"});if(a=="after"){if(e.overlap=="horizontal"){Sortable._marker.setStyle({left:(d[0]+c.clientWidth)+"px"})}else{Sortable._marker.setStyle({top:(d[1]+c.clientHeight)+"px"})}}Sortable._marker.show()},_tree:function(f,c,g){var e=Sortable.findElements(f,c)||[];for(var d=0;d<e.length;++d){var a=e[d].id.match(c.format);if(!a){continue}var h={id:encodeURIComponent(a?a[1]:null),element:f,parent:g,children:[],position:g.children.length,container:$(e[d]).down(c.treeTag)};if(h.container){this._tree(h.container,c,h)}g.children.push(h)}return g},tree:function(e){e=$(e);var d=this.options(e);var c=Object.extend({tag:d.tag,treeTag:d.treeTag,only:d.only,name:e.id,format:d.format},arguments[1]||{});var a={id:null,parent:null,children:[],container:e,position:0};return Sortable._tree(e,c,a)},_constructIndex:function(c){var a="";do{if(c.id){a="["+c.position+"]"+a}}while((c=c.parent)!=null);return a},sequence:function(c){c=$(c);var a=Object.extend(this.options(c),arguments[1]||{});return $(this.findElements(c,a)||[]).map(function(d){return d.id.match(a.format)?d.id.match(a.format)[1]:""})},setSequence:function(c,d){c=$(c);var a=Object.extend(this.options(c),arguments[2]||{});var e={};this.findElements(c,a).each(function(f){if(f.id.match(a.format)){e[f.id.match(a.format)[1]]=[f,f.parentNode]}f.parentNode.removeChild(f)});d.each(function(f){var g=e[f];if(g){g[1].appendChild(g[0]);delete e[f]}})},serialize:function(d){d=$(d);var c=Object.extend(Sortable.options(d),arguments[1]||{});var a=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:d.id);if(c.tree){return Sortable.tree(d,arguments[1]).children.map(function(e){return[a+Sortable._constructIndex(e)+"[id]="+encodeURIComponent(e.id)].concat(e.children.map(arguments.callee))}).flatten().join("&")}else{return Sortable.sequence(d,arguments[1]).map(function(e){return a+"[]="+encodeURIComponent(e)}).join("&")}}};Element.isParent=function(c,a){if(!c.parentNode||c==a){return false}if(c.parentNode==a){return true}return Element.isParent(c.parentNode,a)};Element.findChildren=function(e,c,a,d){if(!e.hasChildNodes()){return null}d=d.toUpperCase();if(c){c=[c].flatten()}var f=[];$A(e.childNodes).each(function(h){if(h.tagName&&h.tagName.toUpperCase()==d&&(!c||(Element.classNames(h).detect(function(j){return c.include(j)})))){f.push(h)}if(a){var g=Element.findChildren(h,c,a,d);if(g){f.push(g)}}});return(f.length>0?f.flatten():[])};Element.offsetSize=function(a,c){return a["offset"+((c=="vertical"||c=="height")?"Height":"Width")]};if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library")}var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(c,d,a){c=$(c);this.element=c;this.update=$(d);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions){this.setOptions(a)}else{this.options=a||{}}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(e,f){if(!f.style.position||f.style.position=="absolute"){f.style.position="absolute";Position.clone(e,f,{setHeight:false,offsetTop:e.offsetHeight})}Effect.Appear(f,{duration:0.15})};this.options.onHide=this.options.onHide||function(e,f){new Effect.Fade(f,{duration:0.15})};if(typeof(this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens)}if(!this.options.tokens.include("\n")){this.options.tokens.push("\n")}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this.element,this.update)}if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+"_iefix")}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50)}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix)},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update)}if(this.iefix){Element.hide(this.iefix)}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator)}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator)}},onKeyPress:function(a){if(this.active){switch(a.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(a);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(a);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(a);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(a);return}}else{if(a.keyCode==Event.KEY_TAB||a.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&a.keyCode==0)){return}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000)},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices()},onHover:function(c){var a=Event.findElement(c,"LI");if(this.index!=a.autocompleteIndex){this.index=a.autocompleteIndex;this.render()}Event.stop(c)},onClick:function(c){var a=Event.findElement(c,"LI");this.index=a.autocompleteIndex;this.selectEntry();this.hide()},onBlur:function(a){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false},render:function(){if(this.entryCount>0){for(var a=0;a<this.entryCount;a++){this.index==a?Element.addClassName(this.getEntry(a),"selected"):Element.removeClassName(this.getEntry(a),"selected")}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1;this.update.scrollTop=this.update.scrollHeight}var c=this.getEntry(this.index),a=c.offsetTop;if(a<this.update.scrollTop){this.update.scrollTop=this.update.scrollTop-c.offsetHeight}},markNext:function(){if(this.index<this.entryCount-1){this.index++}else{this.index=0;this.update.scrollTop=0}var a=this.getEntry(this.index),c=a.offsetTop+a.offsetHeight;if(c>this.update.scrollTop+this.update.offsetHeight){this.update.scrollTop=this.update.scrollTop+a.offsetHeight}},getEntry:function(a){return this.update.firstChild.childNodes[a]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry())},updateElement:function(g){if(this.options.updateElement){this.options.updateElement(g);return}var e="";if(this.options.select){var a=$(g).select("."+this.options.select)||[];if(a.length>0){e=Element.collectTextNodes(a[0],this.options.select)}}else{e=Element.collectTextNodesIgnoreClass(g,"informal")}var d=this.getTokenBounds();if(d[0]!=-1){var f=this.element.value.substr(0,d[0]);var c=this.element.value.substr(d[0]).match(/^\s+/);if(c){f+=c[0]}this.element.value=f+e+this.element.value.substr(d[1])}else{this.element.value=e}this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,g)}},updateChoices:function(d){if(!this.changed&&this.hasFocus){this.update.innerHTML=d;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var a=0;a<this.entryCount;a++){var c=this.getEntry(a);c.autocompleteIndex=a;this.addObservers(c)}}else{this.entryCount=0}this.stopIndicator();this.update.scrollTop=0;this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},addObservers:function(a){Event.observe(a,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(a,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices()}else{this.active=false;this.hide()}this.oldElementValue=this.element.value},getToken:function(){var a=this.getTokenBounds();return this.element.value.substring(a[0],a[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds){return this.tokenBounds}var f=this.element.value;if(f.strip().empty()){return[-1,0]}var g=arguments.callee.getFirstDifferencePos(f,this.oldElementValue);var j=(g==this.oldElementValue.length?1:0);var e=-1,d=f.length;var h;for(var c=0,a=this.options.tokens.length;c<a;++c){h=f.lastIndexOf(this.options.tokens[c],g+j-1);if(h>e){e=h}h=f.indexOf(this.options.tokens[c],g+j);if(-1!=h&&h<d){d=h}}return(this.tokenBounds=[e+1,d])}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(d,a){var e=Math.min(d.length,a.length);for(var c=0;c<e;++c){if(d[c]!=a[c]){return c}}return e};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(d,e,c,a){this.baseInitialize(d,e,a);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=c},getUpdatedChoices:function(){this.startIndicator();var a=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,a):a;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams}new Ajax.Request(this.url,this.options)},onComplete:function(a){this.updateChoices(a.responseText)}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(c,e,d,a){this.baseInitialize(c,e,a);this.options.array=d},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(a){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(c){var e=[];var d=[];var j=c.getToken();var h=0;for(var f=0;f<c.options.array.length&&e.length<c.options.choices;f++){var g=c.options.array[f];var k=c.options.ignoreCase?g.toLowerCase().indexOf(j.toLowerCase()):g.indexOf(j);while(k!=-1){if(k==0&&g.length!=j.length){e.push("<li><strong>"+g.substr(0,j.length)+"</strong>"+g.substr(j.length)+"</li>");break}else{if(j.length>=c.options.partialChars&&c.options.partialSearch&&k!=-1){if(c.options.fullSearch||/\s/.test(g.substr(k-1,1))){d.push("<li>"+g.substr(0,k)+"<strong>"+g.substr(k,j.length)+"</strong>"+g.substr(k+j.length)+"</li>");break}}}k=c.options.ignoreCase?g.toLowerCase().indexOf(j.toLowerCase(),k+1):g.indexOf(j,k+1)}}if(d.length){e=e.concat(d.slice(0,c.options.choices-e.length))}return"<ul>"+e.join("")+"</ul>"}},a||{})}});Field.scrollFreeActivate=function(a){setTimeout(function(){Field.activate(a)},1)};Ajax.InPlaceEditor=Class.create({initialize:function(d,c,a){this.url=c;this.element=d=$(d);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(a);Object.extend(this.options,a||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId=""}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl)}if(!this.options.externalControl){this.options.externalControlOnly=false}this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners()},checkForEscapeOrReturn:function(a){if(!this._editing||a.ctrlKey||a.altKey||a.shiftKey){return}if(Event.KEY_ESC==a.keyCode){this.handleFormCancellation(a)}else{if(Event.KEY_RETURN==a.keyCode){this.handleFormSubmission(a)}}},createControl:function(h,d,c){var f=this.options[h+"Control"];var g=this.options[h+"Text"];if("button"==f){var a=document.createElement("input");a.type="submit";a.value=g;a.className="editor_"+h+"_button";if("cancel"==h){a.onclick=this._boundCancelHandler}this._form.appendChild(a);this._controls[h]=a}else{if("link"==f){var e=document.createElement("a");e.href="#";e.appendChild(document.createTextNode(g));e.onclick="cancel"==h?this._boundCancelHandler:this._boundSubmitHandler;e.className="editor_"+h+"_link";if(c){e.className+=" "+c}this._form.appendChild(e);this._controls[h]=e}}},createEditField:function(){var d=(this.options.loadTextURL?this.options.loadingText:this.getText());var c;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){c=document.createElement("input");c.type="text";var a=this.options.size||this.options.cols||0;if(0<a){c.size=a}}else{c=document.createElement("textarea");c.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);c.cols=this.options.cols||40}c.name=this.options.paramName;c.value=d;c.className="editor_field";if(this.options.submitOnBlur){c.onblur=this._boundSubmitHandler}this._controls.editor=c;if(this.options.loadTextURL){this.loadExternalText()}this._form.appendChild(this._controls.editor)},createForm:function(){var c=this;function a(e,f){var d=c.options["text"+e+"Controls"];if(!d||f===false){return}c._form.appendChild(document.createTextNode(d))}this._form=$(document.createElement("form"));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if("textarea"==this._controls.editor.tagName.toLowerCase()){this._form.appendChild(document.createElement("br"))}if(this.options.onFormCustomization){this.options.onFormCustomization(this,this._form)}a("Before",this.options.okControl||this.options.cancelControl);this.createControl("ok",this._boundSubmitHandler);a("Between",this.options.okControl&&this.options.cancelControl);this.createControl("cancel",this._boundCancelHandler,"editor_cancel");a("After",this.options.okControl||this.options.cancelControl)},destroy:function(){if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML}this.leaveEditMode();this.unregisterListeners()},enterEditMode:function(a){if(this._saving||this._editing){return}this._editing=true;this.triggerCallback("onEnterEditMode");if(this.options.externalControl){this.options.externalControl.hide()}this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL){this.postProcessEditField()}if(a){Event.stop(a)}},enterHover:function(a){if(this.options.hoverClassName){this.element.addClassName(this.options.hoverClassName)}if(this._saving){return}this.triggerCallback("onEnterHover")},getText:function(){return this.element.innerHTML.unescapeHTML()},handleAJAXFailure:function(a){this.triggerCallback("onFailure",a);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null}},handleFormCancellation:function(a){this.wrapUp();if(a){Event.stop(a)}},handleFormSubmission:function(f){var c=this._form;var d=$F(this._controls.editor);this.prepareSubmission();var g=this.options.callback(c,d)||"";if(Object.isString(g)){g=g.toQueryParams()}g.editorId=this.element.id;if(this.options.htmlResponse){var a=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(a,{parameters:g,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,a)}else{var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:g,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,a)}if(f){Event.stop(f)}},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl){this.options.externalControl.show()}this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback("onLeaveEditMode")},leaveHover:function(a){if(this.options.hoverClassName){this.element.removeClassName(this.options.hoverClassName)}if(this._saving){return}this.triggerCallback("onLeaveHover")},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(d){this._form.removeClassName(this.options.loadingClassName);var c=d.responseText;if(this.options.stripLoadedTextTags){c=c.stripTags()}this._controls.editor.value=c;this._controls.editor.disabled=false;this.postProcessEditField()}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,a)},postProcessEditField:function(){var a=this.options.fieldPostCreation;if(a){$(this._controls.editor)["focus"==a?"focus":"activate"]()}},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(a){Object.extend(this.options,a)}.bind(this))},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving()},registerListeners:function(){this._listeners={};var a;$H(Ajax.InPlaceEditor.Listeners).each(function(c){a=this[c.value].bind(this);this._listeners[c.key]=a;if(!this.options.externalControlOnly){this.element.observe(c.key,a)}if(this.options.externalControl){this.options.externalControl.observe(c.key,a)}}.bind(this))},removeForm:function(){if(!this._form){return}this._form.remove();this._form=null;this._controls={}},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show()},triggerCallback:function(c,a){if("function"==typeof this.options[c]){this.options[c](this,a)}},unregisterListeners:function(){$H(this._listeners).each(function(a){if(!this.options.externalControlOnly){this.element.stopObserving(a.key,a.value)}if(this.options.externalControl){this.options.externalControl.stopObserving(a.key,a.value)}}.bind(this))},wrapUp:function(a){this.leaveEditMode();this._boundComplete(a,this.element)}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,d,c,a){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(d,c,a)},createEditField:function(){var a=document.createElement("select");a.name=this.options.paramName;a.size=1;this._controls.editor=a;this._collection=this.options.collection||[];if(this.options.loadCollectionURL){this.loadCollection()}else{this.checkForExternalText()}this._form.appendChild(this._controls.editor)},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js)){throw ("Server returned an invalid collection representation.")}this._collection=eval(js);this.checkForExternalText()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options)},showLoadingText:function(c){this._controls.editor.disabled=true;var a=this._controls.editor.firstChild;if(!a){a=document.createElement("option");a.value="";this._controls.editor.appendChild(a);a.selected=true}a.update((c||"").stripScripts().stripTags())},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL){this.loadExternalText()}else{this.buildOptionList()}},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var a=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(a,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(c){this._text=c.responseText.strip();this.buildOptionList()}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,a)},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(e){return 2===e.length?e:[e,e].flatten()});var c=("value" in this.options)?this.options.value:this._text;var a=this._collection.any(function(e){return e[0]==c}.bind(this));this._controls.editor.update("");var d;this._collection.each(function(f,e){d=document.createElement("option");d.value=f[0];d.selected=a?f[0]==c:0==e;d.appendChild(document.createTextNode(f[1]));this._controls.editor.appendChild(d)}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor)}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(a){if(!a){return}function c(d,e){if(d in a||e===undefined){return}a[d]=e}c("cancelControl",(a.cancelLink?"link":(a.cancelButton?"button":a.cancelLink==a.cancelButton==false?false:undefined)));c("okControl",(a.okLink?"link":(a.okButton?"button":a.okLink==a.okButton==false?false:undefined)));c("highlightColor",a.highlightcolor);c("highlightEndColor",a.highlightendcolor)};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:false,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:true,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",savingText:"Saving...",size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(a){return Form.serialize(a)},onComplete:function(c,a){new Effect.Highlight(a,{startcolor:this.options.highlightColor,keepBackgroundImage:true})},onEnterEditMode:null,onEnterHover:function(a){a.element.style.backgroundColor=a.options.highlightColor;if(a._effect){a._effect.cancel()}},onFailure:function(c,a){alert("Error communication with the server: "+c.responseText.stripTags())},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(a){a._effect=new Effect.Highlight(a.element,{startcolor:a.options.highlightColor,endcolor:a.options.highlightEndColor,restorecolor:a._originalBackground,keepBackgroundImage:true})}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."};Form.Element.DelayedObserver=Class.create({initialize:function(c,a,d){this.delay=a||0.5;this.element=$(c);this.callback=d;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(a){if(this.lastValue==$F(this.element)){return}if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element)},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element))}});
/*!
 * jQuery UI 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(a,e){a.ui=a.ui||{};if(a.ui.version){return}a.extend(a.ui,{version:"1.9pre",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(f,g){return typeof f==="number"?this.each(function(){var h=this;setTimeout(function(){a(h).focus();if(g){g.call(h)}},f)}):this._focus.apply(this,arguments)},scrollParent:function(){var f;if((a.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){f=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(a.curCSS(this,"position",1))&&(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}else{f=this.parents().filter(function(){return(/(auto|scroll)/).test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!f.length?a(document):f},zIndex:function(j){if(j!==e){return this.css("zIndex",j)}if(this.length){var g=a(this[0]),f,h;while(g.length&&g[0]!==document){f=g.css("position");if(f==="absolute"||f==="relative"||f==="fixed"){h=parseInt(g.css("zIndex"),10);if(!isNaN(h)&&h!==0){return h}}g=g.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(f){f.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});a.each(["Width","Height"],function(h,f){var g=f==="Width"?["Left","Right"]:["Top","Bottom"],j=f.toLowerCase(),l={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};function k(o,n,m,p){a.each(g,function(){n-=parseFloat(a.curCSS(o,"padding"+this,true))||0;if(m){n-=parseFloat(a.curCSS(o,"border"+this+"Width",true))||0}if(p){n-=parseFloat(a.curCSS(o,"margin"+this,true))||0}});return n}a.fn["inner"+f]=function(m){if(m===e){return l["inner"+f].call(this)}return this.each(function(){a(this).css(j,k(this,m)+"px")})};a.fn["outer"+f]=function(m,n){if(typeof m!=="number"){return l["outer"+f].call(this,m)}return this.each(function(){a(this).css(j,k(this,m,true,n)+"px")})}});function d(h,f){var l=h.nodeName.toLowerCase();if("area"===l){var k=h.parentNode,j=k.name,g;if(!h.href||!j||k.nodeName.toLowerCase()!=="map"){return false}g=a("img[usemap=#"+j+"]")[0];return !!g&&c(g)}return(/input|select|textarea|button|object/.test(l)?!h.disabled:"a"==l?h.href||f:f)&&c(h)}function c(f){return !a(f).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.extend(a.expr[":"],{data:function(h,g,f){return !!a.data(h,f[3])},focusable:function(f){return d(f,!isNaN(a.attr(f,"tabindex")))},tabbable:function(h){var f=a.attr(h,"tabindex"),g=isNaN(f);return(g||f>=0)&&d(h,!g)}});a(function(){var f=document.body,g=f.appendChild(g=document.createElement("div"));a.extend(g.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=g.offsetHeight===100;a.support.selectstart="onselectstart" in g;f.removeChild(g).style.display="none"});a.extend(a.ui,{plugin:{add:function(g,h,k){var j=a.ui[g].prototype;for(var f in k){j.plugins[f]=j.plugins[f]||[];j.plugins[f].push([h,k[f]])}},call:function(f,h,g){var k=f.plugins[h];if(!k||!f.element[0].parentNode){return}for(var j=0;j<k.length;j++){if(f.options[k[j][0]]){k[j][1].apply(f.element,g)}}}},contains:a.contains,hasScroll:function(j,g){if(a(j).css("overflow")==="hidden"){return false}var f=(g&&g==="left")?"scrollLeft":"scrollTop",h=false;if(j[f]>0){return true}j[f]=1;h=(j[f]>0);j[f]=0;return h},isOverAxis:function(g,f,h){return(g>f)&&(g<(f+h))},isOver:function(l,g,k,j,f,h){return a.ui.isOverAxis(l,k,f)&&a.ui.isOverAxis(g,j,h)}})})(jQuery);
/*!
 * jQuery UI Widget 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(a,e){var d=Array.prototype.slice;var c=a.cleanData;a.cleanData=function(f){for(var g=0,h;(h=f[g])!=null;g++){a(h).triggerHandler("remove")}c(f)};a.widget=function(g,j,f){var h=g.split(".")[0],l;g=g.split(".")[1];l=h+"-"+g;if(!f){f=j;j=a.Widget}a.expr[":"][l]=function(m){return !!a.data(m,g)};a[h]=a[h]||{};a[h][g]=a.extend(function(m,n){if(!this._createWidget){return new a[h][g](m,n)}if(arguments.length){this._createWidget(m,n)}},a[h][g],{version:f.version});var k=new j();k.options=a.widget.extend({},k.options);a.each(f,function(n,m){if(a.isFunction(m)){f[n]=(function(){var o=function(q){return j.prototype[q].apply(this,d.call(arguments,1))};var p=function(r,q){return j.prototype[r].apply(this,q)};return function(){var s=this._super,q=this._superApply,r;this._super=o;this._superApply=p;r=m.apply(this,arguments);this._super=s;this._superApply=q;return r}}())}});a[h][g].prototype=a.widget.extend(k,{namespace:h,widgetName:g,widgetEventPrefix:g,widgetBaseClass:l},f);a.widget.bridge(g,a[h][g])};a.widget.extend=function(l){var g=d.call(arguments,1),k=0,f=g.length,h,j;for(;k<f;k++){for(h in g[k]){j=g[k][h];if(g[k].hasOwnProperty(h)&&j!==e){l[h]=a.isPlainObject(j)?a.widget.extend({},l[h],j):j}}}return l};a.widget.bridge=function(g,f){a.fn[g]=function(k){var h=typeof k==="string",j=d.call(arguments,1),l=this;k=!h&&j.length?a.widget.extend.apply(null,[k].concat(j)):k;if(h){this.each(function(){var m=a.data(this,g);if(!m){return a.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+k+"'")}if(!a.isFunction(m[k])||k.charAt(0)==="_"){return a.error("no such method '"+k+"' for "+g+" widget instance")}var n=m[k].apply(m,j);if(n!==m&&n!==e){l=n&&n.jquery?l.pushStack(n.get()):n;return false}})}else{this.each(function(){var m=a.data(this,g);if(m){m.option(k||{})._init()}else{f(k,this)}})}return l}};a.Widget=function(f,g){if(!this._createWidget){return new a[namespace][name](f,g)}if(arguments.length){this._createWidget(f,g)}};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(f,g){g=a(g||this.defaultElement||this)[0];this.element=a(g);this.options=a.widget.extend({},this.options,this._getCreateOptions(),f);this.bindings=a();this.hoverable=a();this.focusable=a();if(g!==this){a.data(g,this.widgetName,this);this._bind({remove:"destroy"})}this._create();this._trigger("create");this._init()},_getCreateOptions:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy();this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled");this.bindings.unbind("."+this.widgetName);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(j,k){var f=j,l,h,g;if(arguments.length===0){return a.widget.extend({},this.options)}if(typeof j==="string"){f={};l=j.split(".");j=l.shift();if(l.length){h=f[j]=a.widget.extend({},this.options[j]);for(g=0;g<l.length-1;g++){h[l[g]]=h[l[g]]||{};h=h[l[g]]}j=l.pop();if(k===e){return h[j]===e?null:h[j]}h[j]=k}else{if(k===e){return this.options[j]===e?null:this.options[j]}f[j]=k}}this._setOptions(f);return this},_setOptions:function(g){var f=this;a.each(g,function(h,j){f._setOption(h,j)});return this},_setOption:function(f,g){this.options[f]=g;if(f==="disabled"){this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!g).attr("aria-disabled",g);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_bind:function(h,g){if(!g){g=h;h=this.element}else{h=a(h);this.bindings=this.bindings.add(h)}var f=this;a.each(g,function(k,j){h.bind(k+"."+f.widgetName,function(){if(f.options.disabled===true||a(this).hasClass("ui-state-disabled")){return}return(typeof j==="string"?f[j]:j).apply(f,arguments)})})},_hoverable:function(f){this.hoverable=this.hoverable.add(f);this._bind(f,{mouseenter:function(g){a(g.currentTarget).addClass("ui-state-hover")},mouseleave:function(g){a(g.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(f){this.focusable=this.focusable.add(f);this._bind(f,{focusin:function(g){a(g.currentTarget).addClass("ui-state-focus")},focusout:function(g){a(g.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(h,j,k){var m=this.options[h],f;j=a.Event(j);j.type=(h===this.widgetEventPrefix?h:this.widgetEventPrefix+h).toLowerCase();k=k||{};if(j.originalEvent){for(var g=a.event.props.length,l;g;){l=a.event.props[--g];j[l]=j.originalEvent[l]}}this.element.trigger(j,k);f=a.isArray(k)?[j].concat(k):[j,k];return !(a.isFunction(m)&&m.apply(this.element[0],f)===false||j.isDefaultPrevented())}};a.each({show:"fadeIn",hide:"fadeOut"},function(g,f){a.Widget.prototype["_"+g]=function(k,j,m){if(typeof j==="string"){j={effect:j}}var l,h=!j?g:j===true||typeof j==="number"?f:j.effect||f;j=j||{};if(typeof j==="number"){j={duration:j}}l=!a.isEmptyObject(j);j.complete=m;if(j.delay){k.delay(j.delay)}if(l&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==false&&a.effects[h])){k[g](j)}else{if(h!==g&&k[h]){k[h](j.duration,j.easing,m)}else{k.queue(function(n){a(this)[g]();if(m){m.call(k[0])}n()})}}}});if(a.uiBackCompat!==false){a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]}}})(jQuery);
/*!
 * jQuery UI Mouse 1.9pre
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(c,d){var a=false;c(document).mousedown(function(f){a=false});c.widget("ui.mouse",{version:"1.9pre",options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(f){return e._mouseDown(f)}).bind("click."+this.widgetName,function(f){if(true===c.data(f.target,e.widgetName+".preventClickEvent")){c.removeData(f.target,e.widgetName+".preventClickEvent");f.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(g){if(a){return}(this._mouseStarted&&this._mouseUp(g));this._mouseDownEvent=g;var f=this,h=(g.which==1),e=(typeof this.options.cancel=="string"?c(g.target).closest(this.options.cancel).length:false);if(!h||e||!this._mouseCapture(g)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){f.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(g)&&this._mouseDelayMet(g)){this._mouseStarted=(this._mouseStart(g)!==false);if(!this._mouseStarted){g.preventDefault();return true}}if(true===c.data(g.target,this.widgetName+".preventClickEvent")){c.removeData(g.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(j){return f._mouseMove(j)};this._mouseUpDelegate=function(j){return f._mouseUp(j)};c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);g.preventDefault();a=true;return true},_mouseMove:function(e){if(c.browser.msie&&!(document.documentMode>=9)&&!e.button){return this._mouseUp(e)}if(this._mouseStarted){this._mouseDrag(e);return e.preventDefault()}if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,e)!==false);(this._mouseStarted?this._mouseDrag(e):this._mouseUp(e))}return !this._mouseStarted},_mouseUp:function(e){c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(e.target==this._mouseDownEvent.target){c.data(e.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(e)}return false},_mouseDistanceMet:function(e){return(Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance)},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return true}})})(jQuery);(function(a,c){a.widget("ui.draggable",a.ui.mouse,{version:"1.9pre",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(d){var e=this.options;if(this.helper||e.disabled||a(d.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(d);if(!this.handle){return false}a(e.iframeFix===true?"iframe":e.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(d){var e=this.options;this.helper=this._createHelper(d);this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(d);this.originalPageX=d.pageX;this.originalPageY=d.pageY;(e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt));if(e.containment){this._setContainment()}if(this._trigger("start",d)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!e.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,d)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(d,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,d)}return true},_mouseDrag:function(d,f){this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");if(!f){var e=this._uiHash();if(this._trigger("drag",d,e)===false){this._mouseUp({});return false}this.position=e.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,d)}return false},_mouseStop:function(e){var f=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){f=a.ui.ddmanager.drop(this,e)}if(this.dropped){f=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode){return false}if((this.options.revert=="invalid"&&!f)||(this.options.revert=="valid"&&f)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,f))){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(d._trigger("stop",e)!==false){d._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(d){if(this.options.iframeFix===true){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,d)}return a.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(d){var e=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==d.target){e=true}});return e},_createHelper:function(e){var f=this.options;var d=a.isFunction(f.helper)?a(f.helper.apply(this.element[0],[e])):(f.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!d.parents("body").length){d.appendTo((f.appendTo=="parent"?this.element[0].parentNode:f.appendTo))}if(d[0]!=this.element[0]&&!(/(fixed|absolute)/).test(d.css("position"))){d.css("position","absolute")}return d},_adjustOffsetFromHelper:function(d){if(typeof d=="string"){d=d.split(" ")}if(a.isArray(d)){d={left:+d[0],top:+d[1]||0}}if("left" in d){this.offset.click.left=d.left+this.margins.left}if("right" in d){this.offset.click.left=this.helperProportions.width-d.right+this.margins.left}if("top" in d){this.offset.click.top=d.top+this.margins.top}if("bottom" in d){this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])){d.left+=this.scrollParent.scrollLeft();d.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){d={top:0,left:0}}return{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var d=this.element.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var g=this.options;if(g.containment=="parent"){g.containment=this.helper[0].parentNode}if(g.containment=="document"||g.containment=="window"){this.containment=[g.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,g.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(g.containment=="document"?0:a(window).scrollLeft())+a(g.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(g.containment=="document"?0:a(window).scrollTop())+(a(g.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(g.containment)&&g.containment.constructor!=Array){var h=a(g.containment);var e=h[0];if(!e){return}var f=h.offset();var d=(a(e).css("overflow")!="hidden");this.containment=[(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0),(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=h}else{if(g.containment.constructor==Array){this.containment=g.containment}}},_convertPositionTo:function(h,k){if(!k){k=this.position}var f=h=="absolute"?1:-1;var g=this.options,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(e[0].tagName);return{top:(k.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:e.scrollTop()))*f)),left:(k.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:e.scrollLeft())*f))}},_generatePosition:function(e){var f=this.options,n=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,k=(/(html|body)/i).test(n[0].tagName);var j=e.pageX;var h=e.pageY;if(this.originalPosition){var d;if(this.containment){if(this.relative_container){var m=this.relative_container.offset();d=[this.containment[0]+m.left,this.containment[1]+m.top,this.containment[2]+m.left,this.containment[3]+m.top]}else{d=this.containment}if(e.pageX-this.offset.click.left<d[0]){j=d[0]+this.offset.click.left}if(e.pageY-this.offset.click.top<d[1]){h=d[1]+this.offset.click.top}if(e.pageX-this.offset.click.left>d[2]){j=d[2]+this.offset.click.left}if(e.pageY-this.offset.click.top>d[3]){h=d[3]+this.offset.click.top}}if(f.grid){var l=f.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/f.grid[1])*f.grid[1]:this.originalPageY;h=d?(!(l-this.offset.click.top<d[1]||l-this.offset.click.top>d[3])?l:(!(l-this.offset.click.top<d[1])?l-f.grid[1]:l+f.grid[1])):l;var g=f.grid[0]?this.originalPageX+Math.round((j-this.originalPageX)/f.grid[0])*f.grid[0]:this.originalPageX;j=d?(!(g-this.offset.click.left<d[0]||g-this.offset.click.left>d[2])?g:(!(g-this.offset.click.left<d[0])?g-f.grid[0]:g+f.grid[0])):g}}return{top:(h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(k?0:n.scrollTop())))),left:(j-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:n.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(d,e,f){f=f||this._uiHash();a.ui.plugin.call(this,d,[e,f]);if(d=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,d,e,f)},plugins:{},_uiHash:function(d){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(e,g){var f=a(this).data("draggable"),h=f.options,d=a.extend({},g,{item:f.element});f.sortables=[];a(h.connectToSortable).each(function(){var j=a.data(this,"sortable");if(j&&!j.options.disabled){f.sortables.push({instance:j,shouldRevert:j.options.revert});j.refreshPositions();j._trigger("activate",e,d)}})},stop:function(e,g){var f=a(this).data("draggable"),d=a.extend({},g,{item:f.element});a.each(f.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;f.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(e);this.instance.options.helper=this.instance.options._helper;if(f.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",e,d)}})},drag:function(e,h){var g=a(this).data("draggable"),d=this;var f=function(l){var r=this.offset.click.top,q=this.offset.click.left;var j=this.positionAbs.top,n=this.positionAbs.left;var m=l.height,p=l.width;var s=l.top,k=l.left;return a.ui.isOver(j+r,n+q,s,k,m,p)};a.each(g.sortables,function(j){this.instance.positionAbs=g.positionAbs;this.instance.helperProportions=g.helperProportions;this.instance.offset.click=g.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(d).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return h.helper[0]};e.target=this.instance.currentItem[0];this.instance._mouseCapture(e,true);this.instance._mouseStart(e,true,true);this.instance.offset.click.top=g.offset.click.top;this.instance.offset.click.left=g.offset.click.left;this.instance.offset.parent.left-=g.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=g.offset.parent.top-this.instance.offset.parent.top;g._trigger("toSortable",e);g.dropped=this.instance.element;g.currentItem=g.element;this.instance.fromOutside=g}if(this.instance.currentItem){this.instance._mouseDrag(e)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",e,this.instance._uiHash(this.instance));this.instance._mouseStop(e,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}g._trigger("fromSortable",e);g.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(e,f){var d=a("body"),g=a(this).data("draggable").options;if(d.css("cursor")){g._cursor=d.css("cursor")}d.css("cursor",g.cursor)},stop:function(d,e){var f=a(this).data("draggable").options;if(f._cursor){a("body").css("cursor",f._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(e,f){var d=a(f.helper),g=a(this).data("draggable").options;if(d.css("opacity")){g._opacity=d.css("opacity")}d.css("opacity",g.opacity)},stop:function(d,e){var f=a(this).data("draggable").options;if(f._opacity){a(e.helper).css("opacity",f._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(e,f){var d=a(this).data("draggable");if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){d.overflowOffset=d.scrollParent.offset()}},drag:function(f,g){var e=a(this).data("draggable"),h=e.options,d=false;if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!="HTML"){if(!h.axis||h.axis!="x"){if((e.overflowOffset.top+e.scrollParent[0].offsetHeight)-f.pageY<h.scrollSensitivity){e.scrollParent[0].scrollTop=d=e.scrollParent[0].scrollTop+h.scrollSpeed}else{if(f.pageY-e.overflowOffset.top<h.scrollSensitivity){e.scrollParent[0].scrollTop=d=e.scrollParent[0].scrollTop-h.scrollSpeed}}}if(!h.axis||h.axis!="y"){if((e.overflowOffset.left+e.scrollParent[0].offsetWidth)-f.pageX<h.scrollSensitivity){e.scrollParent[0].scrollLeft=d=e.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(f.pageX-e.overflowOffset.left<h.scrollSensitivity){e.scrollParent[0].scrollLeft=d=e.scrollParent[0].scrollLeft-h.scrollSpeed}}}}else{if(!h.axis||h.axis!="x"){if(f.pageY-a(document).scrollTop()<h.scrollSensitivity){d=a(document).scrollTop(a(document).scrollTop()-h.scrollSpeed)}else{if(a(window).height()-(f.pageY-a(document).scrollTop())<h.scrollSensitivity){d=a(document).scrollTop(a(document).scrollTop()+h.scrollSpeed)}}}if(!h.axis||h.axis!="y"){if(f.pageX-a(document).scrollLeft()<h.scrollSensitivity){d=a(document).scrollLeft(a(document).scrollLeft()-h.scrollSpeed)}else{if(a(window).width()-(f.pageX-a(document).scrollLeft())<h.scrollSensitivity){d=a(document).scrollLeft(a(document).scrollLeft()+h.scrollSpeed)}}}}if(d!==false&&a.ui.ddmanager&&!h.dropBehaviour){a.ui.ddmanager.prepareOffsets(e,f)}}});a.ui.plugin.add("draggable","snap",{start:function(e,f){var d=a(this).data("draggable"),g=d.options;d.snapElements=[];a(g.snap.constructor!=String?(g.snap.items||":data(draggable)"):g.snap).each(function(){var j=a(this);var h=j.offset();if(this!=d.element[0]){d.snapElements.push({item:this,width:j.outerWidth(),height:j.outerHeight(),top:h.top,left:h.left})}})},drag:function(v,q){var h=a(this).data("draggable"),s=h.options;var A=s.snapTolerance;var z=q.offset.left,y=z+h.helperProportions.width,g=q.offset.top,f=g+h.helperProportions.height;for(var w=h.snapElements.length-1;w>=0;w--){var u=h.snapElements[w].left,p=u+h.snapElements[w].width,n=h.snapElements[w].top,C=n+h.snapElements[w].height;if(!((u-A<z&&z<p+A&&n-A<g&&g<C+A)||(u-A<z&&z<p+A&&n-A<f&&f<C+A)||(u-A<y&&y<p+A&&n-A<g&&g<C+A)||(u-A<y&&y<p+A&&n-A<f&&f<C+A))){if(h.snapElements[w].snapping){(h.options.snap.release&&h.options.snap.release.call(h.element,v,a.extend(h._uiHash(),{snapItem:h.snapElements[w].item})))}h.snapElements[w].snapping=false;continue}if(s.snapMode!="inner"){var e=Math.abs(n-f)<=A;var B=Math.abs(C-g)<=A;var k=Math.abs(u-y)<=A;var m=Math.abs(p-z)<=A;if(e){q.position.top=h._convertPositionTo("relative",{top:n-h.helperProportions.height,left:0}).top-h.margins.top}if(B){q.position.top=h._convertPositionTo("relative",{top:C,left:0}).top-h.margins.top}if(k){q.position.left=h._convertPositionTo("relative",{top:0,left:u-h.helperProportions.width}).left-h.margins.left}if(m){q.position.left=h._convertPositionTo("relative",{top:0,left:p}).left-h.margins.left}}var j=(e||B||k||m);if(s.snapMode!="outer"){var e=Math.abs(n-g)<=A;var B=Math.abs(C-f)<=A;var k=Math.abs(u-z)<=A;var m=Math.abs(p-y)<=A;if(e){q.position.top=h._convertPositionTo("relative",{top:n,left:0}).top-h.margins.top}if(B){q.position.top=h._convertPositionTo("relative",{top:C-h.helperProportions.height,left:0}).top-h.margins.top}if(k){q.position.left=h._convertPositionTo("relative",{top:0,left:u}).left-h.margins.left}if(m){q.position.left=h._convertPositionTo("relative",{top:0,left:p-h.helperProportions.width}).left-h.margins.left}}if(!h.snapElements[w].snapping&&(e||B||k||m||j)){(h.options.snap.snap&&h.options.snap.snap.call(h.element,v,a.extend(h._uiHash(),{snapItem:h.snapElements[w].item})))}h.snapElements[w].snapping=(e||B||k||m||j)}}});a.ui.plugin.add("draggable","stack",{start:function(e,f){var h=a(this).data("draggable").options;var g=a.makeArray(a(h.stack)).sort(function(k,j){return(parseInt(a(k).css("zIndex"),10)||0)-(parseInt(a(j).css("zIndex"),10)||0)});if(!g.length){return}var d=parseInt(g[0].style.zIndex)||0;a(g).each(function(j){this.style.zIndex=d+j});this[0].style.zIndex=d+g.length}});a.ui.plugin.add("draggable","zIndex",{start:function(e,f){var d=a(f.helper),g=a(this).data("draggable").options;if(d.css("zIndex")){g._zIndex=d.css("zIndex")}d.css("zIndex",g.zIndex)},stop:function(d,e){var f=a(this).data("draggable").options;if(f._zIndex){a(e.helper).css("zIndex",f._zIndex)}}})})(jQuery);(function(a,c){a.widget("ui.droppable",{version:"1.9pre",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var e=this.options,d=e.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(d)?d:function(f){return f.is(d)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[e.scope]=a.ui.ddmanager.droppables[e.scope]||[];a.ui.ddmanager.droppables[e.scope].push(this);(e.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var d=a.ui.ddmanager.droppables[this.options.scope];for(var e=0;e<d.length;e++){if(d[e]==this){d.splice(e,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(d,e){if(d=="accept"){this.accept=a.isFunction(e)?e:function(f){return f.is(e)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var d=a.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(d&&this._trigger("activate",e,this.ui(d)))},_deactivate:function(e){var d=a.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(d&&this._trigger("deactivate",e,this.ui(d)))},_over:function(e){var d=a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",e,this.ui(d))}},_out:function(e){var d=a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",e,this.ui(d))}},_drop:function(e,f){var d=f||a.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]==this.element[0]){return false}var g=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var h=a.data(this,"droppable");if(h.options.greedy&&!h.options.disabled&&h.options.scope==d.options.scope&&h.accept.call(h.element[0],(d.currentItem||d.element))&&a.ui.intersect(d,a.extend(h,{offset:h.element.offset()}),h.options.tolerance)){g=true;return false}});if(g){return false}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",e,this.ui(d));return this.element}return false},ui:function(d){return{draggable:(d.currentItem||d.element),helper:d.helper,position:d.position,offset:d.positionAbs}}});a.ui.intersect=function(u,m,q){if(!m.offset){return false}var f=(u.positionAbs||u.position.absolute).left,e=f+u.helperProportions.width,p=(u.positionAbs||u.position.absolute).top,o=p+u.helperProportions.height;var h=m.offset.left,d=h+m.proportions.width,s=m.offset.top,n=s+m.proportions.height;switch(q){case"fit":return(h<=f&&e<=d&&s<=p&&o<=n);break;case"intersect":return(h<f+(u.helperProportions.width/2)&&e-(u.helperProportions.width/2)<d&&s<p+(u.helperProportions.height/2)&&o-(u.helperProportions.height/2)<n);break;case"pointer":var j=((u.positionAbs||u.position.absolute).left+(u.clickOffset||u.offset.click).left),k=((u.positionAbs||u.position.absolute).top+(u.clickOffset||u.offset.click).top),g=a.ui.isOver(k,j,s,h,m.proportions.height,m.proportions.width);return g;break;case"touch":return((p>=s&&p<=n)||(o>=s&&o<=n)||(p<s&&o>n))&&((f>=h&&f<=d)||(e>=h&&e<=d)||(f<h&&e>d));break;default:return false;break}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(g,k){var d=a.ui.ddmanager.droppables[g.options.scope]||[];var h=k?k.type:null;var l=(g.currentItem||g.element).find(":data(droppable)").andSelf();droppablesLoop:for(var f=0;f<d.length;f++){if(d[f].options.disabled||(g&&!d[f].accept.call(d[f].element[0],(g.currentItem||g.element)))){continue}for(var e=0;e<l.length;e++){if(l[e]==d[f].element[0]){d[f].proportions.height=0;continue droppablesLoop}}d[f].visible=d[f].element.css("display")!="none";if(!d[f].visible){continue}if(h=="mousedown"){d[f]._activate.call(d[f],k)}d[f].offset=d[f].element.offset();d[f].proportions={width:d[f].element[0].offsetWidth,height:d[f].element[0].offsetHeight}}},drop:function(d,e){var f=false;a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&a.ui.intersect(d,this,this.options.tolerance)){f=f||this._drop.call(this,e)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(d.currentItem||d.element))){this.isout=1;this.isover=0;this._deactivate.call(this,e)}});return f},dragStart:function(d,e){d.element.parentsUntil("body").bind("scroll.droppable",function(){if(!d.options.refreshPositions){a.ui.ddmanager.prepareOffsets(d,e)}})},drag:function(d,e){if(d.options.refreshPositions){a.ui.ddmanager.prepareOffsets(d,e)}a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var g=a.ui.intersect(d,this,this.options.tolerance);var j=!g&&this.isover==1?"isout":(g&&this.isover==0?"isover":null);if(!j){return}var h;if(this.options.greedy){var f=this.element.parents(":data(droppable):eq(0)");if(f.length){h=a.data(f[0],"droppable");h.greedyChild=(j=="isover"?1:0)}}if(h&&j=="isover"){h.isover=0;h.isout=1;h._out.call(h,e)}this[j]=1;this[j=="isout"?"isover":"isout"]=0;this[j=="isover"?"_over":"_out"].call(this,e);if(h&&j=="isout"){h.isout=0;h.isover=1;h._over.call(h,e)}})},dragStop:function(d,e){d.element.parentsUntil("body").unbind("scroll.droppable");if(!d.options.refreshPositions){a.ui.ddmanager.prepareOffsets(d,e)}}}})(jQuery);(function(d,e){d.widget("ui.resizable",d.ui.mouse,{version:"1.9pre",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var g=this,l=this.options;this.element.addClass("ui-resizable");d.extend(this,{_aspectRatio:!!(l.aspectRatio),aspectRatio:l.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:l.helper||l.ghost||l.animate?l.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){if(/relative/.test(this.element.css("position"))&&d.browser.opera){this.element.css({position:"relative",top:"auto",left:"auto"})}this.element.wrap(d('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=l.handles||(!d(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var m=this.handles.split(",");this.handles={};for(var h=0;h<m.length;h++){var k=d.trim(m[h]),f="ui-resizable-"+k;var j=d('<div class="ui-resizable-handle '+f+'"></div>');if(/sw|se|ne|nw/.test(k)){j.css({zIndex:++l.zIndex})}if("se"==k){j.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[k]=".ui-resizable-"+k;this.element.append(j)}}this._renderAxis=function(r){r=r||this.element;for(var o in this.handles){if(this.handles[o].constructor==String){this.handles[o]=d(this.handles[o],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var p=d(this.handles[o],this.element),q=0;q=/sw|ne|nw|se|n|s/.test(o)?p.outerHeight():p.outerWidth();var n=["padding",/ne|nw|n/.test(o)?"Top":/se|sw|s/.test(o)?"Bottom":/^e$/.test(o)?"Right":"Left"].join("");r.css(n,q);this._proportionallyResize()}if(!d(this.handles[o]).length){continue}}};this._renderAxis(this.element);this._handles=d(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!g.resizing){if(this.className){var n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}g.axis=n&&n[1]?n[1]:"se"}});if(l.autoHide){this._handles.hide();d(this.element).addClass("ui-resizable-autohide").hover(function(){if(l.disabled){return}d(this).removeClass("ui-resizable-autohide");g._handles.show()},function(){if(l.disabled){return}if(!g.resizing){d(this).addClass("ui-resizable-autohide");g._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var f=function(h){d(h).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){f(this.element);var g=this.element;g.after(this.originalElement.css({position:g.css("position"),width:g.outerWidth(),height:g.outerHeight(),top:g.css("top"),left:g.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);f(this.originalElement);return this},_mouseCapture:function(g){var h=false;for(var f in this.handles){if(d(this.handles[f])[0]==g.target){h=true}}return !this.options.disabled&&h},_mouseStart:function(h){var l=this.options,g=this.element.position(),f=this.element;this.resizing=true;this.documentScroll={top:d(document).scrollTop(),left:d(document).scrollLeft()};if(f.is(".ui-draggable")||(/absolute/).test(f.css("position"))){f.css({position:"absolute",top:g.top,left:g.left})}if(d.browser.opera&&(/relative/).test(f.css("position"))){f.css({position:"relative",top:"auto",left:"auto"})}this._renderProxy();var m=c(this.helper.css("left")),j=c(this.helper.css("top"));if(l.containment){m+=d(l.containment).scrollLeft()||0;j+=d(l.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:m,top:j};this.size=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()};this.originalSize=this._helper?{width:f.outerWidth(),height:f.outerHeight()}:{width:f.width(),height:f.height()};this.originalPosition={left:m,top:j};this.sizeDiff={width:f.outerWidth()-f.width(),height:f.outerHeight()-f.height()};this.originalMousePosition={left:h.pageX,top:h.pageY};this.aspectRatio=(typeof l.aspectRatio=="number")?l.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var k=d(".ui-resizable-"+this.axis).css("cursor");d("body").css("cursor",k=="auto"?this.axis+"-resize":k);f.addClass("ui-resizable-resizing");this._propagate("start",h);return true},_mouseDrag:function(f){var j=this.helper,h=this.options,p={},s=this,l=this.originalMousePosition,q=this.axis;var t=(f.pageX-l.left)||0,r=(f.pageY-l.top)||0;var k=this._change[q];if(!k){return false}var n=k.apply(this,[f,t,r]),m=d.browser.msie&&d.browser.version<7,g=this.sizeDiff;this._updateVirtualBoundaries(f.shiftKey);if(this._aspectRatio||f.shiftKey){n=this._updateRatio(n,f)}n=this._respectSize(n,f);this._propagate("resize",f);j.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(n);this._trigger("resize",f,this.ui());return false},_mouseStop:function(j){this.resizing=false;var k=this.options,p=this;if(this._helper){var h=this._proportionallyResizeElements,f=h.length&&(/textarea/i).test(h[0].nodeName),g=f&&d.ui.hasScroll(h[0],"left")?0:p.sizeDiff.height,m=f?0:p.sizeDiff.width;var q={width:(p.helper.width()-m),height:(p.helper.height()-g)},l=(parseInt(p.element.css("left"),10)+(p.position.left-p.originalPosition.left))||null,n=(parseInt(p.element.css("top"),10)+(p.position.top-p.originalPosition.top))||null;if(!k.animate){this.element.css(d.extend(q,{top:n,left:l}))}p.helper.height(p.size.height);p.helper.width(p.size.width);if(this._helper&&!k.animate){this._proportionallyResize()}}d("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",j);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(h){var l=this.options,k,j,g,m,f;f={minWidth:a(l.minWidth)?l.minWidth:0,maxWidth:a(l.maxWidth)?l.maxWidth:Infinity,minHeight:a(l.minHeight)?l.minHeight:0,maxHeight:a(l.maxHeight)?l.maxHeight:Infinity};if(this._aspectRatio||h){k=f.minHeight*this.aspectRatio;g=f.minWidth/this.aspectRatio;j=f.maxHeight*this.aspectRatio;m=f.maxWidth/this.aspectRatio;if(k>f.minWidth){f.minWidth=k}if(g>f.minHeight){f.minHeight=g}if(j<f.maxWidth){f.maxWidth=j}if(m<f.maxHeight){f.maxHeight=m}}this._vBoundaries=f},_updateCache:function(f){var g=this.options;this.offset=this.helper.offset();if(a(f.left)){this.position.left=f.left}if(a(f.top)){this.position.top=f.top}if(a(f.height)){this.size.height=f.height}if(a(f.width)){this.size.width=f.width}},_updateRatio:function(j,h){var k=this.options,l=this.position,g=this.size,f=this.axis;if(a(j.height)){j.width=(j.height*this.aspectRatio)}else{if(a(j.width)){j.height=(j.width/this.aspectRatio)}}if(f=="sw"){j.left=l.left+(g.width-j.width);j.top=null}if(f=="nw"){j.top=l.top+(g.height-j.height);j.left=l.left+(g.width-j.width)}return j},_respectSize:function(n,h){var l=this.helper,k=this._vBoundaries,t=this._aspectRatio||h.shiftKey,s=this.axis,v=a(n.width)&&k.maxWidth&&(k.maxWidth<n.width),p=a(n.height)&&k.maxHeight&&(k.maxHeight<n.height),j=a(n.width)&&k.minWidth&&(k.minWidth>n.width),u=a(n.height)&&k.minHeight&&(k.minHeight>n.height);if(j){n.width=k.minWidth}if(u){n.height=k.minHeight}if(v){n.width=k.maxWidth}if(p){n.height=k.maxHeight}var g=this.originalPosition.left+this.originalSize.width,r=this.position.top+this.size.height;var m=/sw|nw|w/.test(s),f=/nw|ne|n/.test(s);if(j&&m){n.left=g-k.minWidth}if(v&&m){n.left=g-k.maxWidth}if(u&&f){n.top=r-k.minHeight}if(p&&f){n.top=r-k.maxHeight}var q=!n.width&&!n.height;if(q&&!n.left&&n.top){n.top=null}else{if(q&&!n.top&&n.left){n.left=null}}return n},_proportionallyResize:function(){var l=this.options;if(!this._proportionallyResizeElements.length){return}var h=this.helper||this.element;for(var g=0;g<this._proportionallyResizeElements.length;g++){var j=this._proportionallyResizeElements[g];if(!this.borderDif){var f=[j.css("borderTopWidth"),j.css("borderRightWidth"),j.css("borderBottomWidth"),j.css("borderLeftWidth")],k=[j.css("paddingTop"),j.css("paddingRight"),j.css("paddingBottom"),j.css("paddingLeft")];this.borderDif=d.map(f,function(m,o){var n=parseInt(m,10)||0,p=parseInt(k[o],10)||0;return n+p})}if(d.browser.msie&&!(!(d(h).is(":hidden")||d(h).parents(":hidden").length))){continue}j.css({height:(h.height()-this.borderDif[0]-this.borderDif[2])||0,width:(h.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var g=this.element,k=this.options;this.elementOffset=g.offset();if(this._helper){this.helper=this.helper||d('<div style="overflow:hidden;"></div>');var f=d.browser.msie&&d.browser.version<7,h=(f?1:0),j=(f?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+j,height:this.element.outerHeight()+j,position:"absolute",left:this.elementOffset.left-h+"px",top:this.elementOffset.top-h+"px",zIndex:++k.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(h,g,f){return{width:this.originalSize.width+g}},w:function(j,g,f){var l=this.options,h=this.originalSize,k=this.originalPosition;return{left:k.left+g,width:h.width-g}},n:function(j,g,f){var l=this.options,h=this.originalSize,k=this.originalPosition;return{top:k.top+f,height:h.height-f}},s:function(h,g,f){return{height:this.originalSize.height+f}},se:function(h,g,f){return d.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[h,g,f]))},sw:function(h,g,f){return d.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[h,g,f]))},ne:function(h,g,f){return d.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[h,g,f]))},nw:function(h,g,f){return d.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[h,g,f]))}},_propagate:function(g,f){d.ui.plugin.call(this,g,[f,this.ui()]);(g!="resize"&&this._trigger(g,f,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});d.ui.plugin.add("resizable","alsoResize",{start:function(g,h){var f=d(this).data("resizable"),k=f.options;var j=function(l){d(l).each(function(){var m=d(this);m.data("resizable-alsoresize",{width:parseInt(m.width(),10),height:parseInt(m.height(),10),left:parseInt(m.css("left"),10),top:parseInt(m.css("top"),10),position:m.css("position")})})};if(typeof(k.alsoResize)=="object"&&!k.alsoResize.parentNode){if(k.alsoResize.length){k.alsoResize=k.alsoResize[0];j(k.alsoResize)}else{d.each(k.alsoResize,function(l){j(l)})}}else{j(k.alsoResize)}},resize:function(h,k){var g=d(this).data("resizable"),l=g.options,j=g.originalSize,n=g.originalPosition;var m={height:(g.size.height-j.height)||0,width:(g.size.width-j.width)||0,top:(g.position.top-n.top)||0,left:(g.position.left-n.left)||0},f=function(o,p){d(o).each(function(){var s=d(this),t=d(this).data("resizable-alsoresize"),r={},q=p&&p.length?p:s.parents(k.originalElement[0]).length?["width","height"]:["width","height","top","left"];d.each(q,function(u,w){var v=(t[w]||0)+(m[w]||0);if(v&&v>=0){r[w]=v||null}});if(d.browser.opera&&/relative/.test(s.css("position"))){g._revertToRelativePosition=true;s.css({position:"absolute",top:"auto",left:"auto"})}s.css(r)})};if(typeof(l.alsoResize)=="object"&&!l.alsoResize.nodeType){d.each(l.alsoResize,function(o,p){f(o,p)})}else{f(l.alsoResize)}},stop:function(h,j){var g=d(this).data("resizable"),k=g.options;var f=function(l){d(l).each(function(){var m=d(this);m.css({position:m.data("resizable-alsoresize").position})})};if(g._revertToRelativePosition){g._revertToRelativePosition=false;if(typeof(k.alsoResize)=="object"&&!k.alsoResize.nodeType){d.each(k.alsoResize,function(l){f(l)})}else{f(k.alsoResize)}}d(this).removeData("resizable-alsoresize")}});d.ui.plugin.add("resizable","animate",{stop:function(k,q){var r=d(this).data("resizable"),l=r.options;var j=r._proportionallyResizeElements,f=j.length&&(/textarea/i).test(j[0].nodeName),g=f&&d.ui.hasScroll(j[0],"left")?0:r.sizeDiff.height,n=f?0:r.sizeDiff.width;var h={width:(r.size.width-n),height:(r.size.height-g)},m=(parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left))||null,p=(parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top))||null;r.element.animate(d.extend(h,p&&m?{top:p,left:m}:{}),{duration:l.animateDuration,easing:l.animateEasing,step:function(){var o={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};if(j&&j.length){d(j[0]).css({width:o.width,height:o.height})}r._updateCache(o);r._propagate("resize",k)}})}});d.ui.plugin.add("resizable","containment",{start:function(g,t){var v=d(this).data("resizable"),l=v.options,n=v.element;var h=l.containment,m=(h instanceof d)?h.get(0):(/parent/.test(h))?n.parent().get(0):h;if(!m){return}v.containerElement=d(m);if(/document/.test(h)||h==document){v.containerOffset={left:0,top:0};v.containerPosition={left:0,top:0};v.parentData={element:d(document),left:0,top:0,width:d(document).width(),height:d(document).height()||document.body.parentNode.scrollHeight}}else{var r=d(m),k=[];d(["Top","Right","Left","Bottom"]).each(function(p,o){k[p]=c(r.css("padding"+o))});v.containerOffset=r.offset();v.containerPosition=r.position();v.containerSize={height:(r.innerHeight()-k[3]),width:(r.innerWidth()-k[1])};var s=v.containerOffset,f=v.containerSize.height,q=v.containerSize.width,j=(d.ui.hasScroll(m,"left")?m.scrollWidth:q),u=(d.ui.hasScroll(m)?m.scrollHeight:f);v.parentData={element:m,left:s.left,top:s.top,width:j,height:u}}},resize:function(h,s){var v=d(this).data("resizable"),k=v.options,g=v.containerSize,r=v.containerOffset,p=v.size,q=v.position,t=v._aspectRatio||h.shiftKey,f={top:0,left:0},j=v.containerElement;if(j[0]!=document&&(/static/).test(j.css("position"))){f=r}if(q.left<(v._helper?r.left:0)){v.size.width=v.size.width+(v._helper?(v.position.left-r.left):(v.position.left-f.left));if(t){v.size.height=v.size.width/k.aspectRatio}v.position.left=k.helper?r.left:0}if(q.top<(v._helper?r.top:0)){v.size.height=v.size.height+(v._helper?(v.position.top-r.top):v.position.top);if(t){v.size.width=v.size.height*k.aspectRatio}v.position.top=v._helper?r.top:0}v.offset.left=v.parentData.left+v.position.left;v.offset.top=v.parentData.top+v.position.top;var n=Math.abs((v._helper?v.offset.left-f.left:(v.offset.left-f.left))+v.sizeDiff.width),u=Math.abs((v._helper?v.offset.top-f.top:(v.offset.top-r.top))+v.sizeDiff.height);var m=v.containerElement.get(0)==v.element.parent().get(0),l=/relative|absolute/.test(v.containerElement.css("position"));if(m&&l){n-=v.parentData.left}if(n+v.size.width>=v.parentData.width){v.size.width=v.parentData.width-n;if(t){v.size.height=v.size.width/v.aspectRatio}}if(u+v.size.height>=v.parentData.height){v.size.height=v.parentData.height-u;if(t){v.size.width=v.size.height*v.aspectRatio}}},stop:function(g,q){var s=d(this).data("resizable"),j=s.options,n=s.position,p=s.containerOffset,f=s.containerPosition,k=s.containerElement;var l=d(s.helper),t=l.offset(),r=l.outerWidth()-s.sizeDiff.width,m=l.outerHeight()-s.sizeDiff.height;if(s._helper&&!j.animate&&(/relative/).test(k.css("position"))){d(this).css({left:t.left-f.left-p.left,width:r,height:m})}if(s._helper&&!j.animate&&(/static/).test(k.css("position"))){d(this).css({left:t.left-f.left-p.left,width:r,height:m})}}});d.ui.plugin.add("resizable","ghost",{start:function(h,j){var f=d(this).data("resizable"),k=f.options,g=f.size;f.ghost=f.originalElement.clone();f.ghost.css({opacity:0.25,display:"block",position:"relative",height:g.height,width:g.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof k.ghost=="string"?k.ghost:"");f.ghost.appendTo(f.helper)},resize:function(g,h){var f=d(this).data("resizable"),j=f.options;if(f.ghost){f.ghost.css({position:"relative",height:f.size.height,width:f.size.width})}},stop:function(g,h){var f=d(this).data("resizable"),j=f.options;if(f.ghost&&f.helper){f.helper.get(0).removeChild(f.ghost.get(0))}}});d.ui.plugin.add("resizable","grid",{resize:function(f,p){var r=d(this).data("resizable"),j=r.options,m=r.size,k=r.originalSize,l=r.originalPosition,q=r.axis,n=j._aspectRatio||f.shiftKey;j.grid=typeof j.grid=="number"?[j.grid,j.grid]:j.grid;var h=Math.round((m.width-k.width)/(j.grid[0]||1))*(j.grid[0]||1),g=Math.round((m.height-k.height)/(j.grid[1]||1))*(j.grid[1]||1);if(/^(se|s|e)$/.test(q)){r.size.width=k.width+h;r.size.height=k.height+g}else{if(/^(ne)$/.test(q)){r.size.width=k.width+h;r.size.height=k.height+g;r.position.top=l.top-g}else{if(/^(sw)$/.test(q)){r.size.width=k.width+h;r.size.height=k.height+g;r.position.left=l.left-h}else{r.size.width=k.width+h;r.size.height=k.height+g;r.position.top=l.top-g;r.position.left=l.left-h}}}}});var c=function(f){return parseInt(f,10)||0};var a=function(f){return !isNaN(parseInt(f,10))}})(jQuery);(function(a,c){a.widget("ui.selectable",a.ui.mouse,{version:"1.9pre",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var d=this;this.element.addClass("ui-selectable");this.dragged=false;var e;this.refresh=function(){e=a(d.options.filter,d.element[0]);e.each(function(){var f=a(this);var g=f.offset();a.data(this,"selectable-item",{element:this,$element:f,left:g.left,top:g.top,right:g.left+f.outerWidth(),bottom:g.top+f.outerHeight(),startselected:false,selected:f.hasClass("ui-selected"),selecting:f.hasClass("ui-selecting"),unselecting:f.hasClass("ui-unselecting")})})};this.refresh();this.selectees=e.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(f){var d=this;this.opos=[f.pageX,f.pageY];if(this.options.disabled){return}var e=this.options;this.selectees=a(e.filter,this.element[0]);this._trigger("start",f);a(e.appendTo).append(this.helper);this.helper.css({left:f.clientX,top:f.clientY,width:0,height:0});if(e.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var g=a.data(this,"selectable-item");g.startselected=true;if(!f.metaKey){g.$element.removeClass("ui-selected");g.selected=false;g.$element.addClass("ui-unselecting");g.unselecting=true;d._trigger("unselecting",f,{unselecting:g.element})}});a(f.target).parents().andSelf().each(function(){var h=a.data(this,"selectable-item");if(h){var g=!f.metaKey||!h.$element.hasClass("ui-selected");h.$element.removeClass(g?"ui-unselecting":"ui-selected").addClass(g?"ui-selecting":"ui-unselecting");h.unselecting=!g;h.selecting=g;h.selected=g;if(g){d._trigger("selecting",f,{selecting:h.element})}else{d._trigger("unselecting",f,{unselecting:h.element})}return false}})},_mouseDrag:function(l){var e=this;this.dragged=true;if(this.options.disabled){return}var g=this.options;var f=this.opos[0],k=this.opos[1],d=l.pageX,j=l.pageY;if(f>d){var h=d;d=f;f=h}if(k>j){var h=j;j=k;k=h}this.helper.css({left:f,top:k,width:d-f,height:j-k});this.selectees.each(function(){var m=a.data(this,"selectable-item");if(!m||m.element==e.element[0]){return}var n=false;if(g.tolerance=="touch"){n=(!(m.left>d||m.right<f||m.top>j||m.bottom<k))}else{if(g.tolerance=="fit"){n=(m.left>f&&m.right<d&&m.top>k&&m.bottom<j)}}if(n){if(m.selected){m.$element.removeClass("ui-selected");m.selected=false}if(m.unselecting){m.$element.removeClass("ui-unselecting");m.unselecting=false}if(!m.selecting){m.$element.addClass("ui-selecting");m.selecting=true;e._trigger("selecting",l,{selecting:m.element})}}else{if(m.selecting){if(l.metaKey&&m.startselected){m.$element.removeClass("ui-selecting");m.selecting=false;m.$element.addClass("ui-selected");m.selected=true}else{m.$element.removeClass("ui-selecting");m.selecting=false;if(m.startselected){m.$element.addClass("ui-unselecting");m.unselecting=true}e._trigger("unselecting",l,{unselecting:m.element})}}if(m.selected){if(!l.metaKey&&!m.startselected){m.$element.removeClass("ui-selected");m.selected=false;m.$element.addClass("ui-unselecting");m.unselecting=true;e._trigger("unselecting",l,{unselecting:m.element})}}}});return false},_mouseStop:function(f){var d=this;this.dragged=false;var e=this.options;a(".ui-unselecting",this.element[0]).each(function(){var g=a.data(this,"selectable-item");g.$element.removeClass("ui-unselecting");g.unselecting=false;g.startselected=false;d._trigger("unselected",f,{unselected:g.element})});a(".ui-selecting",this.element[0]).each(function(){var g=a.data(this,"selectable-item");g.$element.removeClass("ui-selecting").addClass("ui-selected");g.selecting=false;g.selected=true;g.startselected=true;d._trigger("selected",f,{selected:g.element})});this._trigger("stop",f);this.helper.remove();return false}})})(jQuery);(function(a,c){a.widget("ui.sortable",a.ui.mouse,{version:"1.9pre",widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var d=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?d.axis==="x"||(/left|right/).test(this.items[0].item.css("float"))||(/inline|table-cell/).test(this.items[0].item.css("display")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var d=this.items.length-1;d>=0;d--){this.items[d].item.removeData("sortable-item")}return this},_setOption:function(d,e){if(d==="disabled"){this.options[d]=e;this.widget().toggleClass("ui-sortable-disabled",!!e)}else{a.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(g,h){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(g);var f=null,e=this,d=a(g.target).parents().each(function(){if(a.data(this,"sortable-item")==e){f=a(this);return false}});if(a.data(g.target,"sortable-item")==e){f=a(g.target)}if(!f){return false}if(this.options.handle&&!h){var j=false;a(this.options.handle,f).find("*").andSelf().each(function(){if(this==g.target){j=true}});if(!j){return false}}this.currentItem=f;this._removeCurrentsFromItems();return true},_mouseStart:function(g,h,d){var j=this.options,e=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(g);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");a.extend(this.offset,{click:{left:g.pageX-this.offset.left,top:g.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(g);this.originalPageX=g.pageX;this.originalPageY=g.pageY;(j.cursorAt&&this._adjustOffsetFromHelper(j.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(j.containment){this._setContainment()}if(j.cursor){if(a("body").css("cursor")){this._storedCursor=a("body").css("cursor")}a("body").css("cursor",j.cursor)}if(j.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",j.opacity)}if(j.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",j.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",g,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!d){for(var f=this.containers.length-1;f>=0;f--){this.containers[f]._trigger("activate",g,e._uiHash(this))}}if(a.ui.ddmanager){a.ui.ddmanager.current=this}if(a.ui.ddmanager&&!j.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,g)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(g);return true},_mouseDrag:function(h){this.position=this._generatePosition(h);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var j=this.options,d=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-h.pageY<j.scrollSensitivity){this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+j.scrollSpeed}else{if(h.pageY-this.overflowOffset.top<j.scrollSensitivity){this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-j.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-h.pageX<j.scrollSensitivity){this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+j.scrollSpeed}else{if(h.pageX-this.overflowOffset.left<j.scrollSensitivity){this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-j.scrollSpeed}}}else{if(h.pageY-a(document).scrollTop()<j.scrollSensitivity){d=a(document).scrollTop(a(document).scrollTop()-j.scrollSpeed)}else{if(a(window).height()-(h.pageY-a(document).scrollTop())<j.scrollSensitivity){d=a(document).scrollTop(a(document).scrollTop()+j.scrollSpeed)}}if(h.pageX-a(document).scrollLeft()<j.scrollSensitivity){d=a(document).scrollLeft(a(document).scrollLeft()-j.scrollSpeed)}else{if(a(window).width()-(h.pageX-a(document).scrollLeft())<j.scrollSensitivity){d=a(document).scrollLeft(a(document).scrollLeft()+j.scrollSpeed)}}}if(d!==false&&a.ui.ddmanager&&!j.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,h)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var f=this.items.length-1;f>=0;f--){var g=this.items[f],e=g.item[0],k=this._intersectsWithPointer(g);if(!k){continue}if(e!=this.currentItem[0]&&this.placeholder[k==1?"next":"prev"]()[0]!=e&&!a.contains(this.placeholder[0],e)&&(this.options.type=="semi-dynamic"?!a.contains(this.element[0],e):true)){this.direction=k==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(g)){this._rearrange(h,g)}else{break}this._trigger("change",h,this._uiHash());break}}this._contactContainers(h);if(a.ui.ddmanager){a.ui.ddmanager.drag(this,h)}this._trigger("sort",h,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,f){if(!e){return}if(a.ui.ddmanager&&!this.options.dropBehaviour){a.ui.ddmanager.drop(this,e)}if(this.options.revert){var d=this;var g=d.placeholder.offset();d.reverting=true;a(this.helper).animate({left:g.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:g.top-this.offset.parent.top-d.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(e)})}else{this._clear(e,f)}return false},cancel:function(){var d=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,d._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,d._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){a(this.domPosition.prev).after(this.currentItem)}else{a(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(f){var d=this._getItemsAsjQuery(f&&f.connected);var e=[];f=f||{};a(d).each(function(){var g=(a(f.item||this).attr(f.attribute||"id")||"").match(f.expression||(/(.+)[-=_](.+)/));if(g){e.push((f.key||g[1]+"[]")+"="+(f.key&&f.expression?g[1]:g[2]))}});if(!e.length&&f.key){e.push(f.key+"=")}return e.join("&")},toArray:function(f){var d=this._getItemsAsjQuery(f&&f.connected);var e=[];f=f||{};d.each(function(){e.push(a(f.item||this).attr(f.attribute||"id")||"")});return e},_intersectsWith:function(o){var f=this.positionAbs.left,e=f+this.helperProportions.width,n=this.positionAbs.top,m=n+this.helperProportions.height;var g=o.left,d=g+o.width,p=o.top,k=p+o.height;var q=this.offset.click.top,j=this.offset.click.left;var h=(n+q)>p&&(n+q)<k&&(f+j)>g&&(f+j)<d;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>o[this.floating?"width":"height"])){return h}else{return(g<f+(this.helperProportions.width/2)&&e-(this.helperProportions.width/2)<d&&p<n+(this.helperProportions.height/2)&&m-(this.helperProportions.height/2)<k)}},_intersectsWithPointer:function(f){var g=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top,f.height),e=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left,f.width),j=g&&e,d=this._getDragVerticalDirection(),h=this._getDragHorizontalDirection();if(!j){return false}return this.floating?(((h&&h=="right")||d=="down")?2:1):(d&&(d=="down"?2:1))},_intersectsWithSides:function(g){var e=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,g.top+(g.height/2),g.height),f=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,g.left+(g.width/2),g.width),d=this._getDragVerticalDirection(),h=this._getDragHorizontalDirection();if(this.floating&&h){return((h=="right"&&f)||(h=="left"&&!f))}else{return d&&((d=="down"&&e)||(d=="up"&&!e))}},_getDragVerticalDirection:function(){var d=this.positionAbs.top-this.lastPositionAbs.top;return d!=0&&(d>0?"down":"up")},_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return d!=0&&(d>0?"right":"left")},refresh:function(d){this._refreshItems(d);this.refreshPositions();return this},_connectWith:function(){var d=this.options;return d.connectWith.constructor==String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(d){var n=this;var k=[];var g=[];var l=this._connectWith();if(l&&d){for(var f=l.length-1;f>=0;f--){var m=a(l[f]);for(var e=m.length-1;e>=0;e--){var h=a.data(m[e],"sortable");if(h&&h!=this&&!h.options.disabled){g.push([a.isFunction(h.options.items)?h.options.items.call(h.element):a(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}}}}g.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var f=g.length-1;f>=0;f--){g[f][0].each(function(){k.push(this)})}return a(k)},_removeCurrentsFromItems:function(){var f=this.currentItem.find(":data(sortable-item)");for(var e=0;e<this.items.length;e++){for(var d=0;d<f.length;d++){if(f[d]==this.items[e].item[0]){this.items.splice(e,1)}}}},_refreshItems:function(d){this.items=[];this.containers=[this];var l=this.items;var r=this;var h=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],d,{item:this.currentItem}):a(this.options.items,this.element),this]];var n=this._connectWith();if(n){for(var g=n.length-1;g>=0;g--){var o=a(n[g]);for(var f=o.length-1;f>=0;f--){var k=a.data(o[f],"sortable");if(k&&k!=this&&!k.options.disabled){h.push([a.isFunction(k.options.items)?k.options.items.call(k.element[0],d,{item:this.currentItem}):a(k.options.items,k.element),k]);this.containers.push(k)}}}}for(var g=h.length-1;g>=0;g--){var m=h[g][1];var e=h[g][0];for(var f=0,p=e.length;f<p;f++){var q=a(e[f]);q.data("sortable-item",m);l.push({item:q,instance:m,width:0,height:0,left:0,top:0})}}},refreshPositions:function(d){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var f=this.items.length-1;f>=0;f--){var g=this.items[f];if(g.instance!=this.currentContainer&&this.currentContainer&&g.item[0]!=this.currentItem[0]){continue}var e=this.options.toleranceElement?a(this.options.toleranceElement,g.item):g.item;if(!d){g.width=e.outerWidth();g.height=e.outerHeight()}var h=e.offset();g.left=h.left;g.top=h.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var f=this.containers.length-1;f>=0;f--){var h=this.containers[f].element.offset();this.containers[f].containerCache.left=h.left;this.containers[f].containerCache.top=h.top;this.containers[f].containerCache.width=this.containers[f].element.outerWidth();this.containers[f].containerCache.height=this.containers[f].element.outerHeight()}}return this},_createPlaceholder:function(f){var d=f||this,g=d.options;if(!g.placeholder||g.placeholder.constructor==String){var e=g.placeholder;g.placeholder={element:function(){var h=a(document.createElement(d.currentItem[0].nodeName)).addClass(e||d.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!e){h.style.visibility="hidden"}return h},update:function(h,j){if(e&&!g.forcePlaceholderSize){return}if(!j.height()){j.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10))}if(!j.width()){j.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10))}}}}d.placeholder=a(g.placeholder.element.call(d.element,d.currentItem));d.currentItem.after(d.placeholder);g.placeholder.update(d,d.placeholder)},_contactContainers:function(d){var f=null,m=null;for(var h=this.containers.length-1;h>=0;h--){if(a.contains(this.currentItem[0],this.containers[h].element[0])){continue}if(this._intersectsWith(this.containers[h].containerCache)){if(f&&a.contains(this.containers[h].element[0],f.element[0])){continue}f=this.containers[h];m=h}else{if(this.containers[h].containerCache.over){this.containers[h]._trigger("out",d,this._uiHash(this));this.containers[h].containerCache.over=0}}}if(!f){return}if(this.containers.length===1){this.containers[m]._trigger("over",d,this._uiHash(this));this.containers[m].containerCache.over=1}else{if(this.currentContainer!=this.containers[m]){var l=10000;var k=null;var e=this.positionAbs[this.containers[m].floating?"left":"top"];for(var g=this.items.length-1;g>=0;g--){if(!a.contains(this.containers[m].element[0],this.items[g].item[0])){continue}var n=this.items[g][this.containers[m].floating?"left":"top"];if(Math.abs(n-e)<l){l=Math.abs(n-e);k=this.items[g]}}if(!k&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[m];k?this._rearrange(d,k,null,true):this._rearrange(d,null,this.containers[m].element,true);this._trigger("change",d,this._uiHash());this.containers[m]._trigger("change",d,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[m]._trigger("over",d,this._uiHash(this));this.containers[m].containerCache.over=1}}},_createHelper:function(e){var f=this.options;var d=a.isFunction(f.helper)?a(f.helper.apply(this.element[0],[e,this.currentItem])):(f.helper=="clone"?this.currentItem.clone():this.currentItem);if(!d.parents("body").length){a(f.appendTo!="parent"?f.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0])}if(d[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(d[0].style.width==""||f.forceHelperSize){d.width(this.currentItem.width())}if(d[0].style.height==""||f.forceHelperSize){d.height(this.currentItem.height())}return d},_adjustOffsetFromHelper:function(d){if(typeof d=="string"){d=d.split(" ")}if(a.isArray(d)){d={left:+d[0],top:+d[1]||0}}if("left" in d){this.offset.click.left=d.left+this.margins.left}if("right" in d){this.offset.click.left=this.helperProportions.width-d.right+this.margins.left}if("top" in d){this.offset.click.top=d.top+this.margins.top}if("bottom" in d){this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])){d.left+=this.scrollParent.scrollLeft();d.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){d={top:0,left:0}}return{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var g=this.options;if(g.containment=="parent"){g.containment=this.helper[0].parentNode}if(g.containment=="document"||g.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(g.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(g.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(g.containment)){var e=a(g.containment)[0];var f=a(g.containment).offset();var d=(a(e).css("overflow")!="hidden");this.containment=[f.left+(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0)-this.margins.left,f.top+(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0)-this.margins.top,f.left+(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,f.top+(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(h,k){if(!k){k=this.position}var f=h=="absolute"?1:-1;var g=this.options,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(e[0].tagName);return{top:(k.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:e.scrollTop()))*f)),left:(k.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:e.scrollLeft())*f))}},_generatePosition:function(g){var k=this.options,d=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=(/(html|body)/i).test(d[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var f=g.pageX;var e=g.pageY;if(this.originalPosition){if(this.containment){if(g.pageX-this.offset.click.left<this.containment[0]){f=this.containment[0]+this.offset.click.left}if(g.pageY-this.offset.click.top<this.containment[1]){e=this.containment[1]+this.offset.click.top}if(g.pageX-this.offset.click.left>this.containment[2]){f=this.containment[2]+this.offset.click.left}if(g.pageY-this.offset.click.top>this.containment[3]){e=this.containment[3]+this.offset.click.top}}if(k.grid){var j=this.originalPageY+Math.round((e-this.originalPageY)/k.grid[1])*k.grid[1];e=this.containment?(!(j-this.offset.click.top<this.containment[1]||j-this.offset.click.top>this.containment[3])?j:(!(j-this.offset.click.top<this.containment[1])?j-k.grid[1]:j+k.grid[1])):j;var h=this.originalPageX+Math.round((f-this.originalPageX)/k.grid[0])*k.grid[0];f=this.containment?(!(h-this.offset.click.left<this.containment[0]||h-this.offset.click.left>this.containment[2])?h:(!(h-this.offset.click.left<this.containment[0])?h-k.grid[0]:h+k.grid[0])):h}}return{top:(e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(l?0:d.scrollTop())))),left:(f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():l?0:d.scrollLeft())))}},_rearrange:function(j,h,e,g){e?e[0].appendChild(this.placeholder[0]):h.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?h.item[0]:h.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var f=this,d=this.counter;window.setTimeout(function(){if(d==f.counter){f.refreshPositions(!g)}},0)},_clear:function(f,g){this.reverting=false;var h=[],d=this;if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS){if(this._storedCSS[e]=="auto"||this._storedCSS[e]=="static"){this._storedCSS[e]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!g){h.push(function(j){this._trigger("receive",j,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!g){h.push(function(j){this._trigger("update",j,this._uiHash())})}if(!a.contains(this.element[0],this.currentItem[0])){if(!g){h.push(function(j){this._trigger("remove",j,this._uiHash())})}for(var e=this.containers.length-1;e>=0;e--){if(a.contains(this.containers[e].element[0],this.currentItem[0])&&!g){h.push((function(j){return function(k){j._trigger("receive",k,this._uiHash(this))}}).call(this,this.containers[e]));h.push((function(j){return function(k){j._trigger("update",k,this._uiHash(this))}}).call(this,this.containers[e]))}}}for(var e=this.containers.length-1;e>=0;e--){if(!g){h.push((function(j){return function(k){j._trigger("deactivate",k,this._uiHash(this))}}).call(this,this.containers[e]))}if(this.containers[e].containerCache.over){h.push((function(j){return function(k){j._trigger("out",k,this._uiHash(this))}}).call(this,this.containers[e]));this.containers[e].containerCache.over=0}}if(this._storedCursor){a("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!g){this._trigger("beforeStop",f,this._uiHash());for(var e=0;e<h.length;e++){h[e].call(this,f)}this._trigger("stop",f,this._uiHash())}return false}if(!g){this._trigger("beforeStop",f,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!g){for(var e=0;e<h.length;e++){h[e].call(this,f)}this._trigger("stop",f,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(a.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var d=e||this;return{helper:d.helper,placeholder:d.placeholder||a([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:e?e.element:null}}})})(jQuery);jQuery.effects||(function(k,f){var j=k.uiBackCompat!==false;k.effects={effect:{}};k.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(q,p){k.fx.step[p]=function(r){if(!r.colorInit){r.start=o(r.elem,p);r.end=m(r.end);r.colorInit=true}r.elem.style[p]="rgb("+Math.max(Math.min(parseInt((r.pos*(r.end[0]-r.start[0]))+r.start[0],10),255),0)+","+Math.max(Math.min(parseInt((r.pos*(r.end[1]-r.start[1]))+r.start[1],10),255),0)+","+Math.max(Math.min(parseInt((r.pos*(r.end[2]-r.start[2]))+r.start[2],10),255),0)+")"}});function m(q){var p;if(q&&q.constructor===Array&&q.length===3){return q}if(p=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(q)){return[parseInt(p[1],10),parseInt(p[2],10),parseInt(p[3],10)]}if(p=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(q)){return[parseFloat(p[1])*2.55,parseFloat(p[2])*2.55,parseFloat(p[3])*2.55]}if(p=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(q)){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}if(p=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(q)){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]}if(p=/rgba\(0, 0, 0, 0\)/.exec(q)){return a.transparent}return a[k.trim(q).toLowerCase()]}function o(r,p){var q;do{q=k.curCSS(r,p);if(q!=""&&q!=="transparent"||k.nodeName(r,"body")){break}p="backgroundColor"}while(r=r.parentNode);return m(q)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var g=["add","remove","toggle"],c={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},e="ec.storage.";k.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(p,q){k.fx.step[q]=function(r){if(r.end!=="none"&&!r.setAttr||r.pos===1&&!r.setAttr){jQuery.style(r.elem,q,r.end);r.setAttr=true}}});function h(){var s=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,t={},q,r,p;if(s&&s.length&&s[0]&&s[s[0]]){p=s.length;while(p--){q=s[p];if(typeof s[q]==="string"){t[k.camelCase(q)]=s[q]}}}else{for(q in s){if(typeof s[q]==="string"){t[q]=s[q]}}}return t}function l(p,r){var t={},q,s;for(q in r){s=r[q];if(p[q]!=s){if(!c[q]){if(k.fx.step[q]||!isNaN(parseFloat(s))){t[q]=s}}}}return t}k.effects.animateClass=function(p,q,t,s){var r=k.speed(q,t,s);return this.queue(function(){var v=k(this),u=v.attr("class"),y,w=r.children?v.find("*").andSelf():v;w=w.map(function(){var z=k(this);return{el:z,originalStyleAttr:z.attr("style")||" ",start:h.call(this)}});k.each(g,function(z,A){if(p[A]){v[A+"Class"](p[A])}});y=v.attr("class");w=w.map(function(){this.end=h.call(this.el[0]);this.diff=l(this.start,this.end);return this});v.attr("class",u);w=w.map(function(){var A=this,z=k.Deferred();this.el.animate(this.diff,{duration:r.duration,easing:r.easing,queue:false,complete:function(){z.resolve(A)}});return z.promise()});k.when.apply(k,w.get()).done(function(){v.attr("class",y);k.each(arguments,function(){if(typeof this.el.attr("style")==="object"){this.el.attr("style").cssText="";this.el.attr("style").cssText=this.originalStyleAttr}else{this.el.attr("style",this.originalStyleAttr)}});r.complete.call(v[0])})})};k.fn.extend({_addClass:k.fn.addClass,addClass:function(q,p,s,r){return p?k.effects.animateClass.apply(this,[{add:q},p,s,r]):this._addClass(q)},_removeClass:k.fn.removeClass,removeClass:function(q,p,s,r){return p?k.effects.animateClass.apply(this,[{remove:q},p,s,r]):this._removeClass(q)},_toggleClass:k.fn.toggleClass,toggleClass:function(r,q,p,t,s){if(typeof q==="boolean"||q===f){if(!p){return this._toggleClass(r,q)}else{return k.effects.animateClass.apply(this,[(q?{add:r}:{remove:r}),p,t,s])}}else{return k.effects.animateClass.apply(this,[{toggle:r},q,p,t])}},switchClass:function(p,r,q,t,s){return k.effects.animateClass.apply(this,[{add:r,remove:p},q,t,s])}});k.extend(k.effects,{version:"1.9pre",save:function(q,r){for(var p=0;p<r.length;p++){if(r[p]!==null){q.data(e+r[p],q[0].style[r[p]])}}},restore:function(q,r){for(var p=0;p<r.length;p++){if(r[p]!==null){q.css(r[p],q.data(e+r[p]))}}},setMode:function(p,q){if(q==="toggle"){q=p.is(":hidden")?"show":"hide"}return q},getBaseline:function(q,r){var s,p;switch(q[0]){case"top":s=0;break;case"middle":s=0.5;break;case"bottom":s=1;break;default:s=q[0]/r.height}switch(q[1]){case"left":p=0;break;case"center":p=0.5;break;case"right":p=1;break;default:p=q[1]/r.width}return{x:p,y:s}},createWrapper:function(q){if(q.parent().is(".ui-effects-wrapper")){return q.parent()}var r={width:q.outerWidth(true),height:q.outerHeight(true),"float":q.css("float")},s=k("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),p={width:q.width(),height:q.height()};q.wrap(s);s=q.parent();if(q.css("position")==="static"){s.css({position:"relative"});q.css({position:"relative"})}else{k.extend(r,{position:q.css("position"),zIndex:q.css("z-index")});k.each(["top","left","bottom","right"],function(t,u){r[u]=q.css(u);if(isNaN(parseInt(r[u],10))){r[u]="auto"}});q.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}q.css(p);return s.css(r).show()},removeWrapper:function(p){if(p.parent().is(".ui-effects-wrapper")){return p.parent().replaceWith(p)}return p},setTransition:function(q,s,p,r){r=r||{};k.each(s,function(u,t){var v=q.cssUnit(t);if(v[0]>0){r[t]=v[0]*p+v[1]}});return r}});function d(q,p,r,s){if(k.isPlainObject(q)){return q}q={effect:q};if(p===f){p={}}if(k.isFunction(p)){s=p;r=null;p={}}if(k.type(p)==="number"||k.fx.speeds[p]){s=r;r=p;p={}}if(k.isFunction(r)){s=r;r=null}if(p){k.extend(q,p)}r=r||p.duration;q.duration=k.fx.off?0:typeof r==="number"?r:r in k.fx.speeds?k.fx.speeds[r]:k.fx.speeds._default;q.complete=s||p.complete;return q}function n(p){if(!p||typeof p==="number"||k.fx.speeds[p]){return true}if(typeof p==="string"&&!k.effects.effect[p]){if(j&&k.effects[p]){return false}return true}return false}k.fn.extend({effect:function(t,r,u,w){var q=d.apply(this,arguments),v=q.mode,p=k.effects.effect[q.effect],s=!p&&j&&k.effects[q.effect];if(k.fx.off||!(p||s)){if(v){return this[v](q.duration,q.complete)}else{return this.each(function(){if(q.complete){q.complete.call(this)}})}}if(p){return p.call(this,q)}else{return s.call(this,{options:q,duration:q.duration,callback:q.complete,mode:q.mode})}},_show:k.fn.show,show:function(q){if(n(q)){return this._show.apply(this,arguments)}else{var p=d.apply(this,arguments);p.mode="show";return this.effect.call(this,p)}},_hide:k.fn.hide,hide:function(q){if(n(q)){return this._hide.apply(this,arguments)}else{var p=d.apply(this,arguments);p.mode="hide";return this.effect.call(this,p)}},__toggle:k.fn.toggle,toggle:function(q){if(n(q)||typeof q==="boolean"||k.isFunction(q)){return this.__toggle.apply(this,arguments)}else{var p=d.apply(this,arguments);p.mode="toggle";return this.effect.call(this,p)}},cssUnit:function(p){var q=this.css(p),r=[];k.each(["em","px","%","pt"],function(s,t){if(q.indexOf(t)>0){r=[parseFloat(q),t]}});return r}});k.easing.jswing=k.easing.swing;k.extend(k.easing,{def:"easeOutQuad",swing:function(q,r,p,u,s){return k.easing[k.easing.def](q,r,p,u,s)},easeInQuad:function(q,r,p,u,s){return u*(r/=s)*r+p},easeOutQuad:function(q,r,p,u,s){return -u*(r/=s)*(r-2)+p},easeInOutQuad:function(q,r,p,u,s){if((r/=s/2)<1){return u/2*r*r+p}return -u/2*((--r)*(r-2)-1)+p},easeInCubic:function(q,r,p,u,s){return u*(r/=s)*r*r+p},easeOutCubic:function(q,r,p,u,s){return u*((r=r/s-1)*r*r+1)+p},easeInOutCubic:function(q,r,p,u,s){if((r/=s/2)<1){return u/2*r*r*r+p}return u/2*((r-=2)*r*r+2)+p},easeInQuart:function(q,r,p,u,s){return u*(r/=s)*r*r*r+p},easeOutQuart:function(q,r,p,u,s){return -u*((r=r/s-1)*r*r*r-1)+p},easeInOutQuart:function(q,r,p,u,s){if((r/=s/2)<1){return u/2*r*r*r*r+p}return -u/2*((r-=2)*r*r*r-2)+p},easeInQuint:function(q,r,p,u,s){return u*(r/=s)*r*r*r*r+p},easeOutQuint:function(q,r,p,u,s){return u*((r=r/s-1)*r*r*r*r+1)+p},easeInOutQuint:function(q,r,p,u,s){if((r/=s/2)<1){return u/2*r*r*r*r*r+p}return u/2*((r-=2)*r*r*r*r+2)+p},easeInSine:function(q,r,p,u,s){return -u*Math.cos(r/s*(Math.PI/2))+u+p},easeOutSine:function(q,r,p,u,s){return u*Math.sin(r/s*(Math.PI/2))+p},easeInOutSine:function(q,r,p,u,s){return -u/2*(Math.cos(Math.PI*r/s)-1)+p},easeInExpo:function(q,r,p,u,s){return(r==0)?p:u*Math.pow(2,10*(r/s-1))+p},easeOutExpo:function(q,r,p,u,s){return(r==s)?p+u:u*(-Math.pow(2,-10*r/s)+1)+p},easeInOutExpo:function(q,r,p,u,s){if(r==0){return p}if(r==s){return p+u}if((r/=s/2)<1){return u/2*Math.pow(2,10*(r-1))+p}return u/2*(-Math.pow(2,-10*--r)+2)+p},easeInCirc:function(q,r,p,u,s){return -u*(Math.sqrt(1-(r/=s)*r)-1)+p},easeOutCirc:function(q,r,p,u,s){return u*Math.sqrt(1-(r=r/s-1)*r)+p},easeInOutCirc:function(q,r,p,u,s){if((r/=s/2)<1){return -u/2*(Math.sqrt(1-r*r)-1)+p}return u/2*(Math.sqrt(1-(r-=2)*r)+1)+p},easeInElastic:function(r,v,q,A,z){var w=1.70158,y=z*0.3,u=A;if(v==0){return q}if((v/=z)==1){return q+A}if(u<Math.abs(A)){u=A;w=y/4}else{w=y/(2*Math.PI)*Math.asin(A/u)}return -(u*Math.pow(2,10*(v-=1))*Math.sin((v*z-w)*(2*Math.PI)/y))+q},easeOutElastic:function(r,v,q,A,z){var w=1.70158,y=z*0.3,u=A;if(v==0){return q}if((v/=z)==1){return q+A}if(u<Math.abs(A)){u=A;w=y/4}else{w=y/(2*Math.PI)*Math.asin(A/u)}return u*Math.pow(2,-10*v)*Math.sin((v*z-w)*(2*Math.PI)/y)+A+q},easeInOutElastic:function(r,v,q,A,z){var w=1.70158,y=z*(0.3*1.5),u=A;if(v==0){return q}if((v/=z/2)==2){return q+A}if(u<Math.abs(A)){u=A;w=y/4}else{w=y/(2*Math.PI)*Math.asin(A/u)}if(v<1){return -0.5*(u*Math.pow(2,10*(v-=1))*Math.sin((v*z-w)*(2*Math.PI)/y))+q}return u*Math.pow(2,-10*(v-=1))*Math.sin((v*z-w)*(2*Math.PI)/y)*0.5+A+q},easeInBack:function(q,r,p,w,v,u){if(u==f){u=1.70158}return w*(r/=v)*r*((u+1)*r-u)+p},easeOutBack:function(q,r,p,w,v,u){if(u==f){u=1.70158}return w*((r=r/v-1)*r*((u+1)*r+u)+1)+p},easeInOutBack:function(q,r,p,w,v,u){if(u==f){u=1.70158}if((r/=v/2)<1){return w/2*(r*r*(((u*=1.525)+1)*r-u))+p}return w/2*((r-=2)*r*(((u*=1.525)+1)*r+u)+2)+p},easeInBounce:function(q,r,p,u,s){return u-k.easing.easeOutBounce(q,s-r,0,u,s)+p},easeOutBounce:function(q,r,p,u,s){if((r/=s)<(1/2.75)){return u*(7.5625*r*r)+p}else{if(r<(2/2.75)){return u*(7.5625*(r-=(1.5/2.75))*r+0.75)+p}else{if(r<(2.5/2.75)){return u*(7.5625*(r-=(2.25/2.75))*r+0.9375)+p}else{return u*(7.5625*(r-=(2.625/2.75))*r+0.984375)+p}}}},easeInOutBounce:function(q,r,p,u,s){if(r<s/2){return k.easing.easeInBounce(q,r*2,0,u,s)*0.5+p}return k.easing.easeOutBounce(q,r*2-s,0,u,s)*0.5+u*0.5+p}})})(jQuery);(function(c,e){var a=/up|down|vertical/;var d=/up|left|vertical|horizontal/;c.effects.effect.blind=function(f){return this.queue(function(){var j=c(this),p=["position","top","bottom","left","right","height","width"],n=c.effects.setMode(j,f.mode||"hide"),q=f.direction||"up",l=a.test(q),k=l?"height":"width",o=l?"top":"left",r=d.test(q),m={},h,g;if(j.parent().is(".ui-effects-wrapper")){c.effects.save(j.parent(),p)}else{c.effects.save(j,p)}j.show();h=c.effects.createWrapper(j).css({overflow:"hidden"});g=h[k]();m[k]=(n==="show"?g:0);if(!r){j.css(l?"bottom":"right",0).css(l?"top":"left","").css({position:"absolute"});m[o]=(n==="show")?0:g}if(n=="show"){h.css(k,0);if(!r){h.css(o,g)}}h.animate(m,{duration:f.duration,easing:f.easing,queue:false,complete:function(){if(n=="hide"){j.hide()}c.effects.restore(j,p);c.effects.removeWrapper(j);if(c.isFunction(f.complete)){f.complete.apply(j[0],arguments)}j.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.bounce=function(d){return this.queue(function(n){var e=a(this),f=["position","top","bottom","left","right","height","width"],m=a.effects.setMode(e,d.mode||"effect"),l=m==="hide",v=m==="show",w=d.direction||"up",g=d.distance,k=d.times||5,y=k*2+(v||l?1:0),u=d.duration/y,p=d.easing,h=(w==="up"||w==="down")?"top":"left",o=(w==="up"||w==="left"),t,j,s,q=e.queue(),r=q.length;if(v||l){f.push("opacity")}a.effects.save(e,f);e.show();a.effects.createWrapper(e);if(!g){g=e[h==="top"?"outerHeight":"outerWidth"]()/3}if(v){s={opacity:1};s[h]=0;e.css("opacity",0).css(h,o?-g*2:g*2).animate(s,u,p)}if(l){g=g/Math.pow(2,k-1)}s={};s[h]=0;for(t=0;t<k;t++){j={};j[h]=(o?"-=":"+=")+g;e.animate(j,u,p).animate(s,u,p);g=l?g*2:g/2}if(l){j={opacity:0};j[h]=(o?"-=":"+=")+g;e.animate(j,u,p)}e.queue(function(z){if(l){e.hide()}a.effects.restore(e,f);a.effects.removeWrapper(e);if(d.complete){d.complete.apply(e[0])}z()});if(r>1){q.splice.apply(q,[1,0].concat(q.splice(r,y+1)))}n()})}})(jQuery);(function(a,c){a.effects.effect.clip=function(d){return this.queue(function(){var h=a(this),n=["position","top","bottom","left","right","height","width"],m=a.effects.setMode(h,d.mode||"hide"),p=m==="show",o=d.direction||"vertical",k=o==="vertical",q=k?"height":"width",l=k?"top":"left",j={},f,g,e;a.effects.save(h,n);h.show();f=a.effects.createWrapper(h).css({overflow:"hidden"});g=(h[0].tagName==="IMG")?f:h;e=g[q]();if(p){g.css(q,0);g.css(l,e/2)}j[q]=p?e:0;j[l]=p?0:e/2;g.animate(j,{queue:false,duration:d.duration,easing:d.easing,complete:function(){if(!p){h.hide()}a.effects.restore(h,n);a.effects.removeWrapper(h);if(a.isFunction(d.complete)){d.complete.apply(h[0],arguments)}h.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.drop=function(d){return this.queue(function(){var g=a(this),f=["position","top","bottom","left","right","opacity","height","width"],l=a.effects.setMode(g,d.mode||"hide"),k=d.direction||"left",h=(k=="up"||k=="down")?"top":"left",e=(k=="up"||k=="left")?"pos":"neg",j={opacity:l=="show"?1:0},m;a.effects.save(g,f);g.show();a.effects.createWrapper(g);m=d.distance||g[h=="top"?"outerHeight":"outerWidth"]({margin:true})/2;if(l=="show"){g.css("opacity",0).css(h,e=="pos"?-m:m)}j[h]=((l=="show")?(e=="pos"?"+=":"-="):(e=="pos"?"-=":"+="))+m;g.animate(j,{queue:false,duration:d.duration,easing:d.easing,complete:function(){l=="hide"&&g.hide();a.effects.restore(g,f);a.effects.removeWrapper(g);a.isFunction(d.complete)&&d.complete.apply(this,arguments);g.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.explode=function(d){return this.queue(function(s){var m=d.pieces?Math.round(Math.sqrt(d.pieces)):3,f=m,e=a(this),o=a.effects.setMode(e,d.mode||"hide"),w=(o=="show"),k=e.show().css("visibility","hidden").offset(),t=Math.ceil(e.outerWidth()/f),r=Math.ceil(e.outerHeight()/m),l=[],v,u,g,q,p,n;for(v=0;v<m;v++){q=k.top+v*r;n=v-(m-1)/2;for(u=0;u<f;u++){g=k.left+u*t;p=u-(f-1)/2;e.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-u*t,top:-v*r}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:t,height:r,left:g+(w?p*t:0),top:q+(w?n*r:0),opacity:w?0:1}).animate({left:g+(w?0:p*t),top:q+(w?0:n*r),opacity:w?1:0},d.duration||500,d.easing,y)}}function y(){l.push(this);if(l.length==m*f){h()}}function h(){e.css({visibility:"visible"});a(l).remove();if(!w){e.hide()}if(a.isFunction(d.complete)){d.complete.apply(e[0])}s()}})}})(jQuery);(function(a,c){a.effects.effect.fade=function(d){return this.queue(function(g){var f=a(this),h=a.effects.setMode(f,d.mode||"toggle"),e=h==="hide";f.show();f.animate({opacity:e?0:1},{queue:false,duration:d.duration,easing:d.easing,complete:function(){if(e){f.hide()}if(d.complete){d.complete.call(this)}g()}})})}})(jQuery);(function(a,c){a.effects.effect.fold=function(d){return this.queue(function(){var g=a(this),n=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(g,d.mode||"hide"),r=d.size||15,m=/([0-9]+)%/.exec(r),q=!!d.horizFirst,l=((k=="show")!=q),h=l?["width","height"]:["height","width"],j=d.duration/2,f,e;a.effects.save(g,n);g.show();f=a.effects.createWrapper(g).css({overflow:"hidden"});e=l?[f.width(),f.height()]:[f.height(),f.width()];if(m){r=parseInt(m[1],10)/100*e[(k=="hide")?0:1]}k=="show"&&f.css(q?{height:0,width:r}:{height:r,width:0});var p={},o={};p[h[0]]=k=="show"?e[0]:r;o[h[1]]=k=="show"?e[1]:0;f.animate(p,j,d.easing).animate(o,j,d.easing,function(){(k=="hide")&&g.hide();a.effects.restore(g,n);a.effects.removeWrapper(g);jQuery.isFunction(d.complete)&&d.complete.apply(g[0],arguments);g.dequeue()})})}})(jQuery);(function(a,c){a.effects.effect.highlight=function(d){return this.queue(function(){var f=a(this),e=["backgroundImage","backgroundColor","opacity"],h=a.effects.setMode(f,d.mode||"show"),g={backgroundColor:f.css("backgroundColor")};if(h=="hide"){g.opacity=0}a.effects.save(f,e);f.show().css({backgroundImage:"none",backgroundColor:d.color||"#ffff99"}).animate(g,{queue:false,duration:d.duration,easing:d.easing,complete:function(){(h=="hide"&&f.hide());a.effects.restore(f,e);(h=="show"&&!a.support.opacity&&this.style.removeAttribute("filter"));jQuery.isFunction(d.complete)&&d.complete.apply(this,arguments);f.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.pulsate=function(d){return this.queue(function(j){var f=a(this),l=a.effects.setMode(f,d.mode||"show"),p=l==="show",m=l==="hide",q=(p||l==="hide"),n=((d.times||5)*2)+(q?1:0),g=d.duration/n,o=0,k=f.queue(),e=k.length,h;if(p||!f.is(":visible")){f.css("opacity",0).show();o=1}for(h=1;h<n;h++){f.animate({opacity:o},g,d.easing);o=1-o}f.animate({opacity:o},g,d.easing);f.queue(function(r){if(m){f.hide()}if(d.complete){d.complete.apply(this)}r()});if(e>1){k.splice.apply(k,[1,0].concat(k.splice(e,n+1)))}j()})}})(jQuery);(function(a,c){a.effects.effect.puff=function(d){return this.queue(function(){var h=a(this),j=a.effects.setMode(h,d.mode||"hide"),g=parseInt(d.percent,10)||150,f=g/100,e={height:h.height(),width:h.width()};a.extend(d,{effect:"scale",queue:false,fade:true,mode:j,percent:j=="hide"?g:100,from:j=="hide"?e:{height:e.height*f,width:e.width*f}});h.effect(d)})};a.effects.effect.scale=function(d){return this[d.queue===false?"each":"queue"](function(){var j=a(this),f=a.extend(true,{},d),m=a.effects.setMode(j,d.mode||"effect"),k=parseInt(d.percent,10)||(parseInt(d.percent,10)==0?0:(m=="hide"?0:100)),l=d.direction||"both",e=d.origin,h={height:j.height(),width:j.width(),outerHeight:j.outerHeight(),outerWidth:j.outerWidth()},g={y:l!="horizontal"?(k/100):1,x:l!="vertical"?(k/100):1};f.effect="size";f.queue=false;if(m!="effect"){f.origin=e||["middle","center"];f.restore=true}f.from=d.from||(m=="show"?{height:0,width:0}:h);f.to={height:h.height*g.y,width:h.width*g.x,outerHeight:h.outerHeight*g.y,outerWidth:h.outerWidth*g.x};if(f.fade){if(m=="show"){f.from.opacity=0;f.to.opacity=1}if(m=="hide"){f.from.opacity=1;f.to.opacity=0}}j.effect(f)})};a.effects.effect.size=function(d){return this[d.queue===false?"each":"queue"](function(){var e=a(this),s=["position","top","bottom","left","right","width","height","overflow","opacity"],r=["position","top","bottom","left","right","overflow","opacity"],o=["width","height","overflow"],u=["fontSize"],p=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],j=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],l=a.effects.setMode(e,d.mode||"effect"),n=d.restore||l!=="effect",g=d.scale||"both",t=d.origin||["middle","center"],f,m,q,k=e.css("position"),h=e.css("bottom")!=="auto"?"bottom":"top";originalHorizontalPositioning=e.css("right")!=="auto"?"right":"left";if(l==="show"){e.show()}f={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()};e.from=d.from||f;e.to=d.to||f;q={from:{y:e.from.height/f.height,x:e.from.width/f.width},to:{y:e.to.height/f.height,x:e.to.width/f.width}};if(g=="box"||g=="both"){if(q.from.y!==q.to.y){s=s.concat(p);e.from=a.effects.setTransition(e,p,q.from.y,e.from);e.to=a.effects.setTransition(e,p,q.to.y,e.to)}if(q.from.x!==q.to.x){s=s.concat(j);e.from=a.effects.setTransition(e,j,q.from.x,e.from);e.to=a.effects.setTransition(e,j,q.to.x,e.to)}}if(g=="content"||g=="both"){if(q.from.y!==q.to.y){s=s.concat(u);e.from=a.effects.setTransition(e,u,q.from.y,e.from);e.to=a.effects.setTransition(e,u,q.to.y,e.to)}}a.effects.save(e,n?s:r);e.show();a.effects.createWrapper(e);e.css("overflow","hidden").css(e.from);if(t){m=a.effects.getBaseline(t,f);e.from.top=(f.outerHeight-e.outerHeight())*m.y;e.from.left=(f.outerWidth-e.outerWidth())*m.x;e.to.top=(f.outerHeight-e.to.outerHeight)*m.y;e.to.left=(f.outerWidth-e.to.outerWidth)*m.x}e.css(e.from);if(g=="content"||g=="both"){p=p.concat(["marginTop","marginBottom"]).concat(u);j=j.concat(["marginLeft","marginRight"]);o=s.concat(p).concat(j);e.find("*[width]").each(function(){var w=a(this),v={height:w.height(),width:w.width()};if(n){a.effects.save(w,o)}w.from={height:v.height*q.from.y,width:v.width*q.from.x};w.to={height:v.height*q.to.y,width:v.width*q.to.x};if(q.from.y!=q.to.y){w.from=a.effects.setTransition(w,p,q.from.y,w.from);w.to=a.effects.setTransition(w,p,q.to.y,w.to)}if(q.from.x!=q.to.x){w.from=a.effects.setTransition(w,j,q.from.x,w.from);w.to=a.effects.setTransition(w,j,q.to.x,w.to)}w.css(w.from);w.animate(w.to,d.duration,d.easing,function(){if(n){a.effects.restore(w,o)}})})}e.animate(e.to,{queue:false,duration:d.duration,easing:d.easing,complete:function(){if(e.to.opacity===0){e.css("opacity",e.from.opacity)}if(l=="hide"){e.hide()}a.effects.restore(e,n?s:r);if(k==="static"){e.css({position:"relative",top:e.to.top,left:e.to.left})}else{a.each([h,originalHorizontalPositioning],function(v,w){e.css(w,function(A,D){var C=parseInt(D,10),y=v?e.to.left:e.to.top,F=v?e.to.outerWidth-e.from.outerWidth:e.to.outerHeight-e.from.outerHeight,E=t[v]===w,z=t[v]==="middle"||t[v]==="center",B=w=="left"||w=="top";if(D==="auto"){return y+"px"}if(!B){if(k==="relative"){y*=-1}else{if(!z){y-=F*(E?-1:1)}}}return C+y+"px"})})}a.effects.removeWrapper(e);a.isFunction(d.complete)&&d.complete.apply(this,arguments);e.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.shake=function(d){return this.queue(function(){var g=a(this),p=["position","top","bottom","left","right","height","width"],o=a.effects.setMode(g,d.mode||"effect"),r=d.direction||"left",e=d.distance||20,f=d.times||3,s=f*2+1,k=d.duration,j=(r=="up"||r=="down")?"top":"left",u=(r=="up"||r=="left")?"pos":"neg",l={},t={},q={},m,n=g.queue(),h=n.length;a.effects.save(g,p);g.show();a.effects.createWrapper(g);l[j]=(u=="pos"?"-=":"+=")+e;t[j]=(u=="pos"?"+=":"-=")+e*2;q[j]=(u=="pos"?"-=":"+=")+e*2;g.animate(l,k,d.easing);for(m=1;m<f;m++){g.animate(t,k,d.easing).animate(q,k,d.easing)}g.animate(t,k,d.easing).animate(l,k/2,d.easing).queue(function(v){if(o==="hide"){g.hide()}a.effects.restore(g,p);a.effects.removeWrapper(g);a.isFunction(d.complete)&&d.complete.apply(this,arguments);v()});if(h>1){n.splice.apply(n,[1,0].concat(n.splice(h,s+1)))}g.dequeue()})}})(jQuery);(function(a,c){a.effects.effect.slide=function(d){return this.queue(function(){var f=a(this),k=["position","top","bottom","left","right","width","height"],j=a.effects.setMode(f,d.mode||"show"),l=d.direction||"left",g=(l=="up"||l=="down")?"top":"left",m=(l=="up"||l=="left")?"pos":"neg",e,h={},n;a.effects.save(f,k);f.show();e=d.distance||f[g=="top"?"outerHeight":"outerWidth"]({margin:true});a.effects.createWrapper(f).css({overflow:"hidden"});if(j=="show"){f.css(g,m=="pos"?(isNaN(e)?"-"+e:-e):e)}h[g]=(j=="show"?(m=="pos"?"+=":"-="):(m=="pos"?"-=":"+="))+e;f.animate(h,{queue:false,duration:d.duration,easing:d.easing,complete:function(){if(j=="hide"){f.hide()}a.effects.restore(f,k);a.effects.removeWrapper(f);a.isFunction(d.complete)&&d.complete.apply(this,arguments);f.dequeue()}})})}})(jQuery);(function(a,c){a.effects.effect.transfer=function(d){return this.queue(function(){var g=a(this),l=a(d.to),o=l.css("position")==="fixed",k=a("body"),m=o?k.scrollTop():0,n=o?k.scrollLeft():0,e=l.offset(),h={top:e.top-m,left:e.left-n,height:l.innerHeight(),width:l.innerWidth()},j=g.offset(),f=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(d.className).css({top:j.top-m,left:j.left-n,height:g.innerHeight(),width:g.innerWidth(),position:o?"fixed":"absolute"}).animate(h,d.duration,d.easing,function(){f.remove();a.isFunction(d.complete)&&d.complete.apply(g[0],arguments);g.dequeue()})})}})(jQuery);(function(a,c){a.widget("ui.accordion",{version:"1.9pre",options:{active:0,animated:"slide",collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var d=this,e=d.options;d.running=false;d.element.addClass("ui-accordion ui-widget ui-helper-reset");d.headers=d.element.find(e.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");d._hoverable(d.headers);d._focusable(d.headers);d.headers.find(":first-child").addClass("ui-accordion-heading");d.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(!e.collapsible&&e.active===false){e.active=0}if(e.active<0){e.active+=this.headers.length}d.active=d._findActive(e.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");d.active.next().addClass("ui-accordion-content-active");d._createIcons();d.refresh();d.element.attr("role","tablist");d.headers.attr("role","tab").bind("keydown.accordion",a.proxy(d,"_keydown")).next().attr("role","tabpanel");d.headers.not(d.active).attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!d.active.length){d.headers.eq(0).attr("tabIndex",0)}else{d.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!a.browser.safari){d.headers.find("a").attr("tabIndex",-1)}this._setupEvents(e.event)},_createIcons:function(){var d=this.options.icons;if(d){a("<span>").addClass("ui-accordion-header-icon ui-icon "+d.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(d.header).addClass(d.activeHeader);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-accordion-header-icon").remove();this.element.removeClass("ui-accordion-icons")},_destroy:function(){this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex").find("a").removeAttr("tabIndex").end().find(".ui-accordion-heading").removeClass("ui-accordion-heading");this._destroyIcons();var d=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(this.options.heightStyle!=="content"){d.css("height","")}},_setOption:function(d,e){if(d==="active"){this._activate(e);return}this._super("_setOption",d,e);if(d==="collapsible"&&!e&&this.options.active===false){this._activate(0)}if(d==="event"){this._setupEvents(e)}if(d==="icons"){this._destroyIcons();if(e){this._createIcons()}}if(d==="disabled"){this.headers.add(this.headers.next()).toggleClass("ui-accordion-disabled ui-state-disabled",!!e)}},_keydown:function(g){if(this.options.disabled||g.altKey||g.ctrlKey){return}var h=a.ui.keyCode,f=this.headers.length,d=this.headers.index(g.target),e=false;switch(g.keyCode){case h.RIGHT:case h.DOWN:e=this.headers[(d+1)%f];break;case h.LEFT:case h.UP:e=this.headers[(d-1+f)%f];break;case h.SPACE:case h.ENTER:this._eventHandler(g)}if(e){a(g.target).attr("tabIndex",-1);a(e).attr("tabIndex",0);e.focus();g.preventDefault()}},refresh:function(){var d=this.options,e=this.element.parent(),f,g;if(d.heightStyle==="fill"){if(!a.support.minHeight){g=e.css("overflow");e.css("overflow","hidden")}f=e.height();this.element.siblings(":visible").each(function(){var j=a(this),h=j.css("position");if(h==="absolute"||h==="fixed"){return}f-=j.outerHeight(true)});if(g){e.css("overflow",g)}this.headers.each(function(){f-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,f-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else{if(d.heightStyle==="auto"){f=0;this.headers.next().each(function(){f=Math.max(f,a(this).height("").height())}).height(f)}}return this},_activate:function(d){var e=this._findActive(d)[0];if(e===this.active[0]){return}e=e||this.active[0];this._eventHandler({target:e,currentTarget:e,preventDefault:a.noop})},_findActive:function(d){return typeof d==="number"?this.headers.eq(d):a()},_setupEvents:function(d){this.headers.unbind(".accordion");if(d){this.headers.bind(d.split(" ").join(".accordion ")+".accordion",a.proxy(this,"_eventHandler"))}},_eventHandler:function(d){var m=this.options,g=this.active,h=a(d.currentTarget),k=h[0]===g[0],e=k&&m.collapsible,f=e?a():h.next(),j=g.next(),l={oldHeader:g,oldContent:j,newHeader:e?a():h,newContent:f};d.preventDefault();if(m.disabled||this.running||(k&&!m.collapsible)||(this._trigger("beforeActivate",d,l)===false)){return}m.active=e?false:this.headers.index(h);this.active=k?a():h;this._toggle(l);g.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-accordion-header-icon").removeClass(m.icons.activeHeader).addClass(m.icons.header);if(!k){h.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-accordion-header-icon").removeClass(m.icons.header).addClass(m.icons.activeHeader);h.next().addClass("ui-accordion-content-active")}},_toggle:function(h){var l=this,m=l.options,d=h.newContent,j=h.oldContent;l.running=true;function e(){l._completed(h)}if(m.animated){var k=a.ui.accordion.animations,g=m.animated,f;if(!k[g]){f={easing:a.easing[g]?g:"slide",duration:700};g="slide"}k[g]({toShow:d,toHide:j,complete:e,down:d.length&&(!j.length||(d.index()<j.index()))},f)}else{j.hide();d.show();e()}j.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();d.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(f){var d=f.newContent,e=f.oldContent;this.running=false;if(this.options.heightStyle==="content"){d.add(e).css({height:"",overflow:""})}e.removeClass("ui-accordion-content-active");if(e.length){e.parent()[0].className=e.parent()[0].className}this._trigger("activate",null,f)}});a.extend(a.ui.accordion,{animations:{slide:function(n,l){var g=n.toShow.css("overflow"),e=n.toHide.css("overflow"),k=0,f={},j={},h=["height","paddingTop","paddingBottom"],d;n=a.extend({easing:"swing",duration:300},n,l);if(!n.toHide.size()){d=n.toShow[0].style.width;n.toShow.show().width(n.toShow.width()).hide().animate({height:"show",paddingTop:"show",paddingBottom:"show"},{duration:n.duration,easing:n.easing,complete:function(){n.toShow.width(d);n.complete()}});return}if(!n.toShow.size()){n.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},n);return}var m=n.toShow;d=m[0].style.width;m.width(parseInt(m.parent().width(),10)-parseInt(m.css("paddingLeft"),10)-parseInt(m.css("paddingRight"),10)-(parseInt(m.css("borderLeftWidth"),10)||0)-(parseInt(m.css("borderRightWidth"),10)||0));a.each(h,function(p,r){j[r]="hide";var q=(""+a.css(n.toShow[0],r)).match(/^([\d+-.]+)(.*)$/),o=r==="height"&&q[1]==="0"?1:q[1];f[r]={value:o,unit:q[2]||"px"}});n.toShow.css({height:0,overflow:"hidden"}).show();n.toHide.filter(":hidden").each(n.complete).end().filter(":visible").animate(j,{step:function(o,p){if(p.prop=="height"){k=(p.end-p.start===0)?0:(p.now-p.start)/(p.end-p.start)}n.toShow[0].style[p.prop]=(k*f[p.prop].value)+f[p.prop].unit},duration:n.duration,easing:n.easing,complete:function(){n.toShow.css({width:d,overflow:g});n.toHide.css("overflow",e);n.complete()}})},bounceslide:function(d){this.slide(d,{easing:d.down?"easeOutBounce":"swing",duration:d.down?1000:200})}}});if(a.uiBackCompat!==false){(function(e,d){e.extend(d.options,{navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var f=d._create;d._create=function(){if(this.options.navigation){var g=this,k=this.element.find(this.options.header),h=k.next(),j=k.add(h).find("a").filter(this.options.navigationFilter)[0];if(j){k.add(h).each(function(l){if(e.contains(this,j)){g.options.active=Math.floor(l/2);return false}})}}f.call(this)}}(jQuery,jQuery.ui.accordion.prototype));(function(f,d){f.extend(d.options,{heightStyle:null,autoHeight:true,clearStyle:false,fillSpace:false});var g=d._create,e=d._setOption;f.extend(d,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();g.call(this)},_setOption:function(h,j){if(h==="autoHeight"||h==="clearStyle"||h==="fillSpace"){this.options.heightStyle=this._mergeHeightStyle()}e.apply(this,arguments)},_mergeHeightStyle:function(){var h=this.options;if(h.fillSpace){return"fill"}if(h.clearStyle){return"content"}if(h.autoHeight){return"auto"}}})}(jQuery,jQuery.ui.accordion.prototype));(function(f,e){f.extend(e.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var d=e._createIcons;e._createIcons=function(){this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected;d.call(this)}}(jQuery,jQuery.ui.accordion.prototype));(function(f,e){e.activate=e._activate;var d=e._findActive;e._findActive=function(g){if(g===-1){g=false}if(g&&typeof g!=="number"){g=this.headers.index(this.headers.filter(g));if(g===-1){g=false}}return d.call(this,g)}}(jQuery,jQuery.ui.accordion.prototype));jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh;(function(f,e){f.extend(e.options,{change:null,changestart:null});var d=e._trigger;e._trigger=function(h,j,k){var g=d.apply(this,arguments);if(!g){return false}if(h==="beforeActivate"){g=d.call(this,"changestart",j,k)}else{if(h==="activate"){g=d.call(this,"change",j,k)}}return g}}(jQuery,jQuery.ui.accordion.prototype))}})(jQuery);(function(a,c){var d=0;a.widget("ui.autocomplete",{version:"1.9pre",defaultElement:"<input>",options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e=this,g=this.element[0].ownerDocument,f,h;this.valueMethod=this.element[this.element.is("input")?"val":"text"];this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(j){if(e.options.disabled||e.element.attr("readonly")){f=true;h=true;return}f=false;h=false;var k=a.ui.keyCode;switch(j.keyCode){case k.PAGE_UP:f=true;e._move("previousPage",j);break;case k.PAGE_DOWN:f=true;e._move("nextPage",j);break;case k.UP:f=true;e._move("previous",j);j.preventDefault();break;case k.DOWN:f=true;e._move("next",j);j.preventDefault();break;case k.ENTER:case k.NUMPAD_ENTER:if(e.menu.active){f=true;j.preventDefault()}case k.TAB:if(!e.menu.active){return}e.menu.select(j);break;case k.ESCAPE:e._value(e.term);e.close(j);break;default:e._searchTimeout(j);break}}).bind("keypress.autocomplete",function(j){if(f){f=false;j.preventDefault();return}var k=a.ui.keyCode;switch(j.keyCode){case k.PAGE_UP:e._move("previousPage",j);break;case k.PAGE_DOWN:e._move("nextPage",j);break;case k.UP:e._move("previous",j);j.preventDefault();break;case k.DOWN:e._move("next",j);j.preventDefault();break}}).bind("input.autocomplete",function(j){if(h){h=false;j.preventDefault();return}e._searchTimeout(j)}).bind("focus.autocomplete",function(){if(e.options.disabled){return}e.selectedItem=null;e.previous=e._value()}).bind("blur.autocomplete",function(j){if(e.options.disabled){return}clearTimeout(e.searching);e.closing=setTimeout(function(){e.close(j);e._change(j)},150)});this._initSource();this.response=function(){return e._response.apply(e,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",g)[0]).mousedown(function(j){var k=e.menu.element[0];if(!a(j.target).closest(".ui-menu-item").length){setTimeout(function(){a(document).one("mousedown",function(l){if(l.target!==e.element[0]&&l.target!==k&&!a.contains(k,l.target)){e.close()}})},1)}setTimeout(function(){clearTimeout(e.closing)},13)}).menu({input:a(),focus:function(k,l){var j=l.item.data("item.autocomplete");if(false!==e._trigger("focus",k,{item:j})){if(/^key/.test(k.originalEvent.type)){e._value(j.value)}}},select:function(l,m){var k=m.item.data("item.autocomplete"),j=e.previous;if(e.element[0]!==g.activeElement){e.element.focus();e.previous=j;setTimeout(function(){e.previous=j;e.selectedItem=k},1)}if(false!==e._trigger("select",l,{item:k})){e._value(k.value)}e.term=e._value();e.close(l);e.selectedItem=k},blur:function(j,k){if(e.menu.element.is(":visible")&&(e._value()!==e.term)){e._value(e.term)}}}).zIndex(this.element.zIndex()+1).hide().data("menu");if(a.fn.bgiframe){this.menu.element.bgiframe()}},_destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove()},_setOption:function(e,f){this._super("_setOption",e,f);if(e==="source"){this._initSource()}if(e==="appendTo"){this.menu.element.appendTo(a(f||"body",this.element[0].ownerDocument)[0])}if(e==="disabled"&&f&&this.xhr){this.xhr.abort()}},_initSource:function(){var e=this,g,f;if(a.isArray(this.options.source)){g=this.options.source;this.source=function(j,h){h(a.ui.autocomplete.filter(g,j.term))}}else{if(typeof this.options.source==="string"){f=this.options.source;this.source=function(j,h){if(e.xhr){e.xhr.abort()}e.xhr=a.ajax({url:f,data:j,dataType:"json",autocompleteRequest:++d,success:function(l,k){if(this.autocompleteRequest===d){h(l)}},error:function(){if(this.autocompleteRequest===d){h([])}}})}}else{this.source=this.options.source}}},_searchTimeout:function(f){var e=this;e.searching=setTimeout(function(){if(e.term!=e.element.val()){e.selectedItem=null;e.search(null,f)}},e.options.delay)},search:function(f,e){f=f!=null?f:this._value();this.term=this._value();if(f.length<this.options.minLength){return this.close(e)}clearTimeout(this.closing);if(this._trigger("search",e)===false){return}return this._search(f)},_search:function(e){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:e},this.response)},_response:function(e){if(e){e=this._normalize(e)}this._trigger("response",null,{content:e});if(!this.options.disabled&&e&&e.length){this._suggest(e);this._trigger("open")}else{this.close()}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},close:function(e){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this._trigger("close",e)}},_change:function(e){if(this.previous!==this._value()){this._trigger("change",e,{item:this.selectedItem})}},_normalize:function(e){if(e.length&&e[0].label&&e[0].value){return e}return a.map(e,function(f){if(typeof f==="string"){return{label:f,value:f}}return a.extend({label:f.label||f.value,value:f.value||f.label},f)})},_suggest:function(e){var f=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(f,e);this.menu.blur();this.menu.refresh();f.show();this._resizeMenu();f.position(a.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new a.Event("mouseover"))}},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(g,f){var e=this;a.each(f,function(h,j){e._renderItem(g,j)})},_renderItem:function(e,f){return a("<li></li>").data("item.autocomplete",f).append(a("<a></a>").text(f.label)).appendTo(e)},_move:function(f,e){if(!this.menu.element.is(":visible")){this.search(null,e);return}if(this.menu.first()&&/^previous/.test(f)||this.menu.last()&&/^next/.test(f)){this._value(this.term);this.menu.blur();return}this.menu[f](e)},widget:function(){return this.menu.element},_value:function(e){return this.valueMethod.apply(this.element,arguments)}});a.extend(a.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(g,e){var f=new RegExp(a.ui.autocomplete.escapeRegex(e),"i");return a.grep(g,function(h){return f.test(h.label||h.value||h)})}})}(jQuery));(function(g,c){var m,f,a,j,k="ui-button ui-widget ui-state-default ui-corner-all",d="ui-state-hover ui-state-active ",h="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var n=g(this).find(":ui-button");setTimeout(function(){n.button("refresh")},1)},e=function(o){var n=o.name,p=o.form,q=g([]);if(n){if(p){q=g(p).find("[name='"+n+"']")}else{q=g("[name='"+n+"']",o.ownerDocument).filter(function(){return !this.form})}}return q};g.widget("ui.button",{version:"1.9pre",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",l);if(typeof this.options.disabled!=="boolean"){this.options.disabled=this.element.attr("disabled")}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var n=this,p=this.options,q=this.type==="checkbox"||this.type==="radio",r="ui-state-hover"+(!q?" ui-state-active":""),o="ui-state-focus";if(p.label===null){p.label=this.buttonElement.html()}if(this.element.is(":disabled")){p.disabled=true}this.buttonElement.addClass(k).attr("role","button").bind("mouseenter.button",function(){if(p.disabled){return}g(this).addClass("ui-state-hover");if(this===m){g(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){if(p.disabled){return}g(this).removeClass(r)}).bind("click.button",function(s){if(p.disabled){s.preventDefault();s.stopImmediatePropagation()}});this.element.bind("focus.button",function(){n.buttonElement.addClass(o)}).bind("blur.button",function(){n.buttonElement.removeClass(o)});if(q){this.element.bind("change.button",function(){if(j){return}n.refresh()});this.buttonElement.bind("mousedown.button",function(s){if(p.disabled){return}j=false;f=s.pageX;a=s.pageY}).bind("mouseup.button",function(s){if(p.disabled){return}if(f!==s.pageX||a!==s.pageY){j=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(p.disabled||j){return false}g(this).toggleClass("ui-state-active");n.buttonElement.attr("aria-pressed",n.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(p.disabled||j){return false}g(this).addClass("ui-state-active");n.buttonElement.attr("aria-pressed",true);var s=n.element[0];e(s).not(s).map(function(){return g(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)})}else{this.buttonElement.bind("mousedown.button",function(){if(p.disabled){return false}g(this).addClass("ui-state-active");m=this;g(document).one("mouseup",function(){m=null})}).bind("mouseup.button",function(){if(p.disabled){return false}g(this).removeClass("ui-state-active")}).bind("keydown.button",function(s){if(p.disabled){return false}if(s.keyCode==g.ui.keyCode.SPACE||s.keyCode==g.ui.keyCode.ENTER){g(this).addClass("ui-state-active")}}).bind("keyup.button",function(){g(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(s){if(s.keyCode===g.ui.keyCode.SPACE){g(this).click()}})}}}this._setOption("disabled",p.disabled);this._resetButton()},_determineButtonType:function(){if(this.element.is(":checkbox")){this.type="checkbox"}else{if(this.element.is(":radio")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){var n=this.element.parents().last(),p="label[for="+this.element.attr("id")+"]";this.buttonElement=n.find(p);if(!this.buttonElement.length){n=n.length?n.siblings():this.element.siblings();this.buttonElement=n.filter(p);if(!this.buttonElement.length){this.buttonElement=n.find(p)}}this.element.addClass("ui-helper-hidden-accessible");var o=this.element.is(":checked");if(o){this.buttonElement.addClass("ui-state-active")}this.buttonElement.attr("aria-pressed",o)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(k+" "+d+" "+h).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(n,o){this._super("_setOption",n,o);if(n==="disabled"){if(o){this.element.attr("disabled",true)}else{this.element.removeAttr("disabled")}return}this._resetButton()},refresh:function(){var n=this.element.is(":disabled");if(n!==this.options.disabled){this._setOption("disabled",n)}if(this.type==="radio"){e(this.element[0]).each(function(){if(g(this).is(":checked")){g(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true)}else{g(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true)}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var r=this.buttonElement.removeClass(h),p=g("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(r.empty()).text(),o=this.options.icons,n=o.primary&&o.secondary,q=[];if(o.primary||o.secondary){if(this.options.text){q.push("ui-button-text-icon"+(n?"s":(o.primary?"-primary":"-secondary")))}if(o.primary){r.prepend("<span class='ui-button-icon-primary ui-icon "+o.primary+"'></span>")}if(o.secondary){r.append("<span class='ui-button-icon-secondary ui-icon "+o.secondary+"'></span>")}if(!this.options.text){q.push(n?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){r.attr("title",p)}}}else{q.push("ui-button-text-only")}r.addClass(q.join(" "))}});g.ui.button.version="1.9pre";g.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(n,o){if(n==="disabled"){this.buttons.button("option",n,o)}this._super("_setOption",n,o)},refresh:function(){var n=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return g(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(n?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(n?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return g(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery));(function($,undefined){$.extend($.ui,{datepicker:{version:"1.9pre"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{$.datepicker._showDatepicker(input[0])}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.show()},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(event){$.datepicker.log(event)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return}var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){if($.datepicker._datepickerShowing){$.datepicker._triggerOnClose($.datepicker._curInst)}$.datepicker._curInst.dpDiv.stop(true,true)}var beforeShow=$.datepicker._get(inst,"beforeShow");extendRemove(inst.settings,(beforeShow?beforeShow.apply(input,[input,inst]):{}));inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+$(document).scrollLeft();var viewHeight=document.documentElement.clientHeight+$(document).scrollTop();offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_triggerOnClose:function(inst){var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return}if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst);this._curInst=null};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}$.datepicker._triggerOnClose(inst);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target);if($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.hasClass($.datepicker._triggerClass)&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst._selectingMonthYear=false;inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_clickMonthYear:function(id){var target=$(id);var inst=this._getInst(target[0]);if(inst.input&&inst._selectingMonthYear){setTimeout(function(){inst.input.focus()},0)}inst._selectingMonthYear=!inst._selectingMonthYear},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', -"+stepMonths+", 'M');\" title=\""+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+inst.id+"', +"+stepMonths+", 'M');\" title=\""+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+inst.id+"');\">"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+inst.id+"',"+printDate.getMonth()+","+printDate.getFullYear()+', this);return false;"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'M');\" onclick=\"DP_jQuery_"+dpuuid+".datepicker._clickMonthYear('#"+inst.id+"');\">";for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+inst.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+dpuuid+".datepicker._clickMonthYear('#"+inst.id+"');\">";for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!=-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!=-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(selector,"mouseover",function(){if(!$.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!=-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!=-1){$(this).addClass("ui-datepicker-next-hover")}}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.9pre";window["DP_jQuery_"+dpuuid]=$})(jQuery);(function(e,f){var c="ui-dialog ui-widget ui-widget-content ui-corner-all ",a={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},d={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};e.widget("ui.dialog",{version:"1.9pre",options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(h){var g=e(this).css(h).offset().top;if(g<0){e(this).css("top",h.top-g)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var p=this,q=p.options,n=q.title||"&#160;",h=e.ui.dialog.getTitleId(p.element),o=(p.uiDialog=e("<div>")).addClass(c+q.dialogClass).css({display:"none",outline:0,zIndex:q.zIndex}).attr("tabIndex",-1).keydown(function(r){if(q.closeOnEscape&&!r.isDefaultPrevented()&&r.keyCode&&r.keyCode===e.ui.keyCode.ESCAPE){p.close(r);r.preventDefault()}}).attr({role:"dialog","aria-labelledby":h}).mousedown(function(r){p.moveToTop(false,r)}),k=p.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(o),j=(p.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(o),m=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(r){r.preventDefault();p.close(r)}).appendTo(j),l=(p.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(q.closeText).appendTo(m),g=e("<span>").addClass("ui-dialog-title").attr("id",h).html(n).prependTo(j);j.find("*").add(j).disableSelection();this._hoverable(m);this._focusable(m);if(q.draggable&&e.fn.draggable){p._makeDraggable()}if(q.resizable&&e.fn.resizable){p._makeResizable()}p._createButtons(q.buttons);p._isOpen=false;o.appendTo(document.body);if(e.fn.bgiframe){o.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},_destroy:function(){var g=this;if(g.overlay){g.overlay.destroy()}g.uiDialog.hide();g.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");g.uiDialog.remove();if(g.originalTitle){g.element.attr("title",g.originalTitle)}},widget:function(){return this.uiDialog},close:function(k){if(!this._isOpen){return g}var g=this,j,h;if(false===g._trigger("beforeClose",k)){return}g._isOpen=false;if(g.overlay){g.overlay.destroy()}g.uiDialog.unbind("keypress.ui-dialog");if(g.options.hide){g.uiDialog.hide(g.options.hide,function(){g._trigger("close",k)})}else{g.uiDialog.hide();g._trigger("close",k)}e.ui.dialog.overlay.resize();if(g.options.modal){j=0;e(".ui-dialog").each(function(){if(this!==g.uiDialog[0]){h=e(this).css("z-index");if(!isNaN(h)){j=Math.max(j,h)}}});e.ui.dialog.maxZ=j}return g},isOpen:function(){return this._isOpen},moveToTop:function(l,k){var g=this,j=g.options,h;if((j.modal&&!l)||(!j.stack&&!j.modal)){return g._trigger("focus",k)}if(j.zIndex>e.ui.dialog.maxZ){e.ui.dialog.maxZ=j.zIndex}if(g.overlay){e.ui.dialog.maxZ+=1;e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ;g.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)}h={scrollTop:g.element.attr("scrollTop"),scrollLeft:g.element.attr("scrollLeft")};e.ui.dialog.maxZ+=1;g.uiDialog.css("z-index",e.ui.dialog.maxZ);g.element.attr(h);g._trigger("focus",k);return g},open:function(){if(this._isOpen){return}var h=this,j=h.options,g=h.uiDialog;h._size();h._position(j.position);g.show(j.show);h.overlay=j.modal?new e.ui.dialog.overlay(h):null;h.moveToTop(true);if(j.modal){g.bind("keypress.ui-dialog",function(n){if(n.keyCode!==e.ui.keyCode.TAB){return}var m=e(":tabbable",this),o=m.filter(":first"),l=m.filter(":last");if(n.target===l[0]&&!n.shiftKey){o.focus(1);return false}else{if(n.target===o[0]&&n.shiftKey){l.focus(1);return false}}})}var k=h.element.find(":tabbable");if(!k.length){k=g.find(".ui-dialog-buttonpane :tabbable");if(!k.length){k=g}}k.eq(0).focus();h._isOpen=true;h._trigger("open");return h},_createButtons:function(k){var j=this,g=false;j.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof k==="object"&&k!==null){e.each(k,function(){return !(g=true)})}if(g){var h=e("<div>").addClass("ui-dialog-buttonpane  ui-widget-content ui-helper-clearfix"),l=e("<div>").addClass("ui-dialog-buttonset").appendTo(h);e.each(k,function(m,o){o=e.isFunction(o)?{click:o,text:m}:o;var n=e("<button type='button'>").attr(o,true).unbind("click").click(function(){o.click.apply(j.element[0],arguments)}).appendTo(l);if(e.fn.button){n.button()}});j.uiDialog.addClass("ui-dialog-buttons");h.appendTo(j.uiDialog)}else{j.uiDialog.removeClass("ui-dialog-buttons")}},_makeDraggable:function(){var g=this,j=g.options,k=e(document);function h(l){return{position:l.position,offset:l.offset}}g.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(l,m){e(this).addClass("ui-dialog-dragging");g._trigger("dragStart",l,h(m))},drag:function(l,m){g._trigger("drag",l,h(m))},stop:function(l,m){j.position=[m.position.left-k.scrollLeft(),m.position.top-k.scrollTop()];e(this).removeClass("ui-dialog-dragging");g._trigger("dragStop",l,h(m));e.ui.dialog.overlay.resize()}})},_makeResizable:function(m){m=(m===f?this.options.resizable:m);var h=this,l=h.options,g=h.uiDialog.css("position"),k=typeof m==="string"?m:"n,e,s,w,se,sw,ne,nw";function j(n){return{originalPosition:n.originalPosition,originalSize:n.originalSize,position:n.position,size:n.size}}h.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:h.element,maxWidth:l.maxWidth,maxHeight:l.maxHeight,minWidth:l.minWidth,minHeight:h._minHeight(),handles:k,start:function(n,o){e(this).addClass("ui-dialog-resizing");h._trigger("resizeStart",n,j(o))},resize:function(n,o){h._trigger("resize",n,j(o))},stop:function(n,o){e(this).removeClass("ui-dialog-resizing");l.height=e(this).height();l.width=e(this).width();h._trigger("resizeStop",n,j(o));e.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var g=this.options;if(g.height==="auto"){return g.minHeight}else{return Math.min(g.minHeight,g.height)}},_position:function(h){var j=[],k=[0,0],g;if(h){if(typeof h==="string"||(typeof h==="object"&&"0" in h)){j=h.split?h.split(" "):[h[0],h[1]];if(j.length===1){j[1]=j[0]}e.each(["left","top"],function(m,l){if(+j[m]===j[m]){k[m]=j[m];j[m]=l}});h={my:j.join(" "),at:j.join(" "),offset:k.join(" ")}}h=e.extend({},e.ui.dialog.prototype.options.position,h)}else{h=e.ui.dialog.prototype.options.position}g=this.uiDialog.is(":visible");if(!g){this.uiDialog.show()}this.uiDialog.position(h);if(!g){this.uiDialog.hide()}},_setOptions:function(k){var h=this,g={},j=false;e.each(k,function(l,m){h._setOption(l,m);if(l in a){j=true}if(l in d){g[l]=m}});if(j){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",g)}},_setOption:function(k,l){var h=this,g=h.uiDialog;switch(k){case"buttons":h._createButtons(l);break;case"closeText":h.uiDialogTitlebarCloseText.text(""+l);break;case"dialogClass":g.removeClass(h.options.dialogClass).addClass(c+l);break;case"disabled":if(l){g.addClass("ui-dialog-disabled")}else{g.removeClass("ui-dialog-disabled")}break;case"draggable":var j=g.is(":data(draggable)");if(j&&!l){g.draggable("destroy")}if(!j&&l){h._makeDraggable()}break;case"position":h._position(l);break;case"resizable":var m=g.is(":data(resizable)");if(m&&!l){g.resizable("destroy")}if(m&&typeof l==="string"){g.resizable("option","handles",l)}if(!m&&l!==false){h._makeResizable(l)}break;case"title":e(".ui-dialog-title",h.uiDialogTitlebar).html(""+(l||"&#160;"));break}this._super("_setOption",k,l)},_size:function(){var l=this.options,h,k,g=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(l.minWidth>l.width){l.width=l.minWidth}h=this.uiDialog.css({height:"auto",width:l.width}).height();k=Math.max(0,l.minHeight-h);if(l.height==="auto"){if(e.support.minHeight){this.element.css({minHeight:k,height:"auto"})}else{this.uiDialog.show();var j=this.element.css("height","auto").height();if(!g){this.uiDialog.hide()}this.element.height(Math.max(j,k))}}else{this.element.height(Math.max(l.height-h,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(g){var h=g.attr("id");if(!h){this.uuid+=1;h=this.uuid}return"ui-dialog-title-"+h},overlay:function(g){this.$el=e.ui.dialog.overlay.create(g)}});e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(g){return g+".dialog-overlay"}).join(" "),create:function(h){if(this.instances.length===0){setTimeout(function(){if(e.ui.dialog.overlay.instances.length){e(document).bind(e.ui.dialog.overlay.events,function(j){if(e(j.target).zIndex()<e.ui.dialog.overlay.maxZ){return false}})}},1);e(document).bind("keydown.dialog-overlay",function(j){if(h.options.closeOnEscape&&!j.isDefaultPrevented()&&j.keyCode&&j.keyCode===e.ui.keyCode.ESCAPE){h.close(j);j.preventDefault()}});e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize)}var g=(this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if(e.fn.bgiframe){g.bgiframe()}this.instances.push(g);return g},destroy:function(g){var h=e.inArray(g,this.instances);if(h!==-1){this.oldInstances.push(this.instances.splice(h,1)[0])}if(this.instances.length===0){e([document,window]).unbind(".dialog-overlay")}g.height(0).width(0).remove();var j=0;e.each(this.instances,function(){j=Math.max(j,this.css("z-index"))});this.maxZ=j},height:function(){var h,g;if(e.browser.msie){h=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);g=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(h<g){return e(window).height()+"px"}else{return h+"px"}}else{return e(document).height()+"px"}},width:function(){var g,h;if(e.browser.msie){g=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);h=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(g<h){return e(window).width()+"px"}else{return g+"px"}}else{return e(document).width()+"px"}},resize:function(){var g=e([]);e.each(e.ui.dialog.overlay.instances,function(){g=g.add(this)});g.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}});e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));(function(c){var a=0;c.widget("ui.menu",{version:"1.9pre",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var d=this;this.activeMenu=this.element;this.menuId=this.element.attr("id")||"ui-menu-"+a++;if(this.element.find(".ui-icon").length){this.element.addClass("ui-menu-icons")}this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(f){var e=c(f.target).closest(".ui-menu-item:has(a)");if(d.options.disabled){return false}if(!e.length){return}if(!d.active||(d.active[0]!==e[0])){d.focus(f,e)}d.select(f)}).bind("mouseover.menu",function(e){if(d.options.disabled){return}var f=c(e.target).closest(".ui-menu-item");if(f.length){d.focus(e,f)}}).bind("mouseout.menu",function(e){if(d.options.disabled){return}var f=c(e.target).closest(".ui-menu-item");if(f.length){d.blur(e)}});this.refresh();this.element.attr("tabIndex",0).bind("keydown.menu",function(j){if(d.options.disabled){return}switch(j.keyCode){case c.ui.keyCode.PAGE_UP:d.previousPage(j);j.preventDefault();j.stopImmediatePropagation();break;case c.ui.keyCode.PAGE_DOWN:d.nextPage(j);j.preventDefault();j.stopImmediatePropagation();break;case c.ui.keyCode.UP:d.previous(j);j.preventDefault();j.stopImmediatePropagation();break;case c.ui.keyCode.DOWN:d.next(j);j.preventDefault();j.stopImmediatePropagation();break;case c.ui.keyCode.LEFT:if(d.left(j)){j.stopImmediatePropagation()}j.preventDefault();break;case c.ui.keyCode.RIGHT:if(d.right(j)){j.stopImmediatePropagation()}j.preventDefault();break;case c.ui.keyCode.ENTER:if(d.active.children("a[aria-haspopup='true']").length){if(d.right(j)){j.stopImmediatePropagation()}}else{d.select(j);j.stopImmediatePropagation()}j.preventDefault();break;case c.ui.keyCode.ESCAPE:if(d.left(j)){j.stopImmediatePropagation()}j.preventDefault();break;default:j.stopPropagation();clearTimeout(d.filterTimer);var e,h=d.previousFilter||"",k=String.fromCharCode(j.keyCode),g=false;if(k==h){g=true}else{k=h+k}function f(l){return l.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}e=d.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+f(k),"i").test(c(this).children("a").text())});e=g&&e.index(d.active.next())!=-1?d.active.nextAll(".ui-menu-item"):e;if(!e.length){k=String.fromCharCode(j.keyCode);e=d.activeMenu.children(".ui-menu-item").filter(function(){return new RegExp("^"+f(k),"i").test(c(this).children("a").text())})}if(e.length){d.focus(j,e);if(e.length>1){d.previousFilter=k;d.filterTimer=setTimeout(function(){delete d.previousFilter},1000)}else{delete d.previousFilter}}else{delete d.previousFilter}}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show();this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var f=this,d=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),e=d.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");e.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(g){return f.element.attr("id")+"-"+g});d.each(function(){var h=c(this),g=h.prev("a");g.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>');h.attr("aria-labelledby",g.attr("id"))})},focus:function(d,l){var j,n=this;this.blur();if(this._hasScroll()){var f=parseFloat(c.curCSS(this.element[0],"borderTopWidth",true))||0,m=parseFloat(c.curCSS(this.element[0],"paddingTop",true))||0,g=l.offset().top-this.element.offset().top-f-m,k=this.element.scrollTop(),h=this.element.height(),e=l.height();if(g<0){this.element.scrollTop(k+g)}else{if(g+e>h){this.element.scrollTop(k+g-h+e)}}}this.active=l.first().children("a").addClass("ui-state-focus").end();n.element.attr("aria-activedescendant",n.active.children("a").attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");n.timer=setTimeout(function(){n._close()},n.delay);j=c(">ul",l);if(j.length&&(/^mouse/.test(d.type))){n._startOpening(j)}this.activeMenu=l.parent();this._trigger("focus",d,{item:l})},blur:function(d){if(!this.active){return}clearTimeout(this.timer);this.active.children("a").removeClass("ui-state-focus");this.active=null},_startOpening:function(e){clearTimeout(this.timer);var d=this;d.timer=setTimeout(function(){d._close();d._open(e)},d.delay)},_open:function(e){clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents()).hide().attr("aria-hidden","true");var d=c.extend({},{of:this.active},c.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(d)},closeAll:function(){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active");this.blur();this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},left:function(e){var d=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(d&&d.length){this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide();this.focus(e,d);return true}},right:function(f){var d=this,e=this.active&&this.active.children("ul").children("li").first();if(e&&e.length){this._open(e.parent());setTimeout(function(){d.focus(f,e)},20);return true}},next:function(d){this._move("next",".ui-menu-item","first",d)},previous:function(d){this._move("prev",".ui-menu-item","last",d)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(h,g,e,f){if(!this.active){this.focus(f,this.activeMenu.children(g)[e]());return}var d=this.active[h+"All"](".ui-menu-item").eq(0);if(d.length){this.focus(f,d)}else{this.focus(f,this.activeMenu.children(g)[e]())}},nextPage:function(f){if(this._hasScroll()){if(!this.active||this.last()){this.focus(f,this.activeMenu.children(".ui-menu-item").first());return}var g=this.active.offset().top,e=this.element.height(),d;this.active.nextAll(".ui-menu-item").each(function(){d=c(this);return c(this).offset().top-g-e<0});this.focus(f,d)}else{this.focus(f,this.activeMenu.children(".ui-menu-item")[!this.active||this.last()?"first":"last"]())}},previousPage:function(f){if(this._hasScroll()){if(!this.active||this.first()){this.focus(f,this.activeMenu.children(".ui-menu-item").last());return}var g=this.active.offset().top,e=this.element.height(),d;this.active.prevAll(".ui-menu-item").each(function(){d=c(this);return c(this).offset().top-g+e>0});this.focus(f,d)}else{this.focus(f,this.activeMenu.children(".ui-menu-item")[!this.active||this.first()?":last":":first"]())}},_hasScroll:function(){return this.element.height()<this.element[c.fn.prop?"prop":"attr"]("scrollHeight")},select:function(d){var e={item:this.active};this.closeAll();this._trigger("select",d,e)}})}(jQuery));(function(a){a.widget("ui.menubar",{version:"1.9pre",options:{buttons:false,menuIcon:false,position:{my:"left top",at:"left bottom"}},_create:function(){var d=this;var c=this.items=this.element.children("li").addClass("ui-menubar-item").attr("role","presentation").children("button, a");c.slice(1).attr("tabIndex",-1);this.element.addClass("ui-menubar ui-widget-header ui-helper-clearfix").attr("role","menubar");this._focusable(c);this._hoverable(c);c.next("ul").menu({position:{within:this.options.position.within},select:function(e,f){f.item.parents("ul.ui-menu:last").hide();d._trigger("select",e,f);d._close();a(e.target).prev().focus()}}).hide().attr("aria-hidden","true").attr("aria-expanded","false").bind("keydown.menubar",function(e){var f=a(this);if(f.is(":hidden")){return}switch(e.keyCode){case a.ui.keyCode.LEFT:d._left(e);e.preventDefault();break;case a.ui.keyCode.RIGHT:d._right(e);e.preventDefault();break}});c.each(function(){var e=a(this),f=e.next("ul");e.bind("click.menubar focus.menubar mouseenter.menubar",function(g){if(g.type=="focus"&&!g.originalEvent){return}g.preventDefault();if(g.type=="click"&&f.is(":visible")&&d.active&&d.active[0]==f[0]){d._close();return}if((d.open&&g.type=="mouseenter")||g.type=="click"){d._open(g,f)}}).bind("keydown",function(g){switch(g.keyCode){case a.ui.keyCode.SPACE:case a.ui.keyCode.UP:case a.ui.keyCode.DOWN:d._open(g,a(this).next());g.preventDefault();break;case a.ui.keyCode.LEFT:d._prev(g,a(this));g.preventDefault();break;case a.ui.keyCode.RIGHT:d._next(g,a(this));g.preventDefault();break}}).addClass("ui-button ui-widget ui-button-text-only ui-menubar-link").attr("role","menuitem").attr("aria-haspopup","true").wrapInner("<span class='ui-button-text'></span>");if(d.options.menuIcon){e.addClass("ui-state-default").append("<span class='ui-button-icon-secondary ui-icon ui-icon-triangle-1-s'></span>");e.removeClass("ui-button-text-only").addClass("ui-button-text-icon-secondary")}if(!d.options.buttons){e.addClass("ui-menubar-link").removeClass("ui-state-default")}});d._bind({keydown:function(e){if(e.keyCode==a.ui.keyCode.ESCAPE&&d.active&&d.active.menu("left",e)!==true){var f=d.active;d.active.blur();d._close(e);f.prev().focus()}},focusin:function(e){clearTimeout(d.closeTimer)},focusout:function(e){d.closeTimer=setTimeout(function(){d._close(e)},100)}})},_destroy:function(){var c=this.element.children("li").removeClass("ui-menubar-item").removeAttr("role","presentation").children("button, a");this.element.removeClass("ui-menubar ui-widget-header ui-helper-clearfix").removeAttr("role","menubar").unbind(".menubar");c.unbind(".menubar").removeClass("ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default").removeAttr("role","menuitem").removeAttr("aria-haspopup","true").children("span.ui-button-text").each(function(d,g){var f=a(this);f.parent().html(f.html())}).end().children(".ui-icon").remove();this.element.find(":ui-menu").menu("destroy").show().removeAttr("aria-hidden","true").removeAttr("aria-expanded","false").removeAttr("tabindex").unbind(".menubar")},_close:function(){if(!this.active||!this.active.length){return}this.active.menu("closeAll").hide().attr("aria-hidden","true").attr("aria-expanded","false");this.active.prev().removeClass("ui-state-active").removeAttr("tabIndex");this.active=null;this.open=false},_open:function(d,e){if(this.active&&this.active[0]==e[0]){return}if(this.active){this.active.menu("closeAll").hide().attr("aria-hidden","true").attr("aria-expanded","false");this.active.prev().removeClass("ui-state-active")}var c=e.prev().addClass("ui-state-active").attr("tabIndex",-1);this.active=e.show().position(a.extend({of:c},this.options.position)).removeAttr("aria-hidden").attr("aria-expanded","true").menu("focus",d,e.children("li").first()).focus().focusin();this.open=true},_prev:function(f,c){c.attr("tabIndex",-1);var e=c.parent().prevAll("li").children(".ui-button").eq(0);if(e.length){e.removeAttr("tabIndex")[0].focus()}else{var d=this.element.children("li:last").children(".ui-button:last");d.removeAttr("tabIndex")[0].focus()}},_next:function(e,c){c.attr("tabIndex",-1);var d=c.parent().nextAll("li").children(".ui-button").eq(0);if(d.length){d.removeAttr("tabIndex")[0].focus()}else{var f=this.element.children("li:first").children(".ui-button:first");f.removeAttr("tabIndex")[0].focus()}},_left:function(e){var d=this.active.parent().prevAll("li:eq(0)").children(".ui-menu").eq(0);if(d.length){this._open(e,d)}else{var c=this.element.children("li:last").children(".ui-menu:first");this._open(e,c)}},_right:function(d){var c=this.active.parent().nextAll("li:eq(0)").children(".ui-menu").eq(0);if(c.length){this._open(d,c)}else{var e=this.element.children("li:first").children(".ui-menu:first");this._open(d,e)}}})}(jQuery));(function(c){var a=0;c.widget("ui.popup",{version:"1.9pre",options:{position:{my:"left top",at:"left bottom"}},_create:function(){if(!this.options.trigger){this.options.trigger=this.element.prev()}if(!this.element.attr("id")){this.element.attr("id","ui-popup-"+a++);this.generatedId=true}if(!this.element.attr("role")){this.element.attr("role","dialog");this.generatedRole=true}this.options.trigger.attr("aria-haspopup",true).attr("aria-owns",this.element.attr("id"));this.element.addClass("ui-popup");this.close();this._bind(this.options.trigger,{keydown:function(d){if(this.options.trigger.is("a:ui-button")&&d.keyCode==c.ui.keyCode.SPACE){d.preventDefault()}if(d.keyCode==c.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")){this.options.trigger.trigger("click",d)}if(d.keyCode==c.ui.keyCode.DOWN){d.preventDefault();this.options.trigger.trigger("click",d)}},click:function(e){e.preventDefault();if(this.isOpen){return}var d=this;clearTimeout(this.closeTimer);setTimeout(function(){d.open(e)},1)}});if(!this.element.is(":ui-menu")){this._bind({keydown:function(f){if(f.keyCode!==c.ui.keyCode.TAB){return}var e=c(":tabbable",this.element),g=e.first(),d=e.last();if(f.target===d[0]&&!f.shiftKey){g.focus(1);f.preventDefault()}else{if(f.target===g[0]&&f.shiftKey){d.focus(1);f.preventDefault()}}}})}this._bind({focusout:function(e){var d=this;d.closeTimer=setTimeout(function(){d.close(e)},100)},focusin:function(d){clearTimeout(this.closeTimer)}});this._bind({keyup:function(d){if(d.keyCode==c.ui.keyCode.ESCAPE&&this.element.is(":visible")){this.close(d);this.options.trigger.focus()}}});this._bind(document,{click:function(d){if(this.isOpen&&!c(d.target).closest(".ui-popup").length){this.close(d)}}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup");this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns");if(this.generatedId){this.element.removeAttr("id")}if(this.generatedRole){this.element.removeAttr("role")}},open:function(f){var d=c.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden",false).attr("aria-expanded",true).position(d);if(this.element.is(":ui-menu")){this.element.menu("focus",f,this.element.children("li").first());this.element.focus()}else{var e=this.element.find(":tabbable");this.removeTabIndex=false;if(!e.length){if(!this.element.is(":tabbable")){this.element.attr("tabindex","0");this.removeTabIndex=true}e=e.add(this.element[0])}e.first().focus(1)}this.options.trigger.attr("tabindex",-1);this.isOpen=true;this._trigger("open",f)},close:function(d){this.element.hide().attr("aria-hidden",true).attr("aria-expanded",false);this.options.trigger.attr("tabindex",0);if(this.removeTabIndex){this.element.removeAttr("tabindex")}this.isOpen=false;this._trigger("close",d)}})}(jQuery));(function(g,d){g.ui=g.ui||{};var f=/left|center|right/,j=/top|center|bottom/,c=/[+-]\d+%?/,k=/^\w+/,e=/%$/,a="center",h=g.fn.position;g.position={scrollbarWidth:function(){var m,l,o=g("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=o.children()[0];g("body").append(o);m=n.offsetWidth;o.css("overflow","scroll");l=n.offsetWidth;if(m===l){l=o[0].clientWidth}o.remove();return m-l},getScrollInfo:function(l){var p=l[0],n=l.height()<p.scrollHeight,m=l.width()<p.scrollWidth,o=g.position.scrollbarWidth();return{height:n?o:0,width:m?o:0}}};g.fn.position=function(t){if(!t||!t.of){return h.apply(this,arguments)}t=g.extend({},t);var p=g(t.of),m=g(t.within||window),q=p[0],s=(t.collision||"flip").split(" "),l={},u,r,o,n;if(q.nodeType===9){r=p.width();o=p.height();n={top:0,left:0}}else{if(g.isWindow(q)){r=p.width();o=p.height();n={top:p.scrollTop(),left:p.scrollLeft()}}else{if(q.preventDefault){t.at="left top";r=o=0;n={top:t.of.pageY,left:t.of.pageX}}else{r=p.outerWidth();o=p.outerHeight();n=p.offset()}}}g.each(["my","at"],function(){var y=(t[this]||"").split(" "),w,v;if(y.length===1){y=f.test(y[0])?y.concat([a]):j.test(y[0])?[a].concat(y):[a,a]}y[0]=f.test(y[0])?y[0]:a;y[1]=j.test(y[1])?y[1]:a;w=c.exec(y[0]);v=c.exec(y[1]);l[this]=[w?w[0]:0,v?v[0]:0];t[this]=[k.exec(y[0])[0],k.exec(y[1])[0]]});if(s.length===1){s[1]=s[0]}if(t.at[0]==="right"){n.left+=r}else{if(t.at[0]===a){n.left+=r/2}}if(t.at[1]==="bottom"){n.top+=o}else{if(t.at[1]===a){n.top+=o/2}}u=[parseInt(l.at[0],10)*(e.test(l.at[0])?r/100:1),parseInt(l.at[1],10)*(e.test(l.at[1])?o/100:1)];n.left+=u[0];n.top+=u[1];return this.each(function(){var A=g(this),C=A.outerWidth(),y=A.outerHeight(),B=parseInt(g.curCSS(this,"marginLeft",true))||0,w=parseInt(g.curCSS(this,"marginTop",true))||0,z=g.position.getScrollInfo(m),F=C+B+(parseInt(g.curCSS(this,"marginRight",true))||0)+z.width,G=y+w+(parseInt(g.curCSS(this,"marginBottom",true))||0)+z.height,D=g.extend({},n),E=[parseInt(l.my[0],10)*(e.test(l.my[0])?A.outerWidth()/100:1),parseInt(l.my[1],10)*(e.test(l.my[1])?A.outerHeight()/100:1)],v;if(t.my[0]==="right"){D.left-=C}else{if(t.my[0]===a){D.left-=C/2}}if(t.my[1]==="bottom"){D.top-=y}else{if(t.my[1]===a){D.top-=y/2}}D.left+=E[0];D.top+=E[1];D.left=Math.round(D.left);D.top=Math.round(D.top);v={left:D.left-B,top:D.top-w};g.each(["left","top"],function(I,H){if(g.ui.position[s[I]]){g.ui.position[s[I]][H](D,{targetWidth:r,targetHeight:o,elemWidth:C,elemHeight:y,collisionPosition:v,collisionWidth:F,collisionHeight:G,offset:[u[0]+E[0],u[1]+E[1]],my:t.my,at:t.at,within:m})}});if(g.fn.bgiframe){A.bgiframe()}A.offset(g.extend(D,{using:t.using}))})};g.ui.position={fit:{left:function(p,o){var n=o.within,q=g(window),m=g.isWindow(o.within[0]),r=m?q.scrollLeft():n.offset().left,t=m?q.width():n.outerWidth(),s=r-o.collisionPosition.left,l=o.collisionPosition.left+o.collisionWidth-t-r;if(o.collisionWidth>t||s>0){p.left+=s}else{if(l>0){p.left-=l}else{p.left=Math.max(p.left-o.collisionPosition.left,p.left)}}},top:function(o,n){var m=n.within,q=g(window),l=g.isWindow(n.within[0]),s=l?q.scrollTop():m.offset().top,t=l?q.height():m.outerHeight(),r=s-n.collisionPosition.top,p=n.collisionPosition.top+n.collisionHeight-t-s;if(n.collisionHeight>t||r>0){o.top+=r}else{if(p>0){o.top-=p}else{o.top=Math.max(o.top-n.collisionPosition.top,o.top)}}}},flip:{left:function(r,q){if(q.at[0]===a){return}var p=q.within,s=g(window),m=g.isWindow(q.within[0]),u=m?0:p.offset().left,y=m?p.width():p.outerWidth(),v=q.collisionPosition.left-u,l=q.collisionPosition.left+q.collisionWidth-y-u,n=q.my[0]==="left",t=q.my[0]==="left"?-q.elemWidth:q.my[0]==="right"?q.elemWidth:0,w=q.at[0]==="left"?q.targetWidth:-q.targetWidth,o=-2*q.offset[0];if(v<0||l>0){r.left+=t+w+o}},top:function(p,o){if(o.at[1]===a){return}var n=o.within,r=g(window),l=g.isWindow(o.within[0]),v=l?0:n.offset().top,w=l?n.height():n.outerHeight(),t=o.collisionPosition.top-v,q=o.collisionPosition.top+o.collisionHeight-w-v,u=o.my[1]==="top",s=u?-o.elemHeight:o.my[1]==="bottom"?o.elemHeight:0,y=o.at[1]==="top"?o.targetHeight:-o.targetHeight,m=-2*o.offset[1];if(t<0||q>0){p.top+=s+y+m}}}};if(g.uiBackCompat!==false){(function(m){var l=m.fn.position;m.fn.position=function(o){if(!o||!o.offset){return l.call(this,o)}var p=o.offset.split(" "),n=o.at.split(" ");if(p.length===1){p[1]=p[0]}if(/^\d/.test(p[0])){p[0]="+"+p[0]}if(/^\d/.test(p[1])){p[1]="+"+p[1]}if(n.length===1){if(/left|center|right/.test(n[0])){n[1]="center"}else{n[1]=n[0];n[0]="center"}}return l.call(this,m.extend(o,{at:n[0]+p[0]+" "+n[1]+p[1],offset:d}))}}(jQuery))}}(jQuery));(function(a,c){a.widget("ui.progressbar",{version:"1.9pre",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(d){if(d===c){return this._value()}this._setOption("value",d);return this},_setOption:function(d,e){if(d==="value"){this.options.value=e;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}this._super("_setOption",d,e)},_value:function(){var d=this.options.value;if(typeof d!=="number"){d=0}return Math.min(this.options.max,Math.max(this.min,d))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value();var d=this._percentage();if(this.oldValue!==e){this.oldValue=e;this._trigger("change")}this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(d.toFixed(0)+"%");this.element.attr("aria-valuenow",e)}})})(jQuery);(function(c,d){var a=5;c.widget("ui.slider",c.ui.mouse,{version:"1.9pre",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var f=this,l=this.options,k=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),j="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",e=(l.values&&l.values.length)||1,h=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(l.disabled?" ui-slider-disabled ui-disabled":""));this.range=c([]);if(l.range){if(l.range===true){if(!l.values){l.values=[this._valueMin(),this._valueMin()]}if(l.values.length&&l.values.length!==2){l.values=[l.values[0],l.values[0]]}}this.range=c("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((l.range==="min"||l.range==="max")?" ui-slider-range-"+l.range:""))}for(var g=k.length;g<e;g+=1){h.push(j)}this.handles=k.add(c(h.join("")).appendTo(f.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(m){m.preventDefault()}).hover(function(){if(!l.disabled){c(this).addClass("ui-state-hover")}},function(){c(this).removeClass("ui-state-hover")}).focus(function(){if(!l.disabled){c(".ui-slider .ui-state-focus").removeClass("ui-state-focus");c(this).addClass("ui-state-focus")}else{c(this).blur()}}).blur(function(){c(this).removeClass("ui-state-focus")});this.handles.each(function(m){c(this).data("index.ui-slider-handle",m)});this.handles.keydown(function(r){var o=true,n=c(this).data("index.ui-slider-handle"),s,p,m,q;if(f.options.disabled){return}switch(r.keyCode){case c.ui.keyCode.HOME:case c.ui.keyCode.END:case c.ui.keyCode.PAGE_UP:case c.ui.keyCode.PAGE_DOWN:case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:o=false;if(!f._keySliding){f._keySliding=true;c(this).addClass("ui-state-active");s=f._start(r,n);if(s===false){return}}break}q=f.options.step;if(f.options.values&&f.options.values.length){p=m=f.values(n)}else{p=m=f.value()}switch(r.keyCode){case c.ui.keyCode.HOME:m=f._valueMin();break;case c.ui.keyCode.END:m=f._valueMax();break;case c.ui.keyCode.PAGE_UP:m=f._trimAlignValue(p+((f._valueMax()-f._valueMin())/a));break;case c.ui.keyCode.PAGE_DOWN:m=f._trimAlignValue(p-((f._valueMax()-f._valueMin())/a));break;case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:if(p===f._valueMax()){return}m=f._trimAlignValue(p+q);break;case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(p===f._valueMin()){return}m=f._trimAlignValue(p-q);break}f._slide(r,n,m);return o}).keyup(function(n){var m=c(this).data("index.ui-slider-handle");if(f._keySliding){f._keySliding=false;f._stop(n,m);f._change(n,m);c(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(g){var h=this.options,l,n,f,j,q,m,p,k,e;if(h.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();l={x:g.pageX,y:g.pageY};n=this._normValueFromMouse(l);f=this._valueMax()-this._valueMin()+1;q=this;this.handles.each(function(o){var r=Math.abs(n-q.values(o));if(f>r){f=r;j=c(this);m=o}});if(h.range===true&&this.values(1)===h.min){m+=1;j=c(this.handles[m])}p=this._start(g,m);if(p===false){return false}this._mouseSliding=true;q._handleIndex=m;j.addClass("ui-state-active").focus();k=j.offset();e=!c(g.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=e?{left:0,top:0}:{left:g.pageX-k.left-(j.width()/2),top:g.pageY-k.top-(j.height()/2)-(parseInt(j.css("borderTopWidth"),10)||0)-(parseInt(j.css("borderBottomWidth"),10)||0)+(parseInt(j.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(g,m,n)}this._animateOff=true;return true},_mouseStart:function(e){return true},_mouseDrag:function(g){var e={x:g.pageX,y:g.pageY},f=this._normValueFromMouse(e);this._slide(g,this._handleIndex,f);return false},_mouseStop:function(e){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(e,this._handleIndex);this._change(e,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(f){var e,j,h,g,k;if(this.orientation==="horizontal"){e=this.elementSize.width;j=f.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{e=this.elementSize.height;j=f.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}h=(j/e);if(h>1){h=1}if(h<0){h=0}if(this.orientation==="vertical"){h=1-h}g=this._valueMax()-this._valueMin();k=this._valueMin()+h*g;return this._trimAlignValue(k)},_start:function(g,f){var e={handle:this.handles[f],value:this.value()};if(this.options.values&&this.options.values.length){e.value=this.values(f);e.values=this.values()}return this._trigger("start",g,e)},_slide:function(j,h,g){var e,f,k;if(this.options.values&&this.options.values.length){e=this.values(h?0:1);if((this.options.values.length===2&&this.options.range===true)&&((h===0&&g>e)||(h===1&&g<e))){g=e}if(g!==this.values(h)){f=this.values();f[h]=g;k=this._trigger("slide",j,{handle:this.handles[h],value:g,values:f});e=this.values(h?0:1);if(k!==false){this.values(h,g,true)}}}else{if(g!==this.value()){k=this._trigger("slide",j,{handle:this.handles[h],value:g});if(k!==false){this.value(g)}}}},_stop:function(g,f){var e={handle:this.handles[f],value:this.value()};if(this.options.values&&this.options.values.length){e.value=this.values(f);e.values=this.values()}this._trigger("stop",g,e)},_change:function(g,f){if(!this._keySliding&&!this._mouseSliding){var e={handle:this.handles[f],value:this.value()};if(this.options.values&&this.options.values.length){e.value=this.values(f);e.values=this.values()}this._trigger("change",g,e)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e);this._refreshValue();this._change(null,0);return}return this._value()},values:function(f,j){var h,e,g;if(arguments.length>1){this.options.values[f]=this._trimAlignValue(j);this._refreshValue();this._change(null,f);return}if(arguments.length){if(c.isArray(arguments[0])){h=this.options.values;e=arguments[0];for(g=0;g<h.length;g+=1){h[g]=this._trimAlignValue(e[g]);this._change(null,g)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(f)}else{return this.value()}}}else{return this._values()}},_setOption:function(f,g){var e,h=0;if(c.isArray(this.options.values)){h=this.options.values.length}c.Widget.prototype._setOption.apply(this,arguments);switch(f){case"disabled":if(g){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(e=0;e<h;e+=1){this._change(null,e)}this._animateOff=false;break}},_value:function(){var e=this.options.value;e=this._trimAlignValue(e);return e},_values:function(e){var h,g,f;if(arguments.length){h=this.options.values[e];h=this._trimAlignValue(h);return h}else{g=this.options.values.slice();for(f=0;f<g.length;f+=1){g[f]=this._trimAlignValue(g[f])}return g}},_trimAlignValue:function(h){if(h<=this._valueMin()){return this._valueMin()}if(h>=this._valueMax()){return this._valueMax()}var e=(this.options.step>0)?this.options.step:1,g=(h-this._valueMin())%e,f=h-g;if(Math.abs(g)*2>=e){f+=(g>0)?e:(-e)}return parseFloat(f.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var h=this.options.range,g=this.options,p=this,f=(!this._animateOff)?g.animate:false,j,e={},k,m,l,n;if(this.options.values&&this.options.values.length){this.handles.each(function(q,o){j=(p.values(q)-p._valueMin())/(p._valueMax()-p._valueMin())*100;e[p.orientation==="horizontal"?"left":"bottom"]=j+"%";c(this).stop(1,1)[f?"animate":"css"](e,g.animate);if(p.options.range===true){if(p.orientation==="horizontal"){if(q===0){p.range.stop(1,1)[f?"animate":"css"]({left:j+"%"},g.animate)}if(q===1){p.range[f?"animate":"css"]({width:(j-k)+"%"},{queue:false,duration:g.animate})}}else{if(q===0){p.range.stop(1,1)[f?"animate":"css"]({bottom:(j)+"%"},g.animate)}if(q===1){p.range[f?"animate":"css"]({height:(j-k)+"%"},{queue:false,duration:g.animate})}}}k=j})}else{m=this.value();l=this._valueMin();n=this._valueMax();j=(n!==l)?(m-l)/(n-l)*100:0;e[p.orientation==="horizontal"?"left":"bottom"]=j+"%";this.handle.stop(1,1)[f?"animate":"css"](e,g.animate);if(h==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[f?"animate":"css"]({width:j+"%"},g.animate)}if(h==="max"&&this.orientation==="horizontal"){this.range[f?"animate":"css"]({width:(100-j)+"%"},{queue:false,duration:g.animate})}if(h==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[f?"animate":"css"]({height:j+"%"},g.animate)}if(h==="max"&&this.orientation==="vertical"){this.range[f?"animate":"css"]({height:(100-j)+"%"},{queue:false,duration:g.animate})}}}})}(jQuery));(function(a){a.widget("ui.spinner",{version:"1.9pre",defaultElement:"<input>",widgetEventPrefix:"spin",options:{incremental:true,max:null,min:null,numberFormat:null,page:10,step:null,value:null},_create:function(){this._draw();this._markupOptions();this._mousewheel();this._aria()},_markupOptions:function(){var c=this;a.each({min:-Number.MAX_VALUE,max:Number.MAX_VALUE,step:1},function(d,e){if(c.options[d]===null){var f=c.element.attr(d);c.options[d]=typeof f==="string"&&f.length>0?c._parse(f):e}});this.value(this.options.value!==null?this.options.value:this.element.val()||0)},_draw:function(){var c=this,d=c.options;var e=this.uiSpinner=c.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(c._uiSpinnerHtml()).parent().append(c._buttonHtml()).disableSelection().hover(function(){if(!d.disabled){a(this).addClass("ui-state-hover")}c.hovered=true},function(){a(this).removeClass("ui-state-hover");c.hovered=false});this.element.attr("role","spinbutton").bind("keydown.spinner",function(f){if(d.disabled){return}if(c._start(f)){return c._keydown(f)}return true}).bind("keyup.spinner",function(f){if(d.disabled){return}if(c.spinning){c._stop(f);c._change(f)}}).bind("focus.spinner",function(){e.addClass("ui-state-active");c.focused=true}).bind("blur.spinner",function(f){c.value(c.element.val());if(!c.hovered){e.removeClass("ui-state-active")}c.focused=false});this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all").bind("mousedown",function(f){if(d.disabled){return}if(c._start(f)===false){return false}c._repeat(null,a(this).hasClass("ui-spinner-up")?1:-1,f)}).bind("mouseup",function(f){if(d.disabled){return}if(c.spinning){c._stop(f);c._change(f)}}).bind("mouseenter",function(){if(c.options.disabled){return}if(a(this).hasClass("ui-state-active")){if(c._start(event)===false){return false}c._repeat(null,a(this).hasClass("ui-spinner-up")?1:-1,event)}}).bind("mouseleave",function(){if(c.spinning){c._stop(event);c._change(event)}});if(d.disabled){this.disable()}},_keydown:function(d){var c=this.options,e=a.ui.keyCode;switch(d.keyCode){case e.UP:this._repeat(null,1,d);return false;case e.DOWN:this._repeat(null,-1,d);return false;case e.PAGE_UP:this._repeat(null,c.page,d);return false;case e.PAGE_DOWN:this._repeat(null,-c.page,d);return false;case e.ENTER:this.value(this.element.val())}return true},_mousewheel:function(){if(!a.fn.mousewheel){return}var c=this;this.element.bind("mousewheel.spinner",function(d,e){if(c.options.disabled||!e){return}if(!c.spinning&&!c._start(d)){return false}c._spin((e>0?1:-1)*c.options.step,d);clearTimeout(c.timeout);c.timeout=setTimeout(function(){if(c.spinning){c._stop(d);c._change(d)}},100);d.preventDefault()})},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon ui-icon-triangle-1-n'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon ui-icon-triangle-1-s'>&#9660;</span></a>"},_start:function(c){if(!this.spinning&&this._trigger("start",c)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(e,d,f){var c=this;e=e||500;clearTimeout(this.timer);this.timer=setTimeout(function(){c._repeat(40,d,f)},e);c._spin(d*c.options.step,f)},_spin:function(e,d){if(!this.counter){this.counter=1}var c=this.value()+e*(this.options.incremental&&this.counter>20?this.counter>100?this.counter>200?100:10:2:1);c=this._trimValue(c);if(this._trigger("spin",d,{value:c})!==false){this.value(c);this.counter++}},_trimValue:function(d){var c=this.options;if(d>c.max){return c.max}if(d<c.min){return c.min}return d},_stop:function(c){this.counter=0;if(this.timer){clearTimeout(this.timer)}this.element.focus();this.spinning=false;this._trigger("stop",c)},_change:function(c){this._trigger("change",c)},_setOption:function(c,d){if(c==="value"){d=this._trimValue(this._parse(d))}if(c==="disabled"){if(d){this.element.attr("disabled",true);this.buttons.button("disable")}else{this.element.removeAttr("disabled");this.buttons.button("enable")}}this._super("_setOption",c,d)},_setOptions:function(c){this._super("_setOptions",c);if("value" in c){this._format(this.options.value)}this._aria()},_aria:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this.options.value})},_parse:function(c){if(typeof c==="string"){c=a.global&&this.options.numberFormat?a.global.parseFloat(c):+c}return isNaN(c)?null:c},_format:function(c){this.element.val(a.global&&this.options.numberFormat?a.global.format(c,this.options.numberFormat):c)},destroy:function(){this.element.removeClass("ui-spinner-input").removeAttr("disabled").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this._super("destroy");this.uiSpinner.replaceWith(this.element)},stepUp:function(c){this._spin((c||1)*this.options.step)},stepDown:function(c){this._spin((c||1)*-this.options.step)},pageUp:function(c){this.stepUp((c||1)*this.options.page)},pageDown:function(c){this.stepDown((c||1)*this.options.page)},value:function(c){if(!arguments.length){return this._parse(this.element.val())}this.option("value",c)},widget:function(){return this.uiSpinner}})}(jQuery));(function(e,g){var d=0;function f(){return ++d}e.widget("ui.tabs",{version:"1.9pre",options:{active:null,collapsible:false,event:"click",fx:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var k=this,j=k.options,l=j.active;k.running=false;k.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");k._processTabs();if(l===null){if(location.hash){k.anchors.each(function(m,n){if(n.hash===location.hash){l=m;return false}})}if(l===null){l=k.lis.filter(".ui-tabs-active").index()}if(l===null||l===-1){l=k.lis.length?0:false}}if(l!==false){l=this.lis.eq(l).index();if(l===-1){l=j.collapsible?false:0}}j.active=l;if(!j.collapsible&&j.active===false&&this.anchors.length){j.active=0}if(e.isArray(j.disabled)){j.disabled=e.unique(j.disabled.concat(e.map(this.lis.filter(".ui-state-disabled"),function(o,m){return k.lis.index(o)}))).sort()}this._setupFx(j.fx);this._refresh();this.panels.hide();this.lis.removeClass("ui-tabs-active ui-state-active");if(j.active!==false&&this.anchors.length){this.active=this._findActive(j.active);var h=k._getPanelForTab(this.active);h.show();this.lis.eq(j.active).addClass("ui-tabs-active ui-state-active");this.load(j.active)}else{this.active=e()}},_setOption:function(h,j){if(h=="active"){this._activate(j);return}if(h==="disabled"){this._setupDisabled(j);return}this._super("_setOption",h,j);if(h==="collapsible"&&!j&&this.options.active===false){this._activate(0)}if(h==="event"){this._setupEvents(j)}if(h==="fx"){this._setupFx(j)}},_tabId:function(h){return e(h).attr("aria-controls")||"ui-tabs-"+f()},_sanitizeSelector:function(h){return h?h.replace(/[!"$%&'()*+,.\/:;<=>?@[\]^`{|}~]/g,"\\$&"):""},refresh:function(){var h=this,k=this.options,j=this.list.children(":has(a[href])");k.disabled=e.map(j.filter(".ui-state-disabled"),function(m){return j.index(m)});this._processTabs();this._refresh();this.panels.not(this._getPanelForTab(this.active)).hide();if(k.active===false||!this.anchors.length){k.active=false;this.active=e()}else{if(this.active.length&&!e.contains(this.list[0],this.active[0])){var l=k.active-1;this._activate(l>=0?l:0)}else{k.active=this.anchors.index(this.active)}}},_refresh:function(){var h=this.options;this.element.toggleClass("ui-tabs-collapsible",h.collapsible);this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");this._setupDisabled(h.disabled);this._setupEvents(h.event);this.lis.unbind(".tabs");this._focusable(this.lis);this._hoverable(this.lis)},_processTabs:function(){var h=this,j=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=e(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return e("a",this)[0]});this.panels=e([]);this.anchors.each(function(o,m){var n=e(m).attr("href"),p=n.split("#")[0],k,l,q;if(p&&(p===location.toString().split("#")[0]||(q=e("base")[0])&&p===q.href)){n=m.hash;m.href=n}if(j.test(n)){k=n;l=h.element.find(h._sanitizeSelector(k))}else{if(n&&n!=="#"){var r=h._tabId(m);k="#"+r;l=h.element.find(k);if(!l.length){l=h._createPanel(r);l.insertAfter(h.panels[o-1]||h.list)}}else{h.options.disabled.push(o)}}if(l.length){h.panels=h.panels.add(l)}e(m).attr("aria-controls",k.substring(1))})},_createPanel:function(h){return e("<div></div>").attr("id",h).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",true)},_setupDisabled:function(k){if(e.isArray(k)){if(!k.length){k=false}else{if(k.length===this.anchors.length){k=true}}}for(var j=0,h;(h=this.lis[j]);j++){e(h).toggleClass("ui-state-disabled",(k===true||e.inArray(j,k)!==-1))}this.options.disabled=k},_setupFx:function(h){if(h){if(e.isArray(h)){this.hideFx=h[0];this.showFx=h[1]}else{this.hideFx=this.showFx=h}}},_resetStyle:function(h,j){if(!e.support.opacity&&j.opacity){h[0].style.removeAttribute("filter")}},_setupEvents:function(h){this.anchors.unbind(".tabs");if(h){this.anchors.bind(h.split(" ").join(".tabs ")+".tabs",e.proxy(this,"_eventHandler"))}this.anchors.bind("click.tabs",function(j){j.preventDefault()})},_eventHandler:function(h){var n=this,s=n.options,m=n.active,o=e(h.currentTarget),q=o[0]===m[0],j=q&&s.collapsible,k=j?e():n._getPanelForTab(o),p=!m.length?e():n._getPanelForTab(m),l=o.closest("li"),r={oldTab:m,oldPanel:p,newTab:j?e():o,newPanel:k};h.preventDefault();if(l.hasClass("ui-state-disabled")||l.hasClass("ui-tabs-loading")||n.running||(q&&!s.collapsible)||(n._trigger("beforeActivate",h,r)===false)){o[0].blur();return}s.active=j?false:n.anchors.index(o);n.active=q?e():o;if(n.xhr){n.xhr.abort()}if(!p.length&&!k.length){throw"jQuery UI Tabs: Mismatching fragment identifier."}if(k.length){n.load(n.anchors.index(o),h);o[0].blur()}n._toggle(h,r)},_toggle:function(p,o){var n=this,m=n.options,h=o.newPanel,l=o.oldPanel;n.running=true;function k(){n.running=false;n._trigger("activate",p,o)}function j(){o.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(h.length&&n.showFx){h.animate(n.showFx,n.showFx.duration||"normal",function(){n._resetStyle(e(this),n.showFx);k()})}else{h.show();k()}}if(l.length&&n.hideFx){l.animate(n.hideFx,n.hideFx.duration||"normal",function(){o.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");n._resetStyle(e(this),n.hideFx);j()})}else{o.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");l.hide();j()}},_activate:function(h){var j=this._findActive(h)[0];if(j===this.active[0]){return}j=j||this.active[0];this._eventHandler({target:j,currentTarget:j,preventDefault:e.noop})},_findActive:function(h){return typeof h==="number"?this.anchors.eq(h):typeof h==="string"?this.anchors.filter("[href$='"+h+"']"):e()},_getIndex:function(h){if(typeof h=="string"){h=this.anchors.index(this.anchors.filter("[href$="+h+"]"))}return h},_destroy:function(){var h=this.options;if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var j=e(this).unbind(".tabs");e.each(["href","load"],function(k,l){j.removeData(l+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(e.data(this,"destroy.tabs")){e(this).remove()}else{e(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-active","ui-state-active","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom"].join(" "))}});return this},enable:function(h){var j=this.options.disabled;if(j===false){return}if(h===g){j=false}else{h=this._getIndex(h);if(e.isArray(j)){j=e.map(j,function(k){return k!==h?k:null})}else{j=e.map(this.lis,function(k,l){return l!==h?l:null})}}this._setupDisabled(j)},disable:function(h){var j=this.options.disabled;if(j===true){return}if(h===g){j=true}else{h=this._getIndex(h);if(e.inArray(h,j)!==-1){return}if(e.isArray(j)){j=e.merge([h],j).sort()}else{j=[h]}}this._setupDisabled(j)},load:function(n,p){n=this._getIndex(n);var j=this,m=this.options,l=this.anchors.eq(n),h=j._getPanelForTab(l),k=l.attr("href").replace(/#.*$/,""),o={tab:l,panel:h};if(!k){return}this.xhr=e.ajax({url:k,beforeSend:function(r,q){return j._trigger("beforeLoad",p,e.extend({jqXHR:r,ajaxSettings:q},o))}});if(this.xhr){this.lis.eq(n).addClass("ui-tabs-loading");this.xhr.success(function(q){h.html(q);j._trigger("load",p,o)}).complete(function(r,q){if(q==="abort"){j.panels.stop(false,true)}j.lis.eq(n).removeClass("ui-tabs-loading");if(r===j.xhr){delete j.xhr}})}return this},_getPanelForTab:function(h){var j=e(h).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+j))}});if(e.uiBackCompat!==false){e.ui.tabs.prototype._ui=function(j,h){return{tab:j,panel:h,index:this.anchors.index(j)}};(function(j,h){h.url=function(l,k){this.anchors.eq(l).attr("href",k)}}(jQuery,jQuery.ui.tabs.prototype));(function(m,k){m.extend(k.options,{ajaxOptions:null,cache:false});var n=k._create,l=k._setOption,j=k._destroy,h=k.url||m.noop;m.extend(k,{_create:function(){n.call(this);var o=this;this.element.bind("tabsbeforeload.tabs",function(p,q){if(m.data(q.tab[0],"cache.tabs")){p.preventDefault();return}m.extend(q.ajaxSettings,o.options.ajaxOptions,{error:function(u,r,t){try{o.options.ajaxOptions.error(u,r,q.tab.closest("li").index(),q.tab[0])}catch(t){}}});q.jqXHR.success(function(){if(o.options.cache){m.data(q.tab[0],"cache.tabs",true)}})})},_setOption:function(o,p){if(o==="cache"&&p===false){this.anchors.removeData("cache.tabs")}l.apply(this,arguments)},_destroy:function(){this.anchors.removeData("cache.tabs");j.call(this)},url:function(p,o){this.anchors.eq(p).removeData("cache.tabs");h.apply(this,arguments)}})}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){h.abort=function(){if(this.xhr){this.xhr.abort()}}}(jQuery,jQuery.ui.tabs.prototype));e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super("_create");this._bind({tabsbeforeload:function(k,l){if(!this.options.spinner){return}var j=l.tab.find("span"),h=j.html();j.html(this.options.spinner);l.jqXHR.complete(function(){j.html(h)})}})}});(function(l,k){l.extend(k.options,{enable:null,disable:null});var j=k.enable,h=k.disable;k.enable=function(o){var n=this.options,m;if(o&&n.disabled===true||(l.isArray(n.disabled)&&l.inArray(o,n.disabled)!==-1)){m=true}j.apply(this,arguments);if(m){this._trigger("enable",null,this._ui(this.anchors[o],this.panels[o]))}};k.disable=function(o){var n=this.options,m;if(o&&n.disabled===false||(l.isArray(n.disabled)&&l.inArray(o,n.disabled)===-1)){m=true}h.apply(this,arguments);if(m){this._trigger("disable",null,this._ui(this.anchors[o],this.panels[o]))}}}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){j.extend(h.options,{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"});h.add=function(p,o,n){if(n===g){n=this.anchors.length}var m=this.options,k=j(m.tabTemplate.replace(/#\{href\}/g,p).replace(/#\{label\}/g,o)),r=!p.indexOf("#")?p.replace("#",""):this._tabId(k.find("a")[0]);k.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);k.find("a").attr("aria-controls",r);var q=n>=this.lis.length;var l=this.element.find("#"+r);if(!l.length){l=this._createPanel(r);if(q){if(n>0){l.insertAfter(this.panels.eq(-1))}else{l.appendTo(this.element)}}else{l.insertBefore(this.panels[n])}}l.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide();if(q){k.appendTo(this.list)}else{k.insertBefore(this.lis[n])}m.disabled=j.map(m.disabled,function(s){return s>=n?++s:s});this.refresh();if(this.lis.length===1&&m.active===false){this.option("active",0)}this._trigger("add",null,this._ui(this.anchors[n],this.panels[n]));return this};h.remove=function(m){m=this._getIndex(m);var l=this.options,n=this.lis.eq(m).remove(),k=this.panels.eq(m).remove();if(n.hasClass("ui-tabs-active")&&this.anchors.length>1){this._activate(m+(m+1<this.anchors.length?1:-1))}l.disabled=j.map(j.grep(l.disabled,function(o){return o!==m}),function(o){return o>=m?--o:o});this.refresh();this._trigger("remove",null,this._ui(n.find("a")[0],k[0]));return this}}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){h.length=function(){return this.anchors.length}}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){j.extend(h.options,{idPrefix:"ui-tabs-"});var k=h._tabId;h._tabId=function(l){return j(l).attr("aria-controls")||l.title&&l.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+f()}}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){j.extend(h.options,{panelTemplate:"<div></div>"});var k=h._createPanel;h._createPanel=function(l){return j(this.options.panelTemplate).attr("id",l).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("destroy.tabs",true)}}(jQuery,jQuery.ui.tabs.prototype));(function(l,h){var m=h._create,k=h._setOption,j=h._eventHandler;h._create=function(){var n=this.options;if(n.active===null&&n.selected!==g){n.active=n.selected===-1?false:n.selected}m.call(this);n.selected=n.active;if(n.selected===false){n.selected=-1}};h._setOption=function(o,p){if(o!=="selected"){return k.apply(this,arguments)}var n=this.options;k.call(this,"active",p===-1?false:p);n.selected=n.active;if(n.selected===false){n.selected=-1}};h._eventHandler=function(n){j.apply(this,arguments);this.options.selected=this.options.active;if(this.options.selected===false){this.options.selected=-1}}}(jQuery,jQuery.ui.tabs.prototype));(function(k,j){k.extend(j.options,{show:null,select:null});var l=j._create,h=j._trigger;j._create=function(){l.call(this);if(this.options.active!==false){this._trigger("show",null,this._ui(this.active[0],this._getPanelForTab(this.active)[0]))}};j._trigger=function(n,o,p){var m=h.apply(this,arguments);if(!m){return false}if(n==="beforeActivate"&&p.newTab.length){m=h.call(this,"select",o,{tab:p.newTab[0],panel:p.newPanel[0],index:p.newTab.closest("li").index()})}else{if(n==="activate"&&p.newTab.length){m=h.call(this,"show",o,{tab:p.newTab[0],panel:p.newPanel[0],index:p.newTab.closest("li").index()})}}}}(jQuery,jQuery.ui.tabs.prototype));(function(j,h){h.select=function(k){k=this._getIndex(k);if(k===-1){if(this.options.collapsible&&this.options.selected!==-1){k=this.options.selected}else{return}}this.anchors.eq(k).trigger(this.options.event+".tabs")}}(jQuery,jQuery.ui.tabs.prototype));var c=0;function a(){return ++c}e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var h=this.options,j;if(h.active==null&&h.cookie){j=parseInt(this._cookie(),10);if(j===-1){j=false}h.active=j}this._super("_create")},_cookie:function(j){var h=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+a())];if(arguments.length){h.push(j===false?-1:j);h.push(this.options.cookie)}return e.cookie.apply(null,h)},_refresh:function(){this._super("_refresh");if(this.options.cookie){this._cookie(this.options.active,this.options.cookie)}},_eventHandler:function(h){this._superApply("_eventHandler",arguments);if(this.options.cookie){this._cookie(this.options.active,this.options.cookie)}},_destroy:function(){this._super("_destroy");if(this.options.cookie){this._cookie(null,this.options.cookie)}}});e.widget("ui.tabs",e.ui.tabs,{_trigger:function(j,k,l){var h=e.extend({},l);if(j==="load"){h.panel=h.panel[0];h.tab=h.tab[0]}return this._super("_trigger",j,k,h)}})}})(jQuery);(function(c){var a=0;c.widget("ui.tooltip",{version:"1.9pre",options:{content:function(){return c(this).attr("title")},hide:true,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flip fit"},show:true,tooltipClass:null,close:null,open:null},_create:function(){this._bind({mouseover:"open",focusin:"open"});this.tooltips={}},_setOption:function(d,e){if(d==="disabled"){this[e?"_disable":"_enable"]();this.options[d]=e;return}this._super("_setOption",d,e)},_disable:function(){var d=this;c.each(this.tooltips,function(g,e){var f=c.Event("blur");f.target=f.currentTarget=e[0];d.close(f,true)});this.element.find(this.options.items).andSelf().each(function(){var e=c(this);if(e.is("[title]")){e.data("tooltip-title",e.attr("title")).attr("title","")}})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var d=c(this);if(d.data("tooltip-title")){d.attr("title",d.data("tooltip-title"))}})},open:function(f){var e,d=this,g=c(f?f.target:this.element).closest(this.options.items);if(!g.length||g.attr("aria-describedby")){return}if(!g.data("tooltip-title")){g.data("tooltip-title",g.attr("title"))}e=this.options.content.call(g[0],function(h){setTimeout(function(){d._open(f,g,h)},1)});if(e){d._open(f,g,e)}},_open:function(e,g,d){if(!d){return}if(g.is("[title]")){g.attr("title","")}var f=this._find(g);if(!f.length){f=this._tooltip(g);g.attr("aria-describedby",f.attr("id"))}f.find(".ui-tooltip-content").html(d);f.stop(true).position(c.extend({of:g},this.options.position)).hide();this._show(f,this.options.show);this._trigger("open",e,{tooltip:f});this._bind(g,{mouseleave:"close",blur:"close"})},close:function(e,g){var d=this,h=c(e?e.currentTarget:this.element),f=this._find(h);if(!g&&document.activeElement===h[0]){return}if(h.data("tooltip-title")){h.attr("title",h.data("tooltip-title"))}h.removeAttr("aria-describedby");f.stop(true);this._hide(f,this.options.hide,function(){c(this).remove();delete d.tooltips[this.id]});h.unbind("mouseleave.tooltip blur.tooltip");this._trigger("close",e,{tooltip:f})},_tooltip:function(d){var f="ui-tooltip-"+a++,e=c("<div>").attr({id:f,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));c("<div>").addClass("ui-tooltip-content").appendTo(e);e.appendTo(document.body);if(c.fn.bgiframe){e.bgiframe()}this.tooltips[f]=d;return e},_find:function(d){var e=d.attr("aria-describedby");return e?c("#"+e):c()},_destroy:function(){c.each(this.tooltips,function(d){c("#"+d).remove()})}})}(jQuery));(function(j,l){var r,h="([^/]+)",m=/:([\w\d]+)/g,n=/\?([^#]*)?$/,d=function(s){return Array.prototype.slice.call(s)},e=function(s){return Object.prototype.toString.call(s)==="[object Function]"},o=function(s){return Object.prototype.toString.call(s)==="[object Array]"},k=function(s){return decodeURIComponent((s||"").replace(/\+/g," "))},c=encodeURIComponent,g=function(t){return String(t).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},p=function(s){return function(t,u){return this.route.apply(this,[s,t,u])}},a={},q=!!(l.history&&history.pushState),f=[];r=function(){var t=d(arguments),u,s;r.apps=r.apps||{};if(t.length===0||t[0]&&e(t[0])){return r.apply(r,["body"].concat(t))}else{if(typeof(s=t.shift())=="string"){u=r.apps[s]||new r.Application();u.element_selector=s;if(t.length>0){j.each(t,function(v,w){u.use(w)})}if(u.element_selector!=s){delete r.apps[s]}r.apps[u.element_selector]=u;return u}}};r.VERSION="0.7.0";r.addLogger=function(s){f.push(s)};r.log=function(){var s=d(arguments);s.unshift("["+Date()+"]");j.each(f,function(u,t){t.apply(r,s)})};if(typeof l.console!="undefined"){if(e(l.console.log.apply)){r.addLogger(function(){l.console.log.apply(l.console,arguments)})}else{r.addLogger(function(){l.console.log(arguments)})}}else{if(typeof console!="undefined"){r.addLogger(function(){console.log.apply(console,arguments)})}}j.extend(r,{makeArray:d,isFunction:e,isArray:o});r.Object=function(s){return j.extend(this,s||{})};j.extend(r.Object.prototype,{escapeHTML:g,h:g,toHash:function(){var s={};j.each(this,function(u,t){if(!e(t)){s[u]=t}});return s},toHTML:function(){var s="";j.each(this,function(u,t){if(!e(t)){s+="<strong>"+u+"</strong> "+t+"<br />"}});return s},keys:function(s){var t=[];for(var u in this){if(!e(this[u])||!s){t.push(u)}}return t},has:function(s){return this[s]&&j.trim(this[s].toString())!==""},join:function(){var t=d(arguments);var s=t.shift();return t.join(s)},log:function(){r.log.apply(r,arguments)},toString:function(t){var u=[];j.each(this,function(w,s){if(!e(s)||t){u.push('"'+w+'": '+s.toString())}});return"Sammy.Object: {"+u.join(",")+"}"}});r.DefaultLocationProxy=function(t,s){this.app=t;this.is_native=false;this.has_history=q;this._startPolling(s)};r.DefaultLocationProxy.fullPath=function(s){var t=s.toString().match(/^[^#]*(#.+)$/);var u=t?t[1]:"";return[s.pathname,s.search,u].join("")};r.DefaultLocationProxy.prototype={bind:function(){var t=this,u=this.app,s=r.DefaultLocationProxy;j(l).bind("hashchange."+this.app.eventNamespace(),function(w,v){if(t.is_native===false&&!v){t.is_native=true;l.clearInterval(s._interval)}u.trigger("location-changed")});if(q&&!u.disable_push_state){j(l).bind("popstate."+this.app.eventNamespace(),function(v){u.trigger("location-changed")});j("a").live("click.history-"+this.app.eventNamespace(),function(w){var v=s.fullPath(this);if(this.hostname==l.location.hostname&&u.lookupRoute("get",v)){w.preventDefault();t.setLocation(v);return false}})}if(!s._bindings){s._bindings=0}s._bindings++},unbind:function(){j(l).unbind("hashchange."+this.app.eventNamespace());j(l).unbind("popstate."+this.app.eventNamespace());j("a").die("click.history-"+this.app.eventNamespace());r.DefaultLocationProxy._bindings--;if(r.DefaultLocationProxy._bindings<=0){l.clearInterval(r.DefaultLocationProxy._interval)}},getLocation:function(){return r.DefaultLocationProxy.fullPath(l.location)},setLocation:function(s){if(/^([^#\/]|$)/.test(s)){if(q){s="/"+s}else{s="#!/"+s}}if(s!=this.getLocation()){if(q&&/^\//.test(s)){history.pushState({path:s},l.title,s);this.app.trigger("location-changed")}else{return(l.location=s)}}},_startPolling:function(u){var t=this;if(!r.DefaultLocationProxy._interval){if(!u){u=10}var s=function(){var v=t.getLocation();if(typeof r.DefaultLocationProxy._last_location=="undefined"||v!=r.DefaultLocationProxy._last_location){l.setTimeout(function(){j(l).trigger("hashchange",[true])},0)}r.DefaultLocationProxy._last_location=v};s();r.DefaultLocationProxy._interval=l.setInterval(s,u)}}};r.Application=function(s){var t=this;this.routes={};this.listeners=new r.Object({});this.arounds=[];this.befores=[];this.namespace=(new Date()).getTime()+"-"+parseInt(Math.random()*1000,10);this.context_prototype=function(){r.EventContext.apply(this,arguments)};this.context_prototype.prototype=new r.EventContext();if(e(s)){s.apply(this,[this])}if(!this._location_proxy){this.setLocationProxy(new r.DefaultLocationProxy(this,this.run_interval_every))}if(this.debug){this.bindToAllEvents(function(v,u){t.log(t.toString(),v.cleaned_type,u||{})})}};r.Application.prototype=j.extend({},r.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:false,element_selector:"body",debug:false,raise_errors:false,run_interval_every:50,disable_push_state:false,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(s){return s?j(this.element_selector).find(s):j(this.element_selector)},use:function(){var s=d(arguments),u=s.shift(),t=u||"";try{s.unshift(this);if(typeof u=="string"){t="Sammy."+u;u=r[u]}u.apply(this,s)}catch(v){if(typeof u==="undefined"){this.error("Plugin Error: called use() but plugin ("+t.toString()+") is not defined",v)}else{if(!e(u)){this.error("Plugin Error: called use() but '"+t.toString()+"' is not a function",v)}else{this.error("Plugin Error",v)}}}return this},setLocationProxy:function(s){var t=this._location_proxy;this._location_proxy=s;if(this.isRunning()){if(t){t.unbind()}this._location_proxy.bind()}},log:function(){r.log.apply(r,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(w,t,z){var v=this,y=[],s,u;if(!z&&e(t)){t=w;z=t;w="any"}w=w.toLowerCase();if(t.constructor==String){m.lastIndex=0;while((u=m.exec(t))!==null){y.push(u[1])}t=new RegExp(t.replace(m,h)+"$")}if(typeof z=="string"){z=v[z]}s=function(A){var B={verb:A,path:t,callback:z,param_names:y};v.routes[A]=v.routes[A]||[];v.routes[A].push(B)};if(w==="any"){j.each(this.ROUTE_VERBS,function(B,A){s(A)})}else{s(w)}return this},get:p("get"),post:p("post"),put:p("put"),del:p("delete"),any:p("any"),mapRoutes:function(t){var s=this;j.each(t,function(u,v){s.route.apply(s,v)});return this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(s,u,w){var v=this;if(typeof w=="undefined"){w=u}var t=function(){var A,y,z;A=arguments[0];z=arguments[1];if(z&&z.context){y=z.context;delete z.context}else{y=new v.context_prototype(v,"bind",A.type,z,A.target)}A.cleaned_type=A.type.replace(v.eventNamespace(),"");w.apply(y,[A,z])};if(!this.listeners[s]){this.listeners[s]=[]}this.listeners[s].push(t);if(this.isRunning()){this._listen(s,t)}return this},trigger:function(s,t){this.$element().trigger([s,this.eventNamespace()].join("."),[t]);return this},refresh:function(){this.last_location=null;this.trigger("location-changed");return this},before:function(s,t){if(e(s)){t=s;s={}}this.befores.push([s,t]);return this},after:function(s){return this.bind("event-context-after",s)},around:function(s){this.arounds.push(s);return this},isRunning:function(){return this._running},helpers:function(s){j.extend(this.context_prototype.prototype,s);return this},helper:function(s,t){this.context_prototype.prototype[s]=t;return this},run:function(s){if(this.isRunning()){return false}var t=this;j.each(this.listeners.toHash(),function(u,v){j.each(v,function(y,w){t._listen(u,w)})});this.trigger("run",{start_url:s});this._running=true;this.last_location=null;if(!(/\#(.+)/.test(this.getLocation()))&&typeof s!="undefined"){this.setLocation(s)}this._checkLocation();this._location_proxy.bind();this.bind("location-changed",function(){t._checkLocation()});this.bind("submit",function(v){var u=t._checkFormSubmission(j(v.target).closest("form"));return(u===false)?v.preventDefault():false});j(l).bind("unload",function(){t.unload()});return this.trigger("changed")},unload:function(){if(!this.isRunning()){return false}var s=this;this.trigger("unload");this._location_proxy.unbind();this.$element().unbind("submit").removeClass(s.eventNamespace());j.each(this.listeners.toHash(),function(t,u){j.each(u,function(w,v){s._unlisten(t,v)})});this._running=false;return this},bindToAllEvents:function(t){var s=this;j.each(this.APP_EVENTS,function(u,v){s.bind(v,t)});j.each(this.listeners.keys(true),function(v,u){if(j.inArray(u,s.APP_EVENTS)==-1){s.bind(u,t)}});return this},routablePath:function(s){return s.replace(n,"")},lookupRoute:function(z,w){var y=this,v=false,u=0,s,t;if(typeof this.routes[z]!="undefined"){s=this.routes[z].length;for(;u<s;u++){t=this.routes[z][u];if(y.routablePath(w).match(t.path)){v=t;break}}}return v},runRoute:function(u,I,w,A){var v=this,G=this.lookupRoute(u,I),t,D,y,C,H,E,B,F,s;this.log("runRoute",[u,I].join(" "));this.trigger("run-route",{verb:u,path:I,params:w});if(typeof w=="undefined"){w={}}j.extend(w,this._parseQueryString(I));if(G){this.trigger("route-found",{route:G});if((F=G.path.exec(this.routablePath(I)))!==null){F.shift();j.each(F,function(J,K){if(G.param_names[J]){w[G.param_names[J]]=k(K)}else{if(!w.splat){w.splat=[]}w.splat.push(k(K))}})}t=new this.context_prototype(this,u,I,w,A);y=this.arounds.slice(0);H=this.befores.slice(0);B=[t].concat(w.splat);D=function(){var J;while(H.length>0){E=H.shift();if(v.contextMatchesOptions(t,E[0])){J=E[1].apply(t,[t]);if(J===false){return false}}}v.last_route=G;t.trigger("event-context-before",{context:t});J=G.callback.apply(t,B);t.trigger("event-context-after",{context:t});return J};j.each(y.reverse(),function(J,K){var L=D;D=function(){return K.apply(t,[L])}});try{s=D()}catch(z){this.error(["500 Error",u,I].join(" "),z)}return s}else{return this.notFound(u,I)}},contextMatchesOptions:function(v,y,t){var u=y;if(typeof u==="undefined"||u=={}){return true}if(typeof t==="undefined"){t=true}if(typeof u==="string"||e(u.test)){u={path:u}}if(u.only){return this.contextMatchesOptions(v,u.only,true)}else{if(u.except){return this.contextMatchesOptions(v,u.except,false)}}var s=true,w=true;if(u.path){if(!e(u.path.test)){u.path=new RegExp(u.path.toString()+"$")}s=u.path.test(v.path)}if(u.verb){if(typeof u.verb==="string"){w=u.verb===v.verb}else{w=u.verb.indexOf(v.verb)>-1}}return t?(w&&s):!(w&&s)},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(s){return this._location_proxy.setLocation(s)},swap:function(s){return this.$element().html(s)},templateCache:function(s,t){if(typeof t!="undefined"){return a[s]=t}else{return a[s]}},clearTemplateCache:function(){return a={}},notFound:function(u,t){var s=this.error(["404 Not Found",u,t].join(" "));return(u==="get")?s:true},error:function(t,s){if(!s){s=new Error()}s.message=[t,s.message].join(" ");this.trigger("error",{message:s.message,error:s});if(this.raise_errors){throw (s)}else{this.log(s.message,s)}},_checkLocation:function(){var s,t;s=this.getLocation();if(!this.last_location||this.last_location[0]!="get"||this.last_location[1]!=s){this.last_location=["get",s];t=this.runRoute("get",s)}return t},_getFormVerb:function(u){var t=j(u),v,s;s=t.find('input[name="_method"]');if(s.length>0){v=s.val()}if(!v){v=t[0].getAttribute("method")}if(!v||v==""){v="get"}return j.trim(v.toString().toLowerCase())},_checkFormSubmission:function(u){var s,v,y,w,t;this.trigger("check-form-submission",{form:u});s=j(u);v=s.attr("action")||"";y=this._getFormVerb(s);this.log("_checkFormSubmission",s,v,y);if(y==="get"){w=this._serializeFormParams(s);if(w!==""){v+="?"+w}this.setLocation(v);t=false}else{w=j.extend({},this._parseFormParams(s));t=this.runRoute(y,v,w,u.get(0))}return(typeof t=="undefined")?false:t},_serializeFormParams:function(t){var v="",s=t.serializeArray(),u;if(s.length>0){v=this._encodeFormPair(s[0].name,s[0].value);for(u=1;u<s.length;u++){v=v+"&"+this._encodeFormPair(s[u].name,s[u].value)}}return v},_encodeFormPair:function(s,t){return c(s)+"="+c(t)},_parseFormParams:function(s){var v={},u=s.serializeArray(),t;for(t=0;t<u.length;t++){v=this._parseParamPair(v,u[t].name,u[t].value)}return v},_parseQueryString:function(v){var y={},u,t,w,s;u=v.match(n);if(u){t=u[1].split("&");for(s=0;s<t.length;s++){w=t[s].split("=");y=this._parseParamPair(y,k(w[0]),k(w[1]||""))}}return y},_parseParamPair:function(u,s,t){if(u[s]){if(o(u[s])){u[s].push(t)}else{u[s]=[u[s],t]}}else{u[s]=t}return u},_listen:function(s,t){return this.$element().bind([s,this.eventNamespace()].join("."),t)},_unlisten:function(s,t){return this.$element().unbind([s,this.eventNamespace()].join("."),t)}});r.RenderContext=function(s){this.event_context=s;this.callbacks=[];this.previous_content=null;this.content=null;this.next_engine=false;this.waiting=false};r.RenderContext.prototype=j.extend({},r.Object.prototype,{then:function(u){if(!e(u)){if(typeof u==="string"&&u in this.event_context){var t=this.event_context[u];u=function(v){return t.apply(this.event_context,[v])}}else{return this}}var s=this;if(this.waiting){this.callbacks.push(u)}else{this.wait();l.setTimeout(function(){var v=u.apply(s,[s.content,s.previous_content]);if(v!==false){s.next(v)}},0)}return this},wait:function(){this.waiting=true},next:function(s){this.waiting=false;if(typeof s!=="undefined"){this.previous_content=this.content;this.content=s}if(this.callbacks.length>0){this.then(this.callbacks.shift())}},load:function(s,t,v){var u=this;return this.then(function(){var w,y,A,z;if(e(t)){v=t;t={}}else{t=j.extend({},t)}if(v){this.then(v)}if(typeof s==="string"){A=(s.match(/\.json$/)||t.json);w=((A&&t.cache===true)||t.cache!==false);u.next_engine=u.event_context.engineFor(s);delete t.cache;delete t.json;if(t.engine){u.next_engine=t.engine;delete t.engine}if(w&&(y=this.event_context.app.templateCache(s))){return y}this.wait();j.ajax(j.extend({url:s,data:{},dataType:A?"json":null,type:"get",success:function(B){if(w){u.event_context.app.templateCache(s,B)}u.next(B)}},t));return false}else{if(s.nodeType){return s.innerHTML}if(s.selector){u.next_engine=s.attr("data-engine");if(t.clone===false){return s.remove()[0].innerHTML.toString()}else{return s[0].innerHTML.toString()}}}})},loadPartials:function(s){if(s){this.partials=this.partials||{};for(name in s){(function(u,t){u.load(s[t]).then(function(v){this.partials[t]=v})})(this,name)}}return this},render:function(s,u,v,t){if(e(s)&&!u){return this.then(s)}else{return this.loadPartials(t).load(s).interpolate(u,s).then(v)}},partial:function(s,t){return this.render(s,t).swap()},send:function(){var u=this,t=d(arguments),s=t.shift();if(o(t[0])){t=t[0]}return this.then(function(v){t.push(function(w){u.next(w)});u.wait();s.apply(s,t);return false})},collect:function(w,v,s){var u=this;var t=function(){if(e(w)){v=w;w=this.content}var y=[],z=false;j.each(w,function(A,C){var B=v.apply(u,[A,C]);if(B.jquery&&B.length==1){B=B[0];z=true}y.push(B);return B});return z?y:y.join("")};return s?t():this.then(t)},renderEach:function(s,t,u,v){if(o(t)){v=u;u=t;t=null}return this.load(s).then(function(y){var w=this;if(!u){u=o(this.previous_content)?this.previous_content:[]}if(v){j.each(u,function(z,B){var C={},A=this.next_engine||s;t?(C[t]=B):(C=B);v(B,w.event_context.interpolate(y,C,A))})}else{return this.collect(u,function(z,B){var C={},A=this.next_engine||s;t?(C[t]=B):(C=B);return this.event_context.interpolate(y,C,A)},true)}})},interpolate:function(v,u,s){var t=this;return this.then(function(y,w){if(!v&&w){v=w}if(this.next_engine){u=this.next_engine;this.next_engine=false}var z=t.event_context.interpolate(y,v,u,this.partials);return s?w+z:z})},swap:function(){return this.then(function(s){this.event_context.swap(s)}).trigger("changed",{})},appendTo:function(s){return this.then(function(t){j(s).append(t)}).trigger("changed",{})},prependTo:function(s){return this.then(function(t){j(s).prepend(t)}).trigger("changed",{})},replace:function(s){return this.then(function(t){j(s).html(t)}).trigger("changed",{})},trigger:function(s,t){return this.then(function(u){if(typeof t=="undefined"){t={content:u}}this.event_context.trigger(s,t)})}});r.EventContext=function(w,v,t,u,s){this.app=w;this.verb=v;this.path=t;this.params=new r.Object(u);this.target=s};r.EventContext.prototype=j.extend({},r.Object.prototype,{$element:function(){return this.app.$element(d(arguments).shift())},engineFor:function(u){var t=this,s;if(e(u)){return u}u=(u||t.app.template_engine).toString();if((s=u.match(/\.([^\.\?\#]+)$/))){u=s[1]}if(u&&e(t[u])){return t[u]}if(t.app.template_engine){return this.engineFor(t.app.template_engine)}return function(v,w){return v}},interpolate:function(u,v,t,s){return this.engineFor(t).apply(this,[u,v,s])},render:function(s,u,v,t){return new r.RenderContext(this).render(s,u,v,t)},renderEach:function(s,t,u,v){return new r.RenderContext(this).renderEach(s,t,u,v)},load:function(s,t,u){return new r.RenderContext(this).load(s,t,u)},partial:function(s,t){return new r.RenderContext(this).partial(s,t)},send:function(){var s=new r.RenderContext(this);return s.send.apply(s,arguments)},redirect:function(){var B,z=d(arguments),y=this.app.getLocation(),t=z.length;if(t>1){var w=0,C=[],s=[],v={},A=false;for(;w<t;w++){if(typeof z[w]=="string"){C.push(z[w])}else{j.extend(v,z[w]);A=true}}B=C.join("/");if(A){for(var u in v){s.push(this.app._encodeFormPair(u,v[u]))}B+="?"+s.join("&")}}else{B=z[0]}this.trigger("redirect",{to:B});this.app.last_location=[this.verb,this.path];this.app.setLocation(B);if(new RegExp(B).test(y)){this.app.trigger("location-changed")}},trigger:function(s,t){if(typeof t=="undefined"){t={}}if(!t.context){t.context=this}return this.app.trigger(s,t)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(s){return this.app.swap(s)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(s){return j.parseJSON(s)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}});j.sammy=l.Sammy=r})(jQuery,window);(function(a){a.fn.someAllCheckboxes=function(c){var d=a.extend({allSelector:".all"},c||{});a(this).each(function(f,j){var h=a(j);var e=h.find(d.allSelector+":checkbox");var g=h.find(":not("+d.allSelector+"):checkbox");h.bind("someAllCheckboxes:allChecked",function(){g.attr("checked",false)});h.bind("someAllCheckboxes:singleChecked",function(){e.attr("checked",false)});e.change(function(){if(a(this).is(":checked")){h.trigger("someAllCheckboxes:allChecked")}});g.change(function(){if(a(this).is("checked")){h.trigger("someAllCheckboxes:singleChecked")}})});return this}})(jQuery);if(typeof(jQuery)==="function"){jQuery.arturo={agentSupportsHTML5Output:("for" in jQuery("<output />")),linkAndShowOutputs:function(){if(jQuery.arturo.agentSupportsHTML5Output){jQuery(".features output,.feature_new output,.feature_edit output").each(function(d,c){var c=jQuery(c);var a=jQuery("#"+c.attr("for"));a.change(function(){c.val(a.val())});c.removeClass("no_js")})}}};jQuery(function(){jQuery.arturo.linkAndShowOutputs()})}if(!document.createElement("canvas").getContext){(function(){var v=Math;var w=v.round;var s=v.sin;var E=v.cos;var n=v.abs;var D=v.sqrt;var a=10;var o=a/2;function h(){return this.context_||(this.context_=new q(this))}var u=Array.prototype.slice;function F(m,G,H){var j=u.call(arguments,2);return function(){return m.apply(G,j.concat(u.call(arguments)))}}var k={init:function(j){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var m=j||document;m.createElement("canvas");m.attachEvent("onreadystatechange",F(this.init_,this,m))}},init_:function(H){if(!H.namespaces.g_vml_){H.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML")}if(!H.namespaces.g_o_){H.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML")}if(!H.styleSheets.ex_canvas_){var G=H.createStyleSheet();G.owningElement.id="ex_canvas_";G.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var m=H.getElementsByTagName("canvas");for(var j=0;j<m.length;j++){this.initElement(m[j])}},initElement:function(m){if(!m.getContext){m.getContext=h;m.innerHTML="";m.attachEvent("onpropertychange",C);m.attachEvent("onresize",c);var j=m.attributes;if(j.width&&j.width.specified){m.style.width=j.width.nodeValue+"px"}else{m.width=m.clientWidth}if(j.height&&j.height.specified){m.style.height=j.height.nodeValue+"px"}else{m.height=m.clientHeight}}return m}};function C(m){var j=m.srcElement;switch(m.propertyName){case"width":j.style.width=j.attributes.width.nodeValue+"px";j.getContext().clearRect();break;case"height":j.style.height=j.attributes.height.nodeValue+"px";j.getContext().clearRect();break}}function c(m){var j=m.srcElement;if(j.firstChild){j.firstChild.style.width=j.clientWidth+"px";j.firstChild.style.height=j.clientHeight+"px"}}k.init();var f=[];for(var A=0;A<16;A++){for(var z=0;z<16;z++){f[A*16+z]=A.toString(16)+z.toString(16)}}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function e(H,G){var m=r();for(var j=0;j<3;j++){for(var K=0;K<3;K++){var I=0;for(var J=0;J<3;J++){I+=H[j][J]*G[J][K]}m[j][K]=I}}return m}function y(m,j){j.fillStyle=m.fillStyle;j.lineCap=m.lineCap;j.lineJoin=m.lineJoin;j.lineWidth=m.lineWidth;j.miterLimit=m.miterLimit;j.shadowBlur=m.shadowBlur;j.shadowColor=m.shadowColor;j.shadowOffsetX=m.shadowOffsetX;j.shadowOffsetY=m.shadowOffsetY;j.strokeStyle=m.strokeStyle;j.globalAlpha=m.globalAlpha;j.arcScaleX_=m.arcScaleX_;j.arcScaleY_=m.arcScaleY_;j.lineScale_=m.lineScale_}function d(m){var I,H=1;m=String(m);if(m.substring(0,3)=="rgb"){var K=m.indexOf("(",3);var j=m.indexOf(")",K+1);var J=m.substring(K+1,j).split(",");I="#";for(var G=0;G<3;G++){I+=f[Number(J[G])]}if(J.length==4&&m.substr(3,1)=="a"){H=J[3]}}else{I=m}return{color:I,alpha:H}}function t(j){switch(j){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function q(m){this.m_=r();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=a*1;this.globalAlpha=1;this.canvas=m;var j=m.ownerDocument.createElement("div");j.style.width=m.clientWidth+"px";j.style.height=m.clientHeight+"px";j.style.overflow="hidden";j.style.position="absolute";m.appendChild(j);this.element_=j;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1}var l=q.prototype;l.clearRect=function(){this.element_.innerHTML=""};l.beginPath=function(){this.currentPath_=[]};l.moveTo=function(m,j){var G=this.getCoords_(m,j);this.currentPath_.push({type:"moveTo",x:G.x,y:G.y});this.currentX_=G.x;this.currentY_=G.y};l.lineTo=function(m,j){var G=this.getCoords_(m,j);this.currentPath_.push({type:"lineTo",x:G.x,y:G.y});this.currentX_=G.x;this.currentY_=G.y};l.bezierCurveTo=function(G,m,M,L,K,I){var j=this.getCoords_(K,I);var J=this.getCoords_(G,m);var H=this.getCoords_(M,L);p(this,J,H,j)};function p(j,H,G,m){j.currentPath_.push({type:"bezierCurveTo",cp1x:H.x,cp1y:H.y,cp2x:G.x,cp2y:G.y,x:m.x,y:m.y});j.currentX_=m.x;j.currentY_=m.y}l.quadraticCurveTo=function(K,G,m,j){var J=this.getCoords_(K,G);var I=this.getCoords_(m,j);var L={x:this.currentX_+2/3*(J.x-this.currentX_),y:this.currentY_+2/3*(J.y-this.currentY_)};var H={x:L.x+(I.x-this.currentX_)/3,y:L.y+(I.y-this.currentY_)/3};p(this,L,H,I)};l.arc=function(N,L,M,I,m,G){M*=a;var R=G?"at":"wa";var O=N+E(I)*M-o;var Q=L+s(I)*M-o;var j=N+E(m)*M-o;var P=L+s(m)*M-o;if(O==j&&!G){O+=0.125}var H=this.getCoords_(N,L);var K=this.getCoords_(O,Q);var J=this.getCoords_(j,P);this.currentPath_.push({type:R,x:H.x,y:H.y,radius:M,xStart:K.x,yStart:K.y,xEnd:J.x,yEnd:J.y})};l.rect=function(G,m,j,H){this.moveTo(G,m);this.lineTo(G+j,m);this.lineTo(G+j,m+H);this.lineTo(G,m+H);this.closePath()};l.strokeRect=function(G,m,j,H){var I=this.currentPath_;this.beginPath();this.moveTo(G,m);this.lineTo(G+j,m);this.lineTo(G+j,m+H);this.lineTo(G,m+H);this.closePath();this.stroke();this.currentPath_=I};l.fillRect=function(G,m,j,H){var I=this.currentPath_;this.beginPath();this.moveTo(G,m);this.lineTo(G+j,m);this.lineTo(G+j,m+H);this.lineTo(G,m+H);this.closePath();this.fill();this.currentPath_=I};l.createLinearGradient=function(m,H,j,G){var I=new B("gradient");I.x0_=m;I.y0_=H;I.x1_=j;I.y1_=G;return I};l.createRadialGradient=function(H,J,G,m,I,j){var K=new B("gradientradial");K.x0_=H;K.y0_=J;K.r0_=G;K.x1_=m;K.y1_=I;K.r1_=j;return K};l.drawImage=function(U,G){var N,L,P,ac,S,Q,X,ae;var O=U.runtimeStyle.width;var T=U.runtimeStyle.height;U.runtimeStyle.width="auto";U.runtimeStyle.height="auto";var M=U.width;var aa=U.height;U.runtimeStyle.width=O;U.runtimeStyle.height=T;if(arguments.length==3){N=arguments[1];L=arguments[2];S=Q=0;X=P=M;ae=ac=aa}else{if(arguments.length==5){N=arguments[1];L=arguments[2];P=arguments[3];ac=arguments[4];S=Q=0;X=M;ae=aa}else{if(arguments.length==9){S=arguments[1];Q=arguments[2];X=arguments[3];ae=arguments[4];N=arguments[5];L=arguments[6];P=arguments[7];ac=arguments[8]}else{throw Error("Invalid number of arguments")}}}var ad=this.getCoords_(N,L);var I=X/2;var m=ae/2;var ab=[];var j=10;var K=10;ab.push(" <g_vml_:group",' coordsize="',a*j,",",a*K,'"',' coordorigin="0,0"',' style="width:',j,"px;height:",K,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var J=[];J.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",w(ad.x/a),",","Dy=",w(ad.y/a),"");var Z=ad;var Y=this.getCoords_(N+P,L);var V=this.getCoords_(N,L+ac);var R=this.getCoords_(N+P,L+ac);Z.x=v.max(Z.x,Y.x,V.x,R.x);Z.y=v.max(Z.y,Y.y,V.y,R.y);ab.push("padding:0 ",w(Z.x/a),"px ",w(Z.y/a),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",J.join(""),", sizingmethod='clip');")}else{ab.push("top:",w(ad.y/a),"px;left:",w(ad.x/a),"px;")}ab.push(' ">','<g_vml_:image src="',U.src,'"',' style="width:',a*P,"px;"," height:",a*ac,'px;"',' cropleft="',S/M,'"',' croptop="',Q/aa,'"',' cropright="',(M-S-X)/M,'"',' cropbottom="',(aa-Q-ae)/aa,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",ab.join(""))};l.stroke=function(ag){var L=[];var M=false;var ar=d(ag?this.fillStyle:this.strokeStyle);var ac=ar.color;var am=ar.alpha*this.globalAlpha;var I=10;var O=10;L.push("<g_vml_:shape",' filled="',!!ag,'"',' style="position:absolute;width:',I,"px;height:",O,'px;"',' coordorigin="0 0" coordsize="',a*I," ",a*O,'"',' stroked="',!ag,'"',' path="');var N=false;var aq={x:null,y:null};var Y={x:null,y:null};for(var al=0;al<this.currentPath_.length;al++){var ak=this.currentPath_[al];var ap;switch(ak.type){case"moveTo":ap=ak;L.push(" m ",w(ak.x),",",w(ak.y));break;case"lineTo":L.push(" l ",w(ak.x),",",w(ak.y));break;case"close":L.push(" x ");ak=null;break;case"bezierCurveTo":L.push(" c ",w(ak.cp1x),",",w(ak.cp1y),",",w(ak.cp2x),",",w(ak.cp2y),",",w(ak.x),",",w(ak.y));break;case"at":case"wa":L.push(" ",ak.type," ",w(ak.x-this.arcScaleX_*ak.radius),",",w(ak.y-this.arcScaleY_*ak.radius)," ",w(ak.x+this.arcScaleX_*ak.radius),",",w(ak.y+this.arcScaleY_*ak.radius)," ",w(ak.xStart),",",w(ak.yStart)," ",w(ak.xEnd),",",w(ak.yEnd));break}if(ak){if(aq.x==null||ak.x<aq.x){aq.x=ak.x}if(Y.x==null||ak.x>Y.x){Y.x=ak.x}if(aq.y==null||ak.y<aq.y){aq.y=ak.y}if(Y.y==null||ak.y>Y.y){Y.y=ak.y}}}L.push(' ">');if(!ag){var X=this.lineScale_*this.lineWidth;if(X<1){am*=X}L.push("<g_vml_:stroke",' opacity="',am,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',t(this.lineCap),'"',' weight="',X,'px"',' color="',ac,'" />')}else{if(typeof this.fillStyle=="object"){var P=this.fillStyle;var U=0;var aj={x:0,y:0};var ad=0;var S=1;if(P.type_=="gradient"){var R=P.x0_/this.arcScaleX_;var m=P.y0_/this.arcScaleY_;var Q=P.x1_/this.arcScaleX_;var at=P.y1_/this.arcScaleY_;var ao=this.getCoords_(R,m);var an=this.getCoords_(Q,at);var K=an.x-ao.x;var J=an.y-ao.y;U=Math.atan2(K,J)*180/Math.PI;if(U<0){U+=360}if(U<0.000001){U=0}}else{var ao=this.getCoords_(P.x0_,P.y0_);var j=Y.x-aq.x;var G=Y.y-aq.y;aj={x:(ao.x-aq.x)/j,y:(ao.y-aq.y)/G};j/=this.arcScaleX_*a;G/=this.arcScaleY_*a;var ai=v.max(j,G);ad=2*P.r0_/ai;S=2*P.r1_/ai-ad}var ab=P.colors_;ab.sort(function(W,H){return W.offset-H.offset});var V=ab.length;var aa=ab[0].color;var Z=ab[V-1].color;var af=ab[0].alpha*this.globalAlpha;var ae=ab[V-1].alpha*this.globalAlpha;var ah=[];for(var al=0;al<V;al++){var T=ab[al];ah.push(T.offset*S+ad+" "+T.color)}L.push('<g_vml_:fill type="',P.type_,'"',' method="none" focus="100%"',' color="',aa,'"',' color2="',Z,'"',' colors="',ah.join(","),'"',' opacity="',ae,'"',' g_o_:opacity2="',af,'"',' angle="',U,'"',' focusposition="',aj.x,",",aj.y,'" />')}else{L.push('<g_vml_:fill color="',ac,'" opacity="',am,'" />')}}L.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",L.join(""))};l.fill=function(){this.stroke(true)};l.closePath=function(){this.currentPath_.push({type:"close"})};l.getCoords_=function(H,G){var j=this.m_;return{x:a*(H*j[0][0]+G*j[1][0]+j[2][0])-o,y:a*(H*j[0][1]+G*j[1][1]+j[2][1])-o}};l.save=function(){var j={};y(this,j);this.aStack_.push(j);this.mStack_.push(this.m_);this.m_=e(r(),this.m_)};l.restore=function(){y(this.aStack_.pop(),this);this.m_=this.mStack_.pop()};l.translate=function(G,m){var j=[[1,0,0],[0,1,0],[G,m,1]];this.m_=e(j,this.m_)};l.rotate=function(m){var H=E(m);var G=s(m);var j=[[H,G,0],[-G,H,0],[0,0,1]];this.m_=e(j,this.m_)};l.scale=function(J,I){this.arcScaleX_*=J;this.arcScaleY_*=I;var G=[[J,0,0],[0,I,0],[0,0,1]];var j=this.m_=e(G,this.m_);var H=j[0][0]*j[1][1]-j[0][1]*j[1][0];this.lineScale_=D(n(H))};l.clip=function(){};l.arcTo=function(){};l.createPattern=function(){return new g};function B(j){this.type_=j;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[]}B.prototype.addColorStop=function(m,j){j=d(j);this.colors_.push({offset:m,color:j.color,alpha:j.alpha})};function g(){}G_vmlCanvasManager=k;CanvasRenderingContext2D=q;CanvasGradient=B;CanvasPattern=g})()}if(typeof(Autocompleter)=="undefined"){Autocompleter={}}Autocompleter.Json=Class.create(Autocompleter.Base,{initialize:function(d,e,a,c){c=c||{};this.baseInitialize(d,e,c);this.lookupFunction=a;this.options.choices=c.choices||10},getUpdatedChoices:function(){this.lookupFunction(this.getToken().toLowerCase(),this.updateJsonChoices.bind(this))},updateJsonChoices:function(a){this.updateChoices("<ul>"+a.slice(0,this.options.choices).map(this.jsonChoiceToListChoice.bind(this)).join("")+"</ul>")},jsonChoiceToListChoice:function(a,c){return"<li>"+a.escapeHTML()+"</li>"}});Autocompleter.RateLimiting=function(){this.currentRequest=null;this.scheduledRequest=null};Autocompleter.RateLimiting.prototype={schedule:function(c,a,d){this.scheduledRequest={f:c,searchTerm:a,callback:d};this._sendRequest()},_sendRequest:function(){if(!this.currentRequest){this.currentRequest=this.scheduledRequest;this.scheduledRequest=null;this.currentRequest.f(this.currentRequest.searchTerm,this._callback.bind(this))}},_callback:function(a){try{this.currentRequest.callback(a)}catch(c){}this.currentRequest=null;if(this.scheduledRequest){this._sendRequest()}}};Autocompleter.Cache=Class.create({initialize:function(c,a){this.cache=new Hash();this.backendLookup=c;this.rateLimiter=new Autocompleter.RateLimiting();this.options=Object.extend({choices:10,fuzzySearch:false},a||{})},lookup:function(a,c){return this._lookupInCache(a,null,c)||this.rateLimiter.schedule(this.backendLookup,a,this._storeInCache.curry(a,c).bind(this))},_lookupInCache:function(f,c,e){c=c||f;var a=this.cache.get(c);if(!a){if(c.length>1){return this._lookupInCache(f,c.substr(0,c.length-1),e)}else{return false}}else{if(f!=c){var d=a.length>0&&a[a.length-1].more===true;a=this._localSearch(a,f);if(!d){this._storeInCache(f,null,a)}else{if(a.length<this.options.choices){return false}}}if(a.length>0&&a[a.length-1].more!==undefined){a=a.slice(0,a.length-1)}e(a.slice(0,this.options.choices));return true}},_localSearch:function(g,e){var j=new RegExp(this.options.fuzzySearch?e.gsub(/./,".*#{0}"):RegExp.escape(e),"i"),h=[];var f=null,c=null;for(var d=0,a=g.length;d<a;++d){f=g[d];if(j.test(f)){h.push(f)}}return h},_storeInCache:function(c,e,d){this.cache.set(c,d);if(e){var a=d.slice(0,this.options.choices);if(a.length>1&&a[a.length-1].more!==undefined){a=a.slice(0,a.length-1)}e(a)}}});Autocompleter.MultiValue=Class.create({options:$H({}),element:null,dataFetcher:null,createSelectedElement:function(e,d){var c=new Element("a",{className:"close"}).update("×");c.observe("click",function(f){this.removeEntry(f.element().up("li"));f.stop()}.bind(this));var a=new Element("input",{type:"hidden",name:this.name+"[]",value:e,style:"display: none;"});return new Element("li",{className:"choice",choice_id:e}).insert((""+d).escapeHTML()).insert(c).insert(a)},initialize:function(f,d,c,e){this.options=e||{};var a=$(f);this.name=a.name;this.form=a.up("form");this.dataFetcher=d;this.active=false;this.acceptNewValues=this.options.acceptNewValues||false;this.newValueChecker=this.options.newValueChecker||(function(){return true});this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||2;this.options.tabindex=this.options.tabindex||a.readAttribute("tabindex")||"";this.options.onShow=this.options.onShow||function(g,j){if(!j.style.position||j.style.position=="absolute"){j.style.position="absolute";try{j.clonePosition(g,{setHeight:false,offsetTop:g.offsetHeight})}catch(h){}}Effect.Appear(j,{duration:0.15})};this.options.onHide=this.options.onHide||function(g,h){new Effect.Fade(h,{duration:0.15})};this.searchField=new Element("input",{type:"text",autocomplete:"off",tabindex:this.options.tabindex});this.searchFieldItem=new Element("li",{className:"search_field_item"}).update(this.searchField);this.holder=new Element("ul",{className:"multi_value_field",style:a.readAttribute("style")}).update(this.searchFieldItem);a.insert({before:this.holder});a.remove();this.choicesHolderList=new Element("ul");this.choicesHolder=new Element("div",{className:"autocomplete",style:"position: absolute;"}).update(this.choicesHolderList);this.holder.insert({after:this.choicesHolder});this.choicesHolder.hide();Event.observe(this.holder,"click",Form.Element.focus.curry(this.searchField));Event.observe(this.searchField,"keydown",this.onSearchFieldKeyDown.bindAsEventListener(this));if(this.acceptNewValues){Event.observe(this.searchField,"keyup",this.onSearchFieldKeyUp.bindAsEventListener(this));Event.observe(this.searchField,"blur",this.onSearchFieldBlur.bindAsEventListener(this))}Event.observe(this.searchField,"focus",this.getUpdatedChoices.bindAsEventListener(this));Event.observe(this.searchField,"focus",this.show.bindAsEventListener(this));Event.observe(this.searchField,"blur",this.hide.bindAsEventListener(this));this.setEmptyValue();(c||[]).each(function(g){this.addEntry(this.getValue(g),this.getTitle(g))},this)},show:function(){if(!this.choicesHolderList.empty()){if(Element.getStyle(this.choicesHolder,"display")=="none"){this.options.onShow(this.holder,this.choicesHolder)}}},hide:function(){this.stopIndicator();if(Element.getStyle(this.choicesHolder,"display")!="none"){this.options.onHide(this.element,this.choicesHolder)}if(this.iefix){Element.hide(this.iefix)}},onSearchFieldKeyDown:function(c){if(this.active){switch(c.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();c.stop();case Event.KEY_ESC:this.hide();this.active=false;c.stop();return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();c.stop();return;case Event.KEY_DOWN:this.markNext();this.render();c.stop();return}}else{if(c.keyCode==Event.KEY_TAB||c.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&!c.keyCode)){return}else{if(c.keyCode==Event.KEY_BACKSPACE){if(c.element().getValue().blank()){var a=c.element().up("li.search_field_item").previous("li.choice");if(a){this.removeEntry(a)}}}}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000)},onSearchFieldKeyUp:function(a){var d="",c,e;if(a.keyCode==188||a.keyCode==32||a.keyCode==13){c=$F(a.element());e=c.length;if(a.keyCode==188){e=c.indexOf(",")}else{if(a.keyCode==32){e=c.indexOf(" ")}}d=c.substr(0,e).toLowerCase().strip()}if(!d.blank()&&this.newValueChecker(d,a)){this.addEntry(d,d);a.element().value=c.substring(e+1,c.length)}},onSearchFieldBlur:function(a){this.addNewValueFromSearchField.bind(this).delay(0.1,a.element())},addNewValueFromSearchField:function(c){var a=$F(c).strip();if(!a.blank()){this.addEntry(a,a);c.value=""}},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices()}else{this.active=false;this.hide()}},getToken:function(){return this.searchField.value.toLowerCase()},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1}},markNext:function(){if(this.index<this.entryCount-1){this.index++}else{this.index=0}},getEntry:function(a){return this.choicesHolderList.childNodes[a]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;var a=this.getCurrentEntry();this.addEntry(a.choiceId,a.textContent||a.innerText);this.searchField.clear();this.searchField.focus()},addEntry:function(d,c){c=c||d;if(!this.selectedEntries().include(""+d)){this.searchFieldItem.insert({before:this.createSelectedElement(d,c)})}var a=this.emptyValueElement();if(a){a.remove()}},removeEntry:function(a){a=Object.isElement(a)?a:this.holder.down("li[choice_id="+a+"]");if(a){a.remove();if(this.selectedEntries().length===0){this.setEmptyValue()}}},clear:function(){this.holder.select("li.choice").each(function(a){this.removeEntry(a)},this)},setEmptyValue:function(){if(!this.emptyValueElement()){this.form.insert(new Element("input",{type:"hidden",name:this.name,className:"emptyValueField"}))}},emptyValueElement:function(){return this.form.down("input.emptyValueField[name='"+this.name+"']")},selectedEntries:function(){return this.form.select("input[type=hidden][name='"+this.name+"[]']").map(function(a){return a.value})},startIndicator:function(){},stopIndicator:function(){},getUpdatedChoices:function(){this.startIndicator();var a=this.getToken();if(a.length>0){this.dataFetcher(a,this.updateChoices.curry(a).bind(this))}else{this.choicesHolderList.update()}},updateChoices:function(c,e){if(!this.changed&&this.hasFocus){this.entryCount=e.length;this.choicesHolderList.innerHTML="";e.each(function(f,g){this.choicesHolderList.insert(this.createChoiceElement(this.getValue(f),this.getTitle(f),g,c))}.bind(this));for(var a=0;a<this.entryCount;a++){var d=this.getEntry(a);d.choiceIndex=a;this.addObservers(d)}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},addObservers:function(a){Event.observe(a,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(a,"click",this.onClick.bindAsEventListener(this))},onHover:function(c){var a=Event.findElement(c,"LI");if(this.index!=a.autocompleteIndex){this.index=a.autocompleteIndex;this.render()}Event.stop(c)},onClick:function(c){var a=Event.findElement(c,"LI");this.index=a.autocompleteIndex;this.selectEntry();this.hide()},createChoiceElement:function(f,e,c,a){var d=new Element("li",{choice_id:f});d.innerHTML=(""+e).escapeHTML();d.choiceId=f;d.autocompleteIndex=c;return d},render:function(){if(this.entryCount>0){for(var a=0;a<this.entryCount;a++){var c=this.index==a?"addClassName":"removeClassName";Element[c](this.getEntry(a),"selected")}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},getTitle:function(a){return Object.isArray(a)?a[0]:a},getValue:function(a){return Object.isArray(a)?a[1]:a}});(function(y,E){function w(){var e=F.elements;return"string"==typeof e?e.split(" "):e}function B(f){var e=v[f[u]];e||(e={},C++,f[u]=C,v[C]=e);return e}function d(f,e,g){e||(e=E);if(D){return e.createElement(f)}g||(g=B(e));e=g.cache[f]?g.cache[f].cloneNode():a.test(f)?(g.cache[f]=g.createElem(f)).cloneNode():g.createElem(f);return e.canHaveChildren&&!H.test(f)?g.frag.appendChild(e):e}function G(f,e){if(!e.cache){e.cache={},e.createElem=f.createElement,e.createFrag=f.createDocumentFragment,e.frag=e.createFrag()}f.createElement=function(g){return !F.shivMethods?e.createElem(g):d(g,f,e)};f.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+w().join().replace(/\w+/g,function(g){e.createElem(g);e.frag.createElement(g);return'c("'+g+'")'})+");return n}")(F,e.frag)}function c(f){f||(f=E);var e=B(f);if(F.shivCSS&&!A&&!e.hasCSS){var h,g=f;h=g.createElement("p");g=g.getElementsByTagName("head")[0]||g.documentElement;h.innerHTML="x<style>article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}</style>";h=g.insertBefore(h.lastChild,g.firstChild);e.hasCSS=!!h}D||G(f,e);return f}var z=y.html5||{},H=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,a=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,A,u="_html5shiv",C=0,v={},D;(function(){try{var f=E.createElement("a");f.innerHTML="<xyz></xyz>";A="hidden" in f;var e;if(!(e=1==f.childNodes.length)){E.createElement("a");var h=E.createDocumentFragment();e="undefined"==typeof h.cloneNode||"undefined"==typeof h.createDocumentFragment||"undefined"==typeof h.createElement}D=e}catch(g){D=A=!0}})();var F={elements:z.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup main mark meter nav output progress section summary time video",version:"3.6.2pre",shivCSS:!1!==z.shivCSS,supportsUnknownElements:D,shivMethods:!1!==z.shivMethods,type:"default",shivDocument:c,createElement:d,createDocumentFragment:function(g,f){g||(g=E);if(D){return g.createDocumentFragment()}for(var f=f||B(g),m=f.frag.cloneNode(),l=0,k=w(),j=k.length;l<j;l++){m.createElement(k[l])}return m}};y.html5=F;c(E)})(this,document);(function(bc,aO){var aS="none",aq="LoadedContent",bd=false,aQ="resize.",aZ="y",aW="auto",a8=true,aT="click",ap="nofollow",aX="on",a1="x";function a9(d,c){d=d?' id="'+a4+d+'"':"";c=c?' style="'+c+'"':"";return bc("<div"+d+c+"/>")}function aY(d,c){c=c===a1?a0.width():a0.height();return typeof d==="string"?Math.round(d.match(/%/)?c/100*parseInt(d,10):parseInt(d,10)):d}function aj(a,c){a=bc.isFunction(a)?a.call(c):a;return be.photo||a.match(/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i)}function aa(d){for(var c in d){if(bc.isFunction(d[c])&&c.substring(0,2)!==aX){d[c]=d[c].call(a2)}}d.rel=d.rel||a2.rel||ap;d.href=d.href||bc(a2).attr("href");d.title=d.title||a2.title;return d}function aP(c,d){d&&d.call(a2);bc.event.trigger(c)}function aJ(){var h,a=a4+"Slideshow_",g,d;if(be.slideshow&&a5[1]){g=function(){aN.text(be.slideshowStop).bind(ai,function(){h=setTimeout(ba.next,be.slideshowSpeed)}).bind(ah,function(){clearTimeout(h)}).one(aT,function(){d()});a6.removeClass(a+"off").addClass(a+aX)};d=function(){clearTimeout(h);aN.text(be.slideshowStart).unbind(ai+" "+ah).one(aT,function(){g();h=setTimeout(ba.next,be.slideshowSpeed)});a6.removeClass(a+aX).addClass(a+"off")};aN.bind(aL,function(){aN.unbind();clearTimeout(h);a6.removeClass(a+"off "+a+aX)});be.slideshowAuto?g():d()}}function aH(a){if(!ao){a2=a;be=aa(bc.extend({},bc.data(a2,aV)));a5=bc(a2);a7=0;if(be.rel!==ap){a5=bc("."+aw).filter(function(){return(bc.data(this,aV).rel||this.rel)===be.rel});a7=a5.index(a2);if(a7===-1){a5=a5.add(a2);a7=a5.length-1}}if(!aR){aR=ax=a8;a6.show();ag=a2;try{ag.blur()}catch(c){}aF.css({opacity:+be.opacity,cursor:be.overlayClose?"pointer":aW}).show();be.w=aY(be.initialWidth,a1);be.h=aY(be.initialHeight,aZ);ba.position(0);af&&a0.bind(aQ+an+" scroll."+an,function(){aF.css({width:a0.width(),height:a0.height(),top:a0.scrollTop(),left:a0.scrollLeft()})}).trigger("scroll."+an);aP(ac,be.onOpen);ad.add(av).add(au).add(aN).add(aE).hide();bf.html(be.close).show()}ba.load(a8)}}var aM={transition:"elastic",speed:300,width:bd,initialWidth:"600",innerWidth:bd,maxWidth:bd,height:bd,initialHeight:"450",innerHeight:bd,maxHeight:bd,scalePhotos:a8,scrolling:a8,inline:bd,html:bd,iframe:bd,photo:bd,href:bd,title:bd,rel:bd,opacity:0.9,preloading:a8,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:bd,loop:a8,slideshow:bd,slideshowAuto:a8,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:bd,onLoad:bd,onComplete:bd,onCleanup:bd,onClosed:bd,overlayClose:a8,escKey:a8,arrowKey:a8},aV="colorbox",a4="cbox",ac=a4+"_open",ah=a4+"_load",ai=a4+"_complete",aI=a4+"_cleanup",aL=a4+"_closed",am=a4+"_purge",ae=a4+"_loaded",aB=bc.browser.msie&&!bc.support.opacity,af=aB&&bc.browser.version<7,an=a4+"_IE6",aF,a6,aA,aU,aK,aG,ak,al,a5,a0,a3,at,ar,aE,ad,aN,au,av,bf,az,ay,aD,aC,a2,ag,a7,be,aR,ax,ao=bd,ba,aw=a4+"Element";ba=bc.fn[aV]=bc[aV]=function(c,g){var f=this,h;if(!f[0]&&f.selector){return f}c=c||{};if(g){c.onComplete=g}if(!f[0]||f.selector===undefined){f=bc("<a/>");c.open=a8}f.each(function(){bc.data(this,aV,bc.extend({},bc.data(this,aV)||aM,c));bc(this).addClass(aw)});h=c.open;if(bc.isFunction(h)){h=h.call(f)}h&&aH(f[0]);return f};ba.init=function(){var c="hover",a="clear:left";a0=bc(aO);a6=a9().attr({id:aV,"class":aB?a4+"IE":""});aF=a9("Overlay",af?"position:absolute":"").hide();aA=a9("Wrapper");aU=a9("Content").append(a3=a9(aq,"width:0; height:0; overflow:hidden"),ar=a9("LoadingOverlay").add(a9("LoadingGraphic")),aE=a9("Title"),ad=a9("Current"),au=a9("Next"),av=a9("Previous"),aN=a9("Slideshow").bind(ac,aJ),bf=a9("Close"));aA.append(a9().append(a9("TopLeft"),aK=a9("TopCenter"),a9("TopRight")),a9(bd,a).append(aG=a9("MiddleLeft"),aU,ak=a9("MiddleRight")),a9(bd,a).append(a9("BottomLeft"),al=a9("BottomCenter"),a9("BottomRight"))).children().children().css({"float":"left"});at=a9(bd,"position:absolute; width:9999px; visibility:hidden; display:none");bc("body").prepend(aF,a6.append(aA,at));aU.children().hover(function(){bc(this).addClass(c)},function(){bc(this).removeClass(c)}).addClass(c);az=aK.height()+al.height()+aU.outerHeight(a8)-aU.height();ay=aG.width()+ak.width()+aU.outerWidth(a8)-aU.width();aD=a3.outerHeight(a8);aC=a3.outerWidth(a8);a6.css({"padding-bottom":az,"padding-right":ay}).hide();au.click(ba.next);av.click(ba.prev);bf.click(ba.close);aU.children().removeClass(c);bc("."+aw).live(aT,function(d){if(!(d.button!==0&&typeof d.button!=="undefined"||d.ctrlKey||d.shiftKey||d.altKey)){d.preventDefault();aH(this)}});aF.click(function(){be.overlayClose&&ba.close()});bc(document).bind("keydown",function(d){if(aR&&be.escKey&&d.keyCode===27){d.preventDefault();ba.close()}if(aR&&be.arrowKey&&!ax&&a5[1]){if(d.keyCode===37&&(a7||be.loop)){d.preventDefault();av.click()}else{if(d.keyCode===39&&(a7<a5.length-1||be.loop)){d.preventDefault();au.click()}}}})};ba.remove=function(){a6.add(aF).remove();bc("."+aw).die(aT).removeData(aV).removeClass(aw)};ba.position=function(j,m){function l(c){aK[0].style.width=al[0].style.width=aU[0].style.width=c.style.width;ar[0].style.height=ar[1].style.height=aU[0].style.height=aG[0].style.height=ak[0].style.height=c.style.height}var k,a=Math.max(document.documentElement.clientHeight-be.h-aD-az,0)/2+a0.scrollTop(),h=Math.max(a0.width()-be.w-aC-ay,0)/2+a0.scrollLeft();k=a6.width()===be.w+aC&&a6.height()===be.h+aD?0:j;aA[0].style.width=aA[0].style.height="9999px";a6.dequeue().animate({width:be.w+aC,height:be.h+aD,top:a,left:h},{duration:k,complete:function(){l(this);ax=bd;aA[0].style.width=be.w+aC+ay+"px";aA[0].style.height=be.h+aD+az+"px";m&&m()},step:function(){l(this)}})};ba.resize=function(a){if(aR){a=a||{};if(a.width){be.w=aY(a.width,a1)-aC-ay}if(a.innerWidth){be.w=aY(a.innerWidth,a1)}a3.css({width:be.w});if(a.height){be.h=aY(a.height,aZ)-aD-az}if(a.innerHeight){be.h=aY(a.innerHeight,aZ)}if(!a.innerHeight&&!a.height){a=a3.wrapInner("<div style='overflow:auto'></div>").children();be.h=a.height();a.replaceWith(a.children())}a3.css({height:be.h});ba.position(be.transition===aS?0:be.speed)}};ba.prep=function(g){var d="hidden";function a(j){var h,k,n,s,p=a5.length,l=be.loop;ba.position(j,function(){if(aR){aB&&e&&a3.fadeIn(100);a3.show();aP(ae);aE.show().html(be.title);if(p>1){ad.html(be.current.replace(/\{current\}/,a7+1).replace(/\{total\}/,p)).show();au[l||a7<p-1?"show":"hide"]().html(be.next);av[l||a7?"show":"hide"]().html(be.previous);h=a7?a5[a7-1]:a5[p-1];n=a7<p-1?a5[a7+1]:a5[0];if(be.slideshow){aN.show();a7===p-1&&!l&&a6.is("."+a4+"Slideshow_on")&&aN.click()}if(be.preloading){s=bc.data(n,aV).href||n.href;k=bc.data(h,aV).href||h.href;if(aj(s,n)){bc("<img/>")[0].src=s}if(aj(k,h)){bc("<img/>")[0].src=k}}}ar.hide();if(be.transition==="fade"){a6.fadeTo(c,1,function(){if(aB){a6[0].style.filter=bd}})}else{if(aB){a6[0].style.filter=bd}}a0.bind(aQ+a4,function(){ba.position(0)});aP(ai,be.onComplete)}})}if(aR){var e,c=be.transition===aS?0:be.speed;a0.unbind(aQ+a4);a3.remove();a3=a9(aq).html(g);a3.hide().appendTo(at.show()).css({width:function(){be.w=be.w||a3.width();be.w=be.mw&&be.mw<be.w?be.mw:be.w;return be.w}(),overflow:be.scrolling?aW:d}).css({height:function(){be.h=be.h||a3.height();be.h=be.mh&&be.mh<be.h?be.mh:be.h;return be.h}()}).prependTo(aU);at.hide();bc("#"+a4+"Photo").css({cssFloat:aS,marginLeft:aW,marginRight:aW});af&&bc("select").not(a6.find("select")).filter(function(){return this.style.visibility!==d}).css({visibility:d}).one(aI,function(){this.style.visibility="inherit"});be.transition==="fade"?a6.fadeTo(c,0,function(){a(0)}):a(c)}};ba.load=function(c){var f,a,d,e=ba.prep;ax=a8;a2=a5[a7];c||(be=aa(bc.extend({},bc.data(a2,aV))));aP(am);aP(ah,be.onLoad);be.h=be.height?aY(be.height,aZ)-aD-az:be.innerHeight&&aY(be.innerHeight,aZ);be.w=be.width?aY(be.width,a1)-aC-ay:be.innerWidth&&aY(be.innerWidth,a1);be.mw=be.w;be.mh=be.h;if(be.maxWidth){be.mw=aY(be.maxWidth,a1)-aC-ay;be.mw=be.w&&be.w<be.mw?be.w:be.mw}if(be.maxHeight){be.mh=aY(be.maxHeight,aZ)-aD-az;be.mh=be.h&&be.h<be.mh?be.h:be.mh}f=be.href;ar.show();if(be.inline){a9().hide().insertBefore(bc(f)[0]).one(am,function(){bc(this).replaceWith(a3.children())});e(bc(f))}else{if(be.iframe){a6.one(ae,function(){var g=bc("<iframe name='"+(new Date).getTime()+"' frameborder=0"+(be.scrolling?"":" scrolling='no'")+(aB?" allowtransparency='true'":"")+" style='width:100%; height:100%; border:0; display:block;'/>");g[0].src=be.href;g.appendTo(a3).one(am,function(){g[0].src="about:blank"})});e(" ")}else{if(be.html){e(be.html)}else{if(aj(f,a2)){a=new Image;a.onload=function(){var g;a.onload=null;a.id=a4+"Photo";bc(a).css({border:aS,display:"block",cssFloat:"left"});if(be.scalePhotos){d=function(){a.height-=a.height*g;a.width-=a.width*g};if(be.mw&&a.width>be.mw){g=(a.width-be.mw)/a.width;d()}if(be.mh&&a.height>be.mh){g=(a.height-be.mh)/a.height;d()}}if(be.h){a.style.marginTop=Math.max(be.h-a.height,0)/2+"px"}a5[1]&&(a7<a5.length-1||be.loop)&&bc(a).css({cursor:"pointer"}).click(ba.next);if(aB){a.style.msInterpolationMode="bicubic"}setTimeout(function(){e(a)},1)};setTimeout(function(){a.src=f},1)}else{a9().appendTo(at).load(f,function(j,h,g){e(h==="error"?"Request unsuccessful: "+g.statusText:this)})}}}}};ba.next=function(){if(!ax){a7=a7<a5.length-1?a7+1:0;ba.load()}};ba.prev=function(){if(!ax){a7=a7?a7-1:a5.length-1;ba.load()}};ba.close=function(){if(aR&&!ao){ao=a8;aR=bd;aP(aI,be.onCleanup);a0.unbind("."+a4+" ."+an);aF.fadeTo("fast",0);a6.stop().fadeTo("fast",0,function(){aP(am);a3.remove();a6.add(aF).css({opacity:1,cursor:aW}).hide();try{ag.focus()}catch(a){}setTimeout(function(){ao=bd;aP(aL,be.onClosed)},1)})}};ba.element=function(){return bc(a2)};ba.settings=aM;bc(ba.init)})(jQuery,this);
/*!
 * jQuery Cookie Plugin v1.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f,c){var a=/\+/g;function e(g){return g}function d(g){return decodeURIComponent(g.replace(a," "))}f.cookie=function(l,k,p){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(k))||k==null)){p=f.extend({},f.cookie.defaults,p);if(k==null){p.expires=-1}if(typeof p.expires==="number"){var m=p.expires,o=p.expires=new Date();o.setDate(o.getDate()+m)}k=String(k);return(c.cookie=[encodeURIComponent(l),"=",p.raw?k:encodeURIComponent(k),p.expires?"; expires="+p.expires.toUTCString():"",p.path?"; path="+p.path:"",p.domain?"; domain="+p.domain:"",p.secure?"; secure":""].join(""))}p=k||f.cookie.defaults||{};var g=p.raw?e:d;var n=c.cookie.split("; ");for(var j=0,h;(h=n[j]&&n[j].split("="));j++){if(g(h.shift())===l){return g(h.join("="))}}return null};f.cookie.defaults={}})(jQuery,document);
/*! Javascript plotting library for jQuery, v. 0.7.
 *
 * Released under the MIT license by IOLA, December 2007.
 *
 */
(function(c){c.color={};c.color.make=function(e,f,h,g){var d={};d.r=e||0;d.g=f||0;d.b=h||0;d.a=g!=null?g:1;d.add=function(j,k){for(var l=0;l<j.length;++l){d[j.charAt(l)]+=k}return d.normalize()};d.scale=function(j,k){for(var l=0;l<j.length;++l){d[j.charAt(l)]*=k}return d.normalize()};d.toString=function(){if(d.a>=1){return"rgb("+[d.r,d.g,d.b].join(",")+")"}else{return"rgba("+[d.r,d.g,d.b,d.a].join(",")+")"}};d.normalize=function(){function j(l,k,m){return k<l?l:(k>m?m:k)}d.r=j(0,parseInt(d.r),255);d.g=j(0,parseInt(d.g),255);d.b=j(0,parseInt(d.b),255);d.a=j(0,d.a,1);return d};d.clone=function(){return c.color.make(d.r,d.b,d.g,d.a)};return d.normalize()};c.color.extract=function(e,f){var d;do{d=e.css(f).toLowerCase();if(d!=""&&d!="transparent"){break}e=e.parent()}while(!c.nodeName(e.get(0),"body"));if(d=="rgba(0, 0, 0, 0)"){d="transparent"}return c.color.parse(d)};c.color.parse=function(d){var e,g=c.color.make;if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(d)){return g(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10))}if(e=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(d)){return g(parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),parseFloat(e[4]))}if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(d)){return g(parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55)}if(e=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(d)){return g(parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55,parseFloat(e[4]))}if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(d)){return g(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16))}if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(d)){return g(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16))}var f=c.trim(d).toLowerCase();if(f=="transparent"){return g(255,255,255,0)}else{e=a[f]||[0,0,0];return g(e[0],e[1],e[2])}};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(d){function c(ax,ak,L,ah){var S=[],Q={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:3},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},hooks:{}},aB=null,af=null,A=null,J=null,C=null,q=[],ay=[],r={left:0,right:0,top:0,bottom:0},I=0,K=0,j=0,y=0,am={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},at=this;at.setData=al;at.setupGrid=u;at.draw=Y;at.getPlaceholder=function(){return ax};at.getCanvas=function(){return aB};at.getPlotOffset=function(){return r};at.width=function(){return j};at.height=function(){return y};at.offset=function(){var aD=A.offset();aD.left+=r.left;aD.top+=r.top;return aD};at.getData=function(){return S};at.getAxes=function(){var aE={},aD;d.each(q.concat(ay),function(aF,aG){if(aG){aE[aG.direction+(aG.n!=1?aG.n:"")+"axis"]=aG}});return aE};at.getXAxes=function(){return q};at.getYAxes=function(){return ay};at.c2p=E;at.p2c=au;at.getOptions=function(){return Q};at.highlight=z;at.unhighlight=V;at.triggerRedrawOverlay=g;at.pointOffset=function(aD){return{left:parseInt(q[aC(aD,"x")-1].p2c(+aD.x)+r.left),top:parseInt(ay[aC(aD,"y")-1].p2c(+aD.y)+r.top)}};at.shutdown=ai;at.resize=function(){D();h(aB);h(af)};at.hooks=am;H(at);ab(L);Z();al(ak);u();Y();aj();function ap(aF,aD){aD=[at].concat(aD);for(var aE=0;aE<aF.length;++aE){aF[aE].apply(this,aD)}}function H(){for(var aD=0;aD<ah.length;++aD){var aE=ah[aD];aE.init(at);if(aE.options){d.extend(true,Q,aE.options)}}}function ab(aE){var aD;d.extend(true,Q,aE);if(Q.xaxis.color==null){Q.xaxis.color=Q.grid.color}if(Q.yaxis.color==null){Q.yaxis.color=Q.grid.color}if(Q.xaxis.tickColor==null){Q.xaxis.tickColor=Q.grid.tickColor}if(Q.yaxis.tickColor==null){Q.yaxis.tickColor=Q.grid.tickColor}if(Q.grid.borderColor==null){Q.grid.borderColor=Q.grid.color}if(Q.grid.tickColor==null){Q.grid.tickColor=d.color.parse(Q.grid.color).scale("a",0.22).toString()}for(aD=0;aD<Math.max(1,Q.xaxes.length);++aD){Q.xaxes[aD]=d.extend(true,{},Q.xaxis,Q.xaxes[aD])}for(aD=0;aD<Math.max(1,Q.yaxes.length);++aD){Q.yaxes[aD]=d.extend(true,{},Q.yaxis,Q.yaxes[aD])}if(Q.xaxis.noTicks&&Q.xaxis.ticks==null){Q.xaxis.ticks=Q.xaxis.noTicks}if(Q.yaxis.noTicks&&Q.yaxis.ticks==null){Q.yaxis.ticks=Q.yaxis.noTicks}if(Q.x2axis){Q.xaxes[1]=d.extend(true,{},Q.xaxis,Q.x2axis);Q.xaxes[1].position="top"}if(Q.y2axis){Q.yaxes[1]=d.extend(true,{},Q.yaxis,Q.y2axis);Q.yaxes[1].position="right"}if(Q.grid.coloredAreas){Q.grid.markings=Q.grid.coloredAreas}if(Q.grid.coloredAreasColor){Q.grid.markingsColor=Q.grid.coloredAreasColor}if(Q.lines){d.extend(true,Q.series.lines,Q.lines)}if(Q.points){d.extend(true,Q.series.points,Q.points)}if(Q.bars){d.extend(true,Q.series.bars,Q.bars)}if(Q.shadowSize!=null){Q.series.shadowSize=Q.shadowSize}for(aD=0;aD<Q.xaxes.length;++aD){X(q,aD+1).options=Q.xaxes[aD]}for(aD=0;aD<Q.yaxes.length;++aD){X(ay,aD+1).options=Q.yaxes[aD]}for(var aF in am){if(Q.hooks[aF]&&Q.hooks[aF].length){am[aF]=am[aF].concat(Q.hooks[aF])}}ap(am.processOptions,[Q])}function al(aD){S=aa(aD);az();B()}function aa(aG){var aE=[];for(var aD=0;aD<aG.length;++aD){var aF=d.extend(true,{},Q.series);if(aG[aD].data!=null){aF.data=aG[aD].data;delete aG[aD].data;d.extend(true,aF,aG[aD]);aG[aD].data=aF.data}else{aF.data=aG[aD]}aE.push(aF)}return aE}function aC(aE,aF){var aD=aE[aF+"axis"];if(typeof aD=="object"){aD=aD.n}if(typeof aD!="number"){aD=1}return aD}function n(){return d.grep(q.concat(ay),function(aD){return aD})}function E(aG){var aE={},aD,aF;for(aD=0;aD<q.length;++aD){aF=q[aD];if(aF&&aF.used){aE["x"+aF.n]=aF.c2p(aG.left)}}for(aD=0;aD<ay.length;++aD){aF=ay[aD];if(aF&&aF.used){aE["y"+aF.n]=aF.c2p(aG.top)}}if(aE.x1!==undefined){aE.x=aE.x1}if(aE.y1!==undefined){aE.y=aE.y1}return aE}function au(aH){var aF={},aE,aG,aD;for(aE=0;aE<q.length;++aE){aG=q[aE];if(aG&&aG.used){aD="x"+aG.n;if(aH[aD]==null&&aG.n==1){aD="x"}if(aH[aD]!=null){aF.left=aG.p2c(aH[aD]);break}}}for(aE=0;aE<ay.length;++aE){aG=ay[aE];if(aG&&aG.used){aD="y"+aG.n;if(aH[aD]==null&&aG.n==1){aD="y"}if(aH[aD]!=null){aF.top=aG.p2c(aH[aD]);break}}}return aF}function X(aE,aD){if(!aE[aD-1]){aE[aD-1]={n:aD,direction:aE==q?"x":"y",options:d.extend(true,{},aE==q?Q.xaxis:Q.yaxis)}}return aE[aD-1]}function az(){var aI;var aO=S.length,aD=[],aG=[];for(aI=0;aI<S.length;++aI){var aL=S[aI].color;if(aL!=null){--aO;if(typeof aL=="number"){aG.push(aL)}else{aD.push(d.color.parse(S[aI].color))}}}for(aI=0;aI<aG.length;++aI){aO=Math.max(aO,aG[aI]+1)}var aE=[],aH=0;aI=0;while(aE.length<aO){var aK;if(Q.colors.length==aI){aK=d.color.make(100,100,100)}else{aK=d.color.parse(Q.colors[aI])}var aF=aH%2==1?-1:1;aK.scale("rgb",1+aF*Math.ceil(aH/2)*0.2);aE.push(aK);++aI;if(aI>=Q.colors.length){aI=0;++aH}}var aJ=0,aP;for(aI=0;aI<S.length;++aI){aP=S[aI];if(aP.color==null){aP.color=aE[aJ].toString();++aJ}else{if(typeof aP.color=="number"){aP.color=aE[aP.color].toString()}}if(aP.lines.show==null){var aN,aM=true;for(aN in aP){if(aP[aN]&&aP[aN].show){aM=false;break}}if(aM){aP.lines.show=true}}aP.xaxis=X(q,aC(aP,"x"));aP.yaxis=X(ay,aC(aP,"y"))}}function B(){var aQ=Number.POSITIVE_INFINITY,aK=Number.NEGATIVE_INFINITY,aD=Number.MAX_VALUE,aW,aU,aT,aP,aF,aL,aV,aR,aJ,aI,aE,a2,aZ,aN;function aH(a5,a4,a3){if(a4<a5.datamin&&a4!=-aD){a5.datamin=a4}if(a3>a5.datamax&&a3!=aD){a5.datamax=a3}}d.each(n(),function(a3,a4){a4.datamin=aQ;a4.datamax=aK;a4.used=false});for(aW=0;aW<S.length;++aW){aL=S[aW];aL.datapoints={points:[]};ap(am.processRawData,[aL,aL.data,aL.datapoints])}for(aW=0;aW<S.length;++aW){aL=S[aW];var a1=aL.data,aY=aL.datapoints.format;if(!aY){aY=[];aY.push({x:true,number:true,required:true});aY.push({y:true,number:true,required:true});if(aL.bars.show||(aL.lines.show&&aL.lines.fill)){aY.push({y:true,number:true,required:false,defaultValue:0});if(aL.bars.horizontal){delete aY[aY.length-1].y;aY[aY.length-1].x=true}}aL.datapoints.format=aY}if(aL.datapoints.pointsize!=null){continue}aL.datapoints.pointsize=aY.length;aR=aL.datapoints.pointsize;aV=aL.datapoints.points;insertSteps=aL.lines.show&&aL.lines.steps;aL.xaxis.used=aL.yaxis.used=true;for(aU=aT=0;aU<a1.length;++aU,aT+=aR){aN=a1[aU];var aG=aN==null;if(!aG){for(aP=0;aP<aR;++aP){a2=aN[aP];aZ=aY[aP];if(aZ){if(aZ.number&&a2!=null){a2=+a2;if(isNaN(a2)){a2=null}else{if(a2==Infinity){a2=aD}else{if(a2==-Infinity){a2=-aD}}}}if(a2==null){if(aZ.required){aG=true}if(aZ.defaultValue!=null){a2=aZ.defaultValue}}}aV[aT+aP]=a2}}if(aG){for(aP=0;aP<aR;++aP){a2=aV[aT+aP];if(a2!=null){aZ=aY[aP];if(aZ.x){aH(aL.xaxis,a2,a2)}if(aZ.y){aH(aL.yaxis,a2,a2)}}aV[aT+aP]=null}}else{if(insertSteps&&aT>0&&aV[aT-aR]!=null&&aV[aT-aR]!=aV[aT]&&aV[aT-aR+1]!=aV[aT+1]){for(aP=0;aP<aR;++aP){aV[aT+aR+aP]=aV[aT+aP]}aV[aT+1]=aV[aT-aR+1];aT+=aR}}}}for(aW=0;aW<S.length;++aW){aL=S[aW];ap(am.processDatapoints,[aL,aL.datapoints])}for(aW=0;aW<S.length;++aW){aL=S[aW];aV=aL.datapoints.points,aR=aL.datapoints.pointsize;var aM=aQ,aS=aQ,aO=aK,aX=aK;for(aU=0;aU<aV.length;aU+=aR){if(aV[aU]==null){continue}for(aP=0;aP<aR;++aP){a2=aV[aU+aP];aZ=aY[aP];if(!aZ||a2==aD||a2==-aD){continue}if(aZ.x){if(a2<aM){aM=a2}if(a2>aO){aO=a2}}if(aZ.y){if(a2<aS){aS=a2}if(a2>aX){aX=a2}}}}if(aL.bars.show){var a0=aL.bars.align=="left"?0:-aL.bars.barWidth/2;if(aL.bars.horizontal){aS+=a0;aX+=a0+aL.bars.barWidth}else{aM+=a0;aO+=a0+aL.bars.barWidth}}aH(aL.xaxis,aM,aO);aH(aL.yaxis,aS,aX)}d.each(n(),function(a3,a4){if(a4.datamin==aQ){a4.datamin=null}if(a4.datamax==aK){a4.datamax=null}})}function k(aD,aE){var aF=document.createElement("canvas");aF.className=aE;aF.width=I;aF.height=K;if(!aD){d(aF).css({position:"absolute",left:0,top:0})}d(aF).appendTo(ax);if(!aF.getContext){aF=window.G_vmlCanvasManager.initElement(aF)}aF.getContext("2d").save();return aF}function D(){I=ax.width();K=ax.height();if(I<=0||K<=0){throw"Invalid dimensions for plot, width = "+I+", height = "+K}}function h(aE){if(aE.width!=I){aE.width=I}if(aE.height!=K){aE.height=K}var aD=aE.getContext("2d");aD.restore();aD.save()}function Z(){var aE,aD=ax.children("canvas.base"),aF=ax.children("canvas.overlay");if(aD.length==0||aF==0){ax.html("");ax.css({padding:0});if(ax.css("position")=="static"){ax.css("position","relative")}D();aB=k(true,"base");af=k(false,"overlay");aE=false}else{aB=aD.get(0);af=aF.get(0);aE=true}J=aB.getContext("2d");C=af.getContext("2d");A=d([af,aB]);if(aE){ax.data("plot").shutdown();at.resize();C.clearRect(0,0,I,K);A.unbind();ax.children().not([aB,af]).remove()}ax.data("plot",at)}function aj(){if(Q.grid.hoverable){A.mousemove(ac);A.mouseleave(m)}if(Q.grid.clickable){A.click(T)}ap(am.bindEvents,[A])}function ai(){if(O){clearTimeout(O)}A.unbind("mousemove",ac);A.unbind("mouseleave",m);A.unbind("click",T);ap(am.shutdown,[A])}function s(aI){function aE(aJ){return aJ}var aH,aD,aF=aI.options.transform||aE,aG=aI.options.inverseTransform;if(aI.direction=="x"){aH=aI.scale=j/Math.abs(aF(aI.max)-aF(aI.min));aD=Math.min(aF(aI.max),aF(aI.min))}else{aH=aI.scale=y/Math.abs(aF(aI.max)-aF(aI.min));aH=-aH;aD=Math.max(aF(aI.max),aF(aI.min))}if(aF==aE){aI.p2c=function(aJ){return(aJ-aD)*aH}}else{aI.p2c=function(aJ){return(aF(aJ)-aD)*aH}}if(!aG){aI.c2p=function(aJ){return aD+aJ/aH}}else{aI.c2p=function(aJ){return aG(aD+aJ/aH)}}}function N(aF){var aD=aF.options,aH,aL=aF.ticks||[],aK=[],aG,aM=aD.labelWidth,aI=aD.labelHeight,aE;function aJ(aO,aN){return d('<div style="position:absolute;top:-10000px;'+aN+'font-size:smaller"><div class="'+aF.direction+"Axis "+aF.direction+aF.n+'Axis">'+aO.join("")+"</div></div>").appendTo(ax)}if(aF.direction=="x"){if(aM==null){aM=Math.floor(I/(aL.length>0?aL.length:1))}if(aI==null){aK=[];for(aH=0;aH<aL.length;++aH){aG=aL[aH].label;if(aG){aK.push('<div class="tickLabel" style="float:left;width:'+aM+'px">'+aG+"</div>")}}if(aK.length>0){aK.push('<div style="clear:left"></div>');aE=aJ(aK,"width:10000px;");aI=aE.height();aE.remove()}}}else{if(aM==null||aI==null){for(aH=0;aH<aL.length;++aH){aG=aL[aH].label;if(aG){aK.push('<div class="tickLabel">'+aG+"</div>")}}if(aK.length>0){aE=aJ(aK,"");if(aM==null){aM=aE.children().width()}if(aI==null){aI=aE.find("div.tickLabel").height()}aE.remove()}}}if(aM==null){aM=0}if(aI==null){aI=0}aF.labelWidth=aM;aF.labelHeight=aI}function aw(aF){var aE=aF.labelWidth,aN=aF.labelHeight,aJ=aF.options.position,aH=aF.options.tickLength,aI=Q.grid.axisMargin,aL=Q.grid.labelMargin,aM=aF.direction=="x"?q:ay,aG;var aD=d.grep(aM,function(aP){return aP&&aP.options.position==aJ&&aP.reserveSpace});if(d.inArray(aF,aD)==aD.length-1){aI=0}if(aH==null){aH="full"}var aK=d.grep(aM,function(aP){return aP&&aP.reserveSpace});var aO=d.inArray(aF,aK)==0;if(!aO&&aH=="full"){aH=5}if(!isNaN(+aH)){aL+=+aH}if(aF.direction=="x"){aN+=aL;if(aJ=="bottom"){r.bottom+=aN+aI;aF.box={top:K-r.bottom,height:aN}}else{aF.box={top:r.top+aI,height:aN};r.top+=aN+aI}}else{aE+=aL;if(aJ=="left"){aF.box={left:r.left+aI,width:aE};r.left+=aE+aI}else{r.right+=aE+aI;aF.box={left:I-r.right,width:aE}}}aF.position=aJ;aF.tickLength=aH;aF.box.padding=aL;aF.innermost=aO}function W(aD){if(aD.direction=="x"){aD.box.left=r.left;aD.box.width=j}else{aD.box.top=r.top;aD.box.height=y}}function u(){var aE,aG=n();d.each(aG,function(aH,aI){aI.show=aI.options.show;if(aI.show==null){aI.show=aI.used}aI.reserveSpace=aI.show||aI.options.reserveSpace;o(aI)});allocatedAxes=d.grep(aG,function(aH){return aH.reserveSpace});r.left=r.right=r.top=r.bottom=0;if(Q.grid.show){d.each(allocatedAxes,function(aH,aI){U(aI);R(aI);ar(aI,aI.ticks);N(aI)});for(aE=allocatedAxes.length-1;aE>=0;--aE){aw(allocatedAxes[aE])}var aF=Q.grid.minBorderMargin;if(aF==null){aF=0;for(aE=0;aE<S.length;++aE){aF=Math.max(aF,S[aE].points.radius+S[aE].points.lineWidth/2)}}for(var aD in r){r[aD]+=Q.grid.borderWidth;r[aD]=Math.max(aF,r[aD])}}j=I-r.left-r.right;y=K-r.bottom-r.top;d.each(aG,function(aH,aI){s(aI)});if(Q.grid.show){d.each(allocatedAxes,function(aH,aI){W(aI)});l()}p()}function o(aG){var aH=aG.options,aF=+(aH.min!=null?aH.min:aG.datamin),aD=+(aH.max!=null?aH.max:aG.datamax),aJ=aD-aF;if(aJ==0){var aE=aD==0?1:0.01;if(aH.min==null){aF-=aE}if(aH.max==null||aH.min!=null){aD+=aE}}else{var aI=aH.autoscaleMargin;if(aI!=null){if(aH.min==null){aF-=aJ*aI;if(aF<0&&aG.datamin!=null&&aG.datamin>=0){aF=0}}if(aH.max==null){aD+=aJ*aI;if(aD>0&&aG.datamax!=null&&aG.datamax<=0){aD=0}}}}if(aH.maxFloor&&aD<aH.maxFloor){aD=aH.maxFloor}aG.min=aF;aG.max=aD}function U(aI){var aO=aI.options;var aJ;if(typeof aO.ticks=="number"&&aO.ticks>0){aJ=aO.ticks}else{aJ=0.3*Math.sqrt(aI.direction=="x"?I:K)}var aV=(aI.max-aI.min)/aJ,aQ,aD,aP,aT,aU,aS,aK;if(aO.mode=="time"){var aL={second:1000,minute:60*1000,hour:60*60*1000,day:24*60*60*1000,month:30*24*60*60*1000,year:365.2425*24*60*60*1000};var aM=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var aE=0;if(aO.minTickSize!=null){if(typeof aO.tickSize=="number"){aE=aO.tickSize}else{aE=aO.minTickSize[0]*aL[aO.minTickSize[1]]}}for(var aU=0;aU<aM.length-1;++aU){if(aV<(aM[aU][0]*aL[aM[aU][1]]+aM[aU+1][0]*aL[aM[aU+1][1]])/2&&aM[aU][0]*aL[aM[aU][1]]>=aE){break}}aQ=aM[aU][0];aP=aM[aU][1];if(aP=="year"){aS=Math.pow(10,Math.floor(Math.log(aV/aL.year)/Math.LN10));aK=(aV/aL.year)/aS;if(aK<1.5){aQ=1}else{if(aK<3){aQ=2}else{if(aK<7.5){aQ=5}else{aQ=10}}}aQ*=aS}aI.tickSize=aO.tickSize||[aQ,aP];aD=function(aZ){var a4=[],a2=aZ.tickSize[0],a5=aZ.tickSize[1],a3=new Date(aZ.min);var aY=a2*aL[a5];if(a5=="second"){a3.setUTCSeconds(a(a3.getUTCSeconds(),a2))}if(a5=="minute"){a3.setUTCMinutes(a(a3.getUTCMinutes(),a2))}if(a5=="hour"){a3.setUTCHours(a(a3.getUTCHours(),a2))}if(a5=="month"){a3.setUTCMonth(a(a3.getUTCMonth(),a2))}if(a5=="year"){a3.setUTCFullYear(a(a3.getUTCFullYear(),a2))}a3.setUTCMilliseconds(0);if(aY>=aL.minute){a3.setUTCSeconds(0)}if(aY>=aL.hour){a3.setUTCMinutes(0)}if(aY>=aL.day){a3.setUTCHours(0)}if(aY>=aL.day*4){a3.setUTCDate(1)}if(aY>=aL.year){a3.setUTCMonth(0)}var a7=0,a6=Number.NaN,a0;do{a0=a6;a6=a3.getTime();a4.push(a6);if(a5=="month"){if(a2<1){a3.setUTCDate(1);var aX=a3.getTime();a3.setUTCMonth(a3.getUTCMonth()+1);var a1=a3.getTime();a3.setTime(a6+a7*aL.hour+(a1-aX)*a2);a7=a3.getUTCHours();a3.setUTCHours(0)}else{a3.setUTCMonth(a3.getUTCMonth()+a2)}}else{if(a5=="year"){a3.setUTCFullYear(a3.getUTCFullYear()+a2)}else{a3.setTime(a6+aY)}}}while(a6<aZ.max&&a6!=a0);return a4};aT=function(aX,a0){var a2=new Date(aX);if(aO.timeformat!=null){return d.plot.formatDate(a2,aO.timeformat,aO.monthNames)}var aY=a0.tickSize[0]*aL[a0.tickSize[1]];var aZ=a0.max-a0.min;var a1=(aO.twelveHourClock)?" %p":"";if(aY<aL.minute){fmt="%h:%M:%S"+a1}else{if(aY<aL.day){if(aZ<2*aL.day){fmt="%h:%M"+a1}else{fmt="%b %d %h:%M"+a1}}else{if(aY<aL.month){fmt="%b %d"}else{if(aY<aL.year){if(aZ<aL.year){fmt="%b"}else{fmt="%b %y"}}else{fmt="%y"}}}}return d.plot.formatDate(a2,fmt,aO.monthNames)}}else{var aW=aO.tickDecimals;var aR=-Math.floor(Math.log(aV)/Math.LN10);if(aW!=null&&aR>aW){aR=aW}aS=Math.pow(10,-aR);aK=aV/aS;if(aK<1.5){aQ=1}else{if(aK<3){aQ=2;if(aK>2.25&&(aW==null||aR+1<=aW)){aQ=2.5;++aR}}else{if(aK<7.5){aQ=5}else{aQ=10}}}aQ*=aS;if(aO.minTickSize!=null&&aQ<aO.minTickSize){aQ=aO.minTickSize}aI.tickDecimals=Math.max(0,aW!=null?aW:aR);aI.tickSize=aO.tickSize||aQ;aD=function(aZ){var a1=[];var a2=a(aZ.min,aZ.tickSize),aY=0,aX=Number.NaN,a0;do{a0=aX;aX=a2+aY*aZ.tickSize;a1.push(aX);++aY}while(aX<aZ.max&&aX!=a0);return a1};aT=function(aX,aY){return aX.toFixed(aY.tickDecimals)}}if(aO.alignTicksWithAxis!=null){var aH=(aI.direction=="x"?q:ay)[aO.alignTicksWithAxis-1];if(aH&&aH.used&&aH!=aI){var aN=aD(aI);if(aN.length>0){if(aO.min==null){aI.min=Math.min(aI.min,aN[0])}if(aO.max==null&&aN.length>1){aI.max=Math.max(aI.max,aN[aN.length-1])}}aD=function(aZ){var a0=[],aX,aY;for(aY=0;aY<aH.ticks.length;++aY){aX=(aH.ticks[aY].v-aH.min)/(aH.max-aH.min);aX=aZ.min+aX*(aZ.max-aZ.min);a0.push(aX)}return a0};if(aI.mode!="time"&&aO.tickDecimals==null){var aG=Math.max(0,-Math.floor(Math.log(aV)/Math.LN10)+1),aF=aD(aI);if(!(aF.length>1&&/\..*0$/.test((aF[1]-aF[0]).toFixed(aG)))){aI.tickDecimals=aG}}}}aI.tickGenerator=aD;if(d.isFunction(aO.tickFormatter)){aI.tickFormatter=function(aX,aY){return""+aO.tickFormatter(aX,aY)}}else{aI.tickFormatter=aT}}function R(aH){var aJ=aH.options.ticks,aI=[];if(aJ==null||(typeof aJ=="number"&&aJ>0)){aI=aH.tickGenerator(aH)}else{if(aJ){if(d.isFunction(aJ)){aI=aJ({min:aH.min,max:aH.max})}else{aI=aJ}}}var aG,aD;aH.ticks=[];for(aG=0;aG<aI.length;++aG){var aE=null;var aF=aI[aG];if(typeof aF=="object"){aD=+aF[0];if(aF.length>1){aE=aF[1]}}else{aD=+aF}if(aE==null){aE=aH.tickFormatter(aD,aH)}if(!isNaN(aD)){aH.ticks.push({v:aD,label:aE})}}}function ar(aD,aE){if(aD.options.autoscaleMargin&&aE.length>0){if(aD.options.min==null){aD.min=Math.min(aD.min,aE[0].v)}if(aD.options.max==null&&aE.length>1){aD.max=Math.max(aD.max,aE[aE.length-1].v)}}}function Y(){J.clearRect(0,0,I,K);var aE=Q.grid;if(aE.show&&aE.backgroundColor){P()}if(aE.show&&!aE.aboveData){ae()}for(var aD=0;aD<S.length;++aD){ap(am.drawSeries,[J,S[aD]]);e(S[aD])}ap(am.draw,[J]);if(aE.show&&aE.aboveData){ae()}}function F(aD,aK){var aG,aJ,aI,aF,aH=n();for(i=0;i<aH.length;++i){aG=aH[i];if(aG.direction==aK){aF=aK+aG.n+"axis";if(!aD[aF]&&aG.n==1){aF=aK+"axis"}if(aD[aF]){aJ=aD[aF].from;aI=aD[aF].to;break}}}if(!aD[aF]){aG=aK=="x"?q[0]:ay[0];aJ=aD[aK+"1"];aI=aD[aK+"2"]}if(aJ!=null&&aI!=null&&aJ>aI){var aE=aJ;aJ=aI;aI=aE}return{from:aJ,to:aI,axis:aG}}function P(){J.save();J.translate(r.left,r.top);J.fillStyle=ao(Q.grid.backgroundColor,y,0,"rgba(255, 255, 255, 0)");J.fillRect(0,0,j,y);J.restore()}function ae(){var aH;J.save();J.translate(r.left,r.top);var aJ=Q.grid.markings;if(aJ){if(d.isFunction(aJ)){var aM=at.getAxes();aM.xmin=aM.xaxis.min;aM.xmax=aM.xaxis.max;aM.ymin=aM.yaxis.min;aM.ymax=aM.yaxis.max;aJ=aJ(aM)}for(aH=0;aH<aJ.length;++aH){var aF=aJ[aH],aE=F(aF,"x"),aK=F(aF,"y");if(aE.from==null){aE.from=aE.axis.min}if(aE.to==null){aE.to=aE.axis.max}if(aK.from==null){aK.from=aK.axis.min}if(aK.to==null){aK.to=aK.axis.max}if(aE.to<aE.axis.min||aE.from>aE.axis.max||aK.to<aK.axis.min||aK.from>aK.axis.max){continue}aE.from=Math.max(aE.from,aE.axis.min);aE.to=Math.min(aE.to,aE.axis.max);aK.from=Math.max(aK.from,aK.axis.min);aK.to=Math.min(aK.to,aK.axis.max);if(aE.from==aE.to&&aK.from==aK.to){continue}aE.from=aE.axis.p2c(aE.from);aE.to=aE.axis.p2c(aE.to);aK.from=aK.axis.p2c(aK.from);aK.to=aK.axis.p2c(aK.to);if(aE.from==aE.to||aK.from==aK.to){J.beginPath();J.strokeStyle=aF.color||Q.grid.markingsColor;J.lineWidth=aF.lineWidth||Q.grid.markingsLineWidth;J.moveTo(aE.from,aK.from);J.lineTo(aE.to,aK.to);J.stroke()}else{J.fillStyle=aF.color||Q.grid.markingsColor;J.fillRect(aE.from,aK.to,aE.to-aE.from,aK.from-aK.to)}}}var aM=n(),aO=Q.grid.borderWidth;for(var aG=0;aG<aM.length;++aG){var aD=aM[aG],aI=aD.box,aS=aD.tickLength,aP,aN,aR,aL;if(!aD.show||aD.ticks.length==0){continue}J.strokeStyle=aD.options.tickColor||d.color.parse(aD.options.color).scale("a",0.22).toString();J.lineWidth=1;if(aD.direction=="x"){aP=0;if(aS=="full"){aN=(aD.position=="top"?0:y)}else{aN=aI.top-r.top+(aD.position=="top"?aI.height:0)}}else{aN=0;if(aS=="full"){aP=(aD.position=="left"?0:j)}else{aP=aI.left-r.left+(aD.position=="left"?aI.width:0)}}if(!aD.innermost){J.beginPath();aR=aL=0;if(aD.direction=="x"){aR=j}else{aL=y}if(J.lineWidth==1){aP=Math.floor(aP)+0.5;aN=Math.floor(aN)+0.5}J.moveTo(aP,aN);J.lineTo(aP+aR,aN+aL);J.stroke()}J.beginPath();for(aH=0;aH<aD.ticks.length;++aH){var aQ=aD.ticks[aH].v;aR=aL=0;if(aQ<aD.min||aQ>aD.max||(aS=="full"&&aO>0&&(aQ==aD.min||aQ==aD.max))){continue}if(aD.direction=="x"){aP=aD.p2c(aQ);aL=aS=="full"?-y:aS;if(aD.position=="top"){aL=-aL}}else{aN=aD.p2c(aQ);aR=aS=="full"?-j:aS;if(aD.position=="left"){aR=-aR}}if(J.lineWidth==1){if(aD.direction=="x"){aP=Math.floor(aP)+0.5}else{aN=Math.floor(aN)+0.5}}J.moveTo(aP,aN);J.lineTo(aP+aR,aN+aL)}J.stroke()}if(aO){J.lineWidth=aO;J.strokeStyle=Q.grid.borderColor;J.strokeRect(-aO/2,-aO/2,j+aO,y+aO)}J.restore()}function l(){ax.find(".tickLabels").remove();var aI=['<div class="tickLabels" style="font-size:smaller">'];var aL=n();for(var aF=0;aF<aL.length;++aF){var aE=aL[aF],aH=aE.box;if(!aE.show){continue}aI.push('<div class="'+aE.direction+"Axis "+aE.direction+aE.n+'Axis" style="color:'+aE.options.color+'">');for(var aG=0;aG<aE.ticks.length;++aG){var aJ=aE.ticks[aG];if(!aJ.label||aJ.v<aE.min||aJ.v>aE.max){continue}var aM={},aK;if(aE.direction=="x"){aK="center";aM.left=Math.round(r.left+aE.p2c(aJ.v)-aE.labelWidth/2);if(aE.position=="bottom"){aM.top=aH.top+aH.padding}else{aM.bottom=K-(aH.top+aH.height-aH.padding)}}else{aM.top=Math.round(r.top+aE.p2c(aJ.v)-aE.labelHeight/2);if(aE.position=="left"){aM.right=I-(aH.left+aH.width-aH.padding);aK="right"}else{aM.left=aH.left+aH.padding;aK="left"}}aM.width=aE.labelWidth;var aD=["position:absolute","text-align:"+aK];for(var aN in aM){aD.push(aN+":"+aM[aN]+"px")}aI.push('<div class="tickLabel" style="'+aD.join(";")+'">'+aJ.label+"</div>")}aI.push("</div>")}aI.push("</div>");ax.append(aI.join(""))}function e(aD){if(aD.lines.show){av(aD)}if(aD.bars.show){f(aD)}if(aD.points.show){aq(aD)}}function av(aG){function aF(aR,aS,aK,aW,aV){var aX=aR.points,aL=aR.pointsize,aP=null,aO=null;J.beginPath();for(var aQ=aL;aQ<aX.length;aQ+=aL){var aN=aX[aQ-aL],aU=aX[aQ-aL+1],aM=aX[aQ],aT=aX[aQ+1];if(aN==null||aM==null){continue}if(aU<=aT&&aU<aV.min){if(aT<aV.min){continue}aN=(aV.min-aU)/(aT-aU)*(aM-aN)+aN;aU=aV.min}else{if(aT<=aU&&aT<aV.min){if(aU<aV.min){continue}aM=(aV.min-aU)/(aT-aU)*(aM-aN)+aN;aT=aV.min}}if(aU>=aT&&aU>aV.max){if(aT>aV.max){continue}aN=(aV.max-aU)/(aT-aU)*(aM-aN)+aN;aU=aV.max}else{if(aT>=aU&&aT>aV.max){if(aU>aV.max){continue}aM=(aV.max-aU)/(aT-aU)*(aM-aN)+aN;aT=aV.max}}if(aN<=aM&&aN<aW.min){if(aM<aW.min){continue}aU=(aW.min-aN)/(aM-aN)*(aT-aU)+aU;aN=aW.min}else{if(aM<=aN&&aM<aW.min){if(aN<aW.min){continue}aT=(aW.min-aN)/(aM-aN)*(aT-aU)+aU;aM=aW.min}}if(aN>=aM&&aN>aW.max){if(aM>aW.max){continue}aU=(aW.max-aN)/(aM-aN)*(aT-aU)+aU;aN=aW.max}else{if(aM>=aN&&aM>aW.max){if(aN>aW.max){continue}aT=(aW.max-aN)/(aM-aN)*(aT-aU)+aU;aM=aW.max}}if(aN!=aP||aU!=aO){J.moveTo(aW.p2c(aN)+aS,aV.p2c(aU)+aK)}aP=aM;aO=aT;J.lineTo(aW.p2c(aM)+aS,aV.p2c(aT)+aK)}J.stroke()}function aH(aK,aS,aR){var aY=aK.points,aX=aK.pointsize,aP=Math.min(Math.max(0,aR.min),aR.max),aZ=0,aW,aV=false,aO=1,aN=0,aT=0;while(true){if(aX>0&&aZ>aY.length+aX){break}aZ+=aX;var a1=aY[aZ-aX],aM=aY[aZ-aX+aO],a0=aY[aZ],aL=aY[aZ+aO];if(aV){if(aX>0&&a1!=null&&a0==null){aT=aZ;aX=-aX;aO=2;continue}if(aX<0&&aZ==aN+aX){J.fill();aV=false;aX=-aX;aO=1;aZ=aN=aT+aX;continue}}if(a1==null||a0==null){continue}if(a1<=a0&&a1<aS.min){if(a0<aS.min){continue}aM=(aS.min-a1)/(a0-a1)*(aL-aM)+aM;a1=aS.min}else{if(a0<=a1&&a0<aS.min){if(a1<aS.min){continue}aL=(aS.min-a1)/(a0-a1)*(aL-aM)+aM;a0=aS.min}}if(a1>=a0&&a1>aS.max){if(a0>aS.max){continue}aM=(aS.max-a1)/(a0-a1)*(aL-aM)+aM;a1=aS.max}else{if(a0>=a1&&a0>aS.max){if(a1>aS.max){continue}aL=(aS.max-a1)/(a0-a1)*(aL-aM)+aM;a0=aS.max}}if(!aV){J.beginPath();J.moveTo(aS.p2c(a1),aR.p2c(aP));aV=true}if(aM>=aR.max&&aL>=aR.max){J.lineTo(aS.p2c(a1),aR.p2c(aR.max));J.lineTo(aS.p2c(a0),aR.p2c(aR.max));continue}else{if(aM<=aR.min&&aL<=aR.min){J.lineTo(aS.p2c(a1),aR.p2c(aR.min));J.lineTo(aS.p2c(a0),aR.p2c(aR.min));continue}}var aQ=a1,aU=a0;if(aM<=aL&&aM<aR.min&&aL>=aR.min){a1=(aR.min-aM)/(aL-aM)*(a0-a1)+a1;aM=aR.min}else{if(aL<=aM&&aL<aR.min&&aM>=aR.min){a0=(aR.min-aM)/(aL-aM)*(a0-a1)+a1;aL=aR.min}}if(aM>=aL&&aM>aR.max&&aL<=aR.max){a1=(aR.max-aM)/(aL-aM)*(a0-a1)+a1;aM=aR.max}else{if(aL>=aM&&aL>aR.max&&aM<=aR.max){a0=(aR.max-aM)/(aL-aM)*(a0-a1)+a1;aL=aR.max}}if(a1!=aQ){J.lineTo(aS.p2c(aQ),aR.p2c(aM))}J.lineTo(aS.p2c(a1),aR.p2c(aM));J.lineTo(aS.p2c(a0),aR.p2c(aL));if(a0!=aU){J.lineTo(aS.p2c(a0),aR.p2c(aL));J.lineTo(aS.p2c(aU),aR.p2c(aL))}}}J.save();J.translate(r.left,r.top);J.lineJoin="round";var aI=aG.lines.lineWidth,aD=aG.shadowSize;if(aI>0&&aD>0){J.lineWidth=aD;J.strokeStyle="rgba(0,0,0,0.1)";var aJ=Math.PI/18;aF(aG.datapoints,Math.sin(aJ)*(aI/2+aD/2),Math.cos(aJ)*(aI/2+aD/2),aG.xaxis,aG.yaxis);J.lineWidth=aD/2;aF(aG.datapoints,Math.sin(aJ)*(aI/2+aD/4),Math.cos(aJ)*(aI/2+aD/4),aG.xaxis,aG.yaxis)}J.lineWidth=aI;J.strokeStyle=aG.color;var aE=ag(aG.lines,aG.color,0,y);if(aE){J.fillStyle=aE;aH(aG.datapoints,aG.xaxis,aG.yaxis)}if(aI>0){aF(aG.datapoints,0,0,aG.xaxis,aG.yaxis)}J.restore()}function aq(aG){function aJ(aP,aO,aW,aM,aU,aV,aS,aL){var aT=aP.points,aK=aP.pointsize;for(var aN=0;aN<aT.length;aN+=aK){var aR=aT[aN],aQ=aT[aN+1];if(aR==null||aR<aV.min||aR>aV.max||aQ<aS.min||aQ>aS.max){continue}J.beginPath();aR=aV.p2c(aR);aQ=aS.p2c(aQ)+aM;if(aL=="circle"){J.arc(aR,aQ,aO,0,aU?Math.PI:Math.PI*2,false)}else{aL(J,aR,aQ,aO,aU)}J.closePath();if(aW){J.fillStyle=aW;J.fill()}J.stroke()}}J.save();J.translate(r.left,r.top);var aI=aG.points.lineWidth,aE=aG.shadowSize,aD=aG.points.radius,aH=aG.points.symbol;if(aI>0&&aE>0){var aF=aE/2;J.lineWidth=aF;J.strokeStyle="rgba(0,0,0,0.1)";aJ(aG.datapoints,aD,null,aF+aF/2,true,aG.xaxis,aG.yaxis,aH);J.strokeStyle="rgba(0,0,0,0.2)";aJ(aG.datapoints,aD,null,aF/2,true,aG.xaxis,aG.yaxis,aH)}J.lineWidth=aI;J.strokeStyle=aG.color;aJ(aG.datapoints,aD,ag(aG.points,aG.color),0,false,aG.xaxis,aG.yaxis,aH);J.restore()}function G(aP,aO,aX,aK,aS,aH,aF,aN,aM,aW,aT,aE){var aG,aV,aL,aR,aI,aD,aQ,aJ,aU;if(aT){aJ=aD=aQ=true;aI=false;aG=aX;aV=aP;aR=aO+aK;aL=aO+aS;if(aV<aG){aU=aV;aV=aG;aG=aU;aI=true;aD=false}}else{aI=aD=aQ=true;aJ=false;aG=aP+aK;aV=aP+aS;aL=aX;aR=aO;if(aR<aL){aU=aR;aR=aL;aL=aU;aJ=true;aQ=false}}if(aV<aN.min||aG>aN.max||aR<aM.min||aL>aM.max){return}if(aG<aN.min){aG=aN.min;aI=false}if(aV>aN.max){aV=aN.max;aD=false}if(aL<aM.min){aL=aM.min;aJ=false}if(aR>aM.max){aR=aM.max;aQ=false}aG=aN.p2c(aG);aL=aM.p2c(aL);aV=aN.p2c(aV);aR=aM.p2c(aR);if(aF){aW.beginPath();aW.moveTo(aG,aL);aW.lineTo(aG,aR);aW.lineTo(aV,aR);aW.lineTo(aV,aL);aW.fillStyle=aF(aL,aR);aW.fill()}if(aE>0&&(aI||aD||aQ||aJ)){aW.beginPath();aW.moveTo(aG,aL+aH);if(aI){aW.lineTo(aG,aR+aH)}else{aW.moveTo(aG,aR+aH)}if(aQ){aW.lineTo(aV,aR+aH)}else{aW.moveTo(aV,aR+aH)}if(aD){aW.lineTo(aV,aL+aH)}else{aW.moveTo(aV,aL+aH)}if(aJ){aW.lineTo(aG,aL+aH)}else{aW.moveTo(aG,aL+aH)}aW.stroke()}}function f(aF){function aE(aL,aK,aN,aI,aM,aP,aO){var aQ=aL.points,aH=aL.pointsize;for(var aJ=0;aJ<aQ.length;aJ+=aH){if(aQ[aJ]==null){continue}G(aQ[aJ],aQ[aJ+1],aQ[aJ+2],aK,aN,aI,aM,aP,aO,J,aF.bars.horizontal,aF.bars.lineWidth)}}J.save();J.translate(r.left,r.top);J.lineWidth=aF.bars.lineWidth;J.strokeStyle=aF.color;var aD=aF.bars.align=="left"?0:-aF.bars.barWidth/2;var aG=aF.bars.fill?function(aH,aI){return ag(aF.bars,aF.color,aH,aI)}:null;aE(aF.datapoints,aD,aD+aF.bars.barWidth,0,aG,aF.xaxis,aF.yaxis);J.restore()}function ag(aF,aD,aE,aH){var aG=aF.fill;if(!aG){return null}if(aF.fillColor){return ao(aF.fillColor,aE,aH,aD)}var aI=d.color.parse(aD);aI.a=typeof aG=="number"?aG:0.4;aI.normalize();return aI.toString()}function p(){ax.find(".legend").remove();if(!Q.legend.show){return}var aJ=[],aH=false,aP=Q.legend.labelFormatter,aO,aL;for(var aG=0;aG<S.length;++aG){aO=S[aG];aL=aO.label;if(!aL){continue}if(aG%Q.legend.noColumns==0){if(aH){aJ.push("</tr>")}aJ.push("<tr>");aH=true}if(aP){aL=aP(aL,aO)}aJ.push('<td class="legendColorBox"><div style="border:1px solid '+Q.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+aO.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+aL+"</td>")}if(aH){aJ.push("</tr>")}if(aJ.length==0){return}var aN='<table style="font-size:smaller;color:'+Q.grid.color+'">'+aJ.join("")+"</table>";if(Q.legend.container!=null){d(Q.legend.container).html(aN)}else{var aK="",aE=Q.legend.position,aF=Q.legend.margin;if(aF[0]==null){aF=[aF,aF]}if(aE.charAt(0)=="n"){aK+="top:"+(aF[1]+r.top)+"px;"}else{if(aE.charAt(0)=="s"){aK+="bottom:"+(aF[1]+r.bottom)+"px;"}}if(aE.charAt(1)=="e"){aK+="right:"+(aF[0]+r.right)+"px;"}else{if(aE.charAt(1)=="w"){aK+="left:"+(aF[0]+r.left)+"px;"}}var aM=d('<div class="legend">'+aN.replace('style="','style="position:absolute;'+aK+";")+"</div>").appendTo(ax);if(Q.legend.backgroundOpacity!=0){var aI=Q.legend.backgroundColor;if(aI==null){aI=Q.grid.backgroundColor;if(aI&&typeof aI=="string"){aI=d.color.parse(aI)}else{aI=d.color.extract(aM,"background-color")}aI.a=1;aI=aI.toString()}var aD=aM.children();d('<div style="position:absolute;width:'+aD.width()+"px;height:"+aD.height()+"px;"+aK+"background-color:"+aI+';"> </div>').prependTo(aM).css("opacity",Q.legend.backgroundOpacity)}}}var ad=[],O=null;function M(aK,aI,aF){var aQ=Q.grid.mouseActiveRadius,a2=aQ*aQ+1,a0=null,aT=false,aY,aW;for(aY=S.length-1;aY>=0;--aY){if(!aF(S[aY])){continue}var aR=S[aY],aJ=aR.xaxis,aH=aR.yaxis,aX=aR.datapoints.points,aV=aR.datapoints.pointsize,aS=aJ.c2p(aK),aP=aH.c2p(aI),aE=aQ/aJ.scale,aD=aQ/aH.scale;if(aJ.options.inverseTransform){aE=Number.MAX_VALUE}if(aH.options.inverseTransform){aD=Number.MAX_VALUE}if(aR.lines.show||aR.points.show){for(aW=0;aW<aX.length;aW+=aV){var aM=aX[aW],aL=aX[aW+1];if(aM==null){continue}if(aM-aS>aE||aM-aS<-aE||aL-aP>aD||aL-aP<-aD){continue}var aO=Math.abs(aJ.p2c(aM)-aK),aN=Math.abs(aH.p2c(aL)-aI),aU=aO*aO+aN*aN;if(aU<a2){a2=aU;a0=[aY,aW/aV]}}}if(aR.bars.show&&!a0){var aG=aR.bars.align=="left"?0:-aR.bars.barWidth/2,aZ=aG+aR.bars.barWidth;for(aW=0;aW<aX.length;aW+=aV){var aM=aX[aW],aL=aX[aW+1],a1=aX[aW+2];if(aM==null){continue}if(S[aY].bars.horizontal?(aS<=Math.max(a1,aM)&&aS>=Math.min(a1,aM)&&aP>=aL+aG&&aP<=aL+aZ):(aS>=aM+aG&&aS<=aM+aZ&&aP>=Math.min(a1,aL)&&aP<=Math.max(a1,aL))){a0=[aY,aW/aV]}}}}if(a0){aY=a0[0];aW=a0[1];aV=S[aY].datapoints.pointsize;return{datapoint:S[aY].datapoints.points.slice(aW*aV,(aW+1)*aV),dataIndex:aW,series:S[aY],seriesIndex:aY}}return null}function ac(aD){if(Q.grid.hoverable){v("plothover",aD,function(aE){return aE.hoverable!=false})}}function m(aD){if(Q.grid.hoverable){v("plothover",aD,function(aE){return false})}}function T(aD){v("plotclick",aD,function(aE){return aE.clickable!=false})}function v(aE,aD,aF){var aG=A.offset(),aJ=aD.pageX-aG.left-r.left,aH=aD.pageY-aG.top-r.top,aL=E({left:aJ,top:aH});aL.pageX=aD.pageX;aL.pageY=aD.pageY;var aM=M(aJ,aH,aF);if(aM){aM.pageX=parseInt(aM.series.xaxis.p2c(aM.datapoint[0])+aG.left+r.left);aM.pageY=parseInt(aM.series.yaxis.p2c(aM.datapoint[1])+aG.top+r.top)}if(Q.grid.autoHighlight){for(var aI=0;aI<ad.length;++aI){var aK=ad[aI];if(aK.auto==aE&&!(aM&&aK.series==aM.series&&aK.point[0]==aM.datapoint[0]&&aK.point[1]==aM.datapoint[1])){V(aK.series,aK.point)}}if(aM){z(aM.series,aM.datapoint,aE)}}ax.trigger(aE,[aL,aM])}function g(){if(!O){O=setTimeout(t,30)}}function t(){O=null;C.save();C.clearRect(0,0,I,K);C.translate(r.left,r.top);var aE,aD;for(aE=0;aE<ad.length;++aE){aD=ad[aE];if(aD.series.bars.show){w(aD.series,aD.point)}else{aA(aD.series,aD.point)}}C.restore();ap(am.drawOverlay,[C])}function z(aF,aD,aH){if(typeof aF=="number"){aF=S[aF]}if(typeof aD=="number"){var aG=aF.datapoints.pointsize;aD=aF.datapoints.points.slice(aG*aD,aG*(aD+1))}var aE=an(aF,aD);if(aE==-1){ad.push({series:aF,point:aD,auto:aH});g()}else{if(!aH){ad[aE].auto=false}}}function V(aF,aD){if(aF==null&&aD==null){ad=[];g()}if(typeof aF=="number"){aF=S[aF]}if(typeof aD=="number"){aD=aF.data[aD]}var aE=an(aF,aD);if(aE!=-1){ad.splice(aE,1);g()}}function an(aF,aG){for(var aD=0;aD<ad.length;++aD){var aE=ad[aD];if(aE.series==aF&&aE.point[0]==aG[0]&&aE.point[1]==aG[1]){return aD}}return -1}function aA(aG,aF){var aE=aF[0],aK=aF[1],aJ=aG.xaxis,aI=aG.yaxis;if(aE<aJ.min||aE>aJ.max||aK<aI.min||aK>aI.max){return}var aH=aG.points.radius+aG.points.lineWidth/2;C.lineWidth=aH;C.strokeStyle=d.color.parse(aG.color).scale("a",0.5).toString();var aD=1.5*aH,aE=aJ.p2c(aE),aK=aI.p2c(aK);C.beginPath();if(aG.points.symbol=="circle"){C.arc(aE,aK,aD,0,2*Math.PI,false)}else{aG.points.symbol(C,aE,aK,aD,false)}C.closePath();C.stroke()}function w(aG,aD){C.lineWidth=aG.bars.lineWidth;C.strokeStyle=d.color.parse(aG.color).scale("a",0.5).toString();var aF=d.color.parse(aG.color).scale("a",0.5).toString();var aE=aG.bars.align=="left"?0:-aG.bars.barWidth/2;G(aD[0],aD[1],aD[2]||0,aE,aE+aG.bars.barWidth,0,function(){return aF},aG.xaxis,aG.yaxis,C,aG.bars.horizontal,aG.bars.lineWidth)}function ao(aL,aD,aJ,aE){if(typeof aL=="string"){return aL}else{var aK=J.createLinearGradient(0,aJ,0,aD);for(var aG=0,aF=aL.colors.length;aG<aF;++aG){var aH=aL.colors[aG];if(typeof aH!="string"){var aI=d.color.parse(aE);if(aH.brightness!=null){aI=aI.scale("rgb",aH.brightness)}if(aH.opacity!=null){aI.a*=aH.opacity}aH=aI.toString()}aK.addColorStop(aG/(aF-1),aH)}return aK}}}d.plot=function(h,f,e){var g=new c(d(h),f,e,d.plot.plugins);return g};d.plot.version="0.7";d.plot.plugins=[];d.plot.formatDate=function(l,f,h){var o=function(q){q=""+q;return q.length==1?"0"+q:q};var e=[];var p=false,j=false;var n=l.getUTCHours();var k=n<12;if(h==null){h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(f.search(/%p|%P/)!=-1){if(n>12){n=n-12}else{if(n==0){n=12}}}for(var g=0;g<f.length;++g){var m=f.charAt(g);if(p){switch(m){case"h":m=""+n;break;case"H":m=o(n);break;case"M":m=o(l.getUTCMinutes());break;case"S":m=o(l.getUTCSeconds());break;case"d":m=""+l.getUTCDate();break;case"m":m=""+(l.getUTCMonth()+1);break;case"y":m=""+l.getUTCFullYear();break;case"b":m=""+h[l.getUTCMonth()];break;case"p":m=(k)?("am"):("pm");break;case"P":m=(k)?("AM"):("PM");break;case"0":m="";j=true;break}if(m&&j){m=o(m);j=false}e.push(m);if(!j){p=false}}else{if(m=="%"){p=true}else{e.push(m)}}}return e.join("")};function a(f,e){return e*Math.floor(f/e)}})(jQuery);(function(a){a.fn.forceRedraw=function(c){a(this).addClass("forceRedraw").removeClass("forceRedraw");if(c){var d=a(this).css("padding-left");var e=parseInt(d,10);a(this).css("padding-left",++e);window.setTimeout(a.proxy(function(){a(this).css("padding-left",d)},this),1)}}})(jQuery);(function(e){var g={put:function(j,h){(h||window).location.hash=this.encoder(j)},get:function(k){var j=((k||window).location.hash).replace(/^#/,"");try{return e.browser.mozilla?j:decodeURIComponent(j)}catch(h){return j}},encoder:encodeURIComponent};var d={id:"__jQuery_history",init:function(){var h='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';e("body").prepend(h);return this},_document:function(){return e("#"+this.id)[0].contentWindow.document},put:function(j){var h=this._document();h.open();h.close();g.put(j,h)},get:function(){return g.get(this._document())}};function f(j){j=e.extend({unescape:false},j||{});g.encoder=k(j.unescape);function k(l){if(l===true){return function(m){return m}}if(typeof l=="string"&&(l=h(l.split("")))||typeof l=="function"){return function(m){return l(encodeURIComponent(m))}}return encodeURIComponent}function h(m){var l=new RegExp(e.map(m,encodeURIComponent).join("|"),"ig");return function(n){return n.replace(l,decodeURIComponent)}}}var c={};c.base={callback:undefined,type:undefined,check:function(){},load:function(h){},init:function(j,h){f(h);a.callback=j;a._options=h;a._init()},_init:function(){},_options:{}};c.timer={_appState:undefined,_init:function(){var h=g.get();a._appState=h;a.callback(h);setInterval(a.check,100)},check:function(){var h=g.get();if(h!=a._appState){a._appState=h;a.callback(h)}},load:function(h){if(h!=a._appState){g.put(h);a._appState=h;a.callback(h)}}};c.iframeTimer={_appState:undefined,_init:function(){var h=g.get();a._appState=h;d.init().put(h);a.callback(h);setInterval(a.check,100)},check:function(){var j=d.get(),h=g.get();if(h!=j){if(h==a._appState){a._appState=j;g.put(j);a.callback(j)}else{a._appState=h;d.put(h);a.callback(h)}}},load:function(h){if(h!=a._appState){g.put(h);d.put(h);a._appState=h;a.callback(h)}}};c.hashchangeEvent={_init:function(){a.callback(g.get());e(window).bind("hashchange",a.check)},check:function(){a.callback(g.get())},load:function(h){g.put(h)}};var a=e.extend({},c.base);if(e.browser.msie&&(e.browser.version<8||document.documentMode<8)){a.type="iframeTimer"}else{if("onhashchange" in window){a.type="hashchangeEvent"}else{a.type="timer"}}e.extend(a,c[a.type]);e.history=a})(jQuery);(function(c){c.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function a(e){if(typeof e.data!=="string"){return}var d=e.handler,f=e.data.toLowerCase().split(" ");e.handler=function(o){if(this!==o.target&&(/textarea|select/i.test(o.target.nodeName)||o.target.type==="text")){return}var j=o.type!=="keypress"&&c.hotkeys.specialKeys[o.which],p=String.fromCharCode(o.which).toLowerCase(),m,n="",h={};if(o.altKey&&j!=="alt"){n+="alt+"}if(o.ctrlKey&&j!=="ctrl"){n+="ctrl+"}if(o.metaKey&&!o.ctrlKey&&j!=="meta"){n+="meta+"}if(o.shiftKey&&j!=="shift"){n+="shift+"}if(j){h[n+j]=true}else{h[n+p]=true;h[n+c.hotkeys.shiftNums[p]]=true;if(n==="shift+"){h[c.hotkeys.shiftNums[p]]=true}}for(var k=0,g=f.length;k<g;k++){if(h[f[k]]){return d.apply(this,arguments)}}}}c.each(["keydown","keyup","keypress"],function(){c.event.special[this]={add:a}})})(jQuery);
/*!
 * jQuery idleTimer plugin
 * version 0.9.100511
 * by Paul Irish. 
 *   http://github.com/paulirish/yui-misc/tree/
 * MIT license

 * adapted from YUI idle timer by nzakas:
 *   http://github.com/nzakas/yui-misc/
*/
(function(a){a.idleTimer=function(l,d){var e=false,h=true,j=30000,m="mousemove keydown DOMMouseScroll mousewheel mousedown";d=d||document;var g=function(p){if(typeof p=="number"){p=undefined}var o=a.data(p||d,"idleTimerObj");o.idle=!o.idle;o.olddate=+new Date;var n=jQuery.Event(a.data(d,"idleTimer",o.idle?"idle":"active")+".idleTimer");n.stopPropagation();a(d).trigger(n)},k=function(n){var o=a.data(n,"idleTimerObj");o.enabled=false;clearTimeout(o.tId);a(n).unbind(".idleTimer")},c=function(){var n=a.data(this,"idleTimerObj");clearTimeout(n.tId);if(n.enabled){if(n.idle){g(this)}n.tId=setTimeout(g,n.timeout)}};var f=a.data(d,"idleTimerObj")||new function(){};f.olddate=f.olddate||+new Date;if(typeof l=="number"){j=l}else{if(l==="destroy"){k(d);return this}else{if(l==="getElapsedTime"){return(+new Date)-f.olddate}}}a(d).bind(a.trim((m+" ").split(" ").join(".idleTimer ")),c);f.idle=e;f.enabled=h;f.timeout=j;f.tId=setTimeout(g,f.timeout);a.data(d,"idleTimer","active");a.data(d,"idleTimerObj",f)};a.fn.idleTimer=function(c){this[0]&&a.idleTimer(c,this[0]);return this}})(jQuery);jQuery.fn.extend({insertAtCaret:function(a){return this.each(function(e){if(document.selection){this.focus();sel=document.selection.createRange();sel.text=a;this.focus()}else{if(this.selectionStart||this.selectionStart=="0"){var d=this.selectionStart;var c=this.selectionEnd;var f=this.scrollTop;this.value=this.value.substring(0,d)+a+this.value.substring(c,this.value.length);this.focus();this.selectionStart=d+a.length;this.selectionEnd=d+a.length;this.scrollTop=f}else{this.value+=a;this.focus()}}})}});(function(c){var a=function(){var d=function(){};d.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(h,g,f,j){if(!j){this.context=g;this.buffer=[]}if(!this.includes("",h)){if(j){return h}else{this.send(h);return}}h=this.render_pragmas(h);var e=this.render_section(h,g,f);if(j){return this.render_tags(e,g,f,j)}this.render_tags(e,g,f,j)},send:function(e){if(e!==""){this.buffer.push(e)}},render_pragmas:function(e){if(!this.includes("%",e)){return e}var g=this;var f=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag,"g");return e.replace(f,function(k,h,j){if(!g.pragmas_implemented[h]){throw ({message:"This implementation of mustache doesn't understand the '"+h+"' pragma"})}g.pragmas[h]={};if(j){var l=j.split("=");g.pragmas[h][l[0]]=l[1]}return""})},render_partial:function(e,g,f){e=this.trim(e);if(!f||f[e]===undefined){throw ({message:"unknown_partial '"+e+"'"})}if(typeof(g[e])!="object"){return this.render(f[e],g,f,true)}return this.render(f[e],g[e],f,true)},render_section:function(g,f,e){if(!this.includes("#",g)&&!this.includes("^",g)){return g}var j=this;var h=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return g.replace(h,function(l,m,k,n){var o=j.find(k,f);if(m=="^"){if(!o||j.is_array(o)&&o.length===0){return j.render(n,f,e,true)}else{return""}}else{if(m=="#"){if(j.is_array(o)){return j.map(o,function(p){return j.render(n,j.create_context(p),e,true)}).join("")}else{if(j.is_object(o)){return j.render(n,j.create_context(o),e,true)}else{if(typeof o==="function"){return o.call(f,n,function(p){return j.render(p,f,e,true)})}else{if(o){return j.render(n,f,e,true)}else{return""}}}}}}})},render_tags:function(n,e,g,j){var h=this;var m=function(){return new RegExp(h.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+h.ctag+"+","g")};var k=m();var l=function(r,p,q){switch(p){case"!":return"";case"=":h.set_delimiters(q);k=m();return"";case">":return h.render_partial(q,e,g);case"{":return h.find(q,e);default:return h.escape(h.find(q,e))}};var o=n.split("\n");for(var f=0;f<o.length;f++){o[f]=o[f].replace(k,l,this);if(!j){this.send(o[f])}}if(j){return o.join("\n")}},set_delimiters:function(f){var e=f.split(" ");this.otag=this.escape_regex(e[0]);this.ctag=this.escape_regex(e[1])},escape_regex:function(f){if(!arguments.callee.sRE){var e=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+e.join("|\\")+")","g")}return f.replace(arguments.callee.sRE,"\\$1")},find:function(f,g){f=this.trim(f);function e(j){return j===false||j===0||j}var h;if(e(g[f])){h=g[f]}else{if(e(this.context[f])){h=this.context[f]}}if(typeof h==="function"){return h.apply(g)}if(h!==undefined){return h}return""},includes:function(f,e){return e.indexOf(this.otag+f)!=-1},escape:function(e){e=String(e===null?"":e);return e.replace(/&(?!\w+;)|["'<>\\]/g,function(f){switch(f){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return f}})},create_context:function(f){if(this.is_object(f)){return f}else{var g=".";if(this.pragmas["IMPLICIT-ITERATOR"]){g=this.pragmas["IMPLICIT-ITERATOR"].iterator}var e={};e[g]=f;return e}},is_object:function(e){return e&&typeof e=="object"},is_array:function(e){return Object.prototype.toString.call(e)==="[object Array]"},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(j,g){if(typeof j.map=="function"){return j.map(g)}else{var h=[];var e=j.length;for(var f=0;f<e;f++){h.push(g(j[f]))}return h}}};return({name:"mustache.js",version:"0.3.1-dev",to_html:function(g,e,f,j){var h=new d();if(j){h.send=j}h.render(g,e,f);if(!j){return h.buffer.join("\n")}}})}();c.mustache=function(f,d,e){return a.to_html(f,d,e)}})(jQuery);(function(a){jQuery.fn.observe_field=function(c,d){c=c*1000;return this.each(function(){var j=a(this);var h=j.val();var e=function(){var k=j.val();if(h!=k){h=k;j.map(d)}};var g=function(){if(f){clearInterval(f);f=setInterval(e,c)}};e();var f=setInterval(e,c);j.bind("keyup click mousemove",g)})}})(jQuery);(function(c){function a(d){this.input=d;d.data(a.DATA_ATTRIBUTE,this);if(d.attr("type")=="password"){this.handlePassword()}c(d[0].form).submit(function(){if(d.hasClass("placeholder")){d.val("")}})}a.DATA_ATTRIBUTE="jquery.placeholder";a.NATIVE_SUPPORT=!!("placeholder" in document.createElement("input"));a.prototype={show:function(f){if(this.input.val()===""||(f&&this.valueIsPlaceholder())){if(this.isPassword){try{this.input[0].setAttribute("type","text")}catch(d){this.input.before(this.fakePassword.show()).hide()}}this.input.val(this.input.attr("placeholder"));this.input.addClass("placeholder")}},hide:function(){if(this.valueIsPlaceholder()&&this.input.hasClass("placeholder")){this.input.removeClass("placeholder");this.input.val("");if(this.isPassword){try{this.input[0].setAttribute("type","password")}catch(d){}this.input.show();this.input[0].focus()}}},valueIsPlaceholder:function(){return this.input[0].value==this.input.attr("placeholder")},handlePassword:function(){var d=this.input;d.attr("realType","password");this.isPassword=true;if(c.browser.msie&&d[0].outerHTML){var e=d[0].outerHTML.replace(/type=(['"])?password\1/gi,"type=$1text$1");this.fakePassword=c(e).val(d.attr("placeholder")).addClass("placeholder").focus(function(){d.trigger("focus");c(this).hide()})}}};c.fn.placeholder=function(){return a.NATIVE_SUPPORT?this:this.each(function(){var d=c(this);var e=new a(d);e.show(true);d.focus(function(){e.hide()});d.blur(function(){e.show(false)});if(c.browser.msie){c(window).load(function(){if(d.val()){d.removeClass("placeholder")}e.show(true)});d.focus(function(){if(c(this).val()===""){var f=this.createTextRange();f.collapse(true);f.moveStart("character",0);f.select()}})}})};c.fn.resetPlaceholder=function(){return a.NATIVE_SUPPORT?this:this.each(function(){var d=c(this).data(a.DATA_ATTRIBUTE);if(d){d.hide();d.show()}})}})(jQuery);jQuery.extend({queryParameters:function(){var a={},h=(document.location.search||"").slice(1),g=h.split("&"),e,d,f;for(var c=0;c<g.length;c++){e=g[c].split("=");d=e[0];f=decodeURIComponent((e[1]||"").replace(/\+/g," "));a[d]=f}return a}});jQuery.fn.sortElements=(function(){var a=[].sort;return function(d,e){e=e||function(){return this};var c=this.map(function(){var g=e.call(this),f=g.parentNode,h=f.insertBefore(document.createTextNode(""),g.nextSibling);return function(){if(f===this){throw new Error("You can't sort elements if any one is a descendant of another.")}f.insertBefore(this,h);f.removeChild(h)}});return a.call(this,d).each(function(f){c[f].call(e.call(this))})}})();(function(e){e.timeago=function(h){if(h instanceof Date){return a(h)}else{if(typeof h==="string"){return a(e.timeago.parse(h))}else{return a(e.timeago.datetime(h))}}};var g=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:I18n.t("txt.vendor.jquery.timeago.less_than_a_minute"),minute:I18n.t("txt.vendor.jquery.timeago.about_a_minute"),minutes:I18n.t("txt.vendor.jquery.timeago.minutes"),hour:I18n.t("txt.vendor.jquery.timeago.about_an_hour"),hours:I18n.t("txt.vendor.jquery.timeago.about_hours"),day:I18n.t("txt.vendor.jquery.timeago.a_day"),days:I18n.t("txt.vendor.jquery.timeago.days"),month:I18n.t("txt.vendor.jquery.timeago.about_a_month"),months:I18n.t("txt.vendor.jquery.timeago.months"),year:I18n.t("txt.vendor.jquery.timeago.a_year"),years:I18n.t("txt.vendor.jquery.timeago.years"),numbers:[]}},inWords:function(n){var o=this.settings.strings;var k=o.prefixAgo;var s=o.suffixAgo;if(this.settings.allowFuture){if(n<0){k=o.prefixFromNow;s=o.suffixFromNow}}var q=Math.abs(n)/1000;var h=q/60;var p=h/60;var r=p/24;var l=r/365;function j(t,v){var u=e.isFunction(t)?t(v,n):t;var w=(o.numbers&&o.numbers[v])||v;return u.replace(/%d/i,w)}var m=q<45&&j(o.seconds,Math.round(q))||q<90&&j(o.minute,1)||h<45&&j(o.minutes,Math.round(h))||h<90&&j(o.hour,1)||p<24&&j(o.hours,Math.round(p))||p<48&&j(o.day,1)||r<30&&j(o.days,Math.floor(r))||r<60&&j(o.month,1)||r<365&&j(o.months,Math.floor(r/30))||l<2&&j(o.year,1)||j(o.years,Math.floor(l));return e.trim([k,m].join(" "))},parse:function(j){var h=e.trim(j);h=h.replace(/\.\d\d\d+/,"");h=h.replace(/-/,"/").replace(/-/,"/");h=h.replace(/T/," ").replace(/Z/," UTC");h=h.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(h)},datetime:function(j){var k=e(j).get(0).tagName.toLowerCase()==="time";var h=k?e(j).attr("datetime"):e(j).attr("title");return g.parse(h)}});e.fn.timeago=function(){var j=this;j.each(d);var h=g.settings;if(h.refreshMillis>0){setInterval(function(){j.each(d)},h.refreshMillis)}return j};function d(){var h=c(this);if(!isNaN(h.datetime)){e(this).text(a(h.datetime))}return this}function c(h){h=e(h);if(!h.data("timeago")){h.data("timeago",{datetime:g.datetime(h)});var j=e.trim(h.text());if(j.length>0){h.attr("title",j)}}return h.data("timeago")}function a(h){return g.inWords(f(h))}function f(h){return(new Date().getTime()-h.getTime())}document.createElement("abbr");document.createElement("time")}(jQuery));(function(a){a.widget("ui.iosMenu",{options:{backText:"Back",backTextFunction:function(c){return null},slideDuration:50,slideEasing:"linear",click:function(c){c.toggle();return false},search:false},toggle:function(){if(this.container.is(":visible")){this.hide()}else{this.show()}},hide:function(){this.container.hide();this.element.hide()},hideAll:function(){a(".ios-menu-container").each(function(c,d){var e=a(d).data("iosMenu");if(e){e.hide()}})},show:function(){this.element.show();this.container.show();this._reposition()},_reposition:function(){var e=this.container.parent().find(".ios-menu-title");this.container.css("top",e.position().top+5).css("left",e.position().left+5);if(a("#ios-menu-spacer").length==0){var f=a("div#footer");var d=f.position().top+f.height();var c=this.container.position().top+this.container.height();if(c>d){f.after(a("<div>&nbsp;</div>").attr("id","ios-menu-spacer").css("padding-top",2*(c-d)))}}},_insertSearchField:function(){this.searchField=a('<input class="ios-menu-search-field" type="text"/>');a('<span class="ios-menu-search"></span>').append(this.searchField).insertBefore(this.element);return this},_insertSearchResults:function(){this.searchResults=a('<ul class="ios-menu-search-results menu" style="display:none;"></ul>').insertAfter(this.element);this.searchResults.menu();return this},_insertBackButtons:function(){var c=this;a(this.element.find("li ul, li ol")).each(function(d,f){var e=a('<li><span class="ui-icon ui-icon-carat-1-w ios-menu-back-image"></span><a href="#menu-back" class="ios-menu-back-link">'+(c.options.backTextFunction(f)||c.options.backText)+"</a></li>");a(f).prepend(e)});return this},_createContainer:function(){var d=this;var c=this.container=a('<div class="ios-menu-container" />').append(a("<div>").addClass("ios-menu-title activated").html(this.options.title).append(a("<a>").addClass("button").click(function(){d.toggle()}).css("float","right").css("padding","0 5px").css("margin","0 5px").html("cancel")));c.insertBefore(this.element).append(this.element.detach()).data("ios-menu",this).hide();if(this.options.title){a('<div class="ios-menu-title"/>').append(a("<a>").html(this.options.title).click(function(e){d.hideAll();d.toggle()})).insertBefore(c);c.css("top","-15px")}return this},_createLinks:function(){var c=this;c.element.find("li").each(function(d,f){f=a(f);var g=a(f).find("> ul").detach();var e=f.text();f.empty().append(a("<a/>").append(e).click(function(){if(g.length>0){return true}else{return c.options.click(c,f)}})).append(g)});return this},_create:function(){var d=this;d._createContainer()._createLinks();if(this.options.search){d._insertSearchField()._insertSearchResults()}if(this.options.renderSearchResult){this.renderSearchResult=this.options.renderSearchResult}else{this.renderSearchResult=function(h){return"<li><a>"+h+"</a></li>"}}d._insertBackButtons().element.addClass("ios-style").menu({position:{my:"left top",at:"right top",of:d.element}});$j(window).resize(function(){d._reposition()});var g=d.element.data("menu");g.select=function(h){h.preventDefault();var j=a(h.target).is("a");if(j&&g.active&&g.active.find("> .ios-menu-back-link").length){g.focus(h,g.active);if(g.left(h)){h.stopImmediatePropagation()}}else{if(j&&g.active&&g.active.find("> ul").length){g.focus(h,g.active);if(g.right(h)){h.stopImmediatePropagation()}g.active.closest("ul").css("overflow-y","hidden")}else{g._trigger("select",h,{item:g.active})}}};var e=g.right;g.right=function(h){if(e.call(g,h)){h.stopImmediatePropagation()}g.active.closest("ul").css("overflow-y","hidden");g.active.find("ul").height(g.active.parent().height())};g.left=function(l){var j=this.active&&this.active.parents("li:not(.ui-menubar-item) ").first(),h=this,k;if(j&&j.length){j.find("> a").addClass("ui-state-focus").removeClass("ui-state-active");k=this.active.parent();k.attr("aria-hidden","true").attr("aria-expanded","false").animate({left:h.element.css("width")},d.options.slideDuration,d.options.slideEasing,function(){k.hide();h.focus(l,j)});j.closest("ul").css("overflow-y","auto");return true}else{if(l&&l.which===a.ui.keyCode.ESCAPE){h._trigger("close",l)}}};var c=g._open;g._open=function(h){c.call(this,h);h.animate({left:0},d.options.slideDuration,d.options.slideEasing)};g._startOpening=function(){clearTimeout(this.timer)};g._move=function(n,m,j,l){if(!this.active){this.focus(l,this.activeMenu.children(m)[j]());return}var h=this.active[n+"All"](".ui-menu-item").eq(0);if(h.length){this.focus(l,h)}else{var k=this.active;this.focus(l,this.activeMenu.children(m)[j]());this._trigger("wrap",l,{direction:n,from:k,menu:this})}};g.focusFirst=function(){this.focus({},this.activeMenu.find(">li:first"))};if(this.options.search){var f=this.searchResults.data("menu");f._move=g._move;f.focusFirst=g.focusFirst;this.searchField.keyup(function(h){switch(h.keyCode){case a.ui.keyCode.DOWN:d.visibleMenu.focus();d.visibleMenu.data("menu").focusFirst();return false;case a.ui.keyCode.ESCAPE:d.searchField.val("");d.showMenu();return false}}).fastAutocomplete({lookup:this.doSearch,render:this.showSearchResults,context:this,frequency:0.1});this.visibleMenu=this.element;this.element.add(this.searchResults).bind("menuwrap",function(h,j){if(j.direction==="prev"){j.menu.focus({},j.from);j.menu.blur();d.searchField.focus()}})}},doSearch:function(c,d){if(this.options.search){d(this.options.search(c))}},showSearchResults:function(e){var f=this;if(e.length===0){return this.showMenu()}var d=e.length;var g=[];for(var c=0;c<d;c++){g.push(this.renderSearchResult(e[c]))}this.searchResults.empty().html(g.join("")).data("menu").refresh();this.searchResults.find("li a").each(function(h){h.click(this.options.click(f,h.parent))});this.element.hide();this.searchResults.show();this.visibleMenu=this.searchResults;return this},showMenu:function(){this.searchResults.hide();this.element.show();this.visibleMenu=this.element},destroy:function(){var c=this.element&&this.element.data("menu");if(c){c.destroy()}c=this.searchResults&&this.searchResults.data("menu");if(c){c.destroy()}}})}(jQuery));
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,f,c){var d="hashchange",j=document,g,h=$.event.special,k=j.documentMode,e="on"+d in f&&(k===c||k>7);function a(l){l=l||location.href;return"#"+l.replace(/^[^#]*#?(.*)$/,"$1")}$.fn[d]=function(l){return l?this.bind(d,l):this.trigger(d)};$.fn[d].delay=50;h[d]=$.extend(h[d],{setup:function(){if(e){return false}$(g.start)},teardown:function(){if(e){return false}$(g.stop)}});g=(function(){var l={},r,o=a(),m=function(s){return s},n=m,q=m;l.start=function(){r||p()};l.stop=function(){r&&clearTimeout(r);r=c};function p(){var t=a(),s=q(o);if(t!==o){n(o=t,s);$(f).trigger(d)}else{if(s!==o){location.href=location.href.replace(/#.*/,"")+s}}r=setTimeout(p,$.fn[d].delay)}$.browser.msie&&!e&&(function(){var s,t;l.start=function(){if(!s){t=$.fn[d].src;t=t&&t+a();s=$('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){t||n(a());p()}).attr("src",t||"javascript:0").insertAfter("body")[0].contentWindow;j.onpropertychange=function(){try{if(event.propertyName==="title"){s.document.title=j.title}}catch(u){}}}};l.stop=m;q=function(){return a(s.location.href)};n=function(y,u){var w=s.document,v=$.fn[d].domain;if(y!==u){w.title=j.title;w.open();v&&w.write('<script>document.domain="'+v+'"<\/script>');w.close();s.location.hash=y}}})();return l})()})(jQuery,this);jQuery.fn.highlight=function(c){function a(f,k){var m=0;if(f.nodeType==3){var l=f.data.toUpperCase().indexOf(k);if(l>=0){var j=document.createElement("span"),g=f.splitText(l),d=g.splitText(k.length),e=g.cloneNode(true);j.className="highlight";j.appendChild(e);g.parentNode.replaceChild(j,g);m=1}}else{if(f.nodeType==1&&f.childNodes&&!/(script|style)/i.test(f.tagName)){for(var h=0;h<f.childNodes.length;++h){h+=a(f.childNodes[h],k)}}}return m}return(!c||c==="")?this:this.each(function(){a(this,c.toUpperCase())})};jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){var a=this.parentNode;a.replaceChild(this.firstChild,this);a.normalize()}).end()};(function(c){var a=0;c.widget("ui.tooltip",{options:{tooltipClass:null,items:"[title]",content:function(){return c(this).attr("title")},position:{my:"right top",at:"right center"}},_create:function(){var d=c.proxy(this.open,this);this.element.bind("mouseover",d).bind("focusin",d)},enable:function(){this.options.disabled=false},disable:function(){this.options.disabled=true},open:function(f){var g=c(f&&f.target||this.element).closest(this.options.items);if(!g.length){return}var d=this;if(!g.data("tooltip-title")){g.data("tooltip-title",g.attr("title"))}var e=this.options.content.call(g[0],function(h){setTimeout(function(){if(g.attr("aria-describedby")!==undefined){d._open(f,g,h)}},13)});if(e){d._open(f,g,e)}},_open:function(e,g,d){if(!d){return}g.attr("title","");if(this.options.disabled){return}if(this._isOpen){return}var f=this._find(g);if(!f.length){f=this._tooltip();g.attr("aria-describedby",f.attr("id"))}f.find(".ui-tooltip-content").html(d);f.position(c.extend({of:g},this.options.position)).hide();f.stop(true);f.show();this._trigger("open",e);this._isOpen=true;var h=c.proxy(this.close,this);g.bind("mouseleave",h).bind("blur",h).bind("click",h)},close:function(d){var f=c(d&&d.currentTarget||this.element);f.attr("title",f.data("tooltip-title"));if(this.options.disabled){return}var e=this._find(f);f.removeAttr("aria-describedby");e.stop(true);e.hide().remove();f.unbind("mouseleave.tooltip blur.tooltip");this._trigger("close",d);this._isOpen=false},_tooltip:function(){var d=c("<div></div>").attr("id","ui-tooltip-"+a++).attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content");if(this.options.tooltipClass){d.addClass(this.options.tooltipClass)}c("<div></div>").addClass("ui-tooltip-content").appendTo(d);d.appendTo(document.body);return d},_find:function(d){var e=d.attr("aria-describedby");return e?c(document.getElementById(e)):c()}});c.ui.tooltip.version="@VERSION"})(jQuery);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(a){Sammy.ActiveTemplate=function(f){var e=function(l,k,h){var j=h||l.attr("data-target");var g=this.render(l,k).replace(j);g.then(function(){c(this.$element().find(j),this)}.bind(this));return g};var c=function(g,j){var h=g.find("*[data-bind]");h.each(function(l,o){var k=a(o).attr("data-bind");var m=k.split(" ")[0];var n=k.split(" ")[1];a(o).bind(m,function(p){j.trigger(n,{element:a(o),domEvent:p})})})};var d=function(l,k,h){var j=h||l.attr("data-target");var g=this.renderEach(l,k).replace(j);g.then(function(){c(this.$element().find(j),this)}.bind(this));return g};f.helper("renderTemplate",e);f.helper("renderCollectionTemplate",d);f.helper("bindDOMEvents",c)}})(jQuery);(function(a){Sammy=Sammy||{};Sammy.FlashHash=function(){this.now={}};Sammy.FlashHash.prototype={toHTML:function(){result=this._renderUL();this.clear();return result},clear:function(){this._clearHash(this);this._clearHash(this.now)},_onRedirect:function(){this._clearHash(this.now)},_clearHash:function(d){var c;for(c in d){if(c!=="now"&&d.hasOwnProperty(c)){d[c]=undefined}}},_renderUL:function(){return'<ul class="flash">'+this._renderLIs(this)+this._renderLIs(this.now)+"</ul>"},_renderLIs:function(e){var c="",d;for(d in e){if(e[d]&&d!=="now"&&e.hasOwnProperty(d)){c=c+'<li class="'+d+'">'+e[d]+"</li>"}}return c}};Sammy.Flash=function(c){c.flash=new Sammy.FlashHash();c.helper("flash",function(d,e){if(arguments.length===0){return this.app.flash}else{if(arguments.length===2){this.app.flash[d]=e}}return this.app.flash[d]});c.helper("flashNow",function(d,e){if(arguments.length===0){return this.app.flash.now}else{if(arguments.length===2){this.app.flash.now[d]=e}}return this.app.flash.now[d]});c.bind("redirect",function(){this.app.flash._onRedirect()})}})(jQuery);(function(a){Sammy.Mustache=function(e,c){var d=function(g,h,f){h=a.extend({},this,h);f=a.extend({},h.partials,f);return a.mustache(g,h,f)};if(!c){c="mustache"}e.helper(c,d)}})(jQuery);(function(a){Sammy=Sammy||{};Sammy.PathLocationProxy=function(c){this.app=c};Sammy.PathLocationProxy.prototype={bind:function(){},unbind:function(){},getLocation:function(){return[window.location.pathname,window.location.search].join("")},setLocation:function(c){return window.location=c}}})(jQuery);(function(){var w=this;var t=w._;var c={};var k=Array.prototype,E=Object.prototype,G=Function.prototype;var u=k.slice,z=k.unshift,y=E.toString,q=E.hasOwnProperty;var o=k.forEach,j=k.map,C=k.reduce,f=k.reduceRight,n=k.filter,a=k.every,B=k.some,v=k.indexOf,g=k.lastIndexOf,d=Array.isArray,D=Object.keys,l=G.bind;var F=function(H){return new h(H)};if(typeof module!=="undefined"&&module.exports){module.exports=F;F._=F}else{w._=F}F.VERSION="1.1.5";var e=F.each=F.forEach=function(M,L,K){if(M==null){return}if(o&&M.forEach===o){M.forEach(L,K)}else{if(F.isNumber(M.length)){for(var J=0,H=M.length;J<H;J++){if(L.call(K,M[J],J,M)===c){return}}}else{for(var I in M){if(q.call(M,I)){if(L.call(K,M[I],I,M)===c){return}}}}}};F.map=function(K,J,I){var H=[];if(K==null){return H}if(j&&K.map===j){return K.map(J,I)}e(K,function(N,L,M){H[H.length]=J.call(I,N,L,M)});return H};F.reduce=F.foldl=F.inject=function(L,K,H,J){var I=H!==void 0;if(L==null){L=[]}if(C&&L.reduce===C){if(J){K=F.bind(K,J)}return I?L.reduce(K,H):L.reduce(K)}e(L,function(O,M,N){if(!I&&M===0){H=O;I=true}else{H=K.call(J,H,O,M,N)}});if(!I){throw new TypeError("Reduce of empty array with no initial value")}return H};F.reduceRight=F.foldr=function(K,J,H,I){if(K==null){K=[]}if(f&&K.reduceRight===f){if(I){J=F.bind(J,I)}return H!==void 0?K.reduceRight(J,H):K.reduceRight(J)}var L=(F.isArray(K)?K.slice():F.toArray(K)).reverse();return F.reduce(L,J,H,I)};F.find=F.detect=function(K,J,I){var H;r(K,function(N,L,M){if(J.call(I,N,L,M)){H=N;return true}});return H};F.filter=F.select=function(K,J,I){var H=[];if(K==null){return H}if(n&&K.filter===n){return K.filter(J,I)}e(K,function(N,L,M){if(J.call(I,N,L,M)){H[H.length]=N}});return H};F.reject=function(K,J,I){var H=[];if(K==null){return H}e(K,function(N,L,M){if(!J.call(I,N,L,M)){H[H.length]=N}});return H};F.every=F.all=function(K,J,I){J=J||F.identity;var H=true;if(K==null){return H}if(a&&K.every===a){return K.every(J,I)}e(K,function(N,L,M){if(!(H=H&&J.call(I,N,L,M))){return c}});return H};var r=F.some=F.any=function(K,J,I){J=J||F.identity;var H=false;if(K==null){return H}if(B&&K.some===B){return K.some(J,I)}e(K,function(N,L,M){if(H=J.call(I,N,L,M)){return c}});return H};F.include=F.contains=function(J,I){var H=false;if(J==null){return H}if(v&&J.indexOf===v){return J.indexOf(I)!=-1}r(J,function(K){if(H=K===I){return true}});return H};F.invoke=function(I,J){var H=u.call(arguments,2);return F.map(I,function(K){return(J?K[J]:K).apply(K,H)})};F.pluck=function(I,H){return F.map(I,function(J){return J[H]})};F.max=function(K,J,I){if(!J&&F.isArray(K)){return Math.max.apply(Math,K)}var H={computed:-Infinity};e(K,function(O,L,N){var M=J?J.call(I,O,L,N):O;M>=H.computed&&(H={value:O,computed:M})});return H.value};F.min=function(K,J,I){if(!J&&F.isArray(K)){return Math.min.apply(Math,K)}var H={computed:Infinity};e(K,function(O,L,N){var M=J?J.call(I,O,L,N):O;M<H.computed&&(H={value:O,computed:M})});return H.value};F.sortBy=function(J,I,H){return F.pluck(F.map(J,function(M,K,L){return{value:M,criteria:I.call(H,M,K,L)}}).sort(function(N,M){var L=N.criteria,K=M.criteria;return L<K?-1:L>K?1:0}),"value")};F.sortedIndex=function(M,L,J){J=J||F.identity;var H=0,K=M.length;while(H<K){var I=(H+K)>>1;J(M[I])<J(L)?H=I+1:K=I}return H};F.toArray=function(H){if(!H){return[]}if(H.toArray){return H.toArray()}if(F.isArray(H)){return H}if(F.isArguments(H)){return u.call(H)}return F.values(H)};F.size=function(H){return F.toArray(H).length};F.first=F.head=function(J,I,H){return(I!=null)&&!H?u.call(J,0,I):J[0]};F.rest=F.tail=function(J,H,I){return u.call(J,(H==null)||I?1:H)};F.last=function(H){return H[H.length-1]};F.compact=function(H){return F.filter(H,function(I){return !!I})};F.flatten=function(H){return F.reduce(H,function(I,J){if(F.isArray(J)){return I.concat(F.flatten(J))}I[I.length]=J;return I},[])};F.without=function(I){var H=u.call(arguments,1);return F.filter(I,function(J){return !F.include(H,J)})};F.uniq=F.unique=function(I,H){return F.reduce(I,function(J,L,K){if(0==K||(H===true?F.last(J)!=L:!F.include(J,L))){J[J.length]=L}return J},[])};F.intersect=function(I){var H=u.call(arguments,1);return F.filter(F.uniq(I),function(J){return F.every(H,function(K){return F.indexOf(K,J)>=0})})};F.zip=function(){var H=u.call(arguments);var K=F.max(F.pluck(H,"length"));var J=new Array(K);for(var I=0;I<K;I++){J[I]=F.pluck(H,""+I)}return J};F.indexOf=function(L,J,K){if(L==null){return -1}var I,H;if(K){I=F.sortedIndex(L,J);return L[I]===J?I:-1}if(v&&L.indexOf===v){return L.indexOf(J)}for(I=0,H=L.length;I<H;I++){if(L[I]===J){return I}}return -1};F.lastIndexOf=function(J,I){if(J==null){return -1}if(g&&J.lastIndexOf===g){return J.lastIndexOf(I)}var H=J.length;while(H--){if(J[H]===I){return H}}return -1};F.range=function(M,K,L){if(arguments.length<=1){K=M||0;M=0}L=arguments[2]||1;var I=Math.max(Math.ceil((K-M)/L),0);var H=0;var J=new Array(I);while(H<I){J[H++]=M;M+=L}return J};F.bind=function(I,J){if(l&&I.bind===l){return I.bind.apply(I,u.call(arguments,1))}var H=u.call(arguments,2);return function(){return I.apply(J,H.concat(u.call(arguments)))}};F.bindAll=function(I){var H=u.call(arguments,1);if(H.length==0){H=F.functions(I)}e(H,function(J){I[J]=F.bind(I[J],I)});return I};F.memoize=function(J,I){var H={};I=I||F.identity;return function(){var K=I.apply(this,arguments);return q.call(H,K)?H[K]:(H[K]=J.apply(this,arguments))}};F.delay=function(I,J){var H=u.call(arguments,2);return setTimeout(function(){return I.apply(I,H)},J)};F.defer=function(H){return F.delay.apply(F,[H,1].concat(u.call(arguments,1)))};var A=function(I,K,H){var J;return function(){var M=this,L=arguments;var N=function(){J=null;I.apply(M,L)};if(H){clearTimeout(J)}if(H||!J){J=setTimeout(N,K)}}};F.throttle=function(H,I){return A(H,I,false)};F.debounce=function(H,I){return A(H,I,true)};F.once=function(J){var H=false,I;return function(){if(H){return I}H=true;return I=J.apply(this,arguments)}};F.wrap=function(H,I){return function(){var J=[H].concat(u.call(arguments));return I.apply(this,J)}};F.compose=function(){var H=u.call(arguments);return function(){var I=u.call(arguments);for(var J=H.length-1;J>=0;J--){I=[H[J].apply(this,I)]}return I[0]}};F.keys=D||function(J){if(J!==Object(J)){throw new TypeError("Invalid object")}var I=[];for(var H in J){if(q.call(J,H)){I[I.length]=H}}return I};F.values=function(H){return F.map(H,F.identity)};F.functions=F.methods=function(H){return F.filter(F.keys(H),function(I){return F.isFunction(H[I])}).sort()};F.extend=function(H){e(u.call(arguments,1),function(I){for(var J in I){H[J]=I[J]}});return H};F.defaults=function(H){e(u.call(arguments,1),function(I){for(var J in I){if(H[J]==null){H[J]=I[J]}}});return H};F.clone=function(H){return F.isArray(H)?H.slice():F.extend({},H)};F.tap=function(I,H){H(I);return I};F.isEqual=function(I,H){if(I===H){return true}var L=typeof(I),N=typeof(H);if(L!=N){return false}if(I==H){return true}if((!I&&H)||(I&&!H)){return false}if(I._chain){I=I._wrapped}if(H._chain){H=H._wrapped}if(I.isEqual){return I.isEqual(H)}if(F.isDate(I)&&F.isDate(H)){return I.getTime()===H.getTime()}if(F.isNaN(I)&&F.isNaN(H)){return false}if(F.isRegExp(I)&&F.isRegExp(H)){return I.source===H.source&&I.global===H.global&&I.ignoreCase===H.ignoreCase&&I.multiline===H.multiline}if(L!=="object"){return false}if(I.length&&(I.length!==H.length)){return false}var J=F.keys(I),M=F.keys(H);if(J.length!=M.length){return false}for(var K in I){if(!(K in H)||!F.isEqual(I[K],H[K])){return false}}return true};F.isEmpty=function(I){if(F.isArray(I)||F.isString(I)){return I.length===0}for(var H in I){if(q.call(I,H)){return false}}return true};F.isElement=function(H){return !!(H&&H.nodeType==1)};F.isArray=d||function(H){return y.call(H)==="[object Array]"};F.isArguments=function(H){return !!(H&&q.call(H,"callee"))};F.isFunction=function(H){return !!(H&&H.constructor&&H.call&&H.apply)};F.isString=function(H){return !!(H===""||(H&&H.charCodeAt&&H.substr))};F.isNumber=function(H){return !!(H===0||(H&&H.toExponential&&H.toFixed))};F.isNaN=function(H){return H!==H};F.isBoolean=function(H){return H===true||H===false};F.isDate=function(H){return !!(H&&H.getTimezoneOffset&&H.setUTCFullYear)};F.isRegExp=function(H){return !!(H&&H.test&&H.exec&&(H.ignoreCase||H.ignoreCase===false))};F.isNull=function(H){return H===null};F.isUndefined=function(H){return H===void 0};F.noConflict=function(){w._=t;return this};F.identity=function(H){return H};F.times=function(K,J,I){for(var H=0;H<K;H++){J.call(I,H)}};F.mixin=function(H){e(F.functions(H),function(I){s(I,F[I]=H[I])})};var m=0;F.uniqueId=function(H){var I=m++;return H?H+I:I};F.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};F.template=function(K,J){var L=F.templateSettings;var H="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+K.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(L.interpolate,function(M,N){return"',"+N.replace(/\\'/g,"'")+",'"}).replace(L.evaluate||null,function(M,N){return"');"+N.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var I=new Function("obj",H);return J?I(J):I};var h=function(H){this._wrapped=H};F.prototype=h.prototype;var p=function(I,H){return H?F(I).chain():I};var s=function(H,I){h.prototype[H]=function(){var J=u.call(arguments);z.call(J,this._wrapped);return p(I.apply(F,J),this._chain)}};F.mixin(F);e(["pop","push","reverse","shift","sort","splice","unshift"],function(H){var I=k[H];h.prototype[H]=function(){I.apply(this._wrapped,arguments);return p(this._wrapped,this._chain)}});e(["concat","join","slice"],function(H){var I=k[H];h.prototype[H]=function(){return p(I.apply(this._wrapped,arguments),this._chain)}});h.prototype.chain=function(){this._chain=true;return this};h.prototype.value=function(){return this._wrapped}})();var Base64=(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c={encode:function(f){var d="";var n,l,j;var m,k,h,g;var e=0;do{n=f.charCodeAt(e++);l=f.charCodeAt(e++);j=f.charCodeAt(e++);m=n>>2;k=((n&3)<<4)|(l>>4);h=((l&15)<<2)|(j>>6);g=j&63;if(isNaN(l)){h=g=64}else{if(isNaN(j)){g=64}}d=d+a.charAt(m)+a.charAt(k)+a.charAt(h)+a.charAt(g)}while(e<f.length);return d},decode:function(f){var d="";var n,l,j;var m,k,h,g;var e=0;f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{m=a.indexOf(f.charAt(e++));k=a.indexOf(f.charAt(e++));h=a.indexOf(f.charAt(e++));g=a.indexOf(f.charAt(e++));n=(m<<2)|(k>>4);l=((k&15)<<4)|(h>>2);j=((h&3)<<6)|g;d=d+String.fromCharCode(n);if(h!=64){d=d+String.fromCharCode(l)}if(g!=64){d=d+String.fromCharCode(j)}}while(e<f.length);return d}};return c})();(function(){var k=typeof(Buffer)=="function"?Buffer:Array;var g=new k(16);var d=[];var m={};for(var h=0;h<256;h++){d[h]=(h+256).toString(16).substr(1);m[d[h]]=h}function e(p){var n=new k(16);var o=0;p.toLowerCase().replace(/[0-9a-f][0-9a-f]/g,function(q){n[o++]=m[q]});return n}function j(o){var p=d,n=o;return p[n[0]]+p[n[1]]+p[n[2]]+p[n[3]]+"-"+p[n[4]]+p[n[5]]+"-"+p[n[6]]+p[n[7]]+"-"+p[n[8]]+p[n[9]]+"-"+p[n[10]]+p[n[11]]+p[n[12]]+p[n[13]]+p[n[14]]+p[n[15]]}var c=255;var l=this.crypto&&crypto.getRandomValues;var f=l?new Uint32Array(4):new Array(4);function a(o,p,t){var n=o!="binary"?g:(p?p:new k(16));var q=p&&t||0;if(l){crypto.getRandomValues(f)}else{f[0]=Math.random()*4294967296;f[1]=Math.random()*4294967296;f[2]=Math.random()*4294967296;f[3]=Math.random()*4294967296}var s=f[0];n[q++]=s&c;n[q++]=s>>>8&c;n[q++]=s>>>16&c;n[q++]=s>>>24&c;s=f[1];n[q++]=s&c;n[q++]=s>>>8&c;n[q++]=s>>>16&15|64;n[q++]=s>>>24&c;s=f[2];n[q++]=s&63|128;n[q++]=s>>>8&c;n[q++]=s>>>16&c;n[q++]=s>>>24&c;s=f[3];n[q++]=s&c;n[q++]=s>>>8&c;n[q++]=s>>>16&c;n[q++]=s>>>24&c;return o===undefined?j(n):n}a.parse=e;a.unparse=j;a.BufferClass=k;if(typeof(module)!="undefined"){module.exports=a}else{this.uuid=a}}());(function(c,d){var a;c.rails=a={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",linkDisableSelector:"a[data-disable-with]",fire:function(h,e,g){var f=c.Event(e);h.trigger(f,g);return f.result!==false},confirm:function(e){return confirm(e)},ajax:function(e){return c.ajax(e)},handleRemote:function(j){var m,g,l,k=j.data("cross-domain")||null,e=j.data("type")||(c.ajaxSettings&&c.ajaxSettings.dataType),f;if(a.fire(j,"ajax:before")){if(j.is("form")){m=j.attr("method");g=j.attr("action");l=j.serializeArray();var h=j.data("ujs:submit-button");if(h){l.push(h);j.data("ujs:submit-button",null)}}else{if(j.is(a.inputChangeSelector)){m=j.data("method");g=j.data("url");l=j.serialize();if(j.data("params")){l=l+"&"+j.data("params")}}else{m=j.data("method");g=j.attr("href");l=j.data("params")||null}}f={type:m||"GET",data:l,dataType:e,crossDomain:k,beforeSend:function(o,n){if(n.dataType===d){o.setRequestHeader("accept","*/*;q=0.5, "+n.accepts.script)}return a.fire(j,"ajax:beforeSend",[o,n])},success:function(o,n,p){j.trigger("ajax:success",[o,n,p])},complete:function(o,n){j.trigger("ajax:complete",[o,n])},error:function(p,n,o){j.trigger("ajax:error",[p,n,o])}};if(g){f.url=g}return a.ajax(f)}else{return false}},handleMethod:function(j){var f=j.attr("href"),m=j.data("method"),k=j.attr("target"),g=c("meta[name=csrf-token]").attr("content"),l=c("meta[name=csrf-param]").attr("content"),h=c('<form method="post" action="'+f+'"></form>'),e='<input name="_method" value="'+m+'" type="hidden" />';if(l!==d&&g!==d){e+='<input name="'+l+'" value="'+g+'" type="hidden" />'}if(k){h.attr("target",k)}h.hide().append(e).appendTo("body");h.submit()},allowAction:function(e){var f=e.data("confirm"),g=false,h;if(!f){return true}if(a.fire(e,"confirm")){g=a.confirm(f);h=a.fire(e,"confirm:complete",[g])}return g&&h},stopEverything:function(f){c(f.target).trigger("ujs:everythingStopped");f.stopImmediatePropagation();return false},disableElement:function(e){e.data("ujs:enable-with",e.html());e.html(e.data("disable-with"));e.bind("click.railsDisable",function(f){return a.stopEverything(f)})},enableElement:function(e){if(e.data("ujs:enable-with")!==d){e.html(e.data("ujs:enable-with"));e.data("ujs:enable-with",false)}e.unbind("click.railsDisable")},CSRFProtection:function(f){var e=this.CSRFToken();if(e){f.setRequestHeader("X-CSRF-Token",e)}},CSRFHeaders:function(f){var e=this.CSRFToken();if(e){f["X-CSRF-Token"]=e}return f},CSRFToken:function(){return c('meta[name="csrf-token"]').attr("content")}};c(document).delegate(a.linkDisableSelector,"ajax:complete",function(){a.enableElement(c(this))});c(document).delegate(a.linkClickSelector,"click.rails",function(h){var f=c(this),j=f.data("method"),g=f.data("params");if(!a.allowAction(f)){return a.stopEverything(h)}if(f.is(a.linkDisableSelector)){a.disableElement(f)}if(f.data("remote")!==d){if((h.metaKey||h.ctrlKey)&&(!j||j==="GET")&&!g){return true}if(a.handleRemote(f)===false){a.enableElement(f)}return false}else{if(f.data("method")){a.handleMethod(f);return false}}});c.ajaxPrefilter(function(e,g,f){if(!e.crossDomain){a.CSRFProtection(f)}})})(jQuery);if(typeof(Ajax)!="undefined"){Ajax.Base.prototype.initialize=Ajax.Base.prototype.initialize.wrap(function(){var c=$A(arguments),d=c.shift();c[0]=c[0]||{};var a=c[0];if(!(a.method&&a.method.toUpperCase()=="GET")&&!a.crossDomain){a.requestHeaders=jQuery.rails.CSRFHeaders(a.requestHeaders||{})}d.apply(null,c)})}(function(){function a(g,d,e){d||(d=0);var f=a.resolve(g,d),c=a.modules[d][f];if(!c){throw new Error('failed to require "'+g+'" from '+e)}if(c.context){d=c.context;f=c.main;c=a.modules[d][c.main]}if(!c.exports){c.exports={};c.call(c.exports,c,c.exports,a.relative(f,d))}return c.exports}a.modules=[{}];a.resolve=function(f,d){var g=f,e=f+".js",c=f+"/index.js";return a.modules[d][e]&&e||a.modules[d][c]&&c||g};a.relative=function(d,c){return function(j){if("."!=j.charAt(0)){return a(j)}var h=d.split("/"),f=j.split("/");h.pop();for(var g=0;g<f.length;g++){var e=f[g];if(".."==e){h.pop()}else{if("."!=e){h.push(e)}}}return a(h.join("/"),c,d)}};a.modules[0]["jquery"]={exports:window.jQuery};a.modules[0]["window"]={exports:window};a.modules[0]["backend.js"]=function(f,c,e){var d=e("./vendor/soundmanager2");var g=e("window");var h=e("jquery");f.exports=(function(){var n=false;var l=false;var k=h.Deferred();var m=function(){k.resolve();k=h.Deferred()};function j(o){this.options=o||{};this.swfUrl=this.options.swfUrl;this.callbacks=[]}j.prototype.ready=function(o){k.done(o);return this};j.prototype.init=function(){if(n){m();return}if(l){return}l=true;var o=new d(this.swfUrl);g.soundManager=o;o.flashVersion=9;o.beginDelayedInit();o.ontimeout(function(){o.reboot()});o.onready(function(){n=true;l=false;m()});return this};return j}())};a.modules[0]["player.js"]=function(d,h,e){var l=e("jquery");var f=e("./backend");function k(m){var o=Math.ceil(m/1000);var n=Math.floor(o/60);o=o%60;if(o<10){o="0"+o}if(n<10){n="0"+n}return n+":"+o}var g=[[3,0],[7,20],[12,40],[17,60],[22,80],[27,100]];function j(o){var n=o.pageX;for(var q=o.target;q;q=q.offsetParent){n-=q.offsetLeft}for(var m=0;m<g.length;m++){var p=g[m];if(n<=p[0]){return p[1]}}}if(l("#zd-player-css").length==0){var c=document.createElement("style");c.type="text/css";c.id="zd-player-css";if(c.styleSheet){c.styleSheet.cssText=e("templates/css")}else{c.appendChild(document.createTextNode(e("templates/css")))}document.getElementsByTagName("head")[0].appendChild(c)}d.exports=(function(){function m(o){this.options=o||{};this.domId=this.options.domId;this.url=this.options.url;this.element=l("#"+this.domId);var p=new f(this.options);this.element.html(e("templates/html"));this.element.addClass("zd-player");this.seekbarElement=this.element.find(".seekbar");this.playElement=this.element.find(".play");this.volumeElement=this.element.find(".volume");var n=this;p.ready(function(){var q=soundManager.createSound({id:n.domId,url:n.url});n.sound=q;q.load({onload:function(){n._loaded()}})}).init()}m.prototype._loaded=function(){var n=this;var o=this.sound;this.playElement.click(function(){n._playSound()});this.seekbarElement.slider({value:0,step:50,max:o.duration,slide:function(q,p){n.seeking=true},change:function(q,p){if(q.originalEvent){o.setPosition(p.value);n._updateTimeRemaining()}n.seeking=false}});this.volumeElement.click(function(p){n._updateVolume(j(p))});this._updateTimeRemaining()};m.prototype._playSound=function(){var o=this.sound;var n=this;if(o.playState===0){o.play({whileplaying:function(){if(n.seeking){return}n.seekbarElement.slider("value",this.position);n._updateTimeRemaining()},onplay:function(){n._markPlaying()},onresume:function(){n._markPlaying()},onpause:function(){n._markNotPlaying()},onstop:function(){n._markNotPlaying();n._updateTimeRemaining()},onfinish:function(){n._markNotPlaying();o.setPosition(0);n.seekbarElement.slider("value",0);n._updateTimeRemaining()}})}else{o.togglePause()}};m.prototype._markPlaying=function(){this.playing=true;this.playElement.addClass("playing")};m.prototype._markNotPlaying=function(){this.playing=false;this.playElement.removeClass("playing")};m.prototype._updateTimeRemaining=function(){this.element.find(".time_remaining").html(k(this.sound.duration-this.sound.position))};m.prototype._updateVolume=function(n){if(n!==null){this.sound.setVolume(n);this.volumeElement.removeClass("v0 v20 v40 v60 v80 v100").addClass("v"+n)}};return m}());d.exports.Audio=e("./player/audio")};a.modules[0]["player/audio.js"]=function(f,d,e){var g=e("jquery");var c=e("../backend");f.exports=(function(){function h(k){this.options=k||{};this.domId=this.options.domId;this.url=this.options.url;this.deferred=g.Deferred();this.stream=this.options.stream||false;this.initialized=false;this.initializing=true;var l=new c(this.options);var j=this;l.ready(function(){soundManager.destroySound(j.domId);j.sound=soundManager.createSound({id:j.domId,url:j.url,stream:j.stream});if(j.stream){m()}else{j.sound.load({onload:m})}}).init();function m(){j.initializing=false;j.initialized=true;j.deferred.resolve(j.sound)}}h.prototype.ready=function(j){if(this.initialized){j(this.sound);return}this.deferred.done(j);return this};return h}())};a.modules[0]["templates/css.js"]=function(e,c,d){e.exports=".zd-player{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAAeCAIAAAAZ2rQwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU9JREFUeNrs3b2KhDAUhuFRUmgERQWxtPT+70e0FBFEkIjiz57ZaeYGNC77PoU4jWGSHM6XRp3zPLdta9vWGCM3r2vEcTwMwwt4BusbUimltc7zXG7Uuq51XSdJkmWZ/LxoSNd15T+XZcny4wmsb0hpeOM4VlVVFIXqui5N0zAMpSVKQV40pOd5cr3u+cDf2pCO40RRJFcpQDVNk7Tmfd9vGFjqnOXHc1jckJ+hfd/v+949jkNaM+sBWEnF7wJkIgDLpcgUAHapO5MxZ0JwJqQTAsRRAMRRgDgKgCIEiKMAcZROCNAJATohnRCgCAHiKHEUxFE6IUAcBUAcBYijAChCgDhKHAVxlE4I/Ls4+nnfExMBWGnF7woMgmCeZ6YDuJ8xRgpQZVnWNI00Q631dS8gXZZFns+ZEA9hfUNKxZlfRVE493wQBsC37w/C/AgwADfzyYql0iMqAAAAAElFTkSuQmCC');background-origin:padding-box;background-size:auto;background-repeat:no-repeat;color:#666;display:block;font-family:Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:32px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:5px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:relative;text-align:left;width:300px;overflow:hidden}.zd-player .play{-webkit-box-shadow:none;-webkit-transition-delay:0s;-webkit-transition-duration:0s;-webkit-transition-property:all;-webkit-transition-timing-function:cubic-bezier(0.25, 0.1, 0.25, 1);background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAA2CAYAAAARSGNVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAANRJREFUeNrs1T1KQ0EQwPHfMyEgeAYrCy8hqbSxtfAMgqXVghDYB8HCe4hdStOkSJ9CFDyAlxBkbF6RmK9NoyhvYJvhvzvfs1VEKJU9O0gL/wzchbquJ7jCa8nLfcxwh4MSN3q4wQsuSn0+xCOecFQa4GljZYD9kmz0cNtcOi9NXQedbfAHhjjGqLsBHOMab5sCfMclzubB7/An7huTD2vLjWlT7uetvYGT32vRlBIRsXByznLOS7qIaKd75XTPL+lqne7fZiOl1G7+Janav/uPw18DAFptQhjz98BHAAAAAElFTkSuQmCC');background-origin:padding-box;background-repeat:no-repeat;background-size:auto;background-position:13px -1px;border-bottom-color:#333;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:none;border-bottom-width:0px;border-left-color:#333;border-left-style:none;border-left-width:0px;border-right-color:#333;border-right-style:none;border-right-width:0px;border-top-color:#333;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:none;border-top-width:0px;box-shadow:none;clear:none;color:#333;display:block;font-family:Arial, Helvetica, sans-serif;font-size:13px;font-style:normal;font-variant:normal;height:30px;line-height:16px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;position:absolute;text-align:left;text-shadow:rgba(255,255,255,0.74609) 0px 1px 1px;width:35px;top:0px;cursor:pointer;padding:0}.zd-player .play.playing{background-position:13px -23px}.zd-player .seekbar{background-attachment:scroll;background-clip:border-box;background-color:white;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAABkCAYAAAD0ZHJ6AAAAeUlEQVRoge3OMQHAIBAAsVL/nh8JDDfAkCjImpn5HvbfDpwIVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVoKVYCVYCVaClWAlWAlWgpVgJVgJVhtqiwTEKTLXTgAAAABJRU5ErkJggg==');background-origin:padding-box;background-size:auto;border-bottom-color:#AAA;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:solid;border-bottom-width:1px;border-left-color:#AAA;border-left-style:solid;border-left-width:1px;border-right-color:#AAA;border-right-style:solid;border-right-width:1px;border-top-color:#AAA;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:solid;border-top-width:1px;color:#222;display:block;font-family:Arial, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:3px;left:48px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;text-align:left;top:13px;width:160px}.zd-player .ui-slider-handle{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAA2CAYAAADOBhlKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAo9JREFUeNrsVc1rE0EUf/uRLyNNSTZt7aokoRJDLHoSxCCIIJ56FfofrEQ8Cz0W/AcCucaL4LE9SBFED56EgsUkF21cjMZ8kDTrZrsxbHadt02gSWarUC/GPPjBzHtvfjPz5u1vGcuy4DTGwiltRvAXCPinLx5NaQ3uEWwRfB1ga+CbrMHYPEDwZDG4IiWjtyEUuGA7m0pZLHx+vVZrfcqS6WMCxYlg80rsjnT10l0woQ/D72RRiMI5YQX2Pr6U8qVXfeJ6SCNYXwjG0pejN0DrNcAiFMeNIbfFWO1gP904kN8S1/NxAikZuwVqrwJ9s0ctDMd6AHPe7MoSjWDV5WJA1b+BafXpFWc4OOtexuE1ag26pgrqzyohMBwIeHCxc/ZhaAQfurqW6hk/oGu0qQRefh4OdRWHuzSC7P6XvdTyeQHahzIYZnf0vVkvzHkuAsmxc2mN9KzZrmQ0hYX5M1FgGAZ6/Y4NHKNPUxhoKd8zwwLS+mCjVH7PBQNL0tLCTbD82tETGn6oVspkcQl33jipE7HDHrSU6jYBPtX1gf/d4Ng7v2vloe3QkqdU0ph//8/E53K5mSpTVDkcDkuRSAR8Pp/t1HVdlGV5rdFoTKjy+Ak24/G4lEwm7YmqqjbQ0IcxzHG6wjrZOS2KImiaBqZpAsuyNnCMPowJgpAmufdpBFIikQDDMIDneXC73SNAH8YwB3NpNVj1+/14X3sBte+JMg3qQldljuPsxU7fBxLgSRxVmeyewlPgnalvTurR6XRGVPl4DbL5fB68Xi94PJ6JGqAPY5jjqMq1Wi1TLBYnSIaLMVav109WZbIDRxrG7oVQKHT0e282oVAoANngz1SZJG4TzFT5/1HlKSD4JcAA3NULNIccYqwAAAAASUVORK5CYII=');background-position:-1px -31px;background-origin:padding-box;background-size:auto;border-bottom-color:#555;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom-style:none;border-bottom-width:0px;border-left-color:#555;border-left-style:none;border-left-width:0px;border-right-color:#555;border-right-style:none;border-right-width:0px;border-top-color:#555;border-top-left-radius:4px;border-top-right-radius:4px;border-top-style:none;border-top-width:0px;color:#555;cursor:pointer;font-family:Arial, sans-serif;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;height:14.399999618530273px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:-7.2px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;text-align:left;text-decoration:none;top:-5px;width:14.399999618530273px;z-index:3;outline:none}.zd-player .ui-slider-handle:hover{background-position:-1px -9px}.zd-player .time_remaining{color:#666;display:block;font-family:Arial, Helvetica, sans-serif;font-size:12px;font-style:normal;font-variant:normal;height:14px;line-height:14.399999618530273px;list-style-image:none;list-style-position:outside;list-style-type:none;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;right:53px;text-align:left;top:9px}.zd-player .volume{background-attachment:scroll;background-clip:border-box;background-color:transparent;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAACWCAYAAAA1xhPdAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKJJREFUeNrs1jEKgCAYgFGNTuidPKPHsYYGh4KgDMMnRODwlh/1i7XW0GstoeOCwwfB15xzP3z/2iMaj/8rewYKh897cTV3Qji5Jx7tRWkBh8/QLSkl3QKHw3WLgcLhw3XLWaNc3S26BQ6H6xYDhcO/6pa7jaJb4HC4bjFQOPzLbnnSKLoFDofrFgOF/+UQlVK6nlCvPxwO9/obKHym138TYABVikT8nEQifAAAAABJRU5ErkJggg==');background-origin:padding-box;background-size:auto;border-bottom-color:#555;border-bottom-style:none;border-bottom-width:0px;border-left-color:#555;border-left-style:none;border-left-width:0px;border-right-color:#555;border-right-style:none;border-right-width:0px;border-top-color:#555;border-top-style:none;border-top-width:0px;color:#555;cursor:pointer;display:block;font-family:'Lucida Sans Unicode', 'Lucida Grande', tahoma, Verdana, sans-serif;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;height:12px;line-height:18px;margin-bottom:0px;margin-left:0px;margin-right:0px;margin-top:0px;outline-color:#555;outline-style:none;outline-width:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;padding-top:0px;position:absolute;right:9px;top:9px;vertical-align:baseline;width:29px;background-position:3px -10px;background-repeat:no-repeat}.zd-player .volume.v0{background-position:3px -128px}.zd-player .volume.v20{background-position:3px -106px}.zd-player .volume.v40{background-position:3px -82px}.zd-player .volume.v60{background-position:3px -58px}.zd-player .volume.v80{background-position:3px -34px}.zd-player .volume.v100{background-position:3px -10px}.zd-player.slim{background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPUAAAAYCAYAAAAia7s5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjFBMkIzNzFDQzU1MTFFMDkzNTBBMkE5MEM3RUFGOUYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjFBMkIzNzJDQzU1MTFFMDkzNTBBMkE5MEM3RUFGOUYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUEyQjM2RkNDNTUxMUUwOTM1MEEyQTkwQzdFQUY5RiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMUEyQjM3MENDNTUxMUUwOTM1MEEyQTkwQzdFQUY5RiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsLNX7oAAADuSURBVHja7NcxaoRAFAbgicRCsBBshBTiJbbNZfYMOUQukXZvIuQANrYupBvQzmKNdkmZbVbD94EOWj1m+Hlvntq2fQ0hvK/PKQBH9rk+b8/r61LXdVUUxUOrybIsdF0XmqZxNPAHSZKENE1DjPHU9/0lWf89PNDA/W63W5jnOZRluX1WW6cOy7LspsA91QJH8TM3ie2AfzaO2wIQamDH3KlBpwaEGjB+Azo1oFODTg0INWD8BnRqQKjB+G38Bp0aEGpAqIFfd+rrNE0veZ67U8OBxRi35bqF+jwMw8e6VnsobBxHpwP3+dry/C3AAF1NT2NuT4aYAAAAAElFTkSuQmCC');width:245px;height:24px;-moz-box-shadow:#cfcfcf 0px 0px 3px 0px;-webkit-box-shadow:#CFCFCF 0px 0px 3px 0px;box-shadow:#CFCFCF 0px 0px 3px 0px}.zd-player.slim .play{top:-3px}.zd-player.slim .seekbar{height:3px;left:48px;top:10px;width:145px}.zd-player.slim .time_remaining{right:12px;font-size:11px;top:5px}.zd-player.slim .volume{display:none}"};a.modules[0]["templates/html.js"]=function(e,c,d){e.exports="<span class='play button'>&nbsp;</span><span class='seekbar'><span class='loading'><span class='handle'></span></span></span><span class='time_remaining'></span><span class='volume'></span><span class='clearfix shim'></span>"};a.modules[0]["vendor/soundmanager2.js"]=function(f,c,d){var g=d("window");var e=d("window");f.exports=function h(a3,aF){function aH(j){return function(l){var k=this._t;return !k||!k._a?null:j.call(this,l)}}this.flashVersion=8;this.debugFlash=this.debugMode=!1;this.consoleOnly=this.useConsole=!0;this.waitForWindowLoad=!1;this.bgColor="#ffffff";this.useHighPerformance=!1;this.html5PollingInterval=this.flashPollingInterval=null;this.flashLoadTimeout=1000;this.wmode=null;this.allowScriptAccess="always";this.useFlashBlock=!1;this.useHTML5Audio=!0;this.html5Test=/^(probably|maybe)$/i;this.preferFlash=!0;this.noSWFCache=!1;this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}};this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100};this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.movieID="sm2-container";this.id=aF||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20120318";this.movieURL=this.version=null;this.url=a3||null;this.altURL=null;this.enabled=this.swfLoaded=!1;this.oMC=null;this.sounds={};this.soundIDs=[];this.didFlashBlock=this.muted=!1;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1};this.sandbox={};var aj;try{aj="undefined"!==typeof Audio&&"undefined"!==typeof(new Audio).canPlayType}catch(au){aj=!1}this.hasHTML5=aj;this.html5={usingFlash:null};this.flash={};this.ignoreFlash=this.html5Only=!1;var bA,aQ=this,aL=null,a2,aE=navigator.userAgent,aN=e,ac=aN.location.href.toString(),aI=document,bC,a1,aJ,aB=[],bd=!1,bb=!1,aD=!1,aw=!1,bt=!1,a9,az,bc,bn,bm,a0,bq,aK,ar,aZ,bl,ak,ad,bE,aY,bk,bD,bv,bu,aX,be,a8=null,bi=null,bh,aO,bg,aW,aV,am,aC,aU=!1,af=!1,aM,al,ae,aS=0,a7=null,bx,ay=null,bF,bs,a6,av,bG,by,bw,aG,ap=Array.prototype.slice,aq=!1,aA,a5,bj,ax,aP,bo=aE.match(/(ipad|iphone|ipod)/i),ai=aE.match(/firefox/i),ab=aE.match(/droid/i),at=aE.match(/msie/i),bB=aE.match(/webkit/i),a4=aE.match(/safari/i)&&!aE.match(/chrome/i),br=aE.match(/opera/i),aR=aE.match(/(mobile|pre\/|xoom)/i)||bo,ao=!ac.match(/usehtml5audio/i)&&!ac.match(/sm2\-ignorebadua/i)&&a4&&!aE.match(/silk/i)&&aE.match(/OS X 10_6_([3-7])/i),ah="undefined"!==typeof aI.hasFocus?aI.hasFocus():null,bf=a4&&"undefined"===typeof aI.hasFocus,an=!bf,ag=/(mp3|mp4|mpa)/i,H=aI.location?aI.location.protocol.match(/http/i):null,bH=!H?"http://":"",bz=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|mp4v|3gp|3g2)\s*(?:$|;)/i,bp="mpeg4,aac,flv,mov,mp4,m4v,f4v,m4a,mp4v,3gp,3g2".split(","),aT=RegExp("\\.("+bp.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!H;this._global_a=null;if(aR&&(aQ.useHTML5Audio=!0,aQ.preferFlash=!1,bo)){aq=aQ.ignoreFlash=!0}this.supported=this.ok=function(){return ay?aD&&!aw:aQ.useHTML5Audio&&aQ.hasHTML5};this.getMovie=function(j){return a2(j)||aI[j]||aN[j]};this.createSound=function(k){function n(){m=aW(m);aQ.sounds[l.id]=new bA(l);aQ.soundIDs.push(l.id);return aQ.sounds[l.id]}var m=null,j=null,l=null;if(!aD||!aQ.ok()){return am(void 0),!1}2===arguments.length&&(k={id:arguments[0],url:arguments[1]});m=az(k);m.url=bx(m.url);l=m;if(aC(l.id,!0)){return aQ.sounds[l.id]}if(bs(l)){j=n(),j._setup_html5(l)}else{if(8<aJ){if(null===l.isMovieStar){l.isMovieStar=l.serverURL||(l.type?l.type.match(bz):!1)||l.url.match(aT)}if(l.isMovieStar&&l.usePeakData){l.usePeakData=!1}}l=aV(l,void 0);j=n();if(8===aJ){aL._createSound(l.id,l.loops||1,l.usePolicyFile)}else{if(aL._createSound(l.id,l.url,l.usePeakData,l.useWaveformData,l.useEQData,l.isMovieStar,l.isMovieStar?l.bufferTime:!1,l.loops||1,l.serverURL,l.duration||null,l.autoPlay,!0,l.autoLoad,l.usePolicyFile),!l.serverURL){j.connected=!0,l.onconnect&&l.onconnect.apply(j)}}!l.serverURL&&(l.autoLoad||l.autoPlay)&&j.load(l)}!l.serverURL&&l.autoPlay&&j.play();return j};this.destroySound=function(k,m){if(!aC(k)){return !1}var l=aQ.sounds[k],j;l._iO={};l.stop();l.unload();for(j=0;j<aQ.soundIDs.length;j++){if(aQ.soundIDs[j]===k){aQ.soundIDs.splice(j,1);break}}m||l.destruct(!0);delete aQ.sounds[k];return !0};this.load=function(j,k){return !aC(j)?!1:aQ.sounds[j].load(k)};this.unload=function(j){return !aC(j)?!1:aQ.sounds[j].unload()};this.onposition=this.onPosition=function(k,m,l,j){return !aC(k)?!1:aQ.sounds[k].onposition(m,l,j)};this.clearOnPosition=function(j,l,k){return !aC(j)?!1:aQ.sounds[j].clearOnPosition(l,k)};this.start=this.play=function(j,k){if(!aD||!aQ.ok()){return am("soundManager.play(): "+bh(!aD?"notReady":"notOK")),!1}if(!aC(j)){k instanceof Object||(k={url:k});return k&&k.url?(k.id=j,aQ.createSound(k).play()):!1}return aQ.sounds[j].play(k)};this.setPosition=function(j,k){return !aC(j)?!1:aQ.sounds[j].setPosition(k)};this.stop=function(j){return !aC(j)?!1:aQ.sounds[j].stop()};this.stopAll=function(){for(var j in aQ.sounds){aQ.sounds.hasOwnProperty(j)&&aQ.sounds[j].stop()}};this.pause=function(j){return !aC(j)?!1:aQ.sounds[j].pause()};this.pauseAll=function(){var j;for(j=aQ.soundIDs.length-1;0<=j;j--){aQ.sounds[aQ.soundIDs[j]].pause()}};this.resume=function(j){return !aC(j)?!1:aQ.sounds[j].resume()};this.resumeAll=function(){var j;for(j=aQ.soundIDs.length-1;0<=j;j--){aQ.sounds[aQ.soundIDs[j]].resume()}};this.togglePause=function(j){return !aC(j)?!1:aQ.sounds[j].togglePause()};this.setPan=function(j,k){return !aC(j)?!1:aQ.sounds[j].setPan(k)};this.setVolume=function(j,k){return !aC(j)?!1:aQ.sounds[j].setVolume(k)};this.mute=function(j){var k=0;"string"!==typeof j&&(j=null);if(j){return !aC(j)?!1:aQ.sounds[j].mute()}for(k=aQ.soundIDs.length-1;0<=k;k--){aQ.sounds[aQ.soundIDs[k]].mute()}return aQ.muted=!0};this.muteAll=function(){aQ.mute()};this.unmute=function(j){"string"!==typeof j&&(j=null);if(j){return !aC(j)?!1:aQ.sounds[j].unmute()}for(j=aQ.soundIDs.length-1;0<=j;j--){aQ.sounds[aQ.soundIDs[j]].unmute()}aQ.muted=!1;return !0};this.unmuteAll=function(){aQ.unmute()};this.toggleMute=function(j){return !aC(j)?!1:aQ.sounds[j].toggleMute()};this.getMemoryUse=function(){var j=0;aL&&8!==aJ&&(j=parseInt(aL._getMemoryUse(),10));return j};this.disable=function(j){var k;"undefined"===typeof j&&(j=!1);if(aw){return !1}aw=!0;for(k=aQ.soundIDs.length-1;0<=k;k--){bu(aQ.sounds[aQ.soundIDs[k]])}a9(j);aG.remove(aN,"load",bm);return !0};this.canPlayMIME=function(j){var k;aQ.hasHTML5&&(k=a6({type:j}));return !ay||k?k:j&&aQ.ok()?!!(8<aJ&&j.match(bz)||j.match(aQ.mimePattern)):null};this.canPlayURL=function(j){var k;aQ.hasHTML5&&(k=a6({url:j}));return !ay||k?k:j&&aQ.ok()?!!j.match(aQ.filePattern):null};this.canPlayLink=function(j){return"undefined"!==typeof j.type&&j.type&&aQ.canPlayMIME(j.type)?!0:aQ.canPlayURL(j.href)};this.getSoundById=function(j){if(!j){throw Error("soundManager.getSoundById(): sID is null/undefined")}return aQ.sounds[j]};this.onready=function(j,k){if(j&&j instanceof Function){return k||(k=aN),bc("onready",j,k),bn(),!0}throw bh("needFunction","onready")};this.ontimeout=function(j,k){if(j&&j instanceof Function){return k||(k=aN),bc("ontimeout",j,k),bn({type:"ontimeout"}),!0}throw bh("needFunction","ontimeout")};this._wD=this._writeDebug=function(){return !0};this._debug=function(){};this.reboot=function(){var j,l;for(j=aQ.soundIDs.length-1;0<=j;j--){aQ.sounds[aQ.soundIDs[j]].destruct()}try{if(at){bi=aL.innerHTML}a8=aL.parentNode.removeChild(aL)}catch(k){}bi=a8=ay=null;aQ.enabled=ad=aD=aU=af=bd=bb=aw=aQ.swfLoaded=!1;aQ.soundIDs=[];aQ.sounds={};aL=null;for(j in aB){if(aB.hasOwnProperty(j)){for(l=aB[j].length-1;0<=l;l--){aB[j][l].fired=!1}}}aN.setTimeout(aQ.beginDelayedInit,20)};this.getMoviePercent=function(){return aL&&"undefined"!==typeof aL.PercentLoaded?aL.PercentLoaded():null};this.beginDelayedInit=function(){bt=!0;bl();setTimeout(function(){if(af){return !1}aY();aZ();return af=!0},20);a0()};this.destruct=function(){aQ.disable(!0)};bA=function(F){var D,C,E=this,B,z,I,A,y,v,w=!1,u=[],s=0,j,G,p=null;D=null;C=null;this.sID=F.id;this.url=F.url;this._iO=this.instanceOptions=this.options=az(F);this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=!1;this._a=null;this.id3={};this._debug=function(){};this.load=function(k){var m=null;if("undefined"!==typeof k){E._iO=az(k,E.options),E.instanceOptions=E._iO}else{if(k=E.options,E._iO=k,E.instanceOptions=E._iO,p&&p!==E.url){E._iO.url=E.url,E.url=null}}if(!E._iO.url){E._iO.url=E.url}E._iO.url=bx(E._iO.url);if(E._iO.url===E.url&&0!==E.readyState&&2!==E.readyState){return 3===E.readyState&&E._iO.onload&&E._iO.onload.apply(E,[!!E.duration]),E}k=E._iO;p=E.url;E.loaded=!1;E.readyState=1;E.playState=0;if(bs(k)){if(m=E._setup_html5(k),!m._called_load){E._html5_canplay=!1,E._a.autobuffer="auto",E._a.preload="auto",m.load(),m._called_load=!0,k.autoPlay&&E.play()}}else{try{E.isHTML5=!1,E._iO=aV(aW(k)),k=E._iO,8===aJ?aL._load(E.sID,k.url,k.stream,k.autoPlay,k.whileloading?1:0,k.loops||1,k.usePolicyFile):aL._load(E.sID,k.url,!!k.stream,!!k.autoPlay,k.loops||1,!!k.autoLoad,k.usePolicyFile)}catch(l){bk({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return E};this.unload=function(){0!==E.readyState&&(E.isHTML5?(A(),E._a&&(E._a.pause(),bG(E._a))):8===aJ?aL._unload(E.sID,"about:blank"):aL._unload(E.sID),B());return E};this.destruct=function(k){if(E.isHTML5){if(A(),E._a){E._a.pause(),bG(E._a),aq||I(),E._a._t=null,E._a=null}}else{E._iO.onfailure=null,aL._destroySound(E.sID)}k||aQ.destroySound(E.sID,!0)};this.start=this.play=function(k,m){var l,m=void 0===m?!0:m;k||(k={});E._iO=az(k,E._iO);E._iO=az(E._iO,E.options);E._iO.url=bx(E._iO.url);E.instanceOptions=E._iO;if(E._iO.serverURL&&!E.connected){return E.getAutoPlay()||E.setAutoPlay(!0),E}bs(E._iO)&&(E._setup_html5(E._iO),y());if(1===E.playState&&!E.paused&&(l=E._iO.multiShot,!l)){return E}if(!E.loaded){if(0===E.readyState){if(!E.isHTML5){E._iO.autoPlay=!0}E.load(E._iO)}else{if(2===E.readyState){return E}}}if(!E.isHTML5&&9===aJ&&0<E.position&&E.position===E.duration){k.position=0}if(E.paused&&E.position&&0<E.position){E.resume()}else{E._iO=az(k,E._iO);if(null!==E._iO.from&&null!==E._iO.to&&0===E.instanceCount&&0===E.playState&&!E._iO.serverURL){l=function(){E._iO=az(k,E._iO);E.play(E._iO)};if(E.isHTML5&&!E._html5_canplay){return E.load({_oncanplay:l}),!1}if(!E.isHTML5&&!E.loaded&&(!E.readyState||2!==E.readyState)){return E.load({onload:l}),!1}E._iO=G()}(!E.instanceCount||E._iO.multiShotEvents||!E.isHTML5&&8<aJ&&!E.getAutoPlay())&&E.instanceCount++;0===E.playState&&E._iO.onposition&&v(E);E.playState=1;E.paused=!1;E.position="undefined"!==typeof E._iO.position&&!isNaN(E._iO.position)?E._iO.position:0;if(!E.isHTML5){E._iO=aV(aW(E._iO))}E._iO.onplay&&m&&(E._iO.onplay.apply(E),w=!0);E.setVolume(E._iO.volume,!0);E.setPan(E._iO.pan,!0);E.isHTML5?(y(),l=E._setup_html5(),E.setPosition(E._iO.position),l.play()):aL._start(E.sID,E._iO.loops||1,9===aJ?E._iO.position:E._iO.position/1000)}return E};this.stop=function(k){var l=E._iO;if(1===E.playState){E._onbufferchange(0);E._resetOnPosition(0);E.paused=!1;if(!E.isHTML5){E.playState=0}j();l.to&&E.clearOnPosition(l.to);if(E.isHTML5){if(E._a){k=E.position,E.setPosition(0),E.position=k,E._a.pause(),E.playState=0,E._onTimer(),A()}}else{aL._stop(E.sID,k),l.serverURL&&E.unload()}E.instanceCount=0;E._iO={};l.onstop&&l.onstop.apply(E)}return E};this.setAutoPlay=function(k){E._iO.autoPlay=k;E.isHTML5||(aL._setAutoPlay(E.sID,k),k&&!E.instanceCount&&1===E.readyState&&E.instanceCount++)};this.getAutoPlay=function(){return E._iO.autoPlay};this.setPosition=function(k){void 0===k&&(k=0);var m=E.isHTML5?Math.max(k,0):Math.min(E.duration||E._iO.duration,Math.max(k,0));E.position=m;k=E.position/1000;E._resetOnPosition(E.position);E._iO.position=m;if(E.isHTML5){if(E._a&&E._html5_canplay&&E._a.currentTime!==k){try{E._a.currentTime=k,(0===E.playState||E.paused)&&E._a.pause()}catch(l){}}}else{k=9===aJ?E.position:k,E.readyState&&2!==E.readyState&&aL._setPosition(E.sID,k,E.paused||!E.playState)}E.isHTML5&&E.paused&&E._onTimer(!0);return E};this.pause=function(k){if(E.paused||0===E.playState&&1!==E.readyState){return E}E.paused=!0;E.isHTML5?(E._setup_html5().pause(),A()):(k||void 0===k)&&aL._pause(E.sID);E._iO.onpause&&E._iO.onpause.apply(E);return E};this.resume=function(){var k=E._iO;if(!E.paused){return E}E.paused=!1;E.playState=1;E.isHTML5?(E._setup_html5().play(),y()):(k.isMovieStar&&!k.serverURL&&E.setPosition(E.position),aL._pause(E.sID));!w&&k.onplay?(k.onplay.apply(E),w=!0):k.onresume&&k.onresume.apply(E);return E};this.togglePause=function(){if(0===E.playState){return E.play({position:9===aJ&&!E.isHTML5?E.position:E.position/1000}),E}E.paused?E.resume():E.pause();return E};this.setPan=function(k,l){"undefined"===typeof k&&(k=0);"undefined"===typeof l&&(l=!1);E.isHTML5||aL._setPan(E.sID,k);E._iO.pan=k;if(!l){E.pan=k,E.options.pan=k}return E};this.setVolume=function(k,l){"undefined"===typeof k&&(k=100);"undefined"===typeof l&&(l=!1);if(E.isHTML5){if(E._a){E._a.volume=Math.max(0,Math.min(1,k/100))}}else{aL._setVolume(E.sID,aQ.muted&&!E.muted||E.muted?0:k)}E._iO.volume=k;if(!l){E.volume=k,E.options.volume=k}return E};this.mute=function(){E.muted=!0;if(E.isHTML5){if(E._a){E._a.muted=!0}}else{aL._setVolume(E.sID,0)}return E};this.unmute=function(){E.muted=!1;var k="undefined"!==typeof E._iO.volume;if(E.isHTML5){if(E._a){E._a.muted=!1}}else{aL._setVolume(E.sID,k?E._iO.volume:E.options.volume)}return E};this.toggleMute=function(){return E.muted?E.unmute():E.mute()};this.onposition=this.onPosition=function(k,m,l){u.push({position:parseInt(k,10),method:m,scope:"undefined"!==typeof l?l:E,fired:!1});return E};this.clearOnPosition=function(k,l){var m,k=parseInt(k,10);if(isNaN(k)){return !1}for(m=0;m<u.length;m++){if(k===u[m].position&&(!l||l===u[m].method)){u[m].fired&&s--,u.splice(m,1)}}};this._processOnPosition=function(){var k,l;k=u.length;if(!k||!E.playState||s>=k){return !1}for(k-=1;0<=k;k--){if(l=u[k],!l.fired&&E.position>=l.position){l.fired=!0,s++,l.method.apply(l.scope,[l.position])}}return !0};this._resetOnPosition=function(k){var l,m;l=u.length;if(!l){return !1}for(l-=1;0<=l;l--){if(m=u[l],m.fired&&k<=m.position){m.fired=!1,s--}}return !0};G=function(){var k=E._iO,o=k.from,n=k.to,l,m;m=function(){E.clearOnPosition(n,m);E.stop()};l=function(){if(null!==n&&!isNaN(n)){E.onPosition(n,m)}};if(null!==o&&!isNaN(o)){k.position=o,k.multiShot=!1,l()}return k};v=function(){var k,l=E._iO.onposition;if(l){for(k in l){if(l.hasOwnProperty(k)){E.onPosition(parseInt(k,10),l[k])}}}};j=function(){var k,l=E._iO.onposition;if(l){for(k in l){l.hasOwnProperty(k)&&E.clearOnPosition(parseInt(k,10))}}};y=function(){E.isHTML5&&aM(E)};A=function(){E.isHTML5&&al(E)};B=function(){u=[];s=0;w=!1;E._hasTimer=null;E._a=null;E._html5_canplay=!1;E.bytesLoaded=null;E.bytesTotal=null;E.duration=E._iO&&E._iO.duration?E._iO.duration:null;E.durationEstimate=null;E.eqData=[];E.eqData.left=[];E.eqData.right=[];E.failures=0;E.isBuffering=!1;E.instanceOptions={};E.instanceCount=0;E.loaded=!1;E.metadata={};E.readyState=0;E.muted=!1;E.paused=!1;E.peakData={left:0,right:0};E.waveformData={left:[],right:[]};E.playState=0;E.position=null};B();this._onTimer=function(k){var n,m=!1,l={};if(E._hasTimer||k){if(E._a&&(k||(0<E.playState||1===E.readyState)&&!E.paused)){n=E._get_html5_duration();if(n!==D){D=n,E.duration=n,m=!0}E.durationEstimate=E.duration;n=1000*E._a.currentTime||0;n!==C&&(C=n,m=!0);(m||k)&&E._whileplaying(n,l,l,l,l);return m}return !1}};this._get_html5_duration=function(){var k=E._iO,l=E._a?1000*E._a.duration:k?k.duration:void 0;return l&&!isNaN(l)&&Infinity!==l?l:k?k.duration:null};this._setup_html5=function(k){var k=az(E._iO,k),o=decodeURI,n=aq?aQ._global_a:E._a,l=o(k.url),m=n&&n._t?n._t.instanceOptions:null;if(n){if(n._t&&(!aq&&l===o(p)||aq&&m.url===k.url&&(!p||p===m.url))){return n}aq&&n._t&&n._t.playState&&k.url!==m.url&&n._t.stop();B();n.src=k.url;p=E.url=k.url;n._called_load=!1}else{n=new Audio(k.url);n._called_load=!1;if(ab){n._called_load=!0}if(aq){aQ._global_a=n}}E.isHTML5=!0;E._a=n;n._t=E;z();n.loop=1<k.loops?"loop":"";k.autoLoad||k.autoPlay?E.load():(n.autobuffer=!1,n.preload="none");n.loop=1<k.loops?"loop":"";return n};z=function(){if(E._a._added_events){return !1}var k;E._a._added_events=!0;for(k in ax){ax.hasOwnProperty(k)&&E._a&&E._a.addEventListener(k,ax[k],!1)}return !0};I=function(){var k;E._a._added_events=!1;for(k in ax){ax.hasOwnProperty(k)&&E._a&&E._a.removeEventListener(k,ax[k],!1)}};this._onload=function(k){k=!!k;E.loaded=k;E.readyState=k?3:2;E._onbufferchange(0);E._iO.onload&&E._iO.onload.apply(E,[k]);return !0};this._onbufferchange=function(k){if(0===E.playState||k&&E.isBuffering||!k&&!E.isBuffering){return !1}E.isBuffering=1===k;E._iO.onbufferchange&&E._iO.onbufferchange.apply(E);return !0};this._onsuspend=function(){E._iO.onsuspend&&E._iO.onsuspend.apply(E);return !0};this._onfailure=function(k,m,l){E.failures++;if(E._iO.onfailure&&1===E.failures){E._iO.onfailure(E,k,m,l)}};this._onfinish=function(){var k=E._iO.onfinish;E._onbufferchange(0);E._resetOnPosition(0);if(E.instanceCount){E.instanceCount--;if(!E.instanceCount){j(),E.playState=0,E.paused=!1,E.instanceCount=0,E.instanceOptions={},E._iO={},A()}(!E.instanceCount||E._iO.multiShotEvents)&&k&&k.apply(E)}};this._whileloading=function(k,o,n,m){var l=E._iO;E.bytesLoaded=k;E.bytesTotal=o;E.duration=Math.floor(n);E.bufferLength=m;if(l.isMovieStar){E.durationEstimate=E.duration}else{if(E.durationEstimate=l.duration?E.duration>l.duration?E.duration:l.duration:parseInt(E.bytesTotal/E.bytesLoaded*E.duration,10),void 0===E.durationEstimate){E.durationEstimate=E.duration}}3!==E.readyState&&l.whileloading&&l.whileloading.apply(E)};this._whileplaying=function(k,q,o,n,m){var l=E._iO;if(isNaN(k)||null===k){return !1}E.position=k;E._processOnPosition();if(!E.isHTML5&&8<aJ){if(l.usePeakData&&"undefined"!==typeof q&&q){E.peakData={left:q.leftPeak,right:q.rightPeak}}if(l.useWaveformData&&"undefined"!==typeof o&&o){E.waveformData={left:o.split(","),right:n.split(",")}}if(l.useEQData&&"undefined"!==typeof m&&m&&m.leftEQ&&(k=m.leftEQ.split(","),E.eqData=k,E.eqData.left=k,"undefined"!==typeof m.rightEQ&&m.rightEQ)){E.eqData.right=m.rightEQ.split(",")}}1===E.playState&&(!E.isHTML5&&8===aJ&&!E.position&&E.isBuffering&&E._onbufferchange(0),l.whileplaying&&l.whileplaying.apply(E));return !0};this._onmetadata=function(k,o){var n={},l,m;for(l=0,m=k.length;l<m;l++){n[k[l]]=o[l]}E.metadata=n;E._iO.onmetadata&&E._iO.onmetadata.apply(E)};this._onid3=function(k,o){var n=[],l,m;for(l=0,m=k.length;l<m;l++){n[k[l]]=o[l]}E.id3=az(E.id3,n);E._iO.onid3&&E._iO.onid3.apply(E)};this._onconnect=function(k){k=1===k;if(E.connected=k){E.failures=0,aC(E.sID)&&(E.getAutoPlay()?E.play(void 0,E.getAutoPlay()):E._iO.autoLoad&&E.load()),E._iO.onconnect&&E._iO.onconnect.apply(E,[k])}};this._ondataerror=function(){0<E.playState&&E._iO.ondataerror&&E._iO.ondataerror.apply(E)}};bE=function(){return aI.body||aI._docElement||aI.getElementsByTagName("div")[0]};a2=function(j){return aI.getElementById(j)};az=function(k,n){var m={},j,l;for(j in k){k.hasOwnProperty(j)&&(m[j]=k[j])}j="undefined"===typeof n?aQ.defaultOptions:n;for(l in j){j.hasOwnProperty(l)&&"undefined"===typeof m[l]&&(m[l]=j[l])}return m};aG=function(){function k(o){var o=ap.call(o),n=o.length;l?(o[1]="on"+o[1],3<n&&o.pop()):3===n&&o.push(!1);return o}function m(n,q){var p=n.shift(),o=[j[q]];if(l){p[o](n[0],n[1])}else{p[o].apply(p,n)}}var l=aN.attachEvent,j={add:l?"attachEvent":"addEventListener",remove:l?"detachEvent":"removeEventListener"};return{add:function(){m(k(arguments),"add")},remove:function(){m(k(arguments),"remove")}}}();ax={abort:aH(function(){}),canplay:aH(function(){var j=this._t,l;if(j._html5_canplay){return !0}j._html5_canplay=!0;j._onbufferchange(0);l=!isNaN(j.position)?j.position/1000:null;if(j.position&&this.currentTime!==l){try{this.currentTime=l}catch(k){}}j._iO._oncanplay&&j._iO._oncanplay()}),load:aH(function(){var j=this._t;j.loaded||(j._onbufferchange(0),j._whileloading(j.bytesTotal,j.bytesTotal,j._get_html5_duration()),j._onload(!0))}),ended:aH(function(){this._t._onfinish()}),error:aH(function(){this._t._onload(!1)}),loadeddata:aH(function(){var j=this._t,k=j.bytesTotal||1;if(!j._loaded&&!a4){j.duration=j._get_html5_duration(),j._whileloading(k,k,j._get_html5_duration()),j._onload(!0)}}),loadedmetadata:aH(function(){}),loadstart:aH(function(){this._t._onbufferchange(1)}),play:aH(function(){this._t._onbufferchange(0)}),playing:aH(function(){this._t._onbufferchange(0)}),progress:aH(function(k){var o=this._t,n,j=0,m=k.target.buffered;n=k.loaded||0;var l=k.total||1;if(o.loaded){return !1}if(m&&m.length){for(n=m.length-1;0<=n;n--){j=m.end(n)-m.start(n)}n=j/k.target.duration}isNaN(n)||(o._onbufferchange(0),o._whileloading(n,l,o._get_html5_duration()),n&&l&&n===l&&ax.load.call(this,k))}),ratechange:aH(function(){}),suspend:aH(function(j){var k=this._t;ax.progress.call(this,j);k._onsuspend()}),stalled:aH(function(){}),timeupdate:aH(function(){this._t._onTimer()}),waiting:aH(function(){this._t._onbufferchange(1)})};bs=function(j){return !j.serverURL&&(j.type?a6({type:j.type}):a6({url:j.url})||aQ.html5Only)};bG=function(j){if(j){j.src=ai?"":"about:blank"}};a6=function(k){function n(o){return aQ.preferFlash&&aA&&!aQ.ignoreFlash&&"undefined"!==typeof aQ.flash[o]&&aQ.flash[o]}if(!aQ.useHTML5Audio||!aQ.hasHTML5){return !1}var m=k.url||null,k=k.type||null,j=aQ.audioFormats,l;if(k&&"undefined"!==typeof aQ.html5[k]){return aQ.html5[k]&&!n(k)}if(!av){av=[];for(l in j){j.hasOwnProperty(l)&&(av.push(l),j[l].related&&(av=av.concat(j[l].related)))}av=RegExp("\\.("+av.join("|")+")(\\?.*)?$","i")}l=m?m.toLowerCase().match(av):null;if(!l||!l.length){if(k){m=k.indexOf(";"),l=(-1!==m?k.substr(0,m):k).substr(6)}else{return !1}}else{l=l[1]}if(l&&"undefined"!==typeof aQ.html5[l]){return aQ.html5[l]&&!n(l)}k="audio/"+l;m=aQ.html5.canPlayType({type:k});return(aQ.html5[l]=m)&&aQ.html5[k]&&!n(k)};bw=function(){function k(q){var p,s,r=!1;if(!o||"function"!==typeof o.canPlayType){return !1}if(q instanceof Array){for(p=0,s=q.length;p<s&&!r;p++){if(aQ.html5[q[p]]||o.canPlayType(q[p]).match(aQ.html5Test)){r=!0,aQ.html5[q[p]]=!0,aQ.flash[q[p]]=!(!aQ.preferFlash||!aA||!q[p].match(ag))}}return r}q=o&&"function"===typeof o.canPlayType?o.canPlayType(q):!1;return !(!q||!q.match(aQ.html5Test))}if(!aQ.useHTML5Audio||"undefined"===typeof Audio){return !1}var o="undefined"!==typeof Audio?br?new Audio(null):new Audio:null,n,j={},m,l;m=aQ.audioFormats;for(n in m){if(m.hasOwnProperty(n)&&(j[n]=k(m[n].type),j["audio/"+n]=j[n],aQ.flash[n]=aQ.preferFlash&&!aQ.ignoreFlash&&n.match(ag)?!0:!1,m[n]&&m[n].related)){for(l=m[n].related.length-1;0<=l;l--){j["audio/"+m[n].related[l]]=j[n],aQ.html5[m[n].related[l]]=j[n],aQ.flash[m[n].related[l]]=j[n]}}}j.canPlayType=o?k:null;aQ.html5=az(aQ.html5,j);return !0};bh=function(){};aW=function(j){if(8===aJ&&1<j.loops&&j.stream){j.stream=!1}return j};aV=function(j){if(j&&!j.usePolicyFile&&(j.onid3||j.usePeakData||j.useWaveformData||j.useEQData)){j.usePolicyFile=!0}return j};am=function(){};bC=function(){return !1};bu=function(j){for(var k in j){j.hasOwnProperty(k)&&"function"===typeof j[k]&&(j[k]=bC)}};aX=function(j){"undefined"===typeof j&&(j=!1);(aw||j)&&aQ.disable(j)};be=function(j){var k=null;if(j){if(j.match(/\.swf(\?.*)?$/i)){if(k=j.substr(j.toLowerCase().lastIndexOf(".swf?")+4)){return j}}else{j.lastIndexOf("/")!==j.length-1&&(j+="/")}}j=(j&&-1!==j.lastIndexOf("/")?j.substr(0,j.lastIndexOf("/")+1):"./")+aQ.movieURL;aQ.noSWFCache&&(j+="?ts="+(new Date).getTime());return j};aK=function(){aJ=parseInt(aQ.flashVersion,10);if(8!==aJ&&9!==aJ){aQ.flashVersion=aJ=8}var j=aQ.debugMode||aQ.debugFlash?"_debug.swf":".swf";if(aQ.useHTML5Audio&&!aQ.html5Only&&aQ.audioFormats.mp4.required&&9>aJ){aQ.flashVersion=aJ=9}aQ.version=aQ.versionNumber+(aQ.html5Only?" (HTML5-only mode)":9===aJ?" (AS3/Flash 9)":" (AS2/Flash 8)");8<aJ?(aQ.defaultOptions=az(aQ.defaultOptions,aQ.flash9Options),aQ.features.buffering=!0,aQ.defaultOptions=az(aQ.defaultOptions,aQ.movieStarOptions),aQ.filePatterns.flash9=RegExp("\\.(mp3|"+bp.join("|")+")(\\?.*)?$","i"),aQ.features.movieStar=!0):aQ.features.movieStar=!1;aQ.filePattern=aQ.filePatterns[8!==aJ?"flash9":"flash8"];aQ.movieURL=(8===aJ?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",j);aQ.features.peakData=aQ.features.waveformData=aQ.features.eqData=8<aJ};bD=function(j,k){if(!aL){return !1}aL._setPolling(j,k)};bv=function(){if(aQ.debugURLParam.test(ac)){aQ.debugMode=!0}};aC=this.getSoundById;bg=function(){var j=[];aQ.debugMode&&j.push("sm2_debug");aQ.debugFlash&&j.push("flash_debug");aQ.useHighPerformance&&j.push("high_performance");return j.join(" ")};aO=function(){bh("fbHandler");var j=aQ.getMoviePercent(),k={type:"FLASHBLOCK"};if(aQ.html5Only){return !1}if(aQ.ok()){if(aQ.oMC){aQ.oMC.className=[bg(),"movieContainer","swf_loaded"+(aQ.didFlashBlock?" swf_unblocked":"")].join(" ")}}else{if(ay){aQ.oMC.className=bg()+" movieContainer "+(null===j?"swf_timedout":"swf_error")}aQ.didFlashBlock=!0;bn({type:"ontimeout",ignoreInit:!0,error:k});bk(k)}};bc=function(j,l,k){"undefined"===typeof aB[j]&&(aB[j]=[]);aB[j].push({method:l,scope:k||null,fired:!1})};bn=function(k){k||(k={type:"onready"});if(!aD&&k&&!k.ignoreInit||"ontimeout"===k.type&&aQ.ok()){return !1}var o={success:k&&k.ignoreInit?aQ.ok():!aw},n=k&&k.type?aB[k.type]||[]:[],j=[],m,o=[o],l=ay&&aQ.useFlashBlock&&!aQ.ok();if(k.error){o[0].error=k.error}for(k=0,m=n.length;k<m;k++){!0!==n[k].fired&&j.push(n[k])}if(j.length){for(k=0,m=j.length;k<m;k++){if(j[k].scope?j[k].method.apply(j[k].scope,o):j[k].method.apply(this,o),!l){j[k].fired=!0}}}return !0};bm=function(){aN.setTimeout(function(){aQ.useFlashBlock&&aO();bn();aQ.onload instanceof Function&&aQ.onload.apply(aN);aQ.waitForWindowLoad&&aG.add(aN,"load",bm)},1)};a5=function(){if(void 0!==aA){return aA}var k=!1,o=navigator,n=o.plugins,j,m=aN.ActiveXObject;if(n&&n.length){(o=o.mimeTypes)&&o["application/x-shockwave-flash"]&&o["application/x-shockwave-flash"].enabledPlugin&&o["application/x-shockwave-flash"].enabledPlugin.description&&(k=!0)}else{if("undefined"!==typeof m){try{j=new m("ShockwaveFlash.ShockwaveFlash")}catch(l){}k=!!j}}return aA=k};bF=function(){var j,k;if(bo&&aE.match(/os (1|2|3_0|3_1)/i)){aQ.hasHTML5=!1;aQ.html5Only=!0;if(aQ.oMC){aQ.oMC.style.display="none"}return !1}if(aQ.useHTML5Audio){if(!aQ.html5||!aQ.html5.canPlayType){return aQ.hasHTML5=!1,!0}aQ.hasHTML5=!0;if(ao&&a5()){return !0}}else{return !0}for(k in aQ.audioFormats){if(aQ.audioFormats.hasOwnProperty(k)&&(aQ.audioFormats[k].required&&!aQ.html5.canPlayType(aQ.audioFormats[k].type)||aQ.flash[k]||aQ.flash[aQ.audioFormats[k].type])){j=!0}}aQ.ignoreFlash&&(j=!1);aQ.html5Only=aQ.hasHTML5&&aQ.useHTML5Audio&&!j;return !aQ.html5Only};bx=function(k){var m,l,j=0;if(k instanceof Array){for(m=0,l=k.length;m<l;m++){if(k[m] instanceof Object){if(aQ.canPlayMIME(k[m].type)){j=m;break}}else{if(aQ.canPlayURL(k[m])){j=m;break}}}if(k[j].url){k[j]=k[j].url}return k[j]}return k};aM=function(j){if(!j._hasTimer){j._hasTimer=!0,!aR&&aQ.html5PollingInterval&&(null===a7&&0===aS&&(a7=e.setInterval(ae,aQ.html5PollingInterval)),aS++)}};al=function(j){if(j._hasTimer){j._hasTimer=!1,!aR&&aQ.html5PollingInterval&&aS--}};ae=function(){var j;if(null!==a7&&!aS){return e.clearInterval(a7),a7=null,!1}for(j=aQ.soundIDs.length-1;0<=j;j--){aQ.sounds[aQ.soundIDs[j]].isHTML5&&aQ.sounds[aQ.soundIDs[j]]._hasTimer&&aQ.sounds[aQ.soundIDs[j]]._onTimer()}};bk=function(j){j="undefined"!==typeof j?j:{};aQ.onerror instanceof Function&&aQ.onerror.apply(aN,[{type:"undefined"!==typeof j.type?j.type:null}]);"undefined"!==typeof j.fatal&&j.fatal&&aQ.disable()};bj=function(){if(!ao||!a5()){return !1}var j=aQ.audioFormats,l,k;for(k in j){if(j.hasOwnProperty(k)&&("mp3"===k||"mp4"===k)){if(aQ.html5[k]=!1,j[k]&&j[k].related){for(l=j[k].related.length-1;0<=l;l--){aQ.html5[j[k].related[l]]=!1}}}}};this._setSandboxType=function(){};this._externalInterfaceOK=function(){if(aQ.swfLoaded){return !1}(new Date).getTime();aQ.swfLoaded=!0;bf=!1;ao&&bj();at?setTimeout(a1,100):a1()};aY=function(z,w){function v(l,j){return'<param name="'+l+'" value="'+j+'" />'}if(bd&&bb){return !1}if(aQ.html5Only){return aK(),aQ.oMC=a2(aQ.movieID),a1(),bb=bd=!0,!1}var y=w||aQ.url,u=aQ.altURL||y,r;r=bE();var t,s,q=bg(),p,n=null,n=(n=aI.getElementsByTagName("html")[0])&&n.dir&&n.dir.match(/rtl/i),z="undefined"===typeof z?aQ.id:z;aK();aQ.url=be(H?y:u);w=aQ.url;aQ.wmode=!aQ.wmode&&aQ.useHighPerformance?"transparent":aQ.wmode;if(null!==aQ.wmode&&(aE.match(/msie 8/i)||!at&&!aQ.useHighPerformance)&&navigator.platform.match(/win32|win64/i)){aQ.wmode=null}r={name:z,id:z,src:w,quality:"high",allowScriptAccess:aQ.allowScriptAccess,bgcolor:aQ.bgColor,pluginspage:bH+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",type:"application/x-shockwave-flash",wmode:aQ.wmode,hasPriority:"true"};if(aQ.debugFlash){r.FlashVars="debug=1"}aQ.wmode||delete r.wmode;if(at){y=aI.createElement("div"),s=['<object id="'+z+'" data="'+w+'" type="'+r.type+'" title="'+r.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+bH+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" width="'+r.width+'" height="'+r.height+'">',v("movie",w),v("AllowScriptAccess",aQ.allowScriptAccess),v("quality",r.quality),aQ.wmode?v("wmode",aQ.wmode):"",v("bgcolor",aQ.bgColor),v("hasPriority","true"),aQ.debugFlash?v("FlashVars",r.FlashVars):"","</object>"].join("")}else{for(t in y=aI.createElement("embed"),r){r.hasOwnProperty(t)&&y.setAttribute(t,r[t])}}bv();q=bg();if(r=bE()){if(aQ.oMC=a2(aQ.movieID)||aI.createElement("div"),aQ.oMC.id){p=aQ.oMC.className;aQ.oMC.className=(p?p+" ":"movieContainer")+(q?" "+q:"");aQ.oMC.appendChild(y);if(at){t=aQ.oMC.appendChild(aI.createElement("div")),t.className="sm2-object-box",t.innerHTML=s}bb=!0}else{aQ.oMC.id=aQ.movieID;aQ.oMC.className="movieContainer "+q;t=q=null;if(!aQ.useFlashBlock){if(aQ.useHighPerformance){q={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}}else{if(q={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},n){q.left=Math.abs(parseInt(q.left,10))+"px"}}}if(bB){aQ.oMC.style.zIndex=10000}if(!aQ.debugFlash){for(p in q){q.hasOwnProperty(p)&&(aQ.oMC.style[p]=q[p])}}try{at||aQ.oMC.appendChild(y);r.appendChild(aQ.oMC);if(at){t=aQ.oMC.appendChild(aI.createElement("div")),t.className="sm2-object-box",t.innerHTML=s}bb=!0}catch(k){throw Error(bh("domError")+" \n"+k.toString())}}}return bd=!0};aZ=function(){if(aQ.html5Only){return aY(),!1}if(aL){return !1}aL=aQ.getMovie(aQ.id);if(!aL){a8?(at?aQ.oMC.innerHTML=bi:aQ.oMC.appendChild(a8),a8=null,bd=!0):aY(aQ.id,aQ.url),aL=aQ.getMovie(aQ.id)}aQ.oninitmovie instanceof Function&&setTimeout(aQ.oninitmovie,1);return !0};a0=function(){setTimeout(bq,1000)};bq=function(){if(aU){return !1}aU=!0;aG.remove(aN,"load",a0);if(bf&&!ah){return !1}var j;aD||(j=aQ.getMoviePercent());setTimeout(function(){j=aQ.getMoviePercent();!aD&&an&&(null===j?aQ.useFlashBlock||0===aQ.flashLoadTimeout?aQ.useFlashBlock&&aO():aX(!0):0!==aQ.flashLoadTimeout&&aX(!0))},aQ.flashLoadTimeout)};ar=function(){function j(){aG.remove(aN,"focus",ar);aG.remove(aN,"load",ar)}if(ah||!bf){return j(),!0}ah=an=!0;a4&&bf&&aG.remove(aN,"mousemove",ar);aU=!1;j();return !0};aP=function(){var j,k=[];if(aQ.useHTML5Audio&&aQ.hasHTML5){for(j in aQ.audioFormats){aQ.audioFormats.hasOwnProperty(j)&&k.push(j+": "+aQ.html5[j]+(!aQ.html5[j]&&aA&&aQ.flash[j]?" (using flash)":aQ.preferFlash&&aQ.flash[j]&&aA?" (preferring flash)":!aQ.html5[j]?" ("+(aQ.audioFormats[j].required?"required, ":"")+"and no flash support)":""))}}};a9=function(j){if(aD){return !1}if(aQ.html5Only){return aD=!0,bm(),!0}var k;if(!aQ.useFlashBlock||!aQ.flashLoadTimeout||aQ.getMoviePercent()){aD=!0,aw&&(k={type:!aA&&ay?"NO_FLASH":"INIT_TIMEOUT"})}if(aw||j){if(aQ.useFlashBlock&&aQ.oMC){aQ.oMC.className=bg()+" "+(null===aQ.getMoviePercent()?"swf_timedout":"swf_error")}bn({type:"ontimeout",error:k});bk(k);return !1}if(aQ.waitForWindowLoad&&!bt){return aG.add(aN,"load",bm),!1}bm();return !0};a1=function(){if(aD){return !1}if(aQ.html5Only){if(!aD){aG.remove(aN,"load",aQ.beginDelayedInit),aQ.enabled=!0,a9()}return !0}aZ();try{aL._externalInterfaceTest(!1),bD(!0,aQ.flashPollingInterval||(aQ.useHighPerformance?10:50)),aQ.debugMode||aL._disableDebug(),aQ.enabled=!0,aQ.html5Only||aG.add(aN,"unload",bC)}catch(j){return bk({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),aX(!0),a9(),!1}a9();aG.remove(aN,"load",aQ.beginDelayedInit);return !0};bl=function(){if(ad){return !1}ad=!0;bv();if(!aA&&aQ.hasHTML5){aQ.useHTML5Audio=!0,aQ.preferFlash=!1}bw();aQ.html5.usingFlash=bF();ay=aQ.html5.usingFlash;aP();if(!aA&&ay){aQ.flashLoadTimeout=1}aI.removeEventListener&&aI.removeEventListener("DOMContentLoaded",bl,!1);aZ();return !0};by=function(){"complete"===aI.readyState&&(bl(),aI.detachEvent("onreadystatechange",by));return !0};ak=function(){bt=!0;aG.remove(aN,"load",ak)};a5();aG.add(aN,"focus",ar);aG.add(aN,"load",ar);aG.add(aN,"load",a0);aG.add(aN,"load",ak);a4&&bf&&aG.add(aN,"mousemove",ar);aI.addEventListener?aI.addEventListener("DOMContentLoaded",bl,!1):aI.attachEvent?aI.attachEvent("onreadystatechange",by):bk({type:"NO_DOM2_EVENTS",fatal:!0});"complete"===aI.readyState&&setTimeout(bl,100)}};Player=a("player.js")}());var Account=Class.create({initialize:function(a){if(a.lastTrialDay){a.lastTrialDay=new Date(a.lastTrialDay)}else{delete a.daysLeftInTrial}_.extend(this,a)},hasFeature:function(a){return _(this.features).contains(a)}});var User=Class.create({initialize:function(a){a.passwordExpiresAt=new Date(a.passwordExpiresAt);switch(a.role){case User.roles.endUser:this.isAnonymous=(typeof(a.id)==="undefined")||(a.id===null);this.isEndUser=true;this.isAgent=false;this.isAdmin=false;break;case User.roles.admin:this.isAnonymous=false;this.isEndUser=false;this.isAgent=true;this.isAdmin=true;break;case User.roles.agent:this.isAnonymous=false;this.isEndUser=false;this.isAgent=true;this.isAdmin=false;break;default:break}_.extend(this,a)},isPasswordExpiring:function(){var a=(new Date()).valueOf();var c=5*24*60*60*1000;return(this.passwordExpiresAt>a)&&(this.passwordExpiresAt<a+c)},isTagged:function(a){return _(this.tags).contains(a)}});User.roles={endUser:0,admin:2,agent:4};User.restrictions={none:0,groups:1,organization:2,assigned:3,requested:4};var Organization=Class.create({initialize:function(a){_.extend(this,a)}});var currentUser=null;var currentAccount=null;User.load=function(a){Zendesk.ToTangoId=a.misc.toTangoID;Zendesk.viewedOnMobileDevice=a.misc.isMobileAgent;currentUser=Zendesk.currentUser=new User(a.user);currentUser.account=currentAccount=Zendesk.currentAccount=new Account(a.account);currentUser.organization=new Organization(a.organization);currentUser.canViewMultipleOrganizations=currentAccount.hasFeature("multipleOrganizations")&&currentUser.sharedOrganizations.length>1;currentUser.canViewOrganization=currentUser.organization.name!=undefined&&(!currentUser.isEndUser||currentUser.restriction===User.restrictions.organization||currentUser.organization.isShared);if(currentUser.isAdmin){Zendesk.NS("Voice");Zendesk.Voice.Config={AccountSid:a.voice.account_sid,ApiVersion:a.voice.api_version};Zendesk.Voice.NumberResources=a.voice.number_resources}};var $j=jQuery.noConflict();var $z=(function(){var a={};var c=function(d){if(typeof(a[d])==="object"){var e=function(){};e.prototype=a[d];return(new e())}};c.defModule=function(d,e){if(typeof(a[d])!=="object"){a[d]=e}};c.initializeModules=function(d){$j(document).ready(function(e){$j(d).each(function(g,f){if(typeof(a[f[0]])==="object"&&typeof(a[f[0]].initialize)==="function"){var j=function(){this.initialize.apply(this,f[1]);delete this["initialize"]};j.prototype=a[f[0]];var h=new j()}})})};return(c)})();var Zendesk=$z;(function(c){var a=c.cookie("_zendesk_settings");c.cookie("_zendesk_settings",null,{path:"current"});if(!c.cookie("_zendesk_settings")){c.cookie("_zendesk_settings",a,{path:"/",expires:365})}Zendesk.SettingsCookie={get:function(d){return Zendesk.SettingsCookie._data()[d]},set:function(d,f){var e=Zendesk.SettingsCookie._data();e[d]=f;Zendesk.SettingsCookie._save();return f},erase:function(d){var e=Zendesk.SettingsCookie._data();delete e[d];Zendesk.SettingsCookie._save()},_data:function(){Zendesk.SettingsCookie._data_object=Zendesk.SettingsCookie._data_object||JSON.parse(c.cookie("_zendesk_settings")||"{}");return Zendesk.SettingsCookie._data_object},_save:function(){var d=Zendesk.SettingsCookie._data();c.cookie("_zendesk_settings",JSON.stringify(d),{path:"/",expires:365})}};window.Cookie=Zendesk.SettingsCookie}(this.jQuery));jQuery.fn.truncateViaFade=function(){this.each(function(){var a=$j(this);a.css("display","block");if(a.css("position")!="absolute"){a.css("position","relative")}a.append($j('<span class="faded_truncation"></span>').css("height",a.height()))})};var arrayEquals=function(d,c){if(d.length!=c.length){return false}for(var e=d.length;--e>=0;){if((d[e] instanceof Date)&&(c[e] instanceof Date)){if(!dateEquals(d[e],c[e])){return false}}else{if(d[e]!==c[e]){return false}}}return true};var dateEquals=function(d,c){return(d instanceof Date)&&(c instanceof Date)&&(d>=c)&&(d<=c)};(function(d,c){if(!c.Zendesk){c.Zendesk={}}var a=c.Zendesk;if(!!a.NS){return}var e=Array.prototype.slice;function f(j,g){if(g.length>0){var h=g.pop();if(d.isFunction(h)){h.apply(j,g)}else{if(!!h){throw new Error(h+" is not a function")}}}}a.NS=function(g){var l=g.split("."),k=a,h;for(h=0;h<l.length;h++){var j=l[h];if(typeof(k[j])==="undefined"){k[j]={}}k=k[j]}f(k,e.call(arguments,1,arguments.length));return k};a.NS.extend=function(g,h){d.extend(a.NS(g),h)}}(this.jQuery,this));Zendesk.NS("UI",this.jQuery,function(a){this.NestedMenu=function(c){this._menu=a(c);var d=this;this.initialize=function(){a(document).bind("click",function(f){if(a(f.target).parents().index(d._menu)<0){d.collapse()}});var e=d._menu.find("li:eq(0)");e.click(function(){e.find("> ul").show();d._menu.css("z-index","15")});d._menu.find("ul > li").each(function(h,f){var g=a(f);g.mouseover(function(){Zendesk.UI.NestedMenu.close_submenu(g);g.parent().data("selection",a(f));g.find("> ul").show()})});return d};this.collapse=function(){d._menu.find("li").each(function(f,e){a(e).find("ul").hide();d._menu.css("z-index","")});return d}};this.NestedMenu.close_submenu=function(d){var c=d.parent().data("selection");if(c){a(c).find("> ul").hide()}}});jQuery(function(h){var f=h("#ticket_assignee_id");var g=f.data("bulk-update");var a=h("#ticket_group_id");if(!f.exists()||!f.data("do-dynamic-filtering")){a.change(function(){window.assigneeSelect(h(this).val())});return}var d={};function e(j){if(d[j]){return new h.Deferred().resolve(d[j])}else{return h.getJSON(f.data("refresh-url"),{group_id:j}).done(function(k){d[j]=k})}}function c(k){f.attr("disabled",false);var j=f.val();if(g){f.html('<option value="-1">'+I18n.t("control.dropdown.value.no_change")+'</option><option value="">-</option>')}else{f.html("<option></option>")}_(k).each(function(l){f.append("<option value='"+l.id+"'>"+l.name+"</option>")});f.val(j).change()}a.change(function(){f.attr("disabled",true);e(a.val()).done(c)}).change();window.assigneeSelect=function(k,j){k=k||a.val();return e(k).done(c).done(function(){j!==undefined&&j!==f.val()&&f.val(j).change();a.add(f).blur()})};window.assigneeSelect(null,f.data("value"))});(function(d){function c(f){var h=Math.ceil(f/1000);var g=Math.floor(h/60);h=h%60;if(h<10){h="0"+h}if(g<10){g="0"+g}return g+":"+h}var e=_([[3,0],[7,20],[12,40],[17,60],[22,80],[27,100]]);function a(g){var f=g.pageX;for(var h=g.target;h;h=h.offsetParent){f-=h.offsetLeft}return(e.find(function(j){return f<=j[0]})||[])[1]}Zendesk.AudioPlayer=function(g,f){this.sound=g;this.playerElement=f;this.seekbar=this.playerElement.find(".seekbar");this.timeRemaining=this.playerElement.find(".time_remaining");this.playButton=this.playerElement.find(".play");this.volumeButton=this.playerElement.find(".volume");this.seeking=false};Zendesk.AudioPlayer.prototype={init:function(){this.soundObj=this.sound.sound;this.soundObj._player=this;var f=this;if(this.sound.playState()!==0){this.playButton.addClass("playing")}this.playButton.click(function(){f.playButton.toggleClass("playing");if(f.playButton.attr("data-state")==="paused"){f.playButton.attr("data-state","playing");f.play()}else{f.playButton.attr("data-state","paused");f.pause()}});this.volumeButton.click(function(g){f.updateVolume(a(g))});this.seekbar.slider({value:0,step:50,max:this.sound.duration(),slide:function(h,g){f.seeking=true},change:function(h,g){if(h.originalEvent){f.sound.seekTo(g.value);f.updateTimeRemaining()}f.seeking=false}});this.updateTimeRemaining();return this},play:function(){this.sound.play({whileplaying:this.timeUpdate,onfinish:this.finishedPlaying})},pause:function(){this.sound.pause()},timeUpdate:function(){var f=this._player;if(f.seeking){return}f.seekbar.slider("value",f.sound.position());f.updateTimeRemaining()},finishedPlaying:function(){var f=this._player;f.seekbar.slider("value",0);f.playButton.attr("data-state","paused");f.playButton.removeClass("playing");f.sound.seekTo(0);f.pause();f.updateTimeRemaining()},updateTimeRemaining:function(){this.timeRemaining.html(c(this.sound.duration()-this.sound.position()))},updateVolume:function(f){if(f!==null){this.sound.volume(f);this.volumeButton.removeClass("v0 v20 v40 v60 v80 v100").addClass("v"+f)}}}}(this.jQuery));(function(a){a.widget("ui.floating_menu",{options:{menuText:I18n.t("txt.users.show.actions")},_create:function(){var c;a.extend(this.options,{menuText:a(this.element).attr("data-menu-text")});a(this.element).wrap(a("<div>").addClass("floating_menu_ui inactive"));c=a("<span>",{html:this.options.menuText}).addClass("floating_menu_action");c.insertBefore(this.element);this.menu=this.element.parent(".floating_menu_ui");c.bind("mouseover",a.proxy(this.show,this));this.menu.bind("mouseleave",a.proxy(this.hide,this))},show:function(c){this.menu.removeClass("inactive")},hide:function(c){this.menu.addClass("inactive")}})}(this.jQuery));$j(function(){$j(".floating_menu").floating_menu()});function identityTypeListElementId(a){return"#"+a+"_identity_list"}Zendesk.Identity=function(c,a){this.singleIdentityLimit=["facebook"];this.unverifieds=["email","unverified_email","google"];this.primaries=["email","google"];this.externalIdentities=["facebook","twitter"];this.identityType=a.identity_type;this.id=a.id;this.isVerified=a.is_verified;this.isPrimary=false;this.isExternalIdentity=_(this.externalIdentities).include(this.identityType);this.listElmId=identityTypeListElementId(this.identityType);this.elmId=(a.identity_type+"_identity_"+a.id);this.removeUrl="/users/"+c+(a.identity_type==="unverified_email"?"/unverified_email_addresses/":"/user_identities/")+a.id+".json";if(_(this.primaries).include(a.identity_type)){this.primaryUrl="/users/"+c+"/user_identities/"+a.id+"/make_primary.json"}switch(a.identity_type){case"twitter":this.name="@"+a.screen_name;break;case"facebook":this.name=a.name;break;default:this.isPrimary=(a.priority==1);this.name=a.value}};Zendesk.Identity.prototype.isUnverified=function(){return(_(this.unverifieds).include(this.identityType)&&!this.isVerified)};Zendesk.Identity.prototype.isPrimaryCandidate=function(){return(_(this.primaries).include(this.identityType)&&this.isVerified)};Zendesk.IdentitiesManager=function(d,c){var a=function(f){var e=$j.parseJSON($j("#all_user_identities").html())||[];var g=$j.parseJSON($j("#unverified_email_addresses").html())||[];return $j.merge(e,g).map(function(h){return new Zendesk.Identity(f,h)})};this.registerOnUpdate(c);this.identities=a(d)};Zendesk.IdentitiesManager.prototype.find=function(a){return _(this.identities).find(function(c){return c.elmId==a})};Zendesk.IdentitiesManager.prototype.remove=function(a,c){if(typeof a=="undefined"){return $j.deferred().reject("No identity provided to be removed")}return $j.ajax({url:a.removeUrl,type:"DELETE"}).done($j.proxy(function(){this.identities=_(this.identities).without(a).compact();this.onUpdate()},this))};Zendesk.IdentitiesManager.prototype.registerOnUpdate=function(a){if(typeof a==="function"){this.onUpdate=a}};Zendesk.IdentitiesManager.prototype.makePrimary=function(a){if(typeof a.primaryUrl=="undefined"){return $j.deferred().reject("The identity type "+a.identityType+" cannot be primary")}return $j.ajax({url:a.primaryUrl,type:"POST"}).done($j.proxy(function(){var c=this.primary();if(c){c.isPrimary=false}a.isPrimary=true},this))};Zendesk.IdentitiesManager.prototype.empty=function(){return this.identities.length===0};Zendesk.IdentitiesManager.prototype.limitToSingleIdentity=function(a){return _(this.singleIdentityLimit).include(a.identityType)};Zendesk.IdentitiesManager.prototype.allPrimaryCandidates=function(){return _(this.identities).select(function(a){return a.isPrimaryCandidate()})};Zendesk.IdentitiesManager.prototype.primary=function(){return _(this.allPrimaryCandidates()).detect(function(a){return a.isPrimary})};(function(f,d){function e(g){return g&&g.length&&g.prop&&/^form$/i.test(g.prop("tagName"))}function c(g){return !!g.data("zd-tracking-enabled")}function a(g){g.data("zd-tracking-enabled",true)}f.fn.extend({instrumentTracking:function(){return f(this).each(function(g,h){h=f(h);if(c(h)){return}if(e(h)){h.submit(function(k){var j=f(this);j.trackEvent();k.preventDefault();window.setTimeout(function(){if(!k.isPropagationStopped()){j[0].submit()}},500)})}else{h.click(function(){f(this).trackEvent()})}a(h)})},trackEvent:function(h,g){f(this).trackZendeskEvent(h,g).trackToTangoEvent(h,g)},trackZendeskEvent:function(h,g){h=h||f(this).closest("[data-metric-activity]").attr("data-metric-activity");g=g||f(this).closest("[data-metric-module]").attr("data-metric-module");if(h&&g){Zendesk.Instrumentation.track(h,g)}return f(this)},trackToTangoEvent:function(h,g){h=h||f(this).closest("[data-tracking-activity]").attr("data-tracking-activity");g=g||f(this).closest("[data-tracking-module]").attr("data-tracking-module");if(h&&g){Zendesk.Instrumentation.ToTango.track(h,g)}return f(this)}});Zendesk.NS.extend("Instrumentation",{BROWSER_MAP:{Chrome:navigator.userAgent.match(/Chrome/),Safari:(navigator.vendor||"").match(/Apple/),Firefox:navigator.userAgent.match(/Firefox/),IE:navigator.userAgent.match(/MSIE/)},currentBrowser:function(){return _(Zendesk.Instrumentation.BROWSER_MAP).find(function(g,h){return h?g:undefined}).first()},track:function(h,g){return},on:function(k,g,l,h){if(k[g].isTracking){return}var j=function(){var m=_.toArray(arguments),p=m.slice(1),n=m[0],q=n.apply(this,p);if(l&&h){var o=_.isFunction(l)?l.apply(this,p):l;if(o){Zendesk.Instrumentation.track(o,h);Zendesk.Instrumentation.ToTango.track(o,h)}}return q};k[g]=_.wrap(k[g],j);k[g].isTracking=true},ToTango:{track:function(h,g){if(d.currentAccount){var j={sdr_s:Zendesk.ToTangoID,sdr_o:d.currentAccount.subdomain,sdr_ofid:d.currentAccount.id,sdr_u:this.username(),sdr_m:d.currentAccount.isInTrial?"Trial":"Customer",sdr_a:[g,h].join(": ")};$j.get("/tracker/pixel.gif?"+$j.param(j))}},username:function(){if(d.currentUser===undefined||d.currentUser.isEndUser){return"end-user"}else{if(d.currentUser.id&&!d.currentAccount.isInTrial){return"agent-"+Base64.encode(d.currentUser.id.toString())}else{return d.currentUser.id}}},tracker:{track:function(){},identify:function(){}},PLATFORM_MAP:_([[/mac/i,"Mac"],[/win/i,"Windows"],[/palm/i,"PalmOS"],[/(unix|linux)/i,"Unix"],[/blackberry/i,"Blackberry"]]),trackOperatingSystem:function(){}}});f(function(){f(".tracked").instrumentTracking()})}(this.jQuery,this));(function(a){a.fn.extend({exists:function(){return this.length>0}});a.fn.responsiveLoad=function(c,f){var e='<center><img src="/images/ajax-loader.gif" alt="Loading"/></center>';var d=a(this);d.html(e).load(c,function(h,g,j){if(g=="error"){d.html("Error:"+j.status+" "+j.statusText)}else{if(f){f(h,g,j)}}})};a.fn.pjaxContainer=function(c){c=c||"a";var d=a(this);a(c,d).live("click",function(){d.responsiveLoad(a(this).attr("href"));return false})}}(this.jQuery));Zendesk.JobStatus=function(d,a){this.statusUrl=d;var c=/\/job_statuses\/([^\.\?]+)/;this.id=(d.match(c)||[])[1];if(this.id==null&&console&&console.warn){console.warn("Could not parse Job ID from "+d)}this.options=_.extend({title:"",interval:1000},a);_.bindAll(this);this.createFlashNotice();this.updateProgress()};Zendesk.JobStatus.prototype={createFlashNotice:function(){if(!this.flash){this.flash=$j('<div id="notice" class="processing"><span class="progress"/> <span>'+this.options.title+" </span></div>");$j("#flash_messages div").hide();$j("#flash_messages").append($j('<div id="flash" class="background"></div>').append(this.flash));$j(document).scrollTop($j("#flash_messages").position().top)}return this.flash},updateProgress:function(){var a=this;$j.getJSON(this.statusUrl,function(d){d.job=a;if(d.status!=="completed"){if(d.total){a.flash.find(".progress").html(""+d.progress+" / "+d.total)}setTimeout(a.updateProgress,a.options.interval)}else{var c=a.options.renderResult(d);a.flash.find(".progress").html(c.title);a.flash.append(c.body);a.flash.removeClass("processing");a.flash.addClass("done_processing")}})}};(function(a){Zendesk.Pager=function(e,d,c){this.container=e;this.nextLink=c;this.prevLink=d;this.pages=a(e).find(".page");this.currentPage=0;this.prevLink.css("visibility","hidden");if(this.pages.length<2){this.nextLink.css("visibility","hidden")}};Zendesk.Pager.prototype={paginate:function(d){this.showPage(this.currentPage);var c=this;a(this.prevLink).click(function(f){if(c.currentPage>0){c.nextLink.css("visibility","visible");c.currentPage=c.currentPage-1;c.showPage(c.currentPage);if(c.currentPage===0){c.prevLink.css("visibility","hidden")}}if(f){f.preventDefault()}});a(this.nextLink).click(function(f){if(c.currentPage<c.pages.length-1){c.prevLink.css("visibility","visible");c.currentPage=c.currentPage+1;c.showPage(c.currentPage);if(c.currentPage===c.pages.length-1){c.nextLink.css("visibility","hidden")}}if(f){f.preventDefault()}});if(_.isFunction(d)){d()}},showPage:function(c){_(this.pages).each(function(d,e){if(e===c){a(d).show()}else{a(d).hide()}})}}}(this.jQuery));(function(e,d,f,a){function c(g){this.duration=g;this.jobs=[]}c.prototype={id:null,duration:null,jobs:null,start:function(){if(!this.id){this._work();this.id=d(this._work.bind(this),this.duration)}},stop:function(){if(this.id){f(this.id);this.id=null}},_work:function(){e.each(this.jobs,function(g,h){h()})}};a.PeriodicWorker=c}(window.jQuery,window.setInterval,window.clearTimeout,window));Zendesk.NS("Utils");Zendesk.Utils.Poller=function(e,g,f,a,d,c){this.wait=g;this.maxWait=f;this.ajaxOptions={url:e.url,method:e.method||"get",data:e.data};this.successCallback=a;this.errorCallback=d;this.timeoutCallback=c;this.periodicWorker=new PeriodicWorker(g);this.waited=-g};Zendesk.Utils.Poller.prototype={start:function(){this.periodicWorker.jobs=[this._poll.bind(this)];this.periodicWorker.start()},stop:function(){this.periodicWorker.stop()},_poll:function(){this.waited=this.waited+this.wait;if(this.waited>this.maxWait){this.stop();if(this.timeoutCallback){this.timeoutCallback()}return}$j.ajax({type:this.ajaxOptions.method,url:this.ajaxOptions.url,data:this.ajaxOptions.data,success:function(a){if(!this.successCallback||!this.successCallback(a)){this.stop()}}.bind(this),error:function(a){if(!this.errorCallback||!this.errorCallback(a)){this.stop()}}.bind(this)})}};var LARGE_SELECT_LENGTH=70;jQuery.fn.extend({autocompleteFromSelectIfLarge:function(a){var c=LARGE_SELECT_LENGTH;jQuery(this).each(function(e,d){if(jQuery("option",d).length>c){jQuery(d).autocompleteFromSelect(a)}})}});jQuery.widget("ui.autocompleteFromSelect",{options:{tabIndex:null,placeholder:null,maxResults:15,combobox:true},_create:function(){var k=this,g=this.element,e=g.children(":selected"),c=g.is(":hidden"),j=e.val()?e.text():null,d=this.options.tabIndex||g.attr("tabindex"),h=this.options.placeholder||g.attr("placeholder"),l=g.attr("data-no-matches-message")||"Sorry, no results found.";g.hide();g.wrap("<span />");if(c){g.parent().hide()}var f=jQuery("<input type='text' />").addClass("ui-widget ui-widget-content").focus(function(){jQuery(this).select()}).mouseup(function(m){m.preventDefault()}).autocomplete({delay:0,minLength:0,source:function(q,n){var s=new RegExp(jQuery.ui.autocomplete.escapeRegex(q.term),"i");var p=g.children("option:enabled").map(function(){var u=jQuery(this).text(),t=jQuery(this).attr("data-email");if(t){u=u+" "+t}if(this.value&&(!q.term||s.test(u))){return{label:u.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+jQuery.ui.autocomplete.escapeRegex(q.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>"),value:u,option:this}}});if(p.length===0){p=[{label:l,value:null,option:null,disabled:true}]}if(k.options.maxResults&&p.length>k.options.maxResults){var m=p.length-k.options.maxResults;var o="";if(m==1){o=I18n.t("txt.javascript.utils.replace_with_autocomplete.one")}else{o=I18n.t("txt.javascript.utils.replace_with_autocomplete.other",{count:m})}var r={label:o,value:null,option:null,disabled:true};p=p.slice(0,k.options.maxResults);p.push(r)}n(p)},select:function(m,n){if(n.item&&!n.item.disabled){n.item.option.selected=true;k._trigger("selected",m,{item:n.item.option});f.data("searching",false)}},change:function(n,o){if(!o.item){var p=new RegExp("^"+jQuery.ui.autocomplete.escapeRegex(jQuery(this).val())+"$","i"),m=false;g.children("option:enabled").each(function(){if(this.value.match(p)||jQuery(this).text().match(p)){this.selected=m=true;return false}});if(!m){jQuery(this).val("");g.val("");return false}}},close:function(m,n){f.data("searching",false)},search:function(m,n){f.data("searching",true)}});f.data("autocomplete")._renderItem=function(m,n){return jQuery("<li></li>").data("item.autocomplete",n).append("<a>"+n.label+"</a>").appendTo(m)};if(d){f.attr("tabindex",d)}if(h){f.attr("placeholder",h)}if(j){f.val(j)}f.insertBefore(g);if(k.options.combobox){var a=jQuery("<input type='button' class='ui-widget combobox-button' value='▼' />").click(function(){if(f.autocomplete("widget").is(":visible")){f.autocomplete("close")}else{f.autocomplete("search","");f.focus()}});f.addClass("combobox").after(a)}g.removeAttr("tabindex").change(function(){var m=jQuery(":selected",this);if(m.length&&!f.data("searching")){f.val(m.text()).change()}else{if(f.data("searching")){f.autocomplete("search",f.val())}}})}});(function(c,g,d,a){var f="script.search_results_data",j=function(k){};if(a&&a.warn){j=d.bind(a.warn,a)}function h(k){var l=k.find(f).last();if(!l.exists()){j("Paginator received search results with no script.search_results_data element");return{}}var m={};try{m=JSON.parse(l.html())}catch(n){}return m}var e=function(k){if(!k){throw"Cannot paginate results for empty containerSelector"}this.$container=g(k);d.bindAll(this,"onMoreClicked","onMoreRetrieved");this.resetPage().bindMoreButton()};e.parseNextPageFrom=function(k){return h(k).nextPage};e.prototype={resetPage:function(){this.nextPage=2;return this},onMoreClicked:function(){this.loadMore();return false},loadMore:function(){var k=this.moreButton().attr("href");this.spinner().show();g.ajax(k,{page:this.nextPage}).done(this.onMoreRetrieved)},onMoreRetrieved:function(k){this.spinner().hide();this.removeCurrentMoreButton().appendNewResults(k).applySearchResultData(k)},spinner:function(){return this.$container.find(".progress")},removeCurrentMoreButton:function(){this.$container.find(".show_more_bar").remove();return this},moreButton:function(){return this.$container.find(".show_more_bar a")},bindMoreButton:function(){if(!this.$container.data("moreIsBound")){this.$container.data("moreIsBound",true);this.$container.delegate(".show_more_bar a","click",this.onMoreClicked)}return this},appendNewResults:function(k){g(".item.nobottom").removeClass("nobottom");if(this.onContentRetrievedCallback){this.onContentRetrievedCallback(this,k)}else{this.$container.append(k)}g(".forum_tabs").trigger("events-loaded.entries.zendesk");return this},applySearchResultData:function(){this.nextPage=e.parseNextPageFrom(this.$container);this.$container.find(f).remove();if(!this.nextPage){this.removeCurrentMoreButton()}return this}};g.fn.paginateResults=function(l){var k=g(this);if(k.data("resultsPaginator")!=null){return}k.data("resultsPaginator",new e(this,l));return k};g(function(){g(".paginates_with_more").paginateResults()});c.ResultsPaginator=e}(this.Zendesk,this.jQuery,this._,this.console));(function(c){function a(){var e=c(this).find("[value="+c(this).val()+"]");var d=e.data("select-interaction")||c(this).data("default-interaction");if(d instanceof Function){d=[d]}if(d instanceof Array){c(d).each($j.proxy(function(f,g){if(g instanceof Function){g.call(this)}},this))}}c.fn.extend({selectInteraction:function(d){if(c(this).prop("nodeName").toLowerCase()!=="select"||typeof d==="undefined"){return c(this)}if(d["default-interaction"]){c(this).data("default-interaction",d["default-interaction"])}c(this).change(a);return c(this).find("option").each(function(e,f){f=c(f);var g=f.val();if(d[g]){f.data("select-interaction",d[g])}}).change()}})}(window.jQuery));(function(d){var a={emptyTargetText:"Drop items here",emptyTargetClass:null,items:"> :not(.emptyTarget)"};function e(f,g){d("li.emptyTarget",this).hide()}function c(f,g){var h=d("li:not(.emptyTarget)",this);if(g&&g.item){h=h.not(g.item)}if(h.length===0){d("li.emptyTarget",this).show()}}d.fn.sortableWithEmptyTarget=function(g){g=d.extend({},a,g||{});var h=g.emptyTargetText,f=["emptyTarget",g.emptyTargetClass].join(" ");delete g.emptyTargetText;delete g.emptyTargetClass;d(this).each(function(){var j=d(this);d('<li class="'+f+'">'+h+"</li>").toggle(j.find("li").length===0).appendTo(j);j.sortable(g).bind("sortover",d.proxy(e,j)).sortable("option","connectWith").bind("sortover",d.proxy(c,j))})}}(this.jQuery));(function(c,a){Zendesk.StatEvent=function(e,f){var d="/stat_event/";d+=e+"/";c.ajax({url:d,type:"GET",data:f,success:function(){}})}}(this.jQuery,this));(function(a){a.Storage={isSupported:function(){try{return"localStorage" in window&&window.localStorage!==null}catch(c){return false}},handle:function(){return window.localStorage}}}(Zendesk));Zendesk.NS.extend("Text",{autoLink:function(a){return a.replace(/\b(https?:\/\/[^\s"]+)\b/g,'<a href="$1" target="_blank">$1</a>')}});(function(d){function c(){var e;if(d(this).attr("data-toggles")){e=d(d(this).attr("data-toggles"));if(d(this).is(":checked")){e.slideDown()}else{e.slideUp()}}if(d(this).is(":checked")&&d(this).attr("data-toggles-show")){e=d(d(this).attr("data-toggles-show"));e.slideDown()}if(d(this).is(":checked")&&d(this).attr("data-toggles-hide")){e=d(d(this).attr("data-toggles-hide"));e.slideUp()}}function a(){d(d(this).attr("data-toggles")).toggle()}d.fn.extend({isToggler:function(){return d(this).filter("[data-toggles],[data-toggles-show],[data-toggles-hide]").each(function(e,g){g=d(g);var f=g.attr("type");if(f==="checkbox"||f==="radio"){g.change(c)}else{g.click(a)}})}});d(function(){d("#contentwrapper [data-toggles], #contentwrapper [data-toggles-show], #contentwrapper [data-toggles-hide]").isToggler().change()})}(window.jQuery));(function(e,c){function a(h){e("#contentcolumn").html('<iframe src="'+h+'" width="100%" height="500px"></iframe>')}function g(h){var j=e("<a />").html(h.text).attr("href",h.href);if(h.target){j.attr("target",h.target)}if(h.iframe){j.click(function(){a(h.href);return false})}return j}function f(j){j=j||{};if(!j.text){throw ("Property 'text' is required for creating a navigation element")}var h=e("<li />");if(j.href){h.html(g(j))}else{h.html(e("<span />").html(j.text))}return h}function d(h){this.element=f(h);this.element.addClass("main clazz");this.element.find("a,span").addClass("tab");this.element.append('<ul class="menu-drop" />')}d.prototype={addElement:function(h){this.element.find("ul").append(f(h));return this}};c.NS.extend("TopNav",{Section:d,addSection:function(h){var j=new d(h);j.element.appendTo("#top-menu ul.agent-tabs");return j}})}(window.jQuery,window.Zendesk));(function(a){var c=function(e,d){return a.reduce(e,function(g,h){var f=a(g).last();if(f.length>=d){g.push([h])}else{f.push(h)}return g},[[]])};a.mixin({split:c})}(window._));Zendesk.NS("API",function(){function a(c){return c.css("color","green")}this.Macro=function(d){this.macro_id=d;var c=this;this._ticketTransforms={comment:function(g,j){var h=g.comment.value;var e=$j("#comment_value",j);if(h&&e&&(e.val()!=h)){e.val(e.val()+h);a(e)}h=g.comment.is_public;var f=$j("#comment_is_public",j);if(h){if(h=="true"){$j("#comment_type",j).attr("class","say public");f.attr("checked",true);$j("#twitter_controls",j).show()}else{$j("#comment_type",j).attr("class","say private");f.attr("checked",false);$j("#twitter_controls",j).hide()}}},current_tags:function(e,f){if(typeof(ticketTagField)=="undefined"){return}ticketTagField.clear();c._addTags(e.current_tags)},remove_tags:function(e,f){c._addRemoveTagsInput(e.remove_tags,f)},_default:function(h,f,j){var e=h.split("#")[0];var g=null;if(e.match(/ticket_fields_/)){g=$j("#"+e,j);c._applyToCustomField(g,f[h])}else{g=$j("#ticket_"+e,j);if(g){setSelectedForSelect($("ticket_"+e),f[h]);a(g)}}}};this._applyToCustomField=function(e,f){if(e.is("input:checkbox")){e.prop("checked",f);return}if(e.is("select")){if(f===true){f="1"}if(f===false){f="0"}}e.val(f).change()};this._addTags=function(e){_(e.split(" ")).each(function(f){if(f.length>0){ticketTagField.addEntry(f)}})};this._addRemoveTagsInput=function(e,g){$j("#ticket_remove_tags",g).val(e);var f=_(e.split(" ")).map(function(h){return"<span class='tag'>"+h+"</span>"});$j("#ticket_remove_tags_message",g).html("Removing tags: "+f.join("")).show()};this._fillTicketForm=function(f,l){var h=f.group_id,k=f.assignee_id;delete f.group_id;delete f.assignee_id;var g=_(f).keys();if(h||k){h&&$j("#ticket_group_id").val(h);assigneeSelect(h,k).done(function(){a($j("#ticket_group_id, #ticket_assignee_id"))})}for(var j=0,e=g.length;j<e;j++){if(this._ticketTransforms[g[j]]){this._ticketTransforms[g[j]](f,l)}else{this._ticketTransforms._default(g[j],f,l)}}$j("#macro_applied").val(this.macro_id)}};this.Macro.prototype={evaluate:function(e){var c=this;var f={};if(e.ticketForm){f=_($j(e.ticketForm).serializeArray()).select(function(g){return g.name!="_method"})}var d;if(e.ticketID!==null){d="/api/v1/macros/"+this.macro_id+"/apply.json?ticket_id="+e.ticketID}else{d="/api/v1/macros/"+this.macro_id+"/apply.json"}$j.ajax({url:d,type:"post",data:$j.param(f),dataType:"json",success:function(g,j,h){if(e.successCallback){e.successCallback(g)}},error:function(g,h){if(e.errorCallback){e.errorCallback(h,g.responseText)}}})},applyToTicket:function(e,d,f){var c=this;this.evaluate({ticketID:e,ticketForm:d,successCallback:function(g){c._fillTicketForm(g,d);var h=$j("textarea#comment_value").val();$j("textarea#comment_value").val("").focus().val(h);Zendesk.Twitter&&Zendesk.Twitter.TicketCreationForm&&(new Zendesk.Twitter.TicketCreationForm()._updateCounter());$(document).fire("macro:applied");$j(document).trigger("applied.macro.zendesk",g);if(f){f(g)}}})}};$j(document).bind("applied.macro.zendesk",function(d,c){Zendesk.Instrumentation.ToTango.track("Applied","Macro")})});Zendesk.NS("API",this.jQuery,function(a){this.TicketForm=function(c){this.ticketForm=a(c)};this.TicketForm.prototype={createTicket:function(c){return a.ajax({url:"/tickets.json",dataType:"text",type:"POST",data:this.mergeIntoDefaults(c)})},mergeIntoDefaults:function(c){var d=this.formDefaults();d.each(function(f){var e=f.name;c.each(function(g){if(typeof(g[e])!="undefined"){f.value=g[e]}})});return a.param(d)},formDefaults:function(){return this.ticketForm.serializeArray()},hasComment:function(){var c=a.trim(this.ticketForm.find('[name="comment[value]"]').val());return c!==""}}});(function(a){if(typeof(Element)!=="undefined"){Element.Methods.originalGetStyle=Element.Methods.getStyle;Element.addMethods({getStyle:function(c,d){try{return Element.Methods.originalGetStyle(c,d)}catch(f){return"static"}}})}if(Prototype&&Prototype.Browser&&Prototype.Browser.IE&&Effect){Effect.Fade=Effect.BlindUp=Effect.SlideUp=function(c){return a(c).hide()};Effect.Appear=Effect.BlindDown=Effect.SlideDown=function(c){return a(c).show()}}}(jQuery));if(typeof deconcept=="undefined"){var deconcept=new Object()}if(typeof deconcept.util=="undefined"){deconcept.util=new Object()}if(typeof deconcept.SWFObjectUtil=="undefined"){deconcept.SWFObjectUtil=new Object()}deconcept.SWFObject=function(o,d,p,f,l,m,j,g,e,n){if(!document.getElementById){return}this.DETECT_KEY=n?n:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(o){this.setAttribute("swf",o)}if(d){this.setAttribute("id",d)}if(p){this.setAttribute("width",p)}if(f){this.setAttribute("height",f)}if(l){this.setAttribute("version",new deconcept.PlayerVersion(l.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(m){this.addParam("bgcolor",m)}var a=j?j:"high";this.addParam("quality",a);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var k=(g)?g:window.location;this.setAttribute("xiRedirectUrl",k);this.setAttribute("redirectUrl","");if(e){this.setAttribute("redirectUrl",e)}};deconcept.SWFObject.prototype={useExpressInstall:function(a){this.xiSWFPath=!a?"expressinstall.swf":a;this.setAttribute("useExpressInstall",true)},setAttribute:function(a,c){this.attributes[a]=c},getAttribute:function(a){return this.attributes[a]},addParam:function(c,a){this.params[c]=a},getParams:function(){return this.params},addVariable:function(c,a){this.variables[c]=a},getVariable:function(a){return this.variables[a]},getVariables:function(){return this.variables},getVariablePairs:function(){var d=new Array();var c;var a=this.getVariables();for(c in a){d[d.length]=c+"="+a[c]}return d},getSWFHTML:function(){var c="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}c='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';c+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var g=this.getParams();for(var f in g){c+=[f]+'="'+g[f]+'" '}var e=this.getVariablePairs().join("&");if(e.length>0){c+='flashvars="'+e+'"'}c+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}c='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';c+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var d=this.getParams();for(var f in d){c+='<param name="'+f+'" value="'+d[f]+'" />'}var a=this.getVariablePairs().join("&");if(a.length>0){c+='<param name="flashvars" value="'+a+'" />'}c+="</object>"}return c},write:function(c){if(this.getAttribute("useExpressInstall")){var a=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(a)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",encodeURIComponent(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var d=(typeof c=="string")?document.getElementById(c):c;d.innerHTML=this.getSWFHTML();if(!(navigator.plugins&&navigator.mimeTypes.length)){window[this.getAttribute("id")]=document.getElementById(this.getAttribute("id"))}return true}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}return false}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var g=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var a=navigator.plugins["Shockwave Flash"];if(a&&a.description){g=new deconcept.PlayerVersion(a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var c=1;var d=3;while(c){try{d++;c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d);g=new deconcept.PlayerVersion([d,0,0])}catch(f){c=null}}}else{try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(f){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");g=new deconcept.PlayerVersion([6,0,21]);c.AllowScriptAccess="always"}catch(f){if(g.major==6){return g}}try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}}if(c!=null){g=new deconcept.PlayerVersion(c.GetVariable("$version").split(" ")[1].split(","))}}}return g};deconcept.PlayerVersion=function(a){this.major=a[0]!=null?parseInt(a[0]):0;this.minor=a[1]!=null?parseInt(a[1]):0;this.rev=a[2]!=null?parseInt(a[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(a){if(this.major<a.major){return false}if(this.major>a.major){return true}if(this.minor<a.minor){return false}if(this.minor>a.minor){return true}if(this.rev<a.rev){return false}return true};deconcept.util={getRequestParameter:function(d){var e=document.location.search||document.location.hash;if(d==null){return e}if(e){var c=e.substring(1).split("&");for(var a=0;a<c.length;a++){if(c[a].substring(0,c[a].indexOf("="))==d){return c[a].substring((c[a].indexOf("=")+1))}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var c=document.getElementsByTagName("OBJECT");for(var d=c.length-1;d>=0;d--){c[d].style.display="none";for(var a in c[d]){if(typeof c[d][a]=="function"){c[d][a]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(a){return document.all[a]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;var SWFObject=deconcept.SWFObject;(function(){Autocompleter.MultiValue.addMethods({beforeFormSubmit:function(){this.addNewValueFromSearchField(this.searchField)}});function c(d){Event.stopObserving(d.searchField,"blur");$j(document.body).bind("click",function(g){var j=$j(d.searchField),f=$j(d.choicesHolder),h=f.is(":visible"),e=f.find(g.target).length===0&&j.add(f).filter(g.target).length===0;if(h&&e){d.hide()}})}var a=Autocompleter.MultiValue.prototype.initialize;Autocompleter.MultiValue.prototype.initialize=function(){a.apply(this,arguments);c(this)};Autocompleter.MultiValue.prototype.hide=function(){var d=this;d.stopIndicator();setTimeout(function(){$j(d.choicesHolder).hide()},5)}}());if(typeof Prototype=="undefined"){alert("CalendarDateSelect Error: Prototype could not be found. Please make sure that your application's layout includes prototype.js (.g. <%= javascript_include_tag :defaults %>) *before* it includes calendar_date_select.js (.g. <%= calendar_date_select_includes %>).")}if(Prototype.Version<"1.6"){alert("Prototype 1.6.0 is required.  If using earlier version of prototype, please use calendar_date_select version 1.8.3")}Element.addMethods({purgeChildren:function(a){$A(a.childNodes).each(function(c){$(c).remove()})},build:function(c,e,a,d){var f=Element.buildAndAppend(e,a,d);c.appendChild(f);return f}});Element.buildAndAppend=function(d,a,c){var f=$(document.createElement(d));$H(a).each(function(e){f[e.key]=e.value});if(c){f.setStyle(c)}return f};nil=null;Date.one_day=24*60*60*1000;Date.weekdays=$w("S M T W T F S");Date.first_day_of_week=0;Date.months=$w("January February March April May June July August September October November December");Date.padded2=function(a){var c=parseInt(a,10);if(a<10){c="0"+c}return c};Date.prototype.getPaddedMinutes=function(){return Date.padded2(this.getMinutes())};Date.prototype.getAMPMHour=function(){var a=this.getHours();return(a==0)?12:(a>12?a-12:a)};Date.prototype.getAMPM=function(){return(this.getHours()<12)?"AM":"PM"};Date.prototype.stripTime=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate())};Date.prototype.daysDistance=function(a){return Math.round((a-this)/Date.one_day)};Date.prototype.toFormattedString=function(c){var a,d;d=Date.months[this.getMonth()]+" "+this.getDate()+", "+this.getFullYear();if(c){a=this.getHours();d+=" "+this.getAMPMHour()+":"+this.getPaddedMinutes()+" "+this.getAMPM()}return d};Date.parseFormattedString=function(a){return new Date(a)};Math.floor_to_interval=function(c,a){return Math.floor(c/a)*a};window.f_height=function(){return([window.innerHeight?window.innerHeight:null,document.documentElement?document.documentElement.clientHeight:null,document.body?document.body.clientHeight:null].select(function(a){return a>0}).first()||0)};window.f_scrollTop=function(){return([window.pageYOffset?window.pageYOffset:null,document.documentElement?document.documentElement.scrollTop:null,document.body?document.body.scrollTop:null].select(function(a){return a>0}).first()||0)};_translations={OK:"OK",Now:"Now",Today:"Today",Clear:"Clear"};SelectBox=Class.create();SelectBox.prototype={initialize:function(e,c,d,a){this.element=$(e).build("select",d,a);this.populate(c)},populate:function(a){this.element.purgeChildren();var c=this;$A(a).each(function(d){if(typeof(d)!="object"){d=[d,d]}c.element.build("option",{value:d[1],innerHTML:d[0]})})},setValue:function(c){var d=this.element;var a=false;$R(0,d.options.length-1).each(function(e){if(d.options[e].value==c.toString()){d.selectedIndex=e;a=true}});return a},getValue:function(){return $F(this.element)}};CalendarDateSelect=Class.create();CalendarDateSelect.prototype={initialize:function(c,a){this.target_element=$(c);if(!this.target_element){alert("Target element "+c+" not found!");return false}if(this.target_element.tagName!="INPUT"){this.target_element=this.target_element.down("INPUT")}this.target_element.calendar_date_select=this;this.last_click_at=0;this.options=$H({embedded:false,popup:nil,time:false,buttons:true,clear_button:true,year_range:10,close_on_click:nil,minute_interval:5,popup_by:this.target_element,month_year:"dropdowns",onchange:this.target_element.onchange,valid_date_check:nil}).merge(a||{});this.use_time=this.options.get("time");this.parseDate();this.callback("before_show");this.initCalendarDiv();if(!this.options.get("embedded")){this.positionCalendarDiv();Event.observe(document,"mousedown",this.closeIfClickedOut_handler=this.closeIfClickedOut.bindAsEventListener(this));Event.observe(document,"keypress",this.keyPress_handler=this.keyPress.bindAsEventListener(this))}this.callback("after_show")},positionCalendarDiv:function(){var o=false;var k=this.calendar_div.cumulativeOffset(),m=k[0],j=k[1],d=this.calendar_div.getDimensions(),p=d.height,c=d.width;var n=window.f_scrollTop(),e=window.f_height();var q=$(this.options.get("popup_by")).cumulativeOffset(),g=q[1],r=q[0],h=$(this.options.get("popup_by")).getDimensions().height,l=g+h;if(((l+p)>(n+e))&&(l-p>n)){o=true}var a=r.toString()+"px",f=(o?(g-p):(g+h)).toString()+"px";this.calendar_div.style.left=a;this.calendar_div.style.top=f;this.calendar_div.setStyle({visibility:""});if(navigator.appName=="Microsoft Internet Explorer"){this.iframe=$(document.body).build("iframe",{src:"javascript:false",className:"ie6_blocker"},{left:a,top:f,height:p.toString()+"px",width:c.toString()+"px",border:"0px"})}},initCalendarDiv:function(){if(this.options.get("embedded")){var parent=this.target_element.parentNode;var style={}}else{var parent=document.body;var style={position:"absolute",visibility:"hidden",left:0,top:0}}this.calendar_div=$(parent).build("div",{className:"calendar_date_select"},style);var that=this;$w("top header body buttons footer bottom").each(function(name){eval("var "+name+"_div = that."+name+"_div = that.calendar_div.build('div', { className: 'cds_"+name+"' }, { clear: 'left'} ); ")});this.initHeaderDiv();this.initButtonsDiv();this.initCalendarGrid();this.updateFooter("&#160;");this.refresh();this.setUseTime(this.use_time)},initHeaderDiv:function(){var a=this.header_div;this.close_button=a.build("a",{innerHTML:"x",href:"#",onclick:function(){this.close();return false}.bindAsEventListener(this),className:"close"});this.next_month_button=a.build("a",{innerHTML:"&gt;",href:"#",onclick:function(){this.navMonth(this.date.getMonth()+1);return false}.bindAsEventListener(this),className:"next"});this.prev_month_button=a.build("a",{innerHTML:"&lt;",href:"#",onclick:function(){this.navMonth(this.date.getMonth()-1);return false}.bindAsEventListener(this),className:"prev"});if(this.options.get("month_year")=="dropdowns"){this.month_select=new SelectBox(a,$R(0,11).map(function(c){return[Date.months[c],c]}),{className:"month",onchange:function(){this.navMonth(this.month_select.getValue())}.bindAsEventListener(this)});this.year_select=new SelectBox(a,[],{className:"year",onchange:function(){this.navYear(this.year_select.getValue())}.bindAsEventListener(this)});this.populateYearRange()}else{this.month_year_label=a.build("span")}},initCalendarGrid:function(){var a=this.body_div;this.calendar_day_grid=[];var h=a.build("table",{cellPadding:"0px",cellSpacing:"0px",width:"100%"});var c=h.build("thead").build("tr");Date.weekdays.each(function(j){c.build("th",{innerHTML:j})});var f=h.build("tbody");var d=0,e;for(var g=0;g<42;g++){e=(g+Date.first_day_of_week)%7;if(g%7==0){days_row=f.build("tr",{className:"row_"+d++})}(this.calendar_day_grid[g]=days_row.build("td",{calendar_date_select:this,onmouseover:function(){this.calendar_date_select.dayHover(this)},onmouseout:function(){this.calendar_date_select.dayHoverOut(this)},onclick:function(){this.calendar_date_select.updateSelectedDate(this,true)},className:(e==0)||(e==6)?" weekend":""},{cursor:"pointer"})).build("div");this.calendar_day_grid[g]}},initButtonsDiv:function(){var e=this.buttons_div;if(this.options.get("time")){var c=$A(this.options.get("time")=="mixed"?[[" - ",""]]:[]);e.build("span",{innerHTML:"@",className:"at_sign"});var a=new Date();this.hour_select=new SelectBox(e,c.concat($R(0,23).map(function(f){a.setHours(f);return $A([a.getAMPMHour()+" "+a.getAMPM(),f])})),{calendar_date_select:this,onchange:function(){this.calendar_date_select.updateSelectedDate({hour:this.value})},className:"hour"});e.build("span",{innerHTML:":",className:"seperator"});var d=this;this.minute_select=new SelectBox(e,c.concat($R(0,59).select(function(f){return(f%d.options.get("minute_interval")==0)}).map(function(f){return $A([Date.padded2(f),f])})),{calendar_date_select:this,onchange:function(){this.calendar_date_select.updateSelectedDate({minute:this.value})},className:"minute"})}else{if(!this.options.get("buttons")){e.remove()}}if(this.options.get("buttons")){e.build("span",{innerHTML:"&#160;"});if(this.options.get("time")=="mixed"||!this.options.get("time")){b=e.build("a",{innerHTML:_translations.Today,href:"#",onclick:function(){this.today(false);return false}.bindAsEventListener(this)})}if(this.options.get("time")=="mixed"){e.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"})}if(this.options.get("time")){b=e.build("a",{innerHTML:_translations.Now,href:"#",onclick:function(){this.today(true);return false}.bindAsEventListener(this)})}if(!this.options.get("embedded")&&!this.closeOnClick()){e.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"});e.build("a",{innerHTML:_translations.OK,href:"#",onclick:function(){this.close();return false}.bindAsEventListener(this)})}if(this.options.get("clear_button")){e.build("span",{innerHTML:"&#160;|&#160;",className:"button_seperator"});e.build("a",{innerHTML:_translations.Clear,href:"#",onclick:function(){this.clearDate();if(!this.options.get("embedded")){this.close()}return false}.bindAsEventListener(this)})}}},refresh:function(){this.refreshMonthYear();this.refreshCalendarGrid();this.setSelectedClass();this.updateFooter()},refreshCalendarGrid:function(){this.beginning_date=new Date(this.date).stripTime();this.beginning_date.setDate(1);this.beginning_date.setHours(12);var c=this.beginning_date.getDay();if(c<3){c+=7}this.beginning_date.setDate(1-c+Date.first_day_of_week);var e=new Date(this.beginning_date);var a=new Date().stripTime();var d=this.date.getMonth();vdc=this.options.get("valid_date_check");for(var f=0;f<42;f++){day=e.getDate();month=e.getMonth();cell=this.calendar_day_grid[f];Element.remove(cell.childNodes[0]);div=cell.build("div",{innerHTML:day});if(month!=d){div.className="other"}cell.day=day;cell.month=month;cell.year=e.getFullYear();if(vdc){if(vdc(e.stripTime())){cell.removeClassName("disabled")}else{cell.addClassName("disabled")}}e.setDate(day+1)}if(this.today_cell){this.today_cell.removeClassName("today")}if($R(0,41).include(days_until=this.beginning_date.stripTime().daysDistance(a))){this.today_cell=this.calendar_day_grid[days_until];this.today_cell.addClassName("today")}},refreshMonthYear:function(){var a=this.date.getMonth();var d=this.date.getFullYear();if(this.options.get("month_year")=="dropdowns"){this.month_select.setValue(a,false);var c=this.year_select.element;if(this.flexibleYearRange()&&(!(this.year_select.setValue(d,false))||c.selectedIndex<=1||c.selectedIndex>=c.options.length-2)){this.populateYearRange()}this.year_select.setValue(d)}else{this.month_year_label.update(Date.months[a]+" "+d.toString())}},populateYearRange:function(){this.year_select.populate(this.yearRange().toArray())},yearRange:function(){if(!this.flexibleYearRange()){return $R(this.options.get("year_range")[0],this.options.get("year_range")[1])}var a=this.date.getFullYear();return $R(a-this.options.get("year_range"),a+this.options.get("year_range"))},flexibleYearRange:function(){return(typeof(this.options.get("year_range"))=="number")},validYear:function(a){if(this.flexibleYearRange()){return true}else{return this.yearRange().include(a)}},dayHover:function(a){var c=new Date(this.selected_date);c.setFullYear(a.year,a.month,a.day);this.updateFooter(c.toFormattedString(this.use_time))},dayHoverOut:function(a){this.updateFooter()},clearSelectedClass:function(){if(this.selected_cell){this.selected_cell.removeClassName("selected")}},setSelectedClass:function(){if(!this.selection_made){return}this.clearSelectedClass();if($R(0,42).include(days_until=this.beginning_date.stripTime().daysDistance(this.selected_date.stripTime()))){this.selected_cell=this.calendar_day_grid[days_until];this.selected_cell.addClassName("selected")}},reparse:function(){this.parseDate();this.refresh()},dateString:function(){return(this.selection_made)?this.selected_date.toFormattedString(this.use_time):"&#160;"},parseDate:function(){var c=$F(this.target_element).strip();var a=this.options.get("default_time");this.selection_made=(c!=""||a);this.date=c==""?NaN:Date.parseFormattedString(this.options.get("date")||c);if(isNaN(this.date)&&!a){this.date=new Date()}else{if(isNaN(this.date)&&a){this.date=(Object.prototype.toString.apply(a)==="[object Function]")?a():a}}if(!this.validYear(this.date.getFullYear())){this.date.setYear((this.date.getFullYear()<this.yearRange().start)?this.yearRange().start:this.yearRange().end)}this.selected_date=new Date(this.date);this.use_time=/[0-9]:[0-9]{2}/.exec(c)?true:false;this.date.setDate(1)},updateFooter:function(a){if(!a){a=this.dateString()}this.footer_div.purgeChildren();this.footer_div.build("span",{innerHTML:a})},clearDate:function(){if((this.target_element.disabled||this.target_element.readOnly)&&this.options.get("popup")!="force"){return false}var a=this.target_element.value;this.target_element.value="";this.clearSelectedClass();this.updateFooter("&#160;");if(a!=this.target_element.value){this.callback("onchange")}},updateSelectedDate:function(c,a){var f=$H(c);if((this.target_element.disabled||this.target_element.readOnly)&&this.options.get("popup")!="force"){return false}if(f.get("day")){var e=this.selected_date,d=this.options.get("valid_date_check");e.setFullYear(f.get("year"),f.get("month"),f.get("day"));if(d&&!d(e.stripTime())){return false}this.selected_date=e;this.selection_made=true}if(!isNaN(f.get("hour"))){this.selected_date.setHours(f.get("hour"))}if(!isNaN(f.get("minute"))){this.selected_date.setMinutes(Math.floor_to_interval(f.get("minute"),this.options.get("minute_interval")))}if(f.get("hour")===""||f.get("minute")===""){this.setUseTime(false)}else{if(!isNaN(f.get("hour"))||!isNaN(f.get("minute"))){this.setUseTime(true)}}this.updateFooter();this.setSelectedClass();if(this.selection_made){this.updateValue()}if(this.closeOnClick()){this.close()}if(a&&!this.options.get("embedded")){if((new Date()-this.last_click_at)<333){this.close()}this.last_click_at=new Date()}},closeOnClick:function(){if(this.options.get("embedded")){return false}if(this.options.get("close_on_click")===nil){return(this.options.get("time"))?false:true}else{return(this.options.get("close_on_click"))}},navMonth:function(a){(target_date=new Date(this.date)).setMonth(a);return(this.navTo(target_date))},navYear:function(a){(target_date=new Date(this.date)).setYear(a);return(this.navTo(target_date))},navTo:function(a){if(!this.validYear(a.getFullYear())){return false}this.date=a;this.date.setDate(1);this.refresh();this.callback("after_navigate",this.date);return true},setUseTime:function(c){this.use_time=this.options.get("time")&&(this.options.get("time")=="mixed"?c:true);if(this.use_time&&this.selected_date){var d=Math.floor_to_interval(this.selected_date.getMinutes(),this.options.get("minute_interval"));var a=this.selected_date.getHours();this.hour_select.setValue(a);this.minute_select.setValue(d)}else{if(this.options.get("time")=="mixed"){this.hour_select.setValue("");this.minute_select.setValue("")}}},updateValue:function(){var a=this.target_element.value;this.target_element.value=this.dateString();if(a!=this.target_element.value){this.callback("onchange")}},today:function(a){var e=new Date();this.date=new Date();var c=$H({day:e.getDate(),month:e.getMonth(),year:e.getFullYear(),hour:e.getHours(),minute:e.getMinutes()});if(!a){c=c.merge({hour:"",minute:""})}this.updateSelectedDate(c,true);this.refresh()},close:function(){if(this.closed){return false}this.callback("before_close");this.target_element.calendar_date_select=nil;Event.stopObserving(document,"mousedown",this.closeIfClickedOut_handler);Event.stopObserving(document,"keypress",this.keyPress_handler);this.calendar_div.remove();this.closed=true;if(this.iframe){this.iframe.remove()}if(this.target_element.type!="hidden"&&!this.target_element.disabled){this.target_element.focus()}this.callback("after_close")},closeIfClickedOut:function(a){if(!$(Event.element(a)).descendantOf(this.calendar_div)){this.close()}},keyPress:function(a){if(a.keyCode==Event.KEY_ESC){this.close()}},callback:function(a,c){if(this.options.get(a)){this.options.get(a).bind(this.target_element)(c)}}};var zd={jsInitializers:[],jsData:{}};$j(document).ready(function(){$j("a.colorbox").live("click",function(){var a=$j(this).attr("data-colorbox-force-photo")?true:false;$j.colorbox({href:$j(this).attr("href"),photo:a});return false});$j("[data-learn-more-block]").click(function(){$j(this).hide();$j($j(this).attr("data-learn-more-block")).slideDown();return false});$j(window).hashchange(function(){var a=$j("head link[rel='shortcut icon']").remove();$j('<link href="'+a.attr("href")+'" rel="shortcut icon" type="'+a.attr("type")+'" />').appendTo("head")});$j("p.zendesk-embedded-screencast").replaceWith(function(){return $j('<iframe width="570" height="340"/>').attr("src",$j(this).find("a").attr("href"))});$j("#account_locale_id").select2({width:"resolve"})});var items={};function renderPerType(){if($j("#ticket_ticket_type_id").length){if($j("#ticket_linked_id").length){var c=($j("#ticket_ticket_type_id").val()==="2");setVisibility("#ticket_link, #ticket_link > span",c)}if($j("#ticket_date").length){setVisibility("#ticket_date",($j("#ticket_ticket_type_id").val()==="4"));if($j("#ticket_due_date").val()===""){var a=new Date();a.setDate(a.getDate()+7);var e=jQuery.datepicker.formatDate(I18n.t("date.datepicker.date_format"),a);$j("#ticket_due_date").val(e);var d=jQuery.datepicker.formatDate("yy-mm-dd",a);$j("#hidden_date").val(d)}}}}var render_per_type=renderPerType;function hideNavigationLinks(){$j("#top-menu li").hide();$j("#top-right").hide();$j("#add_widget_button").hide();document.observe("widgets:load",function(){$j("#add_widget_button").hide()})}function assigneeSelect(d,c){var a=$j("#ticket_assignee_id");a.html($j("<option>"));if(!a.exists()||d===""||typeof d==="undefined"){return $j.when()}var e,f;d=Number(d);if(d>=0){e=_(window.groups).find(function(g){return $j.when(g.id===d)});f=_(e.users);_(window.agents).select(function(g){return $j.when(f.contains(g.id))}).each(function(g){a.append($j("<option />").val(""+g.id).html(""+g.name).prop("selected",g.id===Number(c)))})}else{a.get(0).selectedIndex=0;a.prop("enabled",false)}a.change().blur();return $j.when([])}var assignee_select=assigneeSelect;function updateProperties(c){var a=$j("#ticket_group_id");if(a.exists()&&$j.trim(a.val())!==""&&$j.trim($j("#ticket_assignee_id").val())===""){assigneeSelect(a.val(),c)}renderPerType();return true}function highlightAgents(){$j("#facebook-list li.choice").each(function(c,a){a=$j(a);var d=a.attr("choice_id");if(_(agents).any(function(e){return e.id===Number(d)})){a.addClass("agent")}if(_(window.lightAgents).any(function(e){return e.id===Number(d)})){a.addClass("agent")}})}function setupHighlightAgents(){highlightAgents();$j("#facebook-list ul.multi_value_field").first().bind("DOMNodeInserted",highlightAgents)}function setVisibility(a,c){if(c){$j(a).show()}else{$j(a).hide()}}function submitUpload(){var a=$j.trim($j("#attachment_content").val());if(a!==""){$j("#uploadform").submit();$j("#uploadinput").hide();$j("#uploadbar").show()}}function notifyOnError(a){alert("Failed to upload file '"+a+"', verify the path");resetView()}var attachmentLists=[];function registerAttachmentList(a,c){if(c===null){attachmentLists[a]=$j(".attach_item").length}else{attachmentLists[a]=c}}function deleteFromAttachmentList(a,c){$j("#"+c).remove();attachmentLists[a]=attachmentLists[a]-1;if(attachmentLists[a]<=0){$j("#"+a).hide();delete attachmentLists[a]}}function showFlash(a,c){c=(typeof c=="undefined")?"notice":c;var d=$j("<div>",{id:c,html:a});$j("#flash").html(d);new Effect.Highlight("flash",{duration:2})}function clearFlash(){$j("#flash").html("")}function pictureDeleted(a){$j("#cancel-block-"+a).hide();if(a==="header_logo"){$j("#sub_setting_website_url").hide()}selectPicture(a)}function selectPicture(a){$j("#image-block-"+a).hide();$j("#upload-block-"+a).show();$j("#ignore-upload-"+a).val(0)}function resetPicture(a){$j("#upload-block-"+a).hide();$j("#image-block-"+a).show();$j("#ignore-upload-"+a).val(1)}function checkTicketDelete(){if($j("#submit_type").val()==="delete"){alert(I18n.t("txt.public.javascripts.application.warning_deleted_tickets_cannot_be_recovered"))}}function check_ticket(a){if(IncidentsWarning.getInstance().isShowingWarning()){return false}$("submit-button").value=I18n.t("txt.admin.views.suspended_tickets.index.submitting_label");$("submit-button").disabled=true;if(typeof(collaboratorList)!=="undefined"){collaboratorList.update()}if($F("submit_type")!=="merge"&&$("edit_requester").style.display==="none"){$("edit_requester").remove()}return true}function copySubmitType(){$("ticket-chat").submit_type.value=$("submit_form").submit_type.value}function submitTicketForm(){if(check_ticket()){$j("#ticket-chat :input").each(function(){this.value=this.value.replace(/\0/g,"")});copySubmitType();if($F("submit_type")==="merge"){new TicketMergeWizard()}else{if(typeof(ticketTagField)!=="undefined"){ticketTagField.beforeFormSubmit()}if($j("#ticket_status_id").val()==="3"){Zendesk.Instrumentation.ToTango.track("Solved","Ticket")}Zendesk.Instrumentation.ToTango.track("Save","Ticket");$j(document).trigger("ticket.submit.zendesk");$("ticket-chat").submit()}}}function submitBulkUpdateForm(){if(fetchTicketsToBulkupdate()){if($j("#submit_type").val()==="merge"){new TicketMergeWizard()}else{if($j("#ticket_ticket_type_id").val()!=="4"){$j("#ticket_date").remove()}$j("#ticket-chat").submit()}}}function copySolvedState(){if($("submit_form").solved_true){$("ticketform").ticket_force_status_change.value=$("submit_form").solved_true.checked}}function submitRequestForm(){$j("#submit-button").prop("disabled",true);$("ticketform").submit()}function submitAttachForm(a){if($j("#uploads_attribute").length){$j("#token").val($j("#uploads_attribute").val())}$j("#submit-button").val(a);$j("#submit-button").prop("disabled",true);$j("#attach_form").submit();$j("#attach_link").hide();$j("#uploading_message").show()}function setSelectedForSelect(a,c){$j(a).val(c).change()}function autotagTicket(a){var c=$j(a).val();if($j.trim(c)!==""&&ticketTagField&&ticketTagField.selectedEntries().length===0){new Ajax.Request("/tags/autotag",{method:"GET",parameters:{text:c,target:"ticketTagField"}})}}var autotag_ticket=autotagTicket;function createTooltip(c,f,a,d){var e="<div class='title clearfix "+d.title+"'>"+f+"</div><div class='content clearfix "+d.title+"'>"+a+"</div>";$j("#"+c).addClass("has-tooltip").tooltip({tooltipClass:"zd_comment "+d["class"],items:".has-tooltip",position:d.position,content:function(){return e}}).unbind("focusin")}function commentTip(c,e,a){var d=[];d.position={my:"left top",at:"center bottom",offset:"50px 10px"};createTooltip(c,e,a,d)}var comment_tip=commentTip;function cmsCommentTip(c,e,a){var d=[];d.title="cms_tooltip_title";d["class"]="cms_tooltip";d.position={offset:"50px 10px"};createTooltip(c,e,a,d)}function stv(e,f,d,c,a){$j('.field-tagger[data-field-id="'+d+'"]').ticketTagger("val",e);return false}function reverseTruncate(a,c){return a.split("").reverse().join("").truncate(c).split("").reverse().join("")}function apply_macro(d,c){if(d!==""){if(typeof(ticket_id)==="undefined"){this_id="0"}else{this_id=ticket_id}var f=jQuery("#ticket-chat");if(jQuery("#tickets_to_bulk_update",f).length>0){new Zendesk.API.Macro(d).applyToTicket(null,f)}else{new Zendesk.API.Macro(d).applyToTicket(this_id,f)}var g=(c)?c:window.event;Event.stop(g);var a=g.findElement();selection_feedback(a);return false}}var hideMacroLi=function(a){Zendesk.UI&&Zendesk.UI.NestedMenu&&Zendesk.UI.NestedMenu.close_submenu($j(a))};function showOrHideBulkForm(){fetchTicketsToBulkupdate();if($j.trim($j("#tickets_to_bulk_update").val())===""){$j("#bulk-update").hide()}else{$j("#bulk-update").show()}}function fetchTicketsToBulkupdate(){var a=_($j("input.tickets_to_bulk_update")).select(function(c){return c.checked}).map(function(c){return $j(c).val()}).join(",");$j("#tickets_to_bulk_update").val(a);return true}function selectAllTicketsForBulkUpdate(c){var a=c.checked;if($j("#bulk-update").length){if(a){$j("#bulk-update").show()}else{$j("#bulk-update").hide()}$j("input.tickets_to_bulk_update").each(function(d){$j(this).prop("checked",a)})}}var rgbToHex=function(c){var a="#";c.match(/\d+/g).each(function(d){a+=Number(d).toColorPart()});return a};Ordering={SetOrder:function(a){$j(a).hide();$j(a+"_sort").sortable({axis:"y"}).show()},cancelOrdering:function(d){var e=$j(d+"_sort");$j(d).show();e.hide().sortable("destroy");var a=function(g,f){var h="data-zendesk-original-position";return($j(g).attr(h)<$j(f).attr(h))?-1:($j(g).attr(h)>$j(f).attr(h))?1:0};var c=$j("ul li.item.sortable",e).sort(function(g,f){return a(g,f)});$j("ul li.item.sortable",e).remove();$j("ul",e).prepend(c)}};function textareaResize(){var e=this;var d=e.value.split("\n");var c=1;for(x=0;x<d.length;x++){if(d[x].length>=e.cols){c+=Math.floor(d[x].length/e.cols)}}c+=d.length;if(c>e.rows){e.rows=c}}var textarea_resize=textareaResize;function time_ago_in_words(a){return distance_of_time_in_words(new Date(),new Date(a))}function i18n_time_ago_in_words(a){return i18n_distance_of_time_in_words(new Date(),new Date(a))}function distance_of_time_in_words(j,h){var g=((j-h)/1000);var e=Math.floor(g/60);if(e<=0){return"less than a minute"}if(e===1){return"a minute"}if(e<45){return e+" minutes"}if(e<90){return"1 hour"}var d=Math.round(e/60);if(e<1439){return d+" hours"}if(e<2879){return"1 day"}var c=Math.round(e/1440);if(e<43199){return c+" days"}if(e<86399){return"1 month"}var a=Math.round(e/43200);if(e<525960){return a+" months"}if(e<1051920){return"1 year"}var f=Math.round(e/525960);return"over "+f+" years"}var ObjectFactory=Class.create({});ObjectFactory.instances=new Hash();ObjectFactory.create=function(c,a){instance=new c(a);ObjectFactory.instances.set(a.id,instance);return instance};ObjectFactory.get=function(a){return ObjectFactory.instances.get(a)};ObjectFactory.remove=function(a){return ObjectFactory.instances.unset(a)};document.getUrlParameter=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d=new RegExp("[\\?&]"+a+"=([^&#]*)");var c=d.exec(window.location.href);return c?unescape(c[1]):null};function addCommas(c){c+="";var a=/(\d+)(\d{3})/;while(a.test(c)){c=c.replace(a,"$1,$2")}return c}function showSortingForForumType(a){setVisibility("#div_ordering",(a===1))}$(document).observe("dom:loaded",function(){jQuery("ul.drop-list").each(function(a,c){new Zendesk.UI.NestedMenu(jQuery(c)).initialize()});if(!window.XMLHttpRequest){startList()}});function createRef(a,c){return function(){c.apply(a,arguments)}}function category_set(e,d,c,a){var f=e.down("ul");if(f){f.style.display=d}}var selection_feedback=function(a){new Effect.Highlight(a,{queue:"end",beforeStart:function(){a.store("selection_feedback.style",a.readAttribute("style"));a.setStyle({color:a.getStyle("background-color")})},startcolor:rgbToHex(a.getStyle("color")),duration:0.2,afterFinish:function(){a.writeAttribute("style",a.retrieve("selection_feedback.style")||"")}});new Effect.Fade(a.up("ul.first-drop"),{queue:"end",duration:0.3,afterFinish:hideMacroLi(a)})};var categoryDescription=function(){if($j("#category-description-link").exists()){$j("#category-description-link").live("click",function(){$j("#category-description").toggle()})}};var categoryTopRightEdit=function(g){var c=$(g).down(".category-top-right");var e=$(g).down("ul.edit_options");var a=function(){c.removeClassName("inactive");e.removeClassName("inactive")};var d=function(){e.addClassName("inactive");c.addClassName("inactive")};$(g).down("span.edit_this").observe("mouseover",a);$(g).down(".category-top-right").observe("mouseleave",d);var f=function(h){new Effect.Highlight(h,{queue:"end",beforeStart:function(){h.store("selection_feedback.style",h.readAttribute("style"));h.setStyle({color:h.getStyle("background-color")})},startcolor:rgbToHex(h.getStyle("color")),duration:0.2,afterFinish:function(){h.writeAttribute("style",h.retrieve("selection_feedback.style")||"");d()}})};e.childElements("li").each(function(h){h.childElements("a").each(function(j){j.observe("click",function(k){f(h)})})})};var makeCategorizedForumsDraggable=function(c){var d=function(e){e.each(function(f,g){var h=f%2===0;$j(g).toggleClass("left",h).toggleClass("right",!h)})};var a=$j("#"+c);a.find(".column").each(function(e,f){$j(f).data("position",e)});$j("#"+c).parent().find(".category-header .category-top-right ul.edit_options li.reorder_forums a").click(function(){a.addClass("reordering").find(".reorder a").show().end().sortable({items:".column"}).bind("sortchange",function(e,f){d(a.find("div.column").not(f.item))}).bind("sortupdate",function(e,f){a.data("changed",true);d(a.find(".column"))});return false});a.find(".column a").click(function(){if(a.hasClass("reordering")){return false}});a.find(".reorder a").click(function(){a.removeClass("reordering").sortable("destroy");if(a.data("changed")){a.find(".column").each(function(f,e){e=$j(e);if(e.data("original_position")!==f){$j.ajax(e.data("forum_path"),{type:"POST",data:{_method:"put","forum[position]":f,authenticity_token:currentUser.authenticityToken}});e.data("original_position",f)}});a.data("changed",false)}return false})};var addCategoryReordering=function(){var e=$j(".buttons-right .reorder a");var d=$j("#sortedlist");var c=d.closest(".frame.columns");d.children().each(function(g,h){$j(h).data("original_position",g)});var f=function(){e.data("reorder_text",e.html()).html(e.data("done_text"));c.addClass("reordering");d.sortable({items:".sortable"}).bind("sortupdate",function(){d.data("changed",true)})};var a=function(){var g=e.data("reorder_text");e.html(g);c.removeClass("reordering");d.sortable("destroy");if(d.data("changed")){d.children().each(function(h,k){k=$j(k);var m=k.data("item_id"),j=$j("#category_header_"+m),l=$j("#category_"+m);c.append(j).append(l);if(h!==k.data("original_position")){$j.ajax(l.data("category_path"),{type:"POST",data:{_method:"put","category[position]":h}});k.data("original_position",h)}});d.data("changed",false)}};e.toggle(f,a)};var submit_sortable_list=function(g,f,c,a){var d=$j("#"+g+"_reorder_done_link");var e=d.prop("href");c=$j("#"+c);c.find("> li.sortable.item").each(function(h,j){$j(j).data("real_element",$j("#"+g+" div.item")[h])});$j("#"+g+"_reorder_done_link").click(function(j){j.preventDefault();var k=c.find("> li.sortable").get().reverse();_(k).each(function(n,m){n=$j(n);var o=$j(n.data("real_element"));o.prependTo(o.parent()).toggleClass("nobottom",m===0);n.data("zendesk-original-position",(k.length-m-1))});$j("#"+f).hide();$j("#"+g).show();var l=c.sortable("serialize",{key:c.prop("id")+"[]"});var h="authenticity_token="+encodeURIComponent(Zendesk.currentUser.authenticityToken);$j.ajax(a,{type:"POST",data:l+"&"+h}).success(function(){window.location.replace(e)})})};function startList(){if(!navigator.userAgent.match(/msie 6/i)){return}iterate_startList($("green"));if(document.getElementById("gray")){iterate_startList($("gray"))}}function iterate_startList(d){var c;if(!d){return}for(var a=0;a<d.childNodes.length;a++){c=d.childNodes[a];if(c.nodeName=="LI"){c.onmouseover=function(){this.className+=" over";if(this.childNodes[2]&&this.childNodes[2].nodeName=="UL"){ie6_show_iframe_mask(this.childNodes[2])}};c.onmouseout=function(){this.className=this.className.replace(" over","");ie6_hide_iframe_mask(this.childNodes[2])}}}}function ie6_show_iframe_mask(a){if(a){a.style.display="block"}var c=document.createElement("iframe");if(document.location.protocol=="https:"){c.src="//0"}else{if(window.opera!="undefined"){c.src=""}else{c.src="javascript:false"}}c.id="mIframe";c.scrolling="no";c.frameBorder="0";c.style.top=-1;c.style.left=-1;c.style.width=a.offsetWidth+"px";c.style.height=a.offsetHeight+"px";c.style.zIndex=-1;c.style.filter="alpha(opacity=0)";a.insertBefore(c,a.childNodes[0]);c.style.position="absolute"}function ie6_hide_iframe_mask(c){if(c){c.style.display="none"}var a=document.getElementById("mIframe");if(a){a.style.display="none"}}var ticket_id;if(!Zendesk){var Zendesk={}}Zendesk.resources=[];Zendesk.Resource=Class.create();Zendesk.Resource.prototype={initialize:function(a){this.options=a||{};this.options.user=a.user||Zendesk.SettingsCookie.get(this.options.anchor+"_user");this.options.pass=a.pass||Zendesk.SettingsCookie.get(this.options.anchor+"_pass");this.content_anchor=$$("#"+this.options.anchor+" #content")[0];this.title_anchor=$$("#"+this.options.anchor+" #title")[0];Ajax.Responders.register({onException:function(c,d){console.error(d)}});if(this.options.title){this.title_anchor.innerHTML=this.options.title}this.render()},submit_credentials:function(a){this.options.user=a.username.value;this.options.pass=a.password.value;if(this.options.user.blank()&&this.options.pass.blank()){alert("Please provide both a username and a password")}else{Zendesk.SettingsCookie.set(this.options.anchor+"_user",this.options.user);Zendesk.SettingsCookie.set(this.options.anchor+"_pass",this.options.pass);this.render()}},logout:function(){var a=this.options;Zendesk.SettingsCookie.erase(a.anchor+"_user");Zendesk.SettingsCookie.erase(a.anchor+"_pass");this.options.user=this.options.pass=null;this.render()},submit_data:function(c){var d=this;var a=Form.serialize(c);a+="&domain="+d.options.domain+"&use_ssl="+d.options.use_ssl;if(ticket_id){a+="&ticket_id="+ticket_id}if(a.indexOf("media_type=")===0){var e=d.options.media_type||"application/xml";a+="&media_type="+e}new Ajax.Request("/proxy.js",{method:"POST",asynchronous:true,evalScripts:true,parameters:a,requestHeaders:{Authorization:"Basic "+Base64.encode(d.options.user+":"+d.options.pass)},onSuccess:function(f){d.resource_write_success(f,d);enable_submit(c)},onFailure:function(f){d.resource_failure(f,d);enable_submit(c)}});disable_submit(c)},render:function(){var c=this;var a=c.options;if(a.login_content!=null&&!(a.user&&a.pass)){c.content_anchor.innerHTML=a.login_content()}else{c.content_anchor.innerHTML=a.application_content();a.application_resources.each(function(d){c.request(d)})}},request:function(a){var c=this;if(a.resource==null){if(a.on_success!=null){a.on_success()}}else{var d=a.media_type||"application/json";new Ajax.Request("/proxy.js",{method:"get",parameters:{domain:c.options.domain,use_ssl:c.options.use_ssl,resource:a.resource,media_type:d,cache_gets:c.options.cache_gets},requestHeaders:{Authorization:"Basic "+Base64.encode(c.options.user+":"+c.options.pass)},onSuccess:function(e){c.resource_read_success(e,c,a)},onFailure:function(e){c.resource_failure(e,c)}})}},resource_failure:function(c,a){if(c.status==401){a.options.user=null;a.options.pass=null;Zendesk.SettingsCookie.erase(a.options.anchor+"_user");Zendesk.SettingsCookie.erase(a.options.anchor+"_pass");if(a.content_anchor.innerHTML!=a.options.login_content()){alert("Username and password are not correct. Please re-enter.")}a.render()}else{alert(c.responseJSON.error)}},resource_read_success:function(d,c,a){if(a!=null&&a.on_success!=null){a.on_success(d.responseJSON)}},resource_write_success:function(f,e){var d=f.request&&f.request.parameters;var a;if(d&&d.event_reference&&d.event_log&&!d.ticket_id.blank()){var c=e.getLoggableAttributes(e,f.responseJSON.response,d.event_log);c.location=f.getHeader("location")||"";a=e.buildAudit(d,c)}if(a!=null){new Ajax.Request("/events.json",{contentType:"application/json",postBody:$H(a).toJSON(),method:"post",asynchronous:true,onSuccess:function(g){},onFailure:function(g){alert("Failed to register event: "+g.responseJSON.error)}})}},buildAudit:function(c,a){return{ticket_id:c.ticket_id,reference:c.event_reference,via_id:14,resource_attributes:a}},getLoggableAttributes:function(f,g,c){var e=c.split(",");var a={};var d;_(e).each(function(h){h=h.strip();if(d=f._deepSearch(g,h)){a[h]=d}});return a},_deepSearch:function(a,e){var d;if(d=a[e]||a[e.toLowerCase()]){return d}else{var c;for(key in a){if(a.hasOwnProperty(key)){c=a[key];if(typeof(c)==="object"){if(d=this._deepSearch(c,e)){return d}}}}}}};function enable_submit(a){a.submit.value=a.submit.getAttribute("originalValue");a.enable();a.reset()}function disable_submit(a){a.submit.setAttribute("originalValue",a.submit.value);a.disable();a.submit.value="Submitting..."}var InputTracking={trackedElements:[],enabled:true,trackElement:function(a){if(!InputTracking.trackedElements.include(this)){if(typeof(this.value)==="undefined"){this.originalValue=this.innerHTML}else{this.originalValue=this.value}InputTracking.trackedElements.push(this);Event.stopObserving(this,"keydown",InputTracking.trackElement)}},disable:function(a){InputTracking.enabled=false;return true},fixSubmit:function(d,a){var c=d[a];if(Object.isString(c)){d[a]="InputTracking.disable() && "+c}else{if(Object.isFunction(c)){d.onsubmitWithoutInputTracking=c;d[a]=function(f){return InputTracking.disable()&&d.onsubmitWithoutInputTracking()}}else{d[a]=InputTracking.disable}}}};var CountrySelectField=Class.create({initialize:function(a){this.element=a;this.container=new Element("div",{className:"country_select_field"});this.closedView=new Element("div",{className:"closed"});this.container.insert(this.closedView);this.openedView=new Element("div",{className:"opened",style:"display: none;"}).update("<ul/>");this.container.insert(this.openedView);this.renderOpenedView();this.updateOpenedView();this.updateClosedView();this.element.hide();this.element.insert({after:this.container});this.closedView.observe("click",this.toggle.bind(this))},renderOpenedView:function(){var c=this.openedView.down("ul");c.update();var a;this.element.select("option").each(function(d){a=new Element("li",{country:d.value});this.renderOption(a,d);c.insert(a);a.observe("click",this.clickOption.bindAsEventListener(this))},this)},updateOpenedView:function(){this.openedView.select("li.selected").each(function(c){c.removeClassName("selected")});var a=this.element.down("option[value="+this.element.getValue()+"]");this.openedView.down("li[country="+a.value+"]").addClassName("selected")},updateClosedView:function(){var a=this.element.down("option[value="+this.element.getValue()+"]");this.renderOption(this.closedView,a)},renderOption:function(a,c){a.update();a.insert(new Element("img",{src:"/images/flags/"+c.value+".gif"}));a.insert(" "+c.innerHTML)},open:function(){this.openedView.show();this.element.focus()},close:function(){this.openedView.hide()},toggle:function(){this.openedView.toggle();this.element.focus()},clickOption:function(a){this.element.down("option[value="+a.findElement("li").getAttribute("country").toLowerCase()+"]").selected=true;this.updateOpenedView();this.updateClosedView();this.close()}});var DelayedRuleCounts=Class.create(Hash,{initialize:function($super,a){$super();this.updateUiFromResponse=this.updateUiFromResponse.bind(this);this.requestUpdate=this.requestUpdate.bind(this);this.ticket_show_empty_views=a.ticket_show_empty_views||false;this.delay=5},newRulesDisplayed:function(){if(this.anyCountUnknown()){this.update()}else{this.updateUi()}},anyCountUnknown:function(){var a=this.keys();return _.detect(this.displayedRules(),function(c){return $j.inArray(c,a)==-1})},requestUpdate:function(a){new Ajax.Request("/rules/count",{method:"GET",parameters:{"rule_ids[]":a},onSuccess:this.updateUiFromResponse})},updateUiFromJson:function(c){var a=this.get(c.ruleId)||{};a.value=c.value;a.fresh=a.fresh||c.fresh;this.set(c.ruleId,a);this.updateUiForRule(c.ruleId)},updateUiFromResponse:function(a){a.responseJSON.each(this.updateUiFromJson,this);var c=this.values().all(function(d){return d.fresh});if(!c){this.update(this.delay);this.delay=this.delay*1.5}},updateNow:function(){this.update()},update:function(c){var a=this.displayedRules();if(a.length>0){if(c){this.requestUpdate.delay(c,a)}else{this.requestUpdate(a)}}},displayedRules:function(){return $$("span.r_count[data-fresh=false]").map(function(a){return a.readAttribute("data-rule-id")}).uniq()},updateUiForRule:function(c){var e=this.get(c);var d=$j("span.r_count[data-rule-id="+c+"]");var a=this;d.each(function(){var f=$j(this);f.html("("+e.value+")");f.data("fresh",e.fresh);if(e.fresh){if(e.value==="0"){f.closest("a").addClass("empty");if(!a.ticket_show_empty_views){$(f.closest("li")[0]).slideUp()}}else{f.closest("a").removeClass("empty")}}})},updateUi:function(){this.keys().each(this.updateUiForRule,this)}});Event.observe(document,"dom:loaded",function(){$$("textarea").each(function(a){Event.observe(a,"keydown",InputTracking.trackElement)});$$("form").each(function(a){InputTracking.fixSubmit(a,"onsubmit")});$$("form input[type=button]").each(function(a){InputTracking.fixSubmit(a,"onclick")});$$("select.country_select_field").each(function(a){new CountrySelectField(a)})});$j(function(){$j("input[placeholder], textarea[placeholder]").placeholder()});window.onbeforeunload=function(){if(InputTracking.enabled){for(var c=0;c<InputTracking.trackedElements.length;c++){var a;if(typeof(InputTracking.trackedElements[c].value)==="undefined"){a=InputTracking.trackedElements[c].innerHTML}else{a=InputTracking.trackedElements[c].value}if(a!==InputTracking.trackedElements[c].originalValue&&InputTracking.trackedElements[c].id!=="comment_value"){return"You have entered some text on this page. If you choose to proceed you will lose your changes."}}}};document.observe("dom:loaded",function(){if(window.fluid){document.body.insert("<div id='notifications' style='display:none'></div>");new Ajax.PeriodicalUpdater("notifications","/notifications/status",{asynchronous:false,method:"get",frequency:120,decay:10,requestHeaders:{Accept:"application/json"},onSuccess:function(c){var a=c.responseText.evalJSON();if(a.count!=null&&a.count>0){window.fluid.dockBadge=a.count}if(a.message!=null){window.fluid.showGrowlNotification({title:"Zendesk update",description:a.message.toString(),priority:1,sticky:false,identifier:"Zendesk "+Math.random()*10000})}}})}});Autocompleter.lookupUser=function(e,a,f){var c=e?"/users/multivalue_autocomplete":"/users/autocomplete";var d={name:a,rand:(new Date()).getTime()};new Ajax.Request(c,{method:"GET",parameters:d,onSuccess:function(g){f(g.responseJSON)}})};Autocompleter.UserCache=new Autocompleter.Cache(Autocompleter.lookupUser.curry(false));Autocompleter.cachedLookupUser=Autocompleter.UserCache.lookup.bind(Autocompleter.UserCache);Autocompleter.MultiUserCache=new Autocompleter.Cache(Autocompleter.lookupUser.curry(true));Autocompleter.cachedLookupMultiUser=Autocompleter.MultiUserCache.lookup.bind(Autocompleter.MultiUserCache);Autocompleter.lookupTag=function(a,c){new Ajax.Request("/tags/autocomplete.json",{method:"GET",parameters:{name:a,rand:(new Date()).getTime()},onSuccess:function(d){c(d.responseJSON)}})};Autocompleter.TagCache=new Autocompleter.Cache(Autocompleter.lookupTag);Autocompleter.cachedLookupTag=Autocompleter.TagCache.lookup.bind(Autocompleter.TagCache);Autocompleter.lookupAccount=function(a,c){new Ajax.Request("/monitor/children/lookup",{method:"GET",parameters:{query:a,rand:(new Date()).getTime()},onSuccess:function(d){c(d.responseJSON)}})};Autocompleter.AccountCache=new Autocompleter.Cache(Autocompleter.lookupAccount,{choices:50});Autocompleter.cachedLookupAccount=Autocompleter.AccountCache.lookup.bind(Autocompleter.AccountCache);Autocompleter.lookupOrganization=function(a,c){new Ajax.Request("/organizations/autocomplete",{method:"GET",parameters:{name:a,rand:(new Date()).getTime()},onSuccess:function(d){c(d.responseJSON)}})};Autocompleter.OrganizationCache=new Autocompleter.Cache(Autocompleter.lookupOrganization);Autocompleter.cachedLookupOrganization=Autocompleter.OrganizationCache.lookup.bind(Autocompleter.OrganizationCache);var ZdCreditCard={submitCreditCardForm:function(){$("credit-card-error").hide();if(ZdCreditCard.validate()){ZdCreditCard.serializeExpiry();$j("#transparent-redirect").submit();$("submit-credit-card").disabled=true;$("submit-credit-card").value=I18n.t("txt.admin.javascript.zd_creditcard")}else{$("credit-card-error").show()}return false},validate:function(){var d=$F("country");var c=$F("state");var a=$F("zip");if(a.blank()||d.blank()||a.blank()){return false}if(d=="prompt"){return false}if(d=="US"){if(c=="prompt"){return false}}return true},resetCreditCardForm:function(){var d=$("submit-credit-card");var a=$$("input#submit-credit-card.trial")[0];var c=$("terms_agree");d.disabled=false;if(a){a.value=I18n.t("txt.public.javascript.zd_creditcard.purchase_my_subscription");d.disabled=true;c.observe("click",function(e){if(c.checked===true){d.disabled=false}else{if(c.checked===false){d.disabled=true}}})}else{d.value=I18n.t("txt.admin.views.account.credit_card._form.submit_credit_card_button_label")}},showCvvHelper:function(){$j.colorbox({href:"/account/subscription/cvv"})},serializeExpiry:function(){var c=$F("expiry_month");var a=$F("expiry_year");$("ccexp").value=c+""+a},preloadImages:function(){image=new Image();image.src="/images/find-the-cvv.png"},toggleStateSelect:function(){if($("country").value=="US"){$("state-select-row").show();$("state").disabled=false}else{$("state-select-row").hide();$("state").disabled=true}}};var ZendeskSearchCursor=Class.create({initialize:function(a){this.pages=new Object();this.pages.length=a.pageCount+1;this.currentPageIndex=a.pageIndex}});var ZendeskSearcher=Class.create({initialize:function(a){self.latestQuery=null;this.options=a;if(typeof(this.options.per_page)=="undefined"){this.options.per_page=3}},executeSearch:function(c,a){this.latestQuery=c;new Ajax.Request("/suggestions/search.json",{requestHeaders:{Accept:"application/json"},method:"get",parameters:{query:c,per_page:this.options.per_page,page:a},onSuccess:function(e){var d=e.responseText.evalJSON();this.results=d.results;this.results.each(function(f){f.titleNoFormatting=f.title;f.content=f.body;f.url="/entries/"+f.id});this.cursor=new ZendeskSearchCursor({pageCount:d.pages,pageIndex:d.page});this.callbackMethod()}.bind(this),onFailure:function(){$("topic_suggestions").update(new Element("h2").update(this.options.noResults));$("topic_suggestions").removeClassName("loading")}.bind(this)})},execute:function(a){return this.executeSearch(a,1)},gotoPage:function(a){if(this.latestQuery){return this.executeSearch(this.latestQuery,a)}else{return false}},setSearchCompleteCallback:function(a,d,c){this.callbackScope=a;this.callbackMethod=d.bind(a)}});var HomePageSearch=Class.create({initialize:function(a){this.options=a;var c=new Element("a").update(this.options.more);this.more=new Element("li",{id:"more_suggestions"}).update(c);this.showMore=a.showMore},searchComplete:function(){$("suggestion_submit").enable();$("topic_suggestions").removeClassName("loading");Try.these(this.more.remove);if(!this.searcher.cursor||this.searcher.cursor.currentPageIndex==0){$("topic_suggestions").update("")}if(this.searcher.results&&this.searcher.results.length>0){var a=$("suggestions");if(!a){a=new Element("ul",{id:"suggestions"});$("topic_suggestions").insert(a)}this.searcher.results.each(function(c){var f=c.titleNoFormatting.gsub(/.* :: /,"");var e=new Element("a",{href:c.url}).update(f);var d=new Element("li",{className:"suggestion"});d.insert(new Element("h3").update(e));d.insert(new Element("div").update(c.content.stripTags().truncate(160)));this.insert(d)},a);if(this.searcher.cursor&&this.searcher.cursor.currentPageIndex<this.searcher.cursor.pages.length-1){a.insert(this.more)}}else{if(this.options.emptyResultRedirect){window.location=this.options.emptyResultRedirect+escape($F("suggestions_query"));return false}else{$("topic_suggestions").insert(new Element("h2").update(this.options.noResults))}}},onSubmit:function(){$("suggestion_submit").disable();$("topic_suggestions").update();$("topic_suggestions").addClassName("loading");this.searcher.execute($F("suggestions_query"));return false},onShowMore:function(){this.more.remove();$("topic_suggestions").addClassName("loading");this.searcher.gotoPage(this.searcher.cursor.currentPageIndex+1);return false},setup:function(){this.searcher=new ZendeskSearcher(this.options);this.searcher.setSearchCompleteCallback(this,this.searchComplete,null);$("suggest_form").onsubmit=this.onSubmit.bind(this);if(this.options.moreLink){this.more.observe("click",function(){window.location=this.options.moreLink+escape($F("suggestions_query"))}.bind(this))}else{this.more.observe("click",this.onShowMore.bind(this))}}});Prototype.Browser.Mac=navigator.userAgent.toLowerCase().indexOf("mac")!=-1;var Widget=Class.create({initialize:function(a){this.id=a.id;this.locationId=a.locationId;this.isEmpty=a.isEmpty;this.sendInvitationMail=a.sendInvitationMail;if(Prototype.Browser.Mac){if(this._closeButton()){this._closeButton().addClassName("mac_widget_close_button")}}if(this.isEmpty){this.containingElement().hide()}},containingElement:function(){return $("widget_"+this.id)},show:function(){this.containingElement().blindDown({duration:0.2})},hide:function(a){this.containingElement().blindUp({duration:0.2,afterFinish:a})},destroy:function(){this.containingElement().remove()},_closeButton:function(){return this.containingElement().down(".widget_close_button")},_editButton:function(){return this.containingElement().down(".widget_edit_button")},showControls:function(){if(this.isEmpty){this.containingElement().show()}this._closeButton().appear({duration:0.3});if(this._editButton()){this._editButton().appear({duration:0.3})}this.containingElement().addClassName("widget_edit_mode")},hideControls:function(){this._closeButton().fade({duration:0.2});if(this._editButton()){this._editButton().fade({duration:0.3})}this.containingElement().removeClassName("widget_edit_mode");if(this.isEmpty){this.containingElement().hide()}}});Object.extend(Widget,{asyncInsertion:function(c){var a=$("widget_fixed");c&&c.each&&c.each(function(d){if(d.location<0&&a){a.insert({before:d.inner_html})}else{if(d.type=="CustomWidget"){$j("#sidebar").append(d.inner_html)}else{$("sidebar").insert({bottom:d.inner_html})}}});Widget.redraw();Widget.fireLoadEvents.delay(0.1)},redraw:function(){var a=$("add_widget_select_widget");if(Widget.hasVisibleWidgets()||(a&&a.visible())){$("container").removeClassName("full_width")}else{$("container").addClassName("full_width")}},hasVisibleWidgets:function(){return $$("#sidebar .draggable").any(function(a){return a.visible()})},pendingWidgets:new Array(),registeredWidgets:new Array(),register:function(c,a){Widget.pendingWidgets.push([c,a||{}])},activateWidgets:function(){var a;while(a=Widget.pendingWidgets.shift()){Widget.registeredWidgets.push(ObjectFactory.create(a[0],a[1]))}}});Widget.ScriptLoadingQueue=Class.create({initialize:function($super){this.QUEUED=10;this.LOADING=20;this.LOADED=30;this.queue=new Array();this.running=false},setExternalScriptState:function(d,c){var a=this.queue.find(function(f){return f.src==d});if(a.state<c){switch(c){case this.LOADING:a.loadingStartTime=new Date().getTime();break;case this.LOADED:a.loadingEndTime=new Date().getTime();break}a.state=c}},loading:function(){return this.queue.find(function(a){return a.state==this.LOADING},this)},isDone:function(){return this.queue.all(function(a){return a.state==this.LOADED},this)},next:function(){return this.queue.find(function(a){return a.state==this.QUEUED},this)},push:function(a,c){if(!this.include(a)){this.queue.push({src:a,state:this.QUEUED,options:c||{},loadingStartTime:null,loadingEndTime:null})}},include:function(a){return this.queue.any(function(c){return c.src==a})},loadScripts:function(f){if(this.isDone()){this.running=false;if(f){f()}}else{this.running=true;if(this.loading()){}else{var d=this.next();this.setExternalScriptState(d.src,this.LOADING);var e=$H({type:"text/javascript",charset:"utf-8"}).merge(d.options);var a=new Element("script");a.src=d.src;e.each(function(g){a.setAttribute(g.key,g.value)});var c=document.getElementsByTagName("head")[0];if(!c){c=document.body.parentNode.appendChild(new Element("head"))}a.onload=this.setExternalScriptState.curry(d.src,this.LOADED).bind(this);a.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){this.onload()}}.bind(a);c.appendChild(a)}this.loadScripts.bind(this).delay(0.1,f)}}});Widget.scriptLoadingQueue=new Widget.ScriptLoadingQueue();Object.extend(Widget,{require:Widget.scriptLoadingQueue.push.bind(Widget.scriptLoadingQueue),require_old:function(f,c){var e=$H({type:"text/javascript",charset:"utf-8"}).merge(c);var a=new Element("script");a.src=f;e.each(function(g){a.setAttribute(g.key,g.value)});var d=document.getElementsByTagName("head")[0];if(!d){d=document.body.parentNode.appendChild(new Element("head"))}d.appendChild(a)},fireLoadEvents:function(){Widget.activateWidgets();Widget.scriptLoadingQueue.loadScripts(document.fire.curry("widgets:load").bind(document))}});var ReportWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.output=a.output;this.graphs=a.graphs;this.pointer=0},displayGraph:function(){if($(this.output)==null){return}this.pointer=this.pointer%this.graphs.length;$(this.output).src=this.graphs[this.pointer]},next:function(){this.pointer=this.pointer+1;this.displayGraph()},start:function(){this.displayGraph()}});var TextWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.output=a.output;this.texts=a.texts;this.delay=a.delay;this.pointer=0;this.callout=null},displayText:function(a,c){if($(c)==null){return}if(a<0){a=this.texts.length-1}else{a=a%this.texts.length}this.pointer=a;$(c).hide();$(c).update(this.texts[a]);$(c).appear({duration:1.5});if(this.texts.length>1){this.callout=this.displayText.bind(this).delay(this.delay,a+1,c)}},next:function(){window.clearTimeout(this.callout);this.displayText(this.pointer+1,this.output)},prev:function(){window.clearTimeout(this.callout);this.displayText(this.pointer-1,this.output)},start:function(){if(this.texts.length>0){this.displayText(this.pointer,this.output)}}});var TopPerformersWidget=Class.create(Widget,{initialize:function($super,c){$super(c);var e=$$(".top_performers_list");var f=e.length>1;$$(".top_performers_list .toggle").each(function(g){if(f){g.show()}else{g.hide()}g.observe("click",function(){e.each(function(h){h.toggle();if(h.visible()){Zendesk.SettingsCookie.set("top-performers-widget-current",h.id)}})})});var a=Zendesk.SettingsCookie.get("top-performers-widget-current");var d=null;if(a){d=$$("#"+a+".top_performers_list")[0]}else{d=e[0]}d.show();Zendesk.SettingsCookie.set("top-performers-widget-current",d.id)}});var CustomWidget=Class.create(Widget,{});var BuddhaMachineWidget=Class.create(Widget,{});var CampfireWidget=Class.create(Widget,{});var OrganizationWidget=Class.create(Widget,{});var EmbedWidget=Class.create(Widget,{});var RelatedEntriesWidget=Class.create(Widget,{});var TopForumEntriesWidget=Class.create(Widget,{});var UserSentimentWidget=Class.create(Widget,{});var TicketSentimentWidget=Class.create(Widget,{});var ViewsWidget=Class.create(Widget,{initialize:function($super,a){$super(a);if(typeof(ruleCounts)!="undefined"){ruleCounts.newRulesDisplayed()}}});var GetSatisfactionWidget=Class.create(Widget,{});var IfbyphoneWidget=Class.create(Widget,{});var SamanageWidget=Class.create(Widget,{});var ConstantContactWidget=Class.create(Widget,{});var ForumsWidget=Class.create(Widget,{initialize:function($super,a){$super(a);var d=document.getUrlParameter("forum_id");if(d){setSelectedForSelect($("forum_id"),d)}var c=document.getUrlParameter("query");if(c&&($("query").value=="")){$("query").value=c}}});var HarvestWidget=Class.create(Widget,{});var SalesforceHelper=Class.create();SalesforceHelper.SOAP_LOGIN=new Template('<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope     xmlns:xsd="http://www.w3.org/2001/XMLSchema"     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"     SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"     xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">      <SOAP-ENV:Body>        <login xmlns="urn:enterprise.soap.sforce.com">          <username xsi:type="xsd:string">#{username}</username>          <password xsi:type="xsd:string">#{password}</password>        </login>      </SOAP-ENV:Body></SOAP-ENV:Envelope>');SalesforceHelper.SOAP_QUERY=new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <SessionHeader xmlns="urn:enterprise.soap.sforce.com">      <sessionId>#{session}</sessionId>    </SessionHeader>  </soap:Header>  <soap:Body>    <query xmlns="urn:enterprise.soap.sforce.com">      <queryString>#{query}</queryString>    </query>  </soap:Body></soap:Envelope>');SalesforceHelper.SELECT=new Template("SELECT department, email, fax, firstname, homephone, lastname, mailingcity,        mailingcountry, mailingpostalcode, mailingstreet, mobilephone, name,        othercity, othercountry, otherphone, otherpostalcode, otherstate,        otherstreet, phone, salutation, title FROM contact WHERE email LIKE '%#{search}%' OR name LIKE '%#{search}%'");SalesforceHelper.LOGIN_URL="/proxy/direct.xml?url=https://www.salesforce.com/services/Soap/c/13.0&timeout=12&body=";SalesforceHelper.QUERY_URL=new Template("/proxy/direct.xml?url=#{serverUrl}&body=#{xml}");SalesforceHelper.SESSION_MATCH=new RegExp("/.*<sessionId>(.*)</sessionId>.*/");SalesforceHelper.SERVER_MATCH=new RegExp("/.*<serverUrl>(.*)</serverUrl>.*/");SalesforceHelper.authorizationUrl=function(c,a){return this.LOGIN_URL+escape(this.SOAP_LOGIN.evaluate({username:c,password:a}))};SalesforceHelper.getNodeValue=function(a,d){if(Prototype.Browser.WebKit){d=d.replace("sf:","")}var c=a.getElementsByTagName(d);if(c==null||c.length==0){return null}return c[0].childNodes[0].nodeValue};SalesforceHelper.getNodeString=function(a,d){var c=this.getNodeValue(a,d);if(c==null){return""}else{return c}};SalesforceHelper.getErrorCode=function(a){return this.getNodeValue(a,"faultcode")};SalesforceHelper.getRecords=function(a){var c=a.getElementsByTagName("records");if(c==null){return new Array()}return c};SalesforceHelper.renderLine=function(a,f,e){var c="";for(var d=0;d<f.length;d++){c+=this.getNodeString(a,f[d]);if(c!=""){c+=" "}}if(c!=""){return e.evaluate({output:c})}else{return""}};SalesforceHelper.renderRecord=function(d){var a="";a+=this.renderLine(d,["sf:Salutation","sf:FirstName","sf:LastName"],new Template("<h5 style='font-size: 16px;'>#{output}</h5>"));a+=this.renderLine(d,["sf:Title"],new Template("<p class='minimum'>#{output}</p>"));a+=this.renderLine(d,["sf:Department"],new Template("<p class='minimum'>#{output}</p>"));var e="";e+=this.renderLine(d,["sf:Phone"],new Template("<p class='minimum'>#{output}</p>"));e+=this.renderLine(d,["sf:MobilePhone"],new Template("<p class='minimum'>#{output}<span class='sub'>mobile</span></p>"));if(e!=""){a+="<h5>Phone</h5>";a+=e}a+=this.renderLine(d,["sf:Email"],new Template("<p class='minimum'><a href='mailto:#{output}'>#{output}</a></p>"));var c=this.renderLine(d,["sf:MailingStreet"],new Template("#{output}")).replace(",","<br />");if(c!=""){subaddress=this.renderLine(d,["sf:MailingPostalCode","sf:MailingCity"],new Template("#{output} "));if(subaddress!=""){c+="<br /> "+subaddress}c+=this.renderLine(d,["sf:MailingCountry"],new Template("<br />#{output}"))}a+=c;return a};SalesforceHelper.buildQueryUrl=function(g,a,c){var f=this.SELECT.evaluate({search:c});var e=this.SOAP_QUERY.evaluate({query:f,session:g});var d=this.QUERY_URL.evaluate({serverUrl:a,xml:escape(e)});return d};var SalesforceWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.username=a.username;this.password=a.password;this.destination=a.destination;this.formInstance=null},disableForm:function(){this.formInstance.button.value="Looking...";this.formInstance.button.disabled=true},enableForm:function(){this.formInstance.button.value="Lookup user";this.formInstance.button.disabled=false},lookup:function(a){this.formInstance=a;this.disableForm();var c=SalesforceHelper.authorizationUrl(this.username,this.password);new Ajax.Request(c,{method:"post",requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(d){this.executeAuthorizedQuery(d.responseXML)}.bind(this),onFailure:function(){alert("Salesforce login failed. Try again in a short moment.");this.enableForm()}.bind(this)})},executeAuthorizedQuery:function(f){var e=SalesforceHelper.getNodeValue(f,"sessionId");var a=SalesforceHelper.getNodeValue(f,"serverUrl");if(e!=null&&a!=null){var c=SalesforceHelper.buildQueryUrl(e,a,this.formInstance.email.value);new Ajax.Request(c,{method:"post",requestHeaders:{Accept:"application/xml",SOAPAction:"query"},onSuccess:function(g){this.displayResult(g.responseXML)}.bind(this),onFailure:function(){alert("Salesforce query failed.");this.enableForm()}.bind(this)})}else{var d=SalesforceHelper.getNodeValue(f,"faultcode");if(d=="sf:LOGIN_MUST_USE_SECURITY_TOKEN"){alert("Salesforce login failed - Salesforce network access needs configuration.")}else{if(d=="sf:API_DISABLED_FOR_ORG"){alert("Salesforce login failed - Your Salesforce edition does not support API access.")}else{alert("Salesforce login failed. Failed to find server or session. Code: "+d)}}this.enableForm()}},displayResult:function(e){var c=SalesforceHelper.getRecords(e);if(c.length==0){alert("No match found in Salesforce.");this.enableForm();return}var a="";for(var d=0;d<c.length;d++){a+=SalesforceHelper.renderRecord(c[d])}a+="<br />";$(this.destination).update(a);this.enableForm()}});var JiraHelper={GET_SESSION:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:login xmlns:q1="http://soap.rpc.jira.atlassian.com">      <in0 xsi:type="xsd:string">#{username}</in0>      <in1 xsi:type="xsd:string"><![CDATA[#{password}]]></in1>    </q1:login>  </soap:Body></soap:Envelope>'),GET_PROJECTS:new Template('<?xml version="1.0" encoding="UTF-8"?><SOAP-ENV:Envelope xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">  <SOAP-ENV:Body>    <m:getProjectsNoSchemes xmlns:m="#{url}rpc/soap/jirasoapservice-v2">      <in0 xsi:type="xsd:string">#{sessionId}</in0>    </m:getProjectsNoSchemes>  </SOAP-ENV:Body></SOAP-ENV:Envelope>'),GET_ASSIGNEES:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/agilossoapservice-v1" xmlns:types="#{url}rpc/soap/agilossoapservice-v1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:getAssignableUsers xmlns:q1="#{url}">      <in0 xsi:type="xsd:string">#{sessionId}</in0>      <in1 xsi:type="xsd:string">#{projectKey}</in1>    </q1:getAssignableUsers>  </soap:Body></soap:Envelope>'),GET_ISSUE_TYPES2:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">  <q1:getIssueTypesForProject xmlns:q1="http://soap.rpc.jira.atlassian.com">   <in0 xsi:type="xsd:string">#{sessionId}</in0>   <in1 xsi:type="xsd:string">#{projectId}</in1>  </q1:getIssueTypesForProject></soap:Body></soap:Envelope>'),GET_ISSUE_TYPES:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><q1:getIssueTypesForProject xmlns:q1="http://soap.rpc.jira.atlassian.com"><in0 xsi:type="xsd:string">#{sessionId}</in0><in1 xsi:type="xsd:string">#{projectId}</in1></q1:getIssueTypesForProject></soap:Body></soap:Envelope>'),SUBMIT_ISSUE:new Template('<?xml version="1.0" encoding="ISO-8859-1"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="#{url}rpc/soap/jirasoapservice-v2" xmlns:types="#{url}rpc/soap/jirasoapservice-v2/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <q1:createIssue xmlns:q1="http://soap.rpc.jira.atlassian.com">      <in0 xsi:type="xsd:string">#{sessionId}</in0>      <in1 href="#id1" />    </q1:createIssue>    <q2:RemoteIssue id="id1" xsi:type="q2:RemoteIssue" xmlns:q2="http://beans.soap.rpc.jira.atlassian.com">      <id xsi:nil="true" />      <affectsVersions xsi:nil="true" />      <assignee xsi:type="xsd:string">#{assignee}</assignee>      <attachmentNames xsi:nil="true" />      <components xsi:nil="true" />      <created xsi:nil="true" />      <customFieldValues xsi:nil="true" />      <description>#{description}</description>      <duedate xsi:nil="true" />      <environment xsi:nil="true" />      <fixVersions xsi:nil="true" />      <key xsi:nil="true" />      <priority xsi:nil="true" />      <project xsi:type="xsd:string">#{projectKey}</project>      <reporter xsi:nil="true" />      <resolution xsi:nil="true" />      <status xsi:nil="true" />      <summary xsi:type="xsd:string">#{summary}</summary>      <type xsi:type="xsd:string">#{type}</type>      <updated xsi:nil="true" />      <votes xsi:nil="true" />      <customFieldValues href="#id2" />    </q2:RemoteIssue>    <soapenc:Array id="id2" xmlns:q3="http://beans.soap.rpc.jira.atlassian.com" soapenc:arrayType="q3:RemoteCustomFieldValue[1]">      <Item href="#id3" />    </soapenc:Array>    <q4:RemoteCustomFieldValue id="id3" xsi:type="q4:RemoteCustomFieldValue" xmlns:q4="http://beans.soap.rpc.jira.atlassian.com">      <customfieldId xsi:type="xsd:string">customfield_#{customFieldId}</customfieldId>      <key xsi:nil="true" />      <values href="#id4" />    </q4:RemoteCustomFieldValue>    <soapenc:Array id="id4" soapenc:arrayType="xsd:string[1]">      <Item>#{ticketId}</Item>    </soapenc:Array>  </soap:Body></soap:Envelope>'),SUBMIT_FORM:new Template('<form class="form" id="jira-form-#{widgetId}"> Submit this ticket as a new issue <label>Project</label><select name="projectId" id="jiraProjectSelector" class="jiraProjectSelector" onchange="ObjectFactory.get(#{widgetId}).projectsSelector(this.options[this.selectedIndex].value)"></select> <label>Type</label><select name="typeId" id="jiraTypeSelector" class="jiraTypeSelector"></select> <label>Assignee ID</label><select name="jiraAssigneeSelector" class="jiraAssigneeSelector" id="jiraAssigneeSelector"></select> <label></label><input type="button" value="Submit" id="submit" class="jiraSubmit" onclick="ObjectFactory.get(#{widgetId}).submitIssue($(\'jiraForm-#{widgetId}\'));return false;"></form>'),JIRA_TAG:new Template("<ticket><additional-tags>jira</additional-tags></ticket>"),JIRA_ISSUE_EXTERNAL_LINK:new Template("<external-link><type>JiraIssue</type><issue-id>#{issueId}</issue-id></external-link>"),NOTICE:new Template('This ticket is related to the following issue in JIRA:<br /><br /><b><a href="#{url}/browse/#{issueId}" target=_blank>#{issueId}</a></b><br />&nbsp;'),MISSING_TICKET:new Template("Only available when viewing tickets.<br />&nbsp;"),getSessionRequest:function(d,c,a){return escape(this.GET_SESSION.evaluate({username:d,password:c,url:a}))},getProjectsRequest:function(c,a){return escape(this.GET_PROJECTS.evaluate({sessionId:c,url:a}))},getProjectsAssigneeRequest:function(d,c,a){return escape(this.GET_ASSIGNEES.evaluate({sessionId:d,url:c,projectKey:a}))},getProjectsIssueTypesRequest:function(d,c,a){return escape(this.GET_ISSUE_TYPES.evaluate({sessionId:d,url:c,projectId:a}))},getSubmitRequest:function(e,c,f,h,a,g,k,d,j){return escape(this.SUBMIT_ISSUE.evaluate({sessionId:e,url:c,assignee:f,projectKey:a,type:h,summary:XmlHelper.encodeString(g),description:XmlHelper.encodeString(k),ticketId:d,customFieldId:j}))},getSubmitForm:function(a){return(this.SUBMIT_FORM.evaluate({widgetId:a}))},getInJiraNotice:function(a,c){return(this.NOTICE.evaluate({url:a,issueId:c}))},getMissingTicketMessage:function(){return(this.MISSING_TICKET.evaluate({}))},setIssueIdRequest:function(a){return this.JIRA_ISSUE_EXTERNAL_LINK.evaluate({issueId:a})},setJiraTagRequest:function(){return this.JIRA_TAG.evaluate()},PROXY_URL1:new Template("/proxy/direct?log=1&url=#{url}rpc/soap/jirasoapservice-v2&json=1"),PROXY_URL2:new Template("/proxy/direct?log=1&url=#{url}rpc/soap/agilossoapservice-v1?"),getProxyUrl:function(c,a){return escape(this.PROXY_URL1.evaluate({url:c,body:a}))},getProxyUrl2:function(c,a){return escape(this.PROXY_URL2.evaluate({url:c,body:a}))},getSessionUrl:function(d,c,a){doc=JiraHelper.getSessionRequest(d,c,a);a=JiraHelper.getProxyUrl(a,doc);return a},getNodeValue:function(a,c){if(Prototype.Browser.WebKit){c=c.replace("sf:","")}node=a.getElementsByTagName(c);if(node==null||node.length==0){return null}return node[0].childNodes[0].nodeValue},getNodeString:function(a,c){value=this.getNodeValue(a,c);if(value==null){return""}else{return value}},getRecords:function(a,d,c){results=a.getElementsByTagName(c);if(results.length==0){results=a.getElementsByTagName(d+":"+c)}if(results==null){return new Array()}return results},populateProjects:function(d,f){var c=[];var a=[];if($("jiraProjectSelector").options.length==0){var e=$A(XmlHelper.getRecords(f,"","multiRef"));e.each(function(g){a.push(new JiraProject(g))});a.sort(function(h,g){return h.name.toLowerCase()<g.name.toLowerCase()?-1:1});projectSelector=d.down("select.jiraProjectSelector");projectSelector.appendChild(new Element("option"));a.each(function(h){var g=new Element("option");g.value=h.key;g.innerHTML=h.name;projectSelector.appendChild(g);c[h.key]=h.id})}return c},populateProjectIssueTypes:function(c,e){var a=[];var d=$A(XmlHelper.getRecords(e,"","multiRef"));d.each(function(f){a.push(new JiraType(f))});a.sort(function(g,f){return g.name.toLowerCase()<f.name.toLowerCase()?-1:1});typeSelector=c.down("select.jiraTypeSelector");typeSelector.update("");typeSelector.appendChild(new Element("option"));a.each(function(g){var f=new Element("option");f.value=g.id;f.innerHTML=g.name;typeSelector.appendChild(f)})},populateAssignees:function(c,e){var a=[];var d=$A(XmlHelper.getRecords(e,"","multiRef"));d.each(function(f){a.push(new JiraAsignee(f))});a.sort(function(g,f){return g.name.toLowerCase()<f.name.toLowerCase()?-1:1});asigneeSelector=c.down("select.jiraAssigneeSelector");asigneeSelector.update("");asigneeSelector.appendChild(new Element("option"));a.each(function(g){var f=new Element("option");f.value=g.name;f.innerHTML=g.fullName;asigneeSelector.appendChild(f)})}};var XmlHelper={getTextContentByKey:function(a,c){if(Prototype.Browser.IE){return a.getElementsByTagName(c)[0].childNodes[0].nodeValue}return a.getElementsByTagName(c)[0].textContent},encodeString:function(c){var a=c;a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/'/g,"&apos;");a=a.replace(/"/g,"&quot;");return a},getRecords:function(a,d,c){results=a.getElementsByTagName(c);if(results.length==0){results=a.getElementsByTagName(d+":"+c)}if(results==null){return new Array()}return results}};var JiraProject=Class.create({initialize:function(a){this.key=XmlHelper.getTextContentByKey(a,"key");this.id=XmlHelper.getTextContentByKey(a,"id");this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(a,"name"))}});var JiraType=Class.create({initialize:function(a){this.id=XmlHelper.getTextContentByKey(a,"id");this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(a,"name"))}});var JiraAsignee=Class.create({initialize:function(a){this.name=XmlHelper.encodeString(XmlHelper.getTextContentByKey(a,"name"));this.fullName=XmlHelper.encodeString(XmlHelper.getTextContentByKey(a,"fullname"))}});var JiraWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.url=a.url;this.username=a.username;this.password=a.password;this.formInstance=null;this.ticketId=a.ticketId;this.issueId=null;this.externalId=a.externalId;this.customFieldId=a.customFieldId;this.widgetId=a.id;this.subject=a.subject;this.description=a.description;this.projectIds=null;this.contentRoot=this.containingElement().down("div.jiraContent"+this.widgetId);if(!this.url.endsWith("/")){this.url+="/"}this.start()},start:function(){if(this.ticketId){var a=this;$j.ajax({type:"get",url:"/tickets/"+this.ticketId+"/external_links.json",success:function(d){var c;if(c=_(d).find(function(e){return e.external_link_type==="JiraIssue"})){a.issueId=c.external_link["issue_id"]||this.externalId;a.contentRoot.update(JiraHelper.getInJiraNotice(a.url,a.issueId))}else{a.contentRoot.update(JiraHelper.getSubmitForm(a.id));a.proxyUrl=JiraHelper.PROXY_URL1.evaluate({url:a.url});a.proxyUrl2=JiraHelper.PROXY_URL2.evaluate({url:a.url});a.getSession()}}})}else{this.contentRoot.update(JiraHelper.getMissingTicketMessage())}},getSession:function(){var a="body="+JiraHelper.getSessionRequest(this.username,this.password,this.url);new Ajax.Request(this.proxyUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(c){this.extractSessionID(c.responseXML)}.bind(this),onFailure:function(){alert("Failed")}.bind(this)})},extractSessionID:function(c){var a=JiraHelper.getRecords(c,"ns1","loginResponse");if(a.length==1){this.sessionId=JiraHelper.getNodeString(a[0],"loginReturn");this.getProjects()}else{alert("Login failed")}},getProjects:function(){var a="body="+JiraHelper.getProjectsRequest(this.sessionId,this.url);new Ajax.Request(this.proxyUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(c){this.projectIds=JiraHelper.populateProjects(this.contentRoot,c.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)})},projectsSelector:function(a){var c="body="+JiraHelper.getProjectsAssigneeRequest(this.sessionId,this.url,a);new Ajax.Request(this.proxyUrl2,{method:"post",postBody:c,requestHeaders:{Accept:"application/xml",SOAPAction:"0"},onSuccess:function(d){JiraHelper.populateAssignees(this.contentRoot,d.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)});c="body="+JiraHelper.getProjectsIssueTypesRequest(this.sessionId,this.url,this.projectIds[a]);new Ajax.Request(this.proxyUrl,{method:"post",postBody:c,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(d){JiraHelper.populateProjectIssueTypes(this.contentRoot,d.responseXML)}.bind(this),onFailure:function(){alert("Failed to get projects")}.bind(this)})},submitIssue:function(c){var a="/tickets/"+this.ticketId+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(e){var d=XmlHelper.getTextContentByKey(e.responseXML,"subject");this.submitIssue2(d,this.description)}.bind(this),onFailure:function(){alert("Failed to submit issue.")}.bind(this)});return false},submitIssue2:function(c,d){var a=c;if(a==""){a="Ticket #"+this.ticketId}var e="body="+JiraHelper.getSubmitRequest(this.sessionId,this.url,this.contentRoot.down("select.jiraAssigneeSelector").getValue(),this.contentRoot.down("select.jiraTypeSelector").getValue(),this.contentRoot.down("select.jiraProjectSelector").getValue(),a,d,this.ticketId,this.customFieldId);new Ajax.Request(this.proxyUrl,{method:"post",postBody:e,requestHeaders:{Accept:"application/xml",SOAPAction:"login"},onSuccess:function(f){this.setIssueId(f.responseXML);this.setJiraTag();this.addTag("jira")}.bind(this),onFailure:function(){alert("Failed to submit issue.")}.bind(this)});return false},addTag:function(a){if(typeof(ticketTagField)!="undefined"){ticketTagField.addEntry("jira","jira")}},setIssueId:function(g){var d=JiraHelper.getRecords(g,"","multiRef");if(d.length>0){var e=XmlHelper.getTextContentByKey(d[0],"key");var f=JiraHelper.setIssueIdRequest(e);var c="/tickets/"+this.ticketId+"/external_links.xml?";new Ajax.Request(c,{contentType:"application/xml",method:"post",encoding:"",postBody:f,onSuccess:function(h){this.contentRoot.update(JiraHelper.getInJiraNotice(this.url,e))}.bind(this),onFailure:function(){alert("Failed to set JIRA issue ID.")}})}else{var a=XmlHelper.getTextContentByKey(g,"faultstring");alert("Failed to retrieve JIRA issue key.\n\n("+a+")")}},setJiraTag:function(a){$j.ajax({url:"/tickets/"+this.ticketId+".xml",type:"post",data:{_method:"put",ticket:{additional_tags:"jira"}},error:function(){alert("Failed to set JIRA tag.")}})}});var TactileHelper={PROXY_URL:new Template("/proxy/direct?log=1&url=#{url}"),QUERYSTRING_PEOPLE:new Template("people/?api_token=#{apiToken}&email=#{email}"),QUERYSTRING_CONTACTMETHODS:new Template("people/contact_methods/?api_token=#{apiToken}&id=#{id}"),QUERYSTRING_PERSON:new Template("people/view/?api_token=#{apiToken}&id=#{id}"),getQueryURL:function(a){return TactileHelper.PROXY_URL.evaluate({url:a})},getPeopleQueryString:function(a,c){return TactileHelper.QUERYSTRING_PEOPLE.evaluate({apiToken:a,email:c})},getContactMethodsQueryString:function(a,c){return TactileHelper.QUERYSTRING_CONTACTMETHODS.evaluate({apiToken:a,id:c})},getPersonQueryString:function(a,c){return TactileHelper.QUERYSTRING_PERSON.evaluate({apiToken:a,id:c})},renderLine:function(c,e){var a="";for(var d=0;d<c.length;d++){if(c[d]>""){if(a!=""){a+=" "}a+=c[d]}}return a>""?e.evaluate({output:a}):""},renderRecord:function(e,a){var f="";var d="";var c="";var g=new Template("#{output}<br />");f+=this.renderLine([e.title,e.name],new Template("<h5 style='font-size: 16px;'>#{output}</h5>"));d+=this.renderLine([e.jobtitle],g);d+=this.renderLine([e.organisation],g);f+=this.renderLine([d],new Template('<p class="minimum">#{output}</p>'));c+=this.renderLine([e.street1],g);c+=this.renderLine([e.street2],g);c+=this.renderLine([e.street3],g);c+=this.renderLine([e.town],g);c+=this.renderLine([e.county],g);c+=this.renderLine([e.postcode],g);c+=this.renderLine([e.country],g);f+=this.renderLine([c],new Template('<p class="minimum">#{output}</p>'));f+=this.renderContactMethods(a,"T","Telephone");f+=this.renderContactMethods(a,"M","Mobile");f+=this.renderContactMethods(a,"E","Email");f+=this.renderLine([e.description],new Template("<h5>Description</h5>#{output}<br />"));return f+"<br />"},renderContactMethods:function(a,g,d){var c="";var f=new Template('#{value} <span class="sub">#{name}</span><br />');for(var e=0;e<a.contact_methods.length;e++){var h=a.contact_methods[e];if(h.type==g){c+=f.evaluate({value:h.contact,name:h.name})}}return c>""?"<h5>"+d+"</h5>"+c:""},renderList:function(c,d){var a="";a="<h5>"+c.length+" matching people found in TactileCRM. Click on a person for more information</h5>";a+=c.collect(function(e){return('<span class="link" onclick="ObjectFactory.get('+d+").lookupPerson("+e.id+')">'+e.name+"</span>")}.bind(this)).join("<br/>")+"<br />&nbsp;";return a}};var TactileWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.widgetId=a.id;this.url=a.url;this.apiToken=a.apiToken;this.formInstance=null;this.contentRoot=this.containingElement().down("div.tactileContent"+this.widgetId);if(!this.url.endsWith("/")){this.url+="/"}},lookup:function(a){var d=a.down("input.email").value;var c=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getPeopleQueryString(this.apiToken,d));new Ajax.Request(c,{method:"get",encoding:"",onSuccess:function(e){this.showList(e.responseText.evalJSON())}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)});return false},showList:function(a){if(a.status=="error"){alert("Error: Unable to login to TactileCRM");return false}if(a.people.length==0){alert("No match found in TactileCRM")}else{if(a.people.length>1){this.contentRoot.update(TactileHelper.renderList(a.people,this.id))}else{this.lookupPerson(a.people[0].id)}}},lookupPerson:function(c){var a=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getPersonQueryString(this.apiToken,c));new Ajax.Request(a,{method:"get",encoding:"",onSuccess:function(d){this.result1=d.responseText.evalJSON();this.lookupContactMethods(c)}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},lookupContactMethods:function(c){var a=TactileHelper.getQueryURL(this.url)+escape(TactileHelper.getContactMethodsQueryString(this.apiToken,c));new Ajax.Request(a,{method:"get",encoding:"",onSuccess:function(d){this.result2=d.responseText.evalJSON();this.show()}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},show:function(){var a=TactileHelper.renderRecord(this.result1.person,this.result2);this.contentRoot.update(a)}});var PagloHelper={SEARCH_FORM:new Template('<div class="asset"></div><div class="software"></div><form class="form" id="paglo-form-#{widgetId}"> <label>Search</label><input type="text" name="token" id="token" value="#{name}"/  > <br/><input type="submit" id="submit" value="Search" onclick="ObjectFactory.get(#{widgetId}).doSearch($(\'paglo-form-#{widgetId}\').token.value);return false;"></form>'),getSearchForm:function(c,a){return PagloHelper.SEARCH_FORM.evaluate({widgetId:c,name:a})},QUERY:new Template("select nvl(system/dns_name, first(interface/inet/ip_address)) as name, first(interface/inet/ip_address) as ip_address from /network/device where system/dns_name like '%#{token}%' or interface/inet/ip_address = '#{token}%' or wmi/win32_computersystem/username = '#{token}' or wmi/win32_computersystem/username like '%#{token2}' order by 1 limit 10"),getQuery:function(a){return PagloHelper.QUERY.evaluate({token:a,token2:"\\"+a})},SOFTWARE_QUERY:new Template("select Name, Version from /network/device[system/dns_name = '#{name}']/wmi/win32_product order by 1,2"),getSoftwareQuery:function(a){return PagloHelper.SOFTWARE_QUERY.evaluate({name:a})},URL:new Template("/proxy/direct?url=https://api.gotomanage.com/api&contenttype=application/x-www-form-urlencoded&body=#{body}"),getURL:function(a){return PagloHelper.URL.evaluate({body:escape(a)})},doc:new Template("method=paglo.query&v=1.0&api_key=#{apiKey}&query=#{query}"),getDoc:function(c,a){return PagloHelper.doc.evaluate({apiKey:c,query:a})},ITEM:new Template('<span class="link" onClick="ObjectFactory.get(#{widgetId}).#{functionName}(\'#{name}\')">#{name}</span><br />'),renderItem:function(a,d,c){return PagloHelper.ITEM.evaluate({name:a,functionName:d,widgetId:c})},LIST_TEMPLATE:new Template("<b>#{title}</b><br /><br />#{content}"),getList:function(c,a){return PagloHelper.LIST_TEMPLATE.evaluate({title:c,content:a})},SOFTWARE_SELECTION:new Template('<b>Select software package:</b><br /><select id="paglo_software" class="software" onChange="ObjectFactory.get(#{widgetId}).selectSoftware(this.options[this.selectedIndex].value)"></select>'),getSoftwareSelection:function(a){return PagloHelper.SOFTWARE_SELECTION.evaluate({widgetId:a})},ASSET:new Template("select system/dns_name, interface/inet/ip_address, nvl(system_profile/spsoftwaredatatype/os_version, os/version, wmi/win32_operatingsystem/caption || ' ' || wmi/win32_operatingsystem/csdversion) as os, nvl(system/class, system/computed_class) as class, nvl(system/vendor, wmi/win32_computersystemproduct/vendor, system/computed_vendor) as vendor, nvl(system/model, wmi/win32_computersystemproduct/name, system/computed_model) as model, nvl(wmi/win32_computersystem/username, system_profile/spsoftwaredatatype/user_name) as username from /network/device where system/(dns_name = '#{name}')"),getAssetQuery:function(a){return PagloHelper.ASSET.evaluate({name:a})},ASSET_INFO_SECTION:new Template("<b>#{title}:</b><br /> #{value}<br /><br />"),getAssetInfoSection:function(c,a){return(a!=""?PagloHelper.ASSET_INFO_SECTION.evaluate({title:c,value:a}):"")},ASSET_HEADER:new Template('<a href="https://app.paglo.com/app/inventory/lookup?key=system/dns_name&value=#{name}" target="_blank"><img src="/images/widgets/paglo/asset.png" />&nbsp;&nbsp;<b>#{name}</b></a> <br /><br />'),getAssetHeader:function(a){return PagloHelper.ASSET_HEADER.evaluate({name:a})},getAssetInfo:function(c,d){var a="";var f=new RegExp("\\S");for(var e=0;e<c.length;e++){if(c[e].attributes.length>0&&c[e].childNodes.length>0){if(c[e].getAttribute("name")==d&&c[e].firstChild.nodeValue.match(f)){a+=(a!=""?"<br />":"")+c[e].firstChild.nodeValue}}}return a},renderAssetInfo:function(d){var c="";var a=XmlHelper.getRecords(d,"","value");c+=PagloHelper.getAssetHeader(PagloHelper.getAssetInfo(a,"system/dns_name"));c+=PagloHelper.getAssetInfoSection("Class",PagloHelper.getAssetInfo(a,"class"));c+=PagloHelper.getAssetInfoSection("Vendor",PagloHelper.getAssetInfo(a,"vendor"));c+=PagloHelper.getAssetInfoSection("Model",PagloHelper.getAssetInfo(a,"model"));c+=PagloHelper.getAssetInfoSection("Operating system",PagloHelper.getAssetInfo(a,"os"));c+=PagloHelper.getAssetInfoSection("Username",PagloHelper.getAssetInfo(a,"username"));c+=PagloHelper.getAssetInfoSection("Network",PagloHelper.getAssetInfo(a,"interface/inet/ip_address"));return c}};var PagloWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.apiKey=a.apikey;this.formInstance=null;this.widgetId=a.id;this.isEmpty=a.isEmpty;this.hardwareFieldId=a.hardwareFieldId;this.softwareFieldId=a.softwareFieldId;this.externalId=a.externalId;this.email=a.email;this.contentRoot=this.containingElement().down("div.paglo-content");this.startup()},startup:function(){if(!($("ticket_fields_"+this.hardwareFieldId)&&$("ticket_fields_"+this.softwareFieldId))){this.contentRoot.update("Not a ticket, or missing custom fields.");return}this.contentRoot.update(PagloHelper.getSearchForm(this.widgetId,""));var c=$("ticket_fields_"+this.hardwareFieldId).value;if(c){this.getAsset(c)}else{c=(c?c:this.externalId);if(!c&&this.email){var d=/(\S*)@\S*/;var a=d.exec(this.email);if(a.length>1){c=a[1]}}if(c){this.doSearch(c)}}this.contentRoot.down("form").token.value=c},doSearch:function(c){var d=PagloHelper.getQuery(c);var e=PagloHelper.getDoc(this.apiKey,d);var a=PagloHelper.getURL(e);this.contentRoot.down("div.asset").update("Searching...");this.contentRoot.down("div.software").update("");new Ajax.Request(a,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(f){this.showResults(f.responseXML)}.bind(this),onFailure:function(){alert("Failed")}})},showResults:function(g){var e="";var d=XmlHelper.getRecords(g,"","tree");if(d.length>0){for(var h=0;h<d.length;h++){var a=new Array();var c=XmlHelper.getRecords(d[h],"","value");for(var f=0;f<c.length;f++){a[c[f].getAttribute("name")]=c[f].firstChild.nodeValue}if(a.name){e+=PagloHelper.renderItem(a.name,"selectAsset",this.widgetId)}}this.contentRoot.down("div.asset").update(PagloHelper.getList("Select hardware asset:",e));this.contentRoot.down("div.software").update("")}else{this.contentRoot.down("div.asset").update("Nothing found")}},selectAsset:function(a){if(a!=""){$("ticket_fields_"+this.hardwareFieldId).value=a;$("ticket_fields_"+this.softwareFieldId).value="";this.getAsset(a);this.getSoftware(a)}},getSoftware:function(c){var d=PagloHelper.getSoftwareQuery(c);var e=PagloHelper.getDoc(this.apiKey,d);var a=PagloHelper.getURL(e);new Ajax.Request(a,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(f){this.showSoftware(f.responseXML)}.bind(this),onFailure:function(){alert("Failed")}})},showSoftware:function(f){var d="";var j;var c=XmlHelper.getRecords(f,"","tree");if(c.length>0){this.contentRoot.down("div.software").update(PagloHelper.getSoftwareSelection(this.widgetId));j=this.contentRoot.down("select.software");j.appendChild(new Element("option"));for(var g=0;g<c.length;g++){var a=XmlHelper.getRecords(c[g],"","value");for(var e=0;e<a.length;e++){if(a[e].getAttribute("name")=="Name"){var h=new Element("option");h.value=a[e].firstChild.nodeValue;h.innerHTML=h.value;j.appendChild(h)}}}}else{this.contentRoot.down("div.software").update("")}},selectSoftware:function(a){$("ticket_fields_"+this.softwareFieldId).value=a},getAsset:function(c){var d=PagloHelper.getAssetQuery(c);var e=PagloHelper.getDoc(this.apiKey,d);var a=PagloHelper.getURL(e);this.contentRoot.down("div.asset").update("Retrieving info...");new Ajax.Request(a,{method:"post",requestHeaders:{Accept:"application/xml"},onSuccess:function(f){this.contentRoot.down("div.asset").update(PagloHelper.renderAssetInfo(f.responseXML))}.bind(this),onFailure:function(){alert("Failed")}})}});var ContactologyHelper={GET_ACTIVE_LISTS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:GetActiveLists>      <sortDir xsi:type="xsd:string">U</sortDir>      <sortID xsi:type="xsd:string">Name</sortID>      <startRecord xsi:type="xsd:int">0</startRecord>      <pageSize xsi:type="xsd:int">0</pageSize>    </tns:GetActiveLists>  </soap:Body></soap:Envelope>'),GET_CONTACT_SUBSCRIPTIONS:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">    <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">      <tns:GetContactSubscriptions>        <email xsi:type="xsd:string">#{email}</email>      </tns:GetContactSubscriptions>    </soap:Body></soap:Envelope>'),SUBSCRIBE_TO_LIST:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:SubscribeToList>      <email xsi:type="xsd:string">#{email}</email>      <listId xsi:type="xsd:int">#{id}</listId>    </tns:SubscribeToList>  </soap:Body></soap:Envelope>'),UNSUBSCRIBE_FROM_LIST:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:UnsubscribeFromList>      <email xsi:type="xsd:string">#{email}</email>      <listId xsi:type="xsd:int">#{id}</listId>    </tns:UnsubscribeFromList>  </soap:Body></soap:Envelope>'),GET_CONTACT:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:GetContactByEmail>      <emailAddress xsi:type="xsd:string">#{email}</emailAddress>    </tns:GetContactByEmail>  </soap:Body></soap:Envelope>'),REACTIVATE:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://soapserver.emailcampaigns.net/1.1/" xmlns:types="http://soapserver.emailcampaigns.net/1.1/encodedTypes" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">    <tns:UpdateContact>      <addressId xsi:type="xsd:int">#{id}</addressId>      <emailAddress xsi:type="xsd:string" />      <status xsi:type="xsd:int">0</status>    </tns:UpdateContact>  </soap:Body></soap:Envelope>'),PROXY_URL:new Template("/proxy/direct?log=1&url=http://soapserver.emailcampaigns.net/1.1/index.php"),SOAP_ACTION:new Template("http://soapserver.emailcampaigns.net/1.1/index.php/#{action}"),getActiveListsRequest:function(){return ContactologyHelper.GET_ACTIVE_LISTS.evaluate({})},getContactSubscriptionsRequest:function(a){return ContactologyHelper.GET_CONTACT_SUBSCRIPTIONS.evaluate({email:a})},getSubscribeToListRequest:function(a,c){return ContactologyHelper.SUBSCRIBE_TO_LIST.evaluate({email:a,id:c})},getGetContactRequest:function(a){return ContactologyHelper.GET_CONTACT.evaluate({email:a})},getReactivateRequest:function(a){return ContactologyHelper.REACTIVATE.evaluate({id:a})},getUnsubscribeFromListRequest:function(a,c){return ContactologyHelper.UNSUBSCRIBE_FROM_LIST.evaluate({email:a,id:c})},getProxyURL:function(){return this.PROXY_URL.evaluate()},getSOAPAction:function(a){return this.SOAP_ACTION.evaluate({action:a})},STATUS_SECTION:new Template('<b>Status:</b><div class="contact_status">#{status}</div><br />'),LIST_SECTION:new Template("<b>#{header}</b><br />#{items}<br />"),LIST_ELEMENT:new Template('<input type="checkbox" style="vertical-align: top;" value="#{id}" #{checked} #{disabled} onClick="ObjectFactory.get(#{widgetId}).changeSubscription(this);"> #{name} <span class="sub">#{status}</span><br />'),REACTIVATE_LINK:new Template('<a href="javascript:ObjectFactory.get(#{widgetId}).reactivate();">Click to reactivate</a><br/><br/>'),renderView:function(h,a,f){var c="";var g=true;var d=XmlHelper.getRecords(h,"","item");if(a){e="NEW"}else{var e=ContactologyHelper.getStatus(h);g=(e=="GLOBALY_UNSUBSCRIBED"||e=="GLOBALLY_UNSUBSCRIBED"||e=="BOUNCED"||e=="DELETED")?false:true}c+=ContactologyHelper.renderStatus(e,a);if(e=="BOUNCED"){c+=ContactologyHelper.REACTIVATE_LINK.evaluate({widgetId:f})}c+=ContactologyHelper.renderListsByType(d,"INTERNAL","Internal",a,f,g);c+=ContactologyHelper.renderListsByType(d,"PUBLIC","Public",a,f,g);c+=ContactologyHelper.renderListsByType(d,"PRIVATE","Private",a,f,g);return c},renderListsByType:function(g,m,o,l,j,k){var d="";for(var h=0;h<g.length;h++){if(XmlHelper.getTextContentByKey(g[h],l?"type_label":"type").toUpperCase()==m){var a=XmlHelper.getTextContentByKey(g[h],l?"list_name":"name");var c=XmlHelper.getTextContentByKey(g[h],l?"list_id":"id");var f=l?"NONE":XmlHelper.getTextContentByKey(g[h],"subscription_status");var n="";var e="";if(f=="SUBSCRIBED"||f=="AWAITING_CONFIRMATION"){n="checked"}if(f=="AWAITING_CONFIRMATION"){e="pending"}d+=ContactologyHelper.LIST_ELEMENT.evaluate({name:a,id:c,checked:n,widgetId:j,status:e,disabled:(k?"":"DISABLED")})}}if(d>""){return ContactologyHelper.LIST_SECTION.evaluate({header:o,items:d})}else{return""}},renderStatus:function(c,a){if(a){return ContactologyHelper.STATUS_SECTION.evaluate({status:"NEW"})}return ContactologyHelper.STATUS_SECTION.evaluate({status:c})},getStatus:function(d){var c=d.getElementsByTagName("return")[0];var a=XmlHelper.getTextContentByKey(c,"contact_status");return a},errorFree:function(a){var c=a.getElementsByTagName("faultstring");return(c.length>0?false:true)}};var ContactologyWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.widgetId=a.id;this.username=a.username;this.password=a.password;this.email=a.email;this.formInstance=null;this.contentRoot=this.containingElement().down("div.contactology-content"+this.widgetId);this.lastChange=null;this.contactId=null;this.startup()},startup:function(){if(this.email==null){this.contentRoot.update("No requester found")}else{this.getSubscriptions()}},getSubscriptions:function(d){var c="body="+ContactologyHelper.getContactSubscriptionsRequest(this.email);var a=ContactologyHelper.getProxyURL();new Ajax.Request(a,{method:"post",encoding:"",postBody:c,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactSubscriptions"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(e){if(XmlHelper.getRecords(e.responseXML,"SOAP-ENV","Fault").length>0){this.getActiveLists()}else{if(d==this.lastChange){this.contentRoot.update(ContactologyHelper.renderView(e.responseXML,false,this.widgetId))}}}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},getActiveLists:function(){var c="body="+ContactologyHelper.getActiveListsRequest();var a=ContactologyHelper.getProxyURL();new Ajax.Request(a,{method:"post",encoding:"",postBody:c,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetActiveLists"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(d){this.contentRoot.update(ContactologyHelper.renderView(d.responseXML,true,this.widgetId))}.bind(this),onFailure:function(){alert("Failed to lookup.")}.bind(this)})},changeSubscription:function(d){var f="";var e="";var c=d.checked;d.disabled=true;this.lastChange=d.value;if(c){f="body="+ContactologyHelper.SUBSCRIBE_TO_LIST.evaluate({email:this.email,id:d.value});e="SubscribeToList"}else{f="body="+ContactologyHelper.UNSUBSCRIBE_FROM_LIST.evaluate({email:this.email,id:d.value});e="UnsubscribeFromList"}var a=ContactologyHelper.getProxyURL();this.showStatus("UPDATING...");new Ajax.Request(a,{method:"post",encoding:"",postBody:f,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction(e),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(g){if(ContactologyHelper.errorFree(g.responseXML)){if(XmlHelper.getTextContentByKey(g.responseXML,"return")!=1){}if(this.lastChange==d.value){this.getSubscriptions(d.value)}}else{this.changeFailed(d,c);return}}.bind(this),onFailure:function(){alert("Failure!");this.changeFailed(d,c)}.bind(this)})},reactivate:function(){var a="body="+ContactologyHelper.getGetContactRequest(this.email);this.showStatus("UPDATING...");new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:a,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactByEmail"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(f){var c=f.responseXML.getElementsByTagName("return")[0];var e=XmlHelper.getTextContentByKey(c,"ID");var d="body="+ContactologyHelper.getReactivateRequest(e);new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:d,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("UpdateContact"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(g){this.lastChange=null;this.getSubscriptions(null)}.bind(this),onFailure:function(){this.refreshStatus();alert("Failed to reactivate")}.bind(this)})}.bind(this),onFailure:function(){this.showStatus("UNKNOWN");alert("Failed to reactivate")}.bind(this)})},showStatus:function(a){this.containingElement().down("div.contact_status").update(a)},refreshStatus:function(){var a="body="+ContactologyHelper.getGetContactRequest(this.email);new Ajax.Request(ContactologyHelper.getProxyURL(),{method:"post",encoding:"",postBody:a,requestHeaders:{SOAPAction:ContactologyHelper.getSOAPAction("GetContactByEmail"),Authorization:"Basic "+Base64.encode(this.username+":"+this.password)},onSuccess:function(e){var d=e.responseXML.getElementsByTagName("return")[0];var c=XmlHelper.getTextContentByKey(d,"StatusLabel");this.showStatus(c.toUpperCase())}.bind(this),onFailure:function(){this.showStatus("ERROR")}.bind(this)})},changeFailed:function(c,a){alert("Failed to change subscription.");c.checked=!a;c.disabled=false;this.refreshStatus()}});var ScreenStepsLiveWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.widgetId=a.id;this.anchor=a.anchor;this.domainname=a.domainname;this.username=a.username;this.password=a.password;this.use_ssl=a.use_ssl;this.space_id=a.space_id;this.ticket_id=a.ticket_id;this.include_login_in_url=a.include_login_in_url;this.screenstepslive_resource=new Zendesk.Resource({anchor:this.anchor,domain:this.domainname||"",user:this.username||"",pass:this.password||"",use_ssl:this.use_ssl||"false",space_id:this.space_id||null,include_login_in_url:this.include_login_in_url||false,enable_resource_cache:"false",show_logout:false,login_content:this.application.bind(this),application_content:this.application.bind(this),application_resources:[{resource:"spaces",media_type:"application/xml",on_success:this.spaces_selector.bind(this)}]})},application:function(){text='<form id="lookup-form" onsubmit="disable_submit($(\'lookup-form\')); ObjectFactory.get('+this.id+').lookup(); return false;">';if(this.space_id==""||this.space_id==null){text+='<label style="width:50px;display:block;">Space: </label><select style="margin-bottom:5px;width:175px;" name="request[space_id]" id="screenstepslive-form-spaces"></select><br />'}else{text+='<input type="hidden" name="request[space_id]" id="screenstepslive-form-spaces" value="'+this.space_id+'">'}text+='<label style="width:50px;display:block;">Search: </label><input type="text" style="margin:5px 5px 5px 0;width:175px;" name="request[text]" id="sslive_search_text"/><br /><input type="submit" value="Submit" id="submit">';text+='</form><div id="screensteps_live_results"></div>';return text},lookup:function(){text=$F("sslive_search_text");space_id=$F("screenstepslive-form-spaces");space_selected_index=$("screenstepslive-form-spaces").selectedIndex;resource="spaces/"+$F("screenstepslive-form-spaces")+"/searches.xml?text="+escape(text);this.screenstepslive_resource.request({resource:resource,on_success:this.search_results.bind(this)});enable_submit($("lookup-form"));if(this.space_id==null){$("screenstepslive-form-spaces").selectedIndex=space_selected_index}$("sslive_search_text").value=text},format_lesson_url:function(a){if(this.include_login_in_url==true){a+="?login="+this.screenstepslive_resource.options.user+"&password="+this.screenstepslive_resource.options.pass;return a}else{return a}},register_events:function(){var a=$$(".sslive_lesson ul.drop-list").each(function(c){document.observe("click",function(d){if(!d.findElement().descendantOf(c)){c.select(".title").each(function(e){e.style.zIndex="0"});c.select(".action-menu").each(function(e){e.style.display="none";e.style.zIndex="0"})}});c.observe("click",function(d){title_container=c.select(".title-container")[0];title=c.select(".title")[0];menu=c.select(".action-menu")[0];title.style.zIndex="26";menu.style.display="block";menu.style.zIndex="25"})})},render_lesson_results:function(a){result="<h5>"+a.length+" matching lessons found. Click on a lesson to view it</h5>";result+="<ul>";result+=a.collect(function(c){return"<li><b>"+c.asset.title+':</b><br /><div class="sslive_lesson"><ul class="drop-list" style="position: relative"><li><div class="title-container"><span class="drop link title" id="" style="cursor:default; z-index:20">'+c.title+'</span></div><ul class="rounded-4 action-menu" style="width: 100%; margin-left:-160px;"><li class="ticket_link link" onclick="$$(\'#comment_value\')[0].value += \''+this.format_lesson_url(c.url)+'\'; this.up().style.display=\'none\'; Event.stop(event);">Copy link to ticket</li><li id="" class="window_link link" onclick="window.open(\''+this.format_lesson_url(c.url)+"', 'new');  this.up().style.display='none'; Event.stop(event);\">Open in new window</li></ul></li></ul></div>"}.bind(this)).join("</li>");result+="</ul>";return result},search_results:function(a){result_field=$("screensteps_live_results");result_field.innerHTML="";lessons=$A(a.lessons);if(lessons.length>0){result=this.render_lesson_results(lessons)}else{result="No results"}result_field.innerHTML=result;this.register_events()},spaces_selector:function(a){if(this.space_id==""||this.space_id==null){var c=$("screenstepslive-form-spaces");c.innerHTML="";spaces=$A(a.spaces);spaces.each(function(e){var d=document.createElement("option");d.value=e.id;d.innerHTML=e.title;c.appendChild(d)})}}});var ScreenStepsLiveTasksWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.widgetId=a.id;this.anchor=a.anchor;this.domainname=a.domainname;this.username=a.username;this.password=a.password;this.use_ssl=a.use_ssl;this.space_id=a.space_id;this.ticket_id=a.ticket_id;this.screenstepslive_tasks_resource=new Zendesk.Resource({anchor:this.anchor,domain:this.domainname||"",user:this.username||"",pass:this.password||"",use_ssl:this.use_ssl||"false",space_id:this.space_id||null,enable_resource_cache:"false",show_logout:false,login_content:this.application.bind(this),application_content:this.application.bind(this),application_resources:[{resource:"spaces/api",media_type:"application/xml",on_success:this.spaces_selector.bind(this)}]})},application:function(){text='<form id="screensteps-live-task-form" onsubmit="if (ObjectFactory.get('+this.id+").validate_sslive_form() == true) {alert('Please enter a valid value for title'); return false;}; ObjectFactory.get("+this.id+").setup_task_form(); ObjectFactory.get("+this.id+').screenstepslive_tasks_resource.submit_data(this); return false;" class="form">';if(this.space_id==""||this.space_id==null){text+='<label style="width:50px;display:block;">Space: </label><select style="margin-bottom:5px;width:175px;" name="task[space_id]" id="screenstepslive-task-form-spaces"></select><br />'}else{text+='<input type="hidden" name="task[space_id]" id="screenstepslive-task-form-spaces" value="'+this.space_id+'">'}text+='<label>Title</label><input type="text" id="task_title" style="width:175px;" name="task[title]"/><label>Description</label><textarea rows="3" id="task_description" style="width:175px;" name="task[description]"></textarea><input type="hidden" name="pluck_param" value="task"><input type="hidden" id="task_resource" name="resource" value=""><input type="hidden" name="media_type" value="application/xml"><input type="hidden" name="event_reference" value="ScreenSteps Live Task Created"><input type="hidden" name="event_log" value="Title,Description,ID"><input type="submit" value="Submit" id="submit"></form>';return text},validate_sslive_form:function(){var a=document.getElementById("task_title").value;if(a==""||a==null){return true}else{return false}},setup_task_form:function(){if(this.ticket_id!=null){$("task_description").value+=("\n\n"+location.href)}$("task_resource").value="spaces/"+$F("screenstepslive-task-form-spaces")+"/tasks";return false},spaces_selector:function(a){if(this.space_id==""||this.space_id==null){var c=$("screenstepslive-task-form-spaces");c.innerHTML="";spaces=$A(a.spaces);spaces.each(function(e){var d=document.createElement("option");d.value=e.id;d.innerHTML=e.title;c.appendChild(d)})}}});var WidgetManagerWidget=Class.create({initialize:function(){widgetManager=this;Widget.redraw()},widgets:function(){return $j("#sidebar div.widget").not("#preview-output .widget").map(function(a,c){var d=(""+$j(c).prop("id")).replace(/^widget_/,"");return ObjectFactory.get(d)}).toArray()},show:function(){$j("#add_widget_select_widget").show();$j("#add_widget_button").hide();this.widgets().each(function(a){a.showControls();a.containingElement().title=I18n.t("txt.admin.public.javascripts.widgets.you_can_drag_and_drop_widgets")});$j("#widget_fixed").addClass("widget_edit_mode");$j("#sidebar").sortable({items:"div.draggable"}).bind("sortupdate",this.updateOrder);Widget.redraw()},hide:function(){$j("#add_widget_button").show();$j("#add_widget_select_widget").hide();this.widgets().each(function(a){a.hideControls();a.containingElement().title=""});$j("#widget_fixed").removeClass("widget_edit_mode");$j("#sidebar").sortable("destroy");Widget.redraw()},updateOrder:function(d,e){var c=_($j(d.target).sortable("toArray")).map(function(f){f=(""+f).replace(/^widget_/,"");return f==="fixed"?"fixed":ObjectFactory.get(f).locationId});if(c.length>0){var a="/widgets/reorder_locations";$j.ajax(a,{type:"POST",data:{locations:c,_method:"put"}})}},addWidgetToPage:function(d,a,c){new Ajax.Request("/widgets/"+c+"/add_to_page",{method:"post",parameters:{controller_name:d,action_name:a}})},removeWidgetFromPage:function(d,a,c){new Ajax.Request("/widgets/"+c+"/remove_from_page",{method:"delete",parameters:{controller_name:d,action_name:a,authenticity_token:Zendesk.currentUser.authenticityToken}})},removeWidget:function(a){var c=ObjectFactory.get(a);c.hide(c.destroy.bind(c));ObjectFactory.remove(a);$("add_widget_"+a).show()},displayNewWidget:function(){$("widget_manager_widget").insert({before:"hello"})}});var widgetManager=null;var BatchBookHelper=Class.create();BatchBookHelper.getNodeValue=function(a,d){var c=a.getElementsByTagName(d);if(c==null||c.length==0||c[0].childNodes.length==0){return null}return c[0].childNodes[0].nodeValue};BatchBookHelper.getNodeString=function(a,d){var c=this.getNodeValue(a,d);if(c==null){return""}else{return c}};BatchBookHelper.getArrayByTagName=function(d,a){var c=a.getElementsByTagName(d);if(c==null){return new Array()}return c};BatchBookHelper.getRecords=BatchBookHelper.getArrayByTagName.curry("person");BatchBookHelper.getLocations=BatchBookHelper.getArrayByTagName.curry("location");var BatchBookQuery=Class.create();BatchBookQuery.SERVER_URL=new Template("https://#{account_name}.batchbook.com/service/people.xml?email=#{email}");BatchBookQuery.PROXY_URL=new Template("/proxy/direct.xml?&url=#{server_url}");BatchBookQuery.CONTACT_URL=new Template("https://#{account_name}.batchbook.com/contacts/show/#{record_id}");BatchBookQuery.buildUrl=function(d,c){var a=this.SERVER_URL.evaluate({account_name:d,email:c});var e=this.PROXY_URL.evaluate({server_url:escape(a)});return e};var BatchBookWidgetView=Class.create();BatchBookWidgetView.HEADLINE_TEMPLATE=new Template('<h4 style="font-size: 16px"><a href="#{contact_url}" target="_blank">#{first_name} #{last_name}</a></h4>');BatchBookWidgetView.LOCATION_TEMPLATE=new Template("<h5>#{label}</h5>#{items}");BatchBookWidgetView.LOCATION_ADDRESS_TEMPLATE=new Template('<span class="sub">#{item_label}</span><br />#{item_value}<br />');BatchBookWidgetView.LOCATION_ITEM_TEMPLATE=new Template('#{item_value} <span class="sub">#{item_label}</span><br />');BatchBookWidgetView.ADDRESS_TEMPLATE=new Template('#{street_1}</h5><p class="minimal">#{items}</p>');BatchBookWidgetView.renderLine=function(a,f,e){var c="";for(var d=0;d<f.length;d++){c+=BatchBookHelper.getNodeString(a,f[d]);if(c!=""){c+=" "}}if(c!=""){return e.evaluate({output:c})}else{return""}};BatchBookWidgetView.renderAddress=function(d){var j=BatchBookHelper.getNodeString(d,"street_1");var g=BatchBookHelper.getNodeString(d,"street_2");var h=BatchBookHelper.getNodeString(d,"city");var f=BatchBookHelper.getNodeString(d,"state");var e=BatchBookHelper.getNodeString(d,"postal_code");var k=BatchBookHelper.getNodeString(d,"country");var c="";if(j!=""){c+=j+"<br />"}if(g!=""){c+=g+"<br />"}if(h!=""){c+=h;if(f!=""||e!=""){c+=", "}}if(f!=""||e!=""){c+=f;if(e!=""){c+=" "}}if(h!=""||f!=""||e!=""){c+=e+"<br />"}if(k!=""){c+=k}return c};BatchBookWidgetView.renderRecord=function(h,q){var t="";var o=BatchBookHelper.getNodeString(h,"id");var m=BatchBookHelper.getNodeString(h,"first_name");var s=BatchBookHelper.getNodeString(h,"last_name");var r=BatchBookWidgetView.contact_url(o,q);t+=BatchBookWidgetView.HEADLINE_TEMPLATE.evaluate({contact_url:r,first_name:m,last_name:s});t+=this.renderLine(h,["title"],new Template("<p class='minimum'>#{output}</p>"));t+=this.renderLine(h,["company"],new Template("<p class='minimum'>#{output}</p>"));var n=BatchBookHelper.getLocations(h);var k={address:"",email:"",website:"",phone:"",cell:"",fax:""};var a=["address","email","website","phone","cell","fax"];for(var g=0;g<n.length;g++){var d=n[g];var f=$j(d).find("label").text();for(var e=0;e<a.length;e++){var p=a[e];var c="";if(p=="address"){c=this.renderAddress(d)}else{c=BatchBookHelper.getNodeString(d,p)}if(c!=""){if(p=="address"){if(k[p]){k[p]+="<br />"}k[p]+=BatchBookWidgetView.LOCATION_ADDRESS_TEMPLATE.evaluate({item_label:f,item_value:c})}else{k[p]+=BatchBookWidgetView.LOCATION_ITEM_TEMPLATE.evaluate({item_label:f,item_value:c})}}}}for(var e=0;e<a.length;e++){var p=a[e];if(k[p]!=""){t+=BatchBookWidgetView.LOCATION_TEMPLATE.evaluate({label:p,items:k[p]})}}return t+"<br />"};BatchBookWidgetView.contact_url=function(c,a){return BatchBookQuery.CONTACT_URL.evaluate({record_id:c,account_name:a})};var BatchBookWidget=Class.create(Widget,{lookup:function(c){$j("#batchbooks-widget-spinner").show();if(this.accountName!=null&&this.token!=null){var a=BatchBookQuery.buildUrl(this.accountName,c.email.value);new Ajax.Request(a,{method:"get",requestHeaders:{Authorization:"Basic "+Base64.encode(this.token+":x")},onSuccess:function(d){this.displayResult(d.responseXML);$j("#batchbooks-widget-spinner").hide()}.bind(this),onFailure:function(){$(this.contentRoot).update("<h5>Unable to search your BatchBook account at this time.  Please try again later.</h5>")}.bind(this)})}else{$(this.contentRoot).update("<h5>BatchBook login failed - BatchBook account needs configuration.</h5>")}},displayResult:function(d){var c=BatchBookHelper.getRecords(d);if(c.length==0){$(this.contentRoot).update("<h5>No match found in your BatchBook account.</h5>");return}else{var a=BatchBookWidgetView.renderRecord(c[0],this.accountName);$(this.contentRoot).update(a)}},initialize:function($super,a){$super(a);this.token=a.token;this.formInstance=null;this.widgetId=a.id;this.isEmpty=a.isEmpty;this.accountName=a.accountName;this.requesterEmail=a.requester_email;this.contentRoot=this.containingElement().down("div.batchbook-content-"+this.widgetId)}});var CustomCalendarDateSelect=Class.create(CalendarDateSelect,{updateValue:function($super){$super();var f=this.selected_date;var a=f.getDate()<10?("0"+f.getDate()):f.getDate();var c=(f.getMonth()+1)<10?("0"+parseInt(f.getMonth()+1)):parseInt(f.getMonth()+1);var e=c+"/"+a+"/"+f.getFullYear();this.target_element.value=e},parseDate:function($super){var a=$F(this.target_element).strip();$super();if(this.selection_made){this.selected_date.setFullYear(a.split("/")[2],parseInt(a.split("/")[0])-1,parseInt(a.split("/")[1]));this.date=this.selected_date}}});var clarizenWidgetUnicodeConverter={convertChar2CP:function(d){var c=0;var g=0;var f="";for(var e=0;e<d.length;e++){var a=d.charCodeAt(e);if(a<0||a>65535){f+="Error "+this.dec2hex(a)+"!"}if(c!==0){if(56320<=a&&a<=57343){f+=this.dec2hex(65536+((c-55296)<<10)+(a-56320))+" ";c=0;continue}else{f+="!erreur "+this.dec2hex(c)+"!";c=0}}if(55296<=a&&a<=56319){c=a}else{f+=this.dec2hex(a)+" "}}f=f.substring(0,f.length-1);return this.convertCP2HexNCR(f)},convertCP2HexNCR:function(a){var e="";a=a.replace(/^\s+/,"");if(a.length===0){return""}a=a.replace(/\s+/g," ");var d=a.split(" ");for(var c=0;c<d.length;c++){var f=parseInt(d[c],16);e+="&#x"+this.dec2hex(f)+";"}return(e)},dec2hex:function(a){return(a+0).toString(16).toUpperCase()}};var clarizenWidgetHelper={PARTNER_ID:"baa861be-8460-4de8-b678-56f915b6be43",SERVICE_URL:"https://api.clarizen.com/v1.0/Clarizen.svc",LOGIN_URL:"http://clarizen.com/api/IClarizen/Login",QUERY_URL:"http://clarizen.com/api/IClarizen/Query",EXECUTE_URL:"http://clarizen.com/api/IClarizen/Execute",WIDGET_ID:"clarizenWidget",IMAGE_PATH:"/images/widgets/clarizen/",PRIORITY_MAPPING:{1:"Low",2:"Medium",3:"High",4:"Critical"},GET_CLARIZEN_USER_PROFILE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">  <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>User</q1:TypeName>     <q1:Where xsi:type="q1:And">       <q1:Conditions>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>Email</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{email}</q1:Value>            </q1:RightExpression>          </Condition>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>FirstName</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{firstName}</q1:Value>            </q1:RightExpression>          </Condition>          <Condition xsi:type="q1:Compare">            <q1:LeftExpression xsi:type="q1:FieldExpression">               <q1:FieldName>LastName</q1:FieldName>            </q1:LeftExpression>            <q1:Operator>Equal</q1:Operator>            <q1:RightExpression xsi:type="q1:ConstantExpression">               <q1:Value xsi:type="xsd:string">#{lastName}</q1:Value>            </q1:RightExpression>          </Condition>       </q1:Conditions>     </q1:Where>  </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_SYSTEM_SETTINGS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>  <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>            <BaseMessage xmlns:q1="http://clarizen.com/api/metadata" xsi:type="q1:GetSystemSettingsValuesMessage">              <q1:Settings>                  <string>Enable issue management</string>                  <string>Enable bug tracking</string>                  <string>Enable requests for enhancements</string>                  <string>Enable risk management</string>              </q1:Settings>            </BaseMessage>         </request>      </Execute>  </soap:Body></soap:Envelope>'),UNLINK_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="UpdateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>Issue</TypeName>                     <Value>#{IssueId}</Value>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>ZdExternalId</FieldName>                        <Value xsi:type="xsd:string"></Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_EXTERNAL_ID_BY_TICKET_ID:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <Session xmlns="http://clarizen.com/api">      <ID>#{sessionId}</ID>    </Session>  </soap:Header>  <soap:Body><Execute xmlns="http://clarizen.com/api"> <request>   <BaseMessage xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>Issue</q1:TypeName>     <q1:Where xsi:type="q1:Compare">       <q1:LeftExpression xsi:type="q1:FieldExpression">          <q1:FieldName>ZdExternalId</q1:FieldName>       </q1:LeftExpression>       <q1:Operator>Equal</q1:Operator>       <q1:RightExpression xsi:type="q1:ConstantExpression">          <q1:Value xsi:type="xsd:string">#{ticketId}</q1:Value>       </q1:RightExpression>     </q1:Where>   </BaseMessage>   <BaseMessage xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields />     <q1:Orders xsi:nil="true" />     <q1:TypeName>Bug</q1:TypeName>     <q1:Where xsi:type="q1:Compare">       <q1:LeftExpression xsi:type="q1:FieldExpression">          <q1:FieldName>ZdExternalId</q1:FieldName>       </q1:LeftExpression>       <q1:Operator>Equal</q1:Operator>       <q1:RightExpression xsi:type="q1:ConstantExpression">          <q1:Value xsi:type="xsd:string">#{ticketId}</q1:Value>       </q1:RightExpression>     </q1:Where>   </BaseMessage> </request></Execute>  </soap:Body></soap:Envelope>'),UPDATE_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>     <Execute xmlns="http://clarizen.com/api">          <request>              <BaseMessage xsi:type="LifecycleMessage">                  <Ids>                      <EntityId>                          <TypeName>#{entity}</TypeName>                          <Value>#{issueId}</Value>                      </EntityId>                  </Ids>                  <Operation>#{operation}</Operation>              </BaseMessage>              <BaseMessage xsi:type="CreateMessage">                  <Entity xsi:type="GenericEntity">                      <Id>                          <TypeName>IssueTeamMembers</TypeName>                          <Value xsi:nil="true" />                      </Id>                      <Values>                          <FieldValue>                              <FieldName>Case</FieldName>                              <Value xsi:type="EntityId">                                  <TypeName>#{entity}</TypeName>                                  <Value>#{issueId}</Value>                              </Value>                          </FieldValue>                          <FieldValue>                              <FieldName>TeamMember</FieldName>                              <Value xsi:type="EntityId">                                  <TypeName>User</TypeName>                                  <Value>#{creatorId}</Value>                              </Value>                          </FieldValue>                      </Values>                  </Entity>                </BaseMessage>          </request>      </Execute>   </soap:Body></soap:Envelope>'),DUE_DATE:new Template('<FieldValue>  <FieldName>DueDate</FieldName>  <Value xsi:type="xsd:dateTime">#{dueDate}</Value></FieldValue>'),PROJECT_ID:new Template('<FieldValue>  <FieldName>PlannedFor</FieldName>  <Value xsi:type="EntityId">    <TypeName>Project</TypeName>    <Value>#{projectId}</Value>  </Value></FieldValue>'),SUBMIT_ISSUE:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="CreateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>#{entity}</TypeName>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>Title</FieldName>                        <Value xsi:type="xsd:string">#{title}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Description</FieldName>                        <Value xsi:type="xsd:string">#{description}</Value>                     </FieldValue>                     #{dueDateTemplate}                     <FieldValue>                        <FieldName>Severity</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>Severity</TypeName>                           <Value>#{severity}</Value>                        </Value>                     </FieldValue>                     <FieldValue>                        <FieldName>AssignedTo</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>User</TypeName>                           <Value>#{userId}</Value>                        </Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Owner</FieldName>                        <Value xsi:type="EntityId">                           <TypeName>User</TypeName>                           <Value>#{ownerId}</Value>                        </Value>                     </FieldValue>                     #{projectTemplate}                     <FieldValue>                        <FieldName>ZdExternalId</FieldName>                        <Value xsi:type="xsd:string">#{ticketId}</Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_PROJECTS:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>    <Session xmlns="http://clarizen.com/api">      <ID>#{sessionId}</ID>    </Session>  </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">  <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">     <q1:Paging xsi:nil="true" />     <q1:Fields>       <string>Name</string>     </q1:Fields>     <q1:Orders xsi:nil="true" />     <q1:TypeName>Project</q1:TypeName>     <q1:Where xsi:nil="true" />  </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_ASSIGNEES:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>      <Session xmlns="http://clarizen.com/api">        <ID>#{sessionId}</ID>      </Session>  </soap:Header>  <soap:Body>  <Query xmlns="http://clarizen.com/api">      <queryExpression xmlns:q1="http://clarizen.com/api/queries" xsi:type="q1:EntityQuery">         <q1:Paging xsi:nil="true" />            <q1:Fields>                 <string>FirstName</string>                 <string>LastName</string>                 <string>Email</string>             </q1:Fields>             <q1:Orders>               <q1:OrderBy>                 <q1:FieldName>DisplayName</q1:FieldName>               </q1:OrderBy>             </q1:Orders>             <q1:TypeName>User</q1:TypeName>             <q1:Where xsi:type="q1:Compare">                      <q1:LeftExpression xsi:type="q1:FieldExpression">                          <q1:FieldName>State</q1:FieldName>                      </q1:LeftExpression>                      <q1:Operator>NotEqual</q1:Operator>                      <q1:RightExpression xsi:type="q1:ConstantExpression">                          <q1:Value xsi:type="EntityId">                              <TypeName>State</TypeName>                              <Value>Deleted</Value>                          </q1:Value>                      </q1:RightExpression>               </q1:Where>     </queryExpression>  </Query>  </soap:Body></soap:Envelope>'),GET_SESSION:new Template('<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Body>    <Login xmlns="http://clarizen.com/api">      <userName>#{username}</userName>      <password>#{password}</password>      <options xsi:type="ExtendedLoginOptions">         <ApplicationId>ClarizenClient</ApplicationId>         <PartnerId>#{partnerId}</PartnerId>         <ClientVersion>1.0</ClientVersion>      </options>    </Login>  </soap:Body></soap:Envelope>'),ISSUE_INLINE_UPDATES:new Template('<div style="padding-bottom:5px; width:85px; float:left;"><strong>Issue number:</strong></div><div style="float: left;">#{sysId}</div><div style="clear:both;"></div><div><strong>Title:</strong></div><div style="padding-bottom:5px;"><span title="#{fullticketTitle}">#{ticketTitle}</span></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>State:</strong></div><div style="float: left;">#{state}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Severity:</strong></div><div style="float: left;">#{severity}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Due Date:</strong></div><div style="float: left;">#{date}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Assigned To:</strong></div><div style="float: left;">#{assignedTo}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Owner:</strong></div><div style="float: left;">#{owner}</div><div style="clear:both;"></div>#{projectTemplate}'),PROJECT_ISSUE_TEMPLATE:new Template('<div><strong>To be Resolved In:</strong></div><span title="#{fullProjectName}">#{projectName}</span>'),SEND_MAIL_TEMPLATE:new Template("<a href=\"mailto:#{mailAsigneeEmail}?subject=%20[zendesk]%20Message%20regarding%20ticket%20'#{mailTitle}'%20(#{mailTicketId})&cc=#{mailOwnerEmail}\">Send email</a>"),DISPLAY_ISSUE_FORM:new Template('<div id="issue-details" style="padding:3px;width:100%;overflow:hidden;"><div style="padding-bottom:5px; width:85px; float:left;"><strong>Issue number:</strong></div><div><div style="float: left;">#{sysId}</div><div style="clear:both;"></div><div><strong>Title:</strong></div><div style="padding-bottom:5px;"><span title="#{fullticketTitle}">#{ticketTitle}</span></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>State:</strong></div><div style="float: left;">#{state}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Severity:</strong></div><div style="float: left;">#{severity}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Due Date:</strong></div><div><div style="float: left;">#{date}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Assigned To:</strong></div><div style="float: left;">#{assignedTo}</div><div style="clear:both;"></div><div style="padding-bottom:5px; width:85px; float:left;"><strong>Owner:</strong></div><div style="float: left;">#{owner}</div><div style="clear:both;"></div>#{projectTemplate}</div><div style="text-align:center;padding-top:5px;"><!--<a onclick="clarizenWidget.unLinkIssue(false);" href="javascript:void(0);">unlink</a> |--> <a onclick="ObjectFactory.get(#{widgetId}).getIssueFromClarizen(false);" href="#">Refresh</a> | #{mailTemplate}</div></div>'),SUBMIT_FORM:new Template('<div style="display:none;"><div id="clarizen-modal-popup" class="frame" style="width:400px;margin:-15px;padding:20px;border-width:10px;"><form class="form" id="clarizen-form" style="margin-bottom:30px;"><div style="float:left;padding-right:10px;">#{logoImage}</div><div style="font-size:16px;padding-top:10px;">Create issue in Clarizen</div><div style="clear:both;"></div><div class="select" style="padding-top:5px"><label style="display:inline;padding-right:70px;">Subject:</label><input type="text" value="" size="30" id="clarizenTitle" style="width:75%;" class="clarizenTitle"/></div><div class="select" style="padding-bottom:5px;padding-top:5px;"><label style="float:left;padding-right:50px;">Description:</label><textarea rows="4" id="clarizenDescription" class="clarizenDescription" style="width:75%;" ></textarea><div style="clear:both;"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">Clarizen priority:</label></div><div style="float:left;"><select id="clarizenSeveritySelector" class="clarizenSeveritySelector" style="width:215px;padding-left:10px;max-width:215px;">   <option value="Critical">Urgent</option>   <option value="High">High</option>   <option value="Low">Low</option>   <option selected="selected" value="Medium">Normal</option></select></div><div style="clear:both"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">To be resolved In:</label></div><div style="float:left;"><select id="clarizenProjectSelector" disabled class="clarizenProjectSelector" style="width:215px;padding-left:10px;max-width:215px;"></select></div><div style="clear:both"></div></div><div style="padding-bottom: 5px"><div style="width:120px; float: left;"><label style="margin-top: 0px;">Assigned To:</label></div><div style="float:left;"><select id="clarizenAssigneeSelecter" disabled class="clarizenAssigneeSelecter" style="width:215px;padding-left:10px;max-width:215px;"></select></div><div style="clear:both"></div></div><div style="width:120px; float: left;"><label style="margin-top: 0px;">Due Date:</label></div><div style="float:left;"><input type="text" value="" size="10" id="dueDate" class="dueDate" /><img alt="Calendar" class="calendar_date_select_popup_icon" onclick="new CustomCalendarDateSelect( $(this).previous(), {buttons:false, popup:\'force\', time:false, year_range:10} ); $$(\'.calendar_date_select\')[0].setStyle({\'zIndex\':\'10010\'}); " src="http://assets.zendesk.com/images/calendar_date_select/calendar.gif?1264325148" style="border:0px; cursor:pointer;" /></div><div style="float:right;"><input type="button" value="Submit" onclick="ObjectFactory.get(#{widgetId}).submitIssueForm($(\'clarizen-form\'));" class="buttonsubmit" /><input type="button" value="Cancel" onclick="ObjectFactory.get(#{widgetId}).closeForm();" class="buttonsubmit" /></div></form></div></div>'),SHOW_AVAILABILITY_LINK:new Template('<div id="availabilityLnk" style="text-align:center;padding-top:10px;padding-bottom:10px;">  <a target="_blank" href="#">Show Availability</a></div>'),TICKET_RESOLUTION:new Template('<div class="clarizen_message">You can create a request for resolution of the ticket in Clarizen<div style="text-align:center;padding-top:10px;padding-bottom:10px;">  <a onclick="ObjectFactory.get(#{widgetId}).showForm();" href="#">Request ticket resolution</a></div></div>'),PROXY_URL:new Template("/proxy/direct?url=#{url}&log=1"),CREATE_USER:new Template('<?xml version="1.0" encoding="utf-8"?>   <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">   <soap:Header>       <Session xmlns="http://clarizen.com/api">         <ID>#{sessionId}</ID>       </Session>   </soap:Header>   <soap:Body>      <Execute xmlns="http://clarizen.com/api">         <request>             <BaseMessage xsi:type="CreateMessage">               <Entity xsi:type="GenericEntity">                  <Id>                     <TypeName>User</TypeName>                  </Id>                  <Values>                     <FieldValue>                        <FieldName>FirstName</FieldName>                        <Value xsi:type="xsd:string">#{firstName}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>LastName</FieldName>                        <Value xsi:type="xsd:string">#{lastName}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>Email</FieldName>                        <Value xsi:type="xsd:string">#{email}</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>AllowEmails</FieldName>                        <Value i:type="b:boolean" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:b="http://www.w3.org/2001/XMLSchema">true</Value>                     </FieldValue>                     <FieldValue>                        <FieldName>SendInvitationMail</FieldName>                        <Value xsi:type="xsd:boolean">#{sendInvitationMail}</Value>                     </FieldValue>                  </Values>               </Entity>            </BaseMessage>         </request>     </Execute>  </soap:Body> </soap:Envelope>'),GET_ISSUE_QUERY:new Template('<?xml version="1.0" encoding="utf-8"?>  <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  <soap:Header>      <Session xmlns="http://clarizen.com/api">        <ID>#{sessionId}</ID>      </Session>  </soap:Header>  <soap:Body>   <Execute xmlns="http://clarizen.com/api">      <request>        <BaseMessage xsi:type="RetrieveMessage">          <Fields>            <string xmlns="http://clarizen.com/api">SYSID</string>            <string xmlns="http://clarizen.com/api">DueDate</string>            <string xmlns="http://clarizen.com/api">State</string>            <string xmlns="http://clarizen.com/api">Severity</string>            <string xmlns="http://clarizen.com/api">AssignedTo.DisplayName</string>            <string xmlns="http://clarizen.com/api">Owner.DisplayName</string>            <string xmlns="http://clarizen.com/api">PlannedFor.Name</string>            <string xmlns="http://clarizen.com/api">Title</string>            <string xmlns="http://clarizen.com/api">ZdExternalId</string>          </Fields>          <Id>               <TypeName>#{entity}</TypeName>               <Value>#{externalId}</Value>          </Id>        </BaseMessage>      </request>   </Execute>  </soap:Body></soap:Envelope>'),MISSING_TICKET:new Template("Only available when viewing tickets or users.<br />&nbsp;"),PROFILE_PAGE_TEXT:new Template("<!--#{logoImage}--><div>Click Show Assignment to see user usage in Clarizen.</div>"),PROFILE_NOT_EXISTS:new Template("<div>User #{name} is not yet registered in Clarizen.</div>"),getMissingTicketMessage:function(){return(this.MISSING_TICKET.evaluate({}))},getProfileNotExistsMessage:function(a){return(this.PROFILE_NOT_EXISTS.evaluate({name:a}))},getAvailabilityLnkForProfilePage:function(a){return(this.PROFILE_PAGE_TEXT.evaluate({logoImage:this.getLogoImage()}))+this.getAvailabilityLnk(a)},getAvailabilityLnk:function(a){return this.SHOW_AVAILABILITY_LINK.evaluate({widgetId:a})},getClarizenUserProfile:function(e,c,d,a){return escape(this.GET_CLARIZEN_USER_PROFILE.evaluate({sessionId:e,email:c,firstName:d,lastName:a}))},getExternalIdByTicketRequest:function(c,a){return escape(this.GET_EXTERNAL_ID_BY_TICKET_ID.evaluate({sessionId:c,ticketId:a}))},setIssueInlineUpdates:function(g,c,h,f,d,a,e,j){return this.ISSUE_INLINE_UPDATES.evaluate({severity:g,sysId:c,ticketTitle:j,fullticketTitle:j,state:(h==="Submitted2"?"Submitted":h),stateImage:this.getStateImage(h),date:this.getFormattedDate(f),assignedTo:d,owner:a,projectTemplate:e===" - "?null:this.PROJECT_ISSUE_TEMPLATE.evaluate({fullProjectName:e,projectName:e}),path:this.IMAGE_PATH})},getDisplayIssueForm:function(h,n,k,a,e,g,c,o,l,f,m,d,j){return this.DISPLAY_ISSUE_FORM.evaluate({widgetId:h,severity:n,sysId:k,ticketTitle:l,fullticketTitle:l,state:(a==="Submitted2"?"Submitted":a),stateImage:this.getStateImage(a),date:this.getFormattedDate(e),assignedTo:g,owner:c,projectTemplate:o===" - "?null:this.PROJECT_ISSUE_TEMPLATE.evaluate({fullProjectName:o,projectName:o}),path:this.IMAGE_PATH,mailTemplate:this.SEND_MAIL_TEMPLATE.evaluate({mailTitle:f,mailTicketId:m,mailAsigneeEmail:d,mailOwnerEmail:j})})},getSystemSettings:function(a){return escape(this.GET_SYSTEM_SETTINGS.evaluate({sessionId:a}))},getProjects:function(a){return escape(this.GET_PROJECTS.evaluate({sessionId:a}))},getCreateUserRequest:function(f,c,d,a,e){return escape(this.CREATE_USER.evaluate({sessionId:f,email:c,firstName:d,lastName:a,sendInvitationMail:e}))},getSubmitForm:function(a){return(this.SUBMIT_FORM.evaluate({widgetId:a,logoImage:this.getLogoImage()}))},getProxyUrl:function(a,c){return escape(this.PROXY_URL.evaluate({url:a,soapAction:c}))},getSubmitFormRequest:function(d,h,j,k,m,f,g,l,a,e){var c=e?"Bug":"Issue";return escape(this.SUBMIT_ISSUE.evaluate({sessionId:d,title:h,description:j,dueDateTemplate:k===null?null:this.DUE_DATE.evaluate({dueDate:k}),severity:m,userId:f,ownerId:l,projectTemplate:g===""||g===null?null:this.PROJECT_ID.evaluate({projectId:g}),ticketId:a,entity:c}))},getUpdateFormRequest:function(e,d,c,a,f){return escape(this.UPDATE_ISSUE.evaluate({sessionId:e,issueId:d,operation:this.getStateValue(c),creatorId:f,entity:a?"Bug":"Issue"}))},getLinkTicketResolution:function(a){return this.TICKET_RESOLUTION.evaluate({widgetId:a})},setUnLinkIssue:function(c,a){return escape(this.UNLINK_ISSUE.evaluate({sessionId:c,IssueId:a}))},getIssueFromClarizenQuery:function(d,a,c){return escape(this.GET_ISSUE_QUERY.evaluate({sessionId:d,externalId:a,entity:c?"Bug":"Issue"}))},getAssigneeRequest:function(a){return escape(this.GET_ASSIGNEES.evaluate({sessionId:a}))},getSessionRequest:function(d,a,c){return escape(this.GET_SESSION.evaluate({username:d,password:a,partnerId:c}))},getLogoImage:function(){return'<img title="Clarizen Logo" alt="Clarizen Logo" src="'+this.IMAGE_PATH+'logo.jpg"/>'},getLoadingImage:function(){return'<img title="Indicator" alt="Indicator" src="'+this.IMAGE_PATH+'indicator.gif"/>'},getStateValue:function(a){switch(a){case 1:return"Open";case 2:return"Reject";case 3:return"MarkResolved";default:return null}},getSeverityImage:function(a){switch(a){case"High":return'<img height="16" style="display:inline;" title="High" alt="High" src="'+this.IMAGE_PATH+'High.jpg"/>';case"Low":return'<img height="16" style="display:inline;" title="Low" alt="Low" src="'+this.IMAGE_PATH+'Low.jpg"/>';case"Critical":return'<img height="16" style="display:inline;" title="Critical" alt="Critical" src="'+this.IMAGE_PATH+'Critical.jpg"/>';default:return""}},getStateImage:function(a){switch(a){case"Submitted":case"Submitted2":return'<img height="16" style="display:inline;" title="Submitted" alt="Submitted" src="'+this.IMAGE_PATH+'Submitted.jpg"/>';case"Opened":return'<img height="16" style="display:inline;" title="Opened" alt="Opened" src="'+this.IMAGE_PATH+'Opened.jpg"/>';case"In Work":return'<img height="16" style="display:inline;" title="In Work" alt="In Work" src="'+this.IMAGE_PATH+'Inwork.jpg"/>';case"Resolved":return'<img height="16" style="display:inline;" title="Resolved" alt="Resolved" src="'+this.IMAGE_PATH+'Resolved.jpg"/>';case"Duplicated":return'<img height="16" style="display:inline;" title="Duplicated" alt="Duplicated" src="'+this.IMAGE_PATH+'Duplicated.jpg"/>';case"Not Reproducible":return'<img height="16" style="display:inline;" title="Not Reproducible" alt="Not Reproducible" src="'+this.IMAGE_PATH+'Notreproducible.jpg"/>';case"Rejected":return'<img height="16" style="display:inline;" title="Rejected" alt="Rejected" src="'+this.IMAGE_PATH+'Rejected.jpg"/>';case"Deferred":return'<img height="16" style="display:inline;" title="Deferred" alt="Deferred" src="'+this.IMAGE_PATH+'Deferred.jpg"/>';case"Closed":return'<img height="16" style="display:inline;" title="Closed" alt="Closed" src="'+this.IMAGE_PATH+'Closed.jpg"/>';default:return""}},convertDateToXSD:function(c){var f=new Date();var j=c.split("/");var a=f.getHours()<10?("0"+f.getHours()):f.getHours();var h=f.getSeconds()<10?("0"+f.getSeconds()):f.getSeconds();var e=f.getMinutes()<10?("0"+f.getMinutes()):f.getMinutes();var g=-f.getTimezoneOffset()/60;g=(g<0?"&#45;":"&#43;")+(Math.abs(g)<10?"0":"")+Math.abs(g);return j[2]+"-"+j[0]+"-"+j[1]+"T12:00:00"+g+":00"},getFormattedDate:function(c){if(c.split("T").length===1){return c}var j=c.split("T")[0].split("-");var e=c.split("T")[1].split(":");var f=new Date();var h=-f.getTimezoneOffset()/60;var k=new Date(j[0],j[1]-1,j[2],parseInt(e[0]),0,0);k.setHours(k.getHours()+h+7);var a=k.getDate()<10?("0"+k.getDate()):k.getDate();var g=(k.getMonth()+1)<10?("0"+parseInt(k.getMonth()+1)):parseInt(k.getMonth()+1);return g+"/"+a+"/"+k.getFullYear()},fixTitle:function(a){return a.length>20?a.substr(0,20)+"...":a},fixProjectName:function(a){return a.length>14?a.substr(0,14)+"...":a},getValue:function(c,f,d){d=d||null;var e=$j(c).find("FieldName:contains("+f+")");var a=e.siblings("Value");if(d&&a.filter(function(){return jQuery(this).attr("i:type")=="GenericEntity"}).length>0){return this.getValue(a,d)}else{if(a.filter(":not(:empty)")){return a.text()}}return" - "},getTextContentByKey:function(a,c){var d=a.getElementsByTagName(c);if(typeof d==="undefined"||d===null||d.length===0){return null}if(Prototype.Browser.IE){if(a.getElementsByTagName(c)[0].childNodes.length===0){return null}return a.getElementsByTagName(c)[0].childNodes[0].nodeValue}return a.getElementsByTagName(c)[0].textContent},getNodeValue:function(a){if(typeof a==="undefined"||a===null){return null}if(Prototype.Browser.IE){return a.childNodes[0].nodeValue}return a.textContent}};var ClarizenWidget=Class.create(Widget,{initialize:function($super,c){$super(c);this.widgetId=c.id;this.username=c.username;this.password=c.password;this.partnerID=clarizenWidgetHelper.PARTNER_ID;this.ticketId=typeof ticket_id==="undefined"?null:ticket_id;this.externalId=this.clarizenUserIdForPopup=this.sessionId=null;this.settings={enableIssues:false,enableBugs:false};this.sendInvitationMail=c.sendInvitationMail;this.formInstance=null;this.contentRoot=this.containingElement().down("div.clarizen-content"+this.widgetId);this.oldContentRoot=this.contentRoot;this.doSelectAssignee=false;this.assigneeXml=null;this.formLoaded=false;var a=this;$j("div#availabilityLnk a").live("click",function(){if(a.clarizenUserIdForPopup){$j(this).attr("href","https://app.clarizen.com/Clarizen/Pages/Calendar/ResourceCalendarView.aspx?u="+a.clarizenUserIdForPopup)}else{alert("Clarizen user information has not been received yet, please try again later.");return false}});this.start()},start:function(){this.proxyClarizenLoginUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});this.proxyClarizenQueryUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});this.proxyClarizenExecuteUrl=clarizenWidgetHelper.PROXY_URL.evaluate({url:clarizenWidgetHelper.SERVICE_URL});if(this.ticketId){this.showLoading();this.getSession(this.getExternalIdByTicketId)}else{if(this.isUserProfilePage()){this.contentRoot.insert(clarizenWidgetHelper.getLoadingImage());this.getSession(function(){this.getZendeskUserForProfilePage(document.location.toString().split("/")[4])})}else{this.contentRoot.update(clarizenWidgetHelper.getMissingTicketMessage())}}},isBugMode:function(){return this.settings.enableBugs&&!this.settings.enableIssues},isUserProfilePage:function(){return(/users/).test(document.location)},showLoading:function(){this.contentRoot.insert(clarizenWidgetHelper.getLoadingImage())},showInitial:function(){this.contentRoot.update(clarizenWidgetHelper.getSubmitForm(this.widgetId)+clarizenWidgetHelper.getLinkTicketResolution(this.widgetId))},failLoading:function(){$("resolutionLnk").update(clarizenWidgetHelper.getLinkTicketResolution(this.widgetId))},showForm:function(){$j.colorbox({inline:true,href:"#clarizen-modal-popup"});this.oldContentRoot=this.contentRoot;this.contentRoot=document.getElementById("clarizen-modal-popup");var a=this;$j(document).bind("cbox_cleanup",function(){a.contentRoot=a.oldContentRoot});if(!this.formLoaded){this.getCurrentTicket();this.retrieveProjects();this.retrieveAssignees()}},closeForm:function(){$j.colorbox.close()},getSession:function(d){var d=d||null;var a=this;var c="body="+clarizenWidgetHelper.getSessionRequest(this.username,this.password,this.partnerID);new Ajax.Request(this.proxyClarizenLoginUrl,{method:"post",postBody:c,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.LOGIN_URL},onSuccess:function(e){this.extractSessionID(e.responseXML,d)}.bind(this),onFailure:function(){this.failLoading();alert("Login has Failed")}})},extractSessionID:function(d,c){success=$j(d).find("Success").text()=="true";if(success){this.sessionId=$j(d).find("SessionId").text();this.organizationId=$j(d).find("OrganizationId").text();this.userId=$j(d).find("UserId").text();if(c){c.apply(this)}}else{var a=clarizenWidgetHelper.getTextContentByKey(d,"faultstring");this.failLoading();if(a!==null&&a!==""){alert(a)}else{alert("Login has Failed")}}},checkSessionTimeOut:function(a){return clarizenWidgetHelper.getTextContentByKey(a,"faultcode")==="s:SessionTimeout"},getExternalIdByTicketId:function(){var a="body="+clarizenWidgetHelper.getExternalIdByTicketRequest(this.sessionId,this.ticketId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(d){if(this.checkSessionTimeOut(d.responseXML)){this.contentRoot.update("Error communicating with Clarizen.");return false}var c=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"TypeName");if(c==="Bug"){this.settings.enableBugs=true}this.externalId=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"Value");if(!this.externalId){this.showInitial()}else{this.getIssueFromClarizen(true)}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Projects List")}.bind(this)})},retrieveProjects:function(){var a="body="+clarizenWidgetHelper.getProjects(this.sessionId);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(c){if(this.checkSessionTimeOut(c.responseXML)){this.getSession(this.retrieveProjects);return false}this.populateProjects(this.contentRoot,c.responseXML)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Projects List")}.bind(this)})},populateProjects:function(c,f){var g=false;var a=$j(c).find("select.clarizenProjectSelector");a.prop("disabled",false);a.html("");try{this.ProjectsList=$j(f).find("BaseEntity");g=(this.ProjectsList.length>0)}catch(d){}if(!g){$j("<option>").val("").html("").prop("selected",true).appendTo(a);return}$j("<option>").val("").html("—select the project—").prop("selected",true).appendTo(a);this.ProjectsList.each(function(e,h){$j("<option>").val($j(h).find("Id Value").text()).html(clarizenWidgetHelper.getValue(h,"Name")).appendTo(a)})},retrieveAssignees:function(){var a="body="+clarizenWidgetHelper.getAssigneeRequest(this.sessionId);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(c){if(this.checkSessionTimeOut(c.responseXML)){this.getSession(this.retrieveAssignees);return false}this.populateAssignees(this.contentRoot,c.responseXML)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Assignee List")}.bind(this)})},populateAssignees:function(c,d){var a=$j(c).find("select.clarizenAssigneeSelecter");a.html("");$j("<option>").val("-1").html("—select an assignee—").prop("selected",true).appendTo(a);this.assigneeXml=d;this.AssigneesList=this.AssigneesList||$j(d).find("BaseEntity");this.AssigneesList.each(function(f,e){$j("<option>").val($j(e).find("Id Value").text()).html(clarizenWidgetHelper.getValue(e,"FirstName")+" "+clarizenWidgetHelper.getValue(e,"LastName")).appendTo(a)});a.prop("disabled",false);a.disabled=false;if(this.doSelectAssignee){this.selectAssignee()}else{this.doSelectAssignee=true}},selectSeverity:function(a){$j("select.clarizenSeveritySelector").val(clarizenWidgetHelper.PRIORITY_MAPPING[parseInt(a)]||"Medium")},selectAssignee:function(){var d=null;var c=null;if(this.ZendeskTicketAssigneeEmail){this.AssigneesList=this.AssigneesList||$j(this.assigneeXml).find("BaseEntity");this.AssigneesList.each(function(j,e){var h=$j(e).find("Id Value").text();var k=clarizenWidgetHelper.getValue(e,"FirstName");var g=clarizenWidgetHelper.getValue(e,"LastName");var f=clarizenWidgetHelper.getValue(e,"Email");if(!d&&k&&g&&this.ZendeskTicketAssigneeFullname===k+" "+g){d=j+1}if(!c&&f&&this.ZendeskTicketAssigneeEmail===f){c=j+1}});var a=$j(this.contentRoot).find("select.clarizenAssigneeSelecter");if(c){a.selectedIndex=c}else{if(d){a.selectedIndex=d}}}},getCurrentTicket:function(){var a="/tickets/"+this.ticketId+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(c){if(this.checkSessionTimeOut(c.responseXML)){this.getSession(this.getCurrentTicket);return false}$j("input.clarizenTitle").val(clarizenWidgetHelper.getTextContentByKey(c.responseXML,"subject"));$j("textarea.clarizenDescription").val(clarizenWidgetHelper.getTextContentByKey(c.responseXML,"description"));this.selectSeverity(clarizenWidgetHelper.getTextContentByKey(c.responseXML,"priority-id"));this.ticketRequesterId=clarizenWidgetHelper.getTextContentByKey(c.responseXML,"requester-id");this.ticketAssigneeId=clarizenWidgetHelper.getTextContentByKey(c.responseXML,"assignee-id");this.ticketStatusId=parseInt(clarizenWidgetHelper.getTextContentByKey(c.responseXML,"status-id"));this.getTicketAssignee(this.ticketAssigneeId);this.getTicketOwner(this.ticketRequesterId)}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a ticket from Zendesk.")}.bind(this)})},getTicketAssignee:function(c){if(!c){return}var a="/users/"+c+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(d){if(this.checkSessionTimeOut(d.responseXML)){this.getSession(function(){this.getTicketAssignee(c)});return false}this.ZendeskTicketAssigneeEmail=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"email");this.ZendeskTicketAssigneeFullname=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"name");if(this.doSelectAssignee){this.selectAssignee()}else{this.doSelectAssignee=true}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a Zendesk User. (3)")}.bind(this)})},getTicketOwner:function(c){var a="/users/"+c+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(d){if(this.checkSessionTimeOut(d.responseXML)){this.getSession(function(){this.getTicketOwner(c)});return false}this.zendeskTicketRequesterEmail=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"email");this.zendeskTicketRequesterFullName=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"name")}.bind(this),onFailure:function(){this.failLoading();alert("Failed to retrieve a Zendesk User. (4)")}.bind(this)})},validateForm:function(){if($j("input.clarizenTitle").val()===""){alert("Subject is required");return false}if($j("textarea.clarizenDescription").val()===""){alert("Description is required");return false}if($j("select.clarizenAssigneeSelecter").val()==="-1"){alert("Please select an assignee");return false}var c=$j("input.dueDate").val();if(c!==""&&!/^[0-9]{2}\/[0-9]{2}\/[0-9]{4}$/.test(c)){alert("Invalid date, must be in MM/DD/YYYY format");return false}var a=new Date();a.setFullYear(c.split("/")[2],parseInt(c.split("/")[0])-1,parseInt(c.split("/")[1]));if(a<new Date()){alert("Please select a due date in the future.");return false}if($j("select.clarizenAssigneeSelecter").val()==="-1"&&!this.ticketAssigneeId){alert("This ticket is currently unassigned. Please select an assignee from the list");return false}this.closeForm();return true},submitIssueForm:function(a){if(this.validateForm()){$j("div.clarizen_message").hide();this.showLoading();this.prepareForSubmit()}},prepareForSubmit:function(){var a="body="+clarizenWidgetHelper.getSystemSettings(this.sessionId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(d){if(this.checkSessionTimeOut(d.responseXML)){this.getSession(this.prepareForSubmit);return false}if(clarizenWidgetHelper.getTextContentByKey(d.responseXML,"Success")==="false"){alert("Failed to get Clarizen Settings ( "+clarizenWidgetHelper.getTextContentByKey(d.responseXML,"faultstring")+" )")}else{var c=XmlHelper.getRecords(d.responseXML,"","anyType");this.settings.enableIssues=clarizenWidgetHelper.getNodeValue(c[0])==="true"?true:false;this.settings.enableBugs=clarizenWidgetHelper.getNodeValue(c[1])==="true"?true:false;if(!this.settings.enableBugs&&!this.settings.enableIssues){this.failLoading();alert("Issues and Bugs are disabled in this organization.")}else{this.checkRequesterInClarizen()}}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to get Clarizen Settings.")}.bind(this)})},checkRequesterInClarizen:function(){this.requestorId=null;if(this.zendeskTicketRequesterFullName){var a=this.zendeskTicketRequesterFullName.split(" ")[0];$j(this.AssigneesList).each(function(d,c){var e=clarizenWidgetHelper.getValue(c,"FirstName");var f=$j(c).find("Id Value").text();if(e==a&&f&&this.requestorId===null){this.requestorId=this.clarizenUserIdForPopup=f}})}this.submitIssue()},submitIssue:function(){var d=this.contentRoot.down("select.clarizenAssigneeSelecter").getValue();var a=this.contentRoot.down("input.dueDate").getValue();var c="body="+clarizenWidgetHelper.getSubmitFormRequest(this.sessionId,clarizenWidgetUnicodeConverter.convertChar2CP(this.contentRoot.down("input.clarizenTitle").getValue()),clarizenWidgetUnicodeConverter.convertChar2CP(this.contentRoot.down("textarea.clarizenDescription").getValue()),a===""?null:clarizenWidgetHelper.convertDateToXSD(a),this.contentRoot.down("select.clarizenSeveritySelector").getValue(),d,this.contentRoot.down("select.clarizenProjectSelector").getValue(),d,this.ticketId,this.isBugMode());new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:c,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(e){if(this.checkSessionTimeOut(e.responseXML)){this.getSession(function(){this.submitIssue()});return false}if(clarizenWidgetHelper.getTextContentByKey(e.responseXML,"Success")==="false"){this.failLoading();alert("An error occured. ("+clarizenWidgetHelper.getTextContentByKey(e.responseXML,"Message")+")")}else{this.externalId=clarizenWidgetHelper.getTextContentByKey(e.responseXML,"Value");if(this.ticketStatusId===0){this.getIssueFromClarizen(true)}else{this.changeIssueStatus()}}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to submit issue.")}.bind(this)})},changeIssueStatus:function(){var a="body="+clarizenWidgetHelper.getUpdateFormRequest(this.sessionId,this.externalId,this.ticketStatusId,this.isBugMode(),this.requestorId);new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(c){if(this.checkSessionTimeOut(c.responseXML)){this.getSession(this.changeIssueStatus);return false}if(clarizenWidgetHelper.getTextContentByKey(c.responseXML,"Success")==="false"){this.failLoading();alert("An error occured. ("+clarizenWidgetHelper.getTextContentByKey(c.responseXML,"Message")+")")}else{this.getIssueFromClarizen(true)}}.bind(this),onFailure:function(){this.failLoading();alert("Failed to submit issue.")}.bind(this)})},getIssueFromClarizen:function(){var a="body="+clarizenWidgetHelper.getIssueFromClarizenQuery(this.sessionId,this.externalId,this.isBugMode());this.contentRoot.update(clarizenWidgetHelper.getLoadingImage());new Ajax.Request(this.proxyClarizenExecuteUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.EXECUTE_URL},onSuccess:function(c){if(this.checkSessionTimeOut(c.responseXML)){this.getSession(function(){this.getIssueFromClarizen(insertRequired)});return false}this.parseIssueResponse(c.responseXML)}.bind(this),onFailure:function(){if(!insertRequired){this.contentRoot.update("")}alert("Failed to get Issue From Clarizen")}.bind(this)})},parseIssueResponse:function(e){var d=clarizenWidgetHelper.getTextContentByKey(e,"Success");if(d!==null&&d!=="false"){this.IssueSysId=clarizenWidgetHelper.getValue(e,"SYSID");this.IssueDueDate=clarizenWidgetHelper.getValue(e,"DueDate");this.IssueState=$j(e).find("TypeName:contains('CaseState')").siblings("Value").text();this.IssueSeverity=$j(e).find("TypeName:contains('Severity')").siblings("Value").text();this.IssuezendeskTicketId=clarizenWidgetHelper.getValue(e,"ZdExternalId");this.IssueAssignedTo=clarizenWidgetHelper.getValue(e,"AssignedTo","DisplayName");this.IssueOwner=clarizenWidgetHelper.getValue(e,"Owner","DisplayName");this.IssueProjectName=clarizenWidgetHelper.getValue(e,"PlannedFor","Name");this.IssueTitle=clarizenWidgetHelper.getValue(e,"Title");this.getZendeskTicket(this.IssuezendeskTicketId)}else{var c=clarizenWidgetHelper.getTextContentByKey(e,"ErrorCode");if(c!==null&&c==="EntityNotFound"){$("issuePlaceHolder").update("");this.externalId=null;this.showInitial()}else{$("issue-details").update("");var a=clarizenWidgetHelper.getTextContentByKey(e,"faultstring");alert(a!==null?a:"Failed to parse Issue response")}}},getZendeskTicket:function(c){var a="/tickets/"+c+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(e){if(this.checkSessionTimeOut(e.responseXML)){this.getSession(function(){this.getZendeskTicket(c)});return false}this.ZendeskUserIdAssigneeId=clarizenWidgetHelper.getTextContentByKey(e.responseXML,"assignee-id");var d=clarizenWidgetHelper.getTextContentByKey(e.responseXML,"requester-id");this.getZendeskOwner(d)}.bind(this),onFailure:function(){alert("Failed to retrieve a ticket from Zendesk.")}})},getZendeskOwner:function(c){var a="/users/"+c+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(d){if(this.checkSessionTimeOut(d.responseXML)){this.getSession(function(){this.getZendeskOwner(c)});return false}this.ZendeskUserOwnerEmail=clarizenWidgetHelper.getTextContentByKey(d.responseXML,"email");if(this.ZendeskUserIdAssigneeId){this.getZendeskUserForProfilePage(this.ZendeskUserIdAssigneeId)}else{this.updateIssueDetails()}}.bind(this),onFailure:function(){alert("Failed to retrieve a Zendesk User. (1)")}})},updateIssueDetails:function(){this.contentRoot.update(clarizenWidgetHelper.getDisplayIssueForm(this.widgetId,this.IssueSeverity,this.IssueSysId,this.IssueState,this.IssueDueDate,this.IssueAssignedTo,this.IssueOwner,this.IssueProjectName,this.IssueTitle,clarizenWidgetUnicodeConverter.convertChar2CP(encodeURIComponent(this.IssueTitle)),window.ticket_id,this.ZendeskUserAssigneeEmail,this.ZendeskUserOwnerEmail)+clarizenWidgetHelper.getAvailabilityLnk(this.widgetId))},updateIssueForm:function(){this.contentRoot.update(clarizenWidgetHelper.getDisplayIssueForm(this.IssueSeverity,this.IssueSysId,this.IssueState,this.IssueDueDate,this.IssueAssignedTo,this.IssueOwner,this.IssueProjectName,this.IssueTitle)+clarizenWidgetHelper.getAvailabilityLnk(this.widgetId))},getZendeskUserForProfilePage:function(c){var a="/users/"+c+".xml";new Ajax.Request(a,{method:"get",requestHeaders:{Accept:"application/xml"},onSuccess:function(e){if(this.checkSessionTimeOut(e.responseXML)){this.getSession(function(){this.getZendeskUserForProfilePage(c)});return false}this.ZendeskUserAssigneeEmail=clarizenWidgetHelper.getTextContentByKey(e.responseXML,"email");var d=clarizenWidgetHelper.getTextContentByKey(e.responseXML,"name").split(" ");if(d.length===1){alert("User '"+d+"' doesn't have a Last Name, cannot search user in Clarizen")}else{this.getClarizenUserProfile(this.ZendeskUserAssigneeEmail,d[0],d[1])}if(!this.isUserProfilePage()){this.updateIssueDetails()}}.bind(this),onFailure:function(){if(this.isUserProfilePage()){this.contentRoot.update("")}alert("Failed to retrieve a Zendesk User. (2)")}.bind(this)})},getClarizenUserProfile:function(c,d,a){var e="body="+clarizenWidgetHelper.getClarizenUserProfile(this.sessionId,c,d,a);new Ajax.Request(this.proxyClarizenQueryUrl,{method:"post",postBody:e,requestHeaders:{Accept:"application/xml",SOAPAction:clarizenWidgetHelper.QUERY_URL},onSuccess:function(f){if(this.checkSessionTimeOut(f.responseXML)){this.getSession(function(){this.getClarizenUserProfile(c,d,a)});return false}this.clarizenUserIdForPopup=clarizenWidgetHelper.getTextContentByKey(f.responseXML,"Value");if(this.isUserProfilePage()){this.contentRoot.update(this.clarizenUserIdForPopup===null?clarizenWidgetHelper.getProfileNotExistsMessage(d):clarizenWidgetHelper.getAvailabilityLnkForProfilePage(this.widgetId))}}.bind(this),onFailure:function(){if(this.isUserProfilePage()){this.contentRoot.update("")}alert("Failed to get Clarizen User Profile")}.bind(this)})}});var FreshbooksHelper={STAFF_FORM:new Template('<form class="form" id="freshbooks-form-#{widget_id}"> <label>Select user</label><select name="staff_id" id="freshbooks-form-staff-id" onchange="ObjectFactory.get(#{widget_id}).staffSelector(this.options[this.selectedIndex].value)"></select> <br/><input type="submit" disabled="disabled" id="freshbooks-submit" value="Sign in" onclick="ObjectFactory.get(#{widget_id}).saveStaffId($(\'freshbooks-form-#{widget_id}\'));return false;"></form>'),SUBMIT_FORM:new Template('<form class="form" id="freshbooks-form-#{widget_id}"> <label>Select project</label><select name="project_id" id="freshbooks-form-projects" onchange="ObjectFactory.get(#{widget_id}).projectsSelector(this.options[this.selectedIndex].value)"></select> <img src="/images/indicator2.gif" id="freshbooks-project-spinner" style="display:none;" /> <label>Select task</label><select disabled name="task_id" id="freshbooks-form-tasks" onchange="ObjectFactory.get(#{widget_id}).tasksSelector(this.options[this.selectedIndex].value)"></select> <img src="/images/indicator2.gif" id="freshbooks-task-spinner" style="display:none;" /> <label>Notes</label><textarea disabled name="freshbooks-form-notes" id="freshbooks-form-notes" wrap="virtual" style="width:190px; height: 50px;">#{default_note}</textarea> <label>Hours</label><input type="text" disabled name="freshbooks-form-hours" id="freshbooks-form-hours" style="width:50px"> <br/><input type="submit" disabled id="freshbooks-form-submit" style="margin-top: 10px;" value="Submit" onclick="ObjectFactory.get(#{widget_id}).submitTimeSpent($(\'freshbooks-form-#{widget_id}\'));return false;"> <span class="link" style="font-weight:normal;margin-left:20px;" onclick="ObjectFactory.get(#{widget_id}).logout()">(logout)</span></form>'),GET_TASKS:new Template('<?xml version="1.0" encoding="utf-8"?> <request method="task.list" >   <project_id>#{project_id}</project_id>   <page>1</page>   <per_page>100</per_page> </request>'),GET_STAFF:new Template('<?xml version="1.0" encoding="utf-8"?><request method="staff.list"></request>'),POST_HOURS:new Template('<?xml version="1.0" encoding="ISO-8859-1"?><request method="time_entry.create">  <time_entry>    <project_id>#{project_id}</project_id>    <task_id>#{task_id}</task_id>    <hours>#{hours}</hours>    <notes><![CDATA[#{notes}]]></notes>    <staff_id>#{staff_id}</staff_id>  </time_entry></request>'),ERROR_MESSAGE:new Template("An error occured:\n\n#{error}\n\nSee https://support.zendesk.com/forums/4372 for troubleshooting\n\nor contact Freshbooks support at support@freshbooks.com"),getTasksRequest:function(a){return escape(this.GET_TASKS.evaluate({project_id:a}))},getProjectsRequest:function(c){var a=new Template('body=<?xml version="1.0" encoding="utf-8"?><request method="project.list">  <page>#{page}</page>  <per_page>100</per_page></request>');return a.evaluate({page:c})},getClientsRequest:function(c){var a=new Template('body=<?xml version="1.0" encoding="utf-8"?><request method="client.list">  <page>#{page}</page>  <per_page>100</per_page></request>');return a.evaluate({page:c})},postHoursRequest:function(e,f,c,d,a){return escape(this.POST_HOURS.evaluate({staff_id:e,project_id:f,task_id:c,notes:d,hours:a}))},getStaffRequest:function(){return escape(this.GET_STAFF.evaluate({}))},buildClientList:function(a){var c={};a.each(function(d){var f=$j(d).find("client_id").text();var e=$j(d).find("organization").text();c[f]=e});return c},populateProjects:function(d,c){var a=$j("#freshbooks-form-projects");a.text("");a.append($j("<option>"));d.each(function(h){var g=$j("<option>");var f=$j(h).find("name").text();var j=$j(h).find("client_id").text();var e=c[j];if(e){f=f+" - "+e}g.attr("value",$j(h).find("project_id").text());g.text(f);a.append(g)});$j("#freshbooks-project-spinner").hide()},populateStaff:function(a){$("freshbooks-form-staff-id").update("");$("freshbooks-form-staff-id").appendChild(new Element("option"));for(i=0;i<a.length;i++){var c=new Element("option");c.value=FreshbooksHelper.getNodeString(a[i],"staff_id");c.innerHTML=FreshbooksHelper.getNodeString(a[i],"first_name")+" "+FreshbooksHelper.getNodeString(a[i],"last_name");$("freshbooks-form-staff-id").appendChild(c)}},populateTasks:function(a){$("freshbooks-form-tasks").update("");$("freshbooks-form-tasks").appendChild(new Element("option"));for(i=0;i<a.length;i++){var c=new Element("option");c.value=FreshbooksHelper.getNodeString(a[i],"task_id");c.innerHTML=FreshbooksHelper.getNodeString(a[i],"name");$("freshbooks-form-tasks").appendChild(c)}$j("#freshbooks-task-spinner").hide();$("freshbooks-form-tasks").enable()},getNodeValue:function(a,d){var c=a.getElementsByTagName(d);if(c==null||c.length==0){return null}if(c[0].childNodes[0]==null){return""}return c[0].childNodes[0].nodeValue},getNodeString:function(a,c){return this.getNodeValue(a,c)||""},getNodeAttribute:function(c,e,a){var d=c.getElementsByTagName(e);if(d==null||d.length==0){return null}return d[0].getAttribute(a)||null},getRecords:function(a,c){return a.getElementsByTagName(c)||new Array()},checkStatus:function(c){var a=FreshbooksHelper.getRecords(c,"response");if(a.length>0){var d=FreshbooksHelper.getNodeString(a[0],"error");if(d!=""){alert(FreshbooksHelper.ERROR_MESSAGE.evaluate({error:d}));return false}}return true}};var FreshbooksWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.url=a.url;if(!this.url.match(/^http/)){this.url="http://"+this.url}this.formInstance=null;this.ticket_id=a.ticket_id;this.default_note=a.default_note;this.apikey=a.apikey;this.staff_id="";this.subject=a.subject;this.contentRoot=this.containingElement().down("div.freshbooks-content");this.clients=null;this.apiUrl=this.buildApiUrl();this.setup()},setup:function(){this.staff_id=Zendesk.SettingsCookie.get("freshbooks_staff_id")||"";if(this.staff_id==""){this.contentRoot.update(FreshbooksHelper.STAFF_FORM.evaluate({widget_id:this.id}));this.loadStaff()}else{this.buildForm()}},saveApiKey:function(a){this.formInstance=a;Zendesk.SettingsCookie.set("freshbooks_api_key",$("freshbooks-form-apikey").value);this.setup()},logout:function(){Zendesk.SettingsCookie.set("freshbooks_staff_id","");this.staff_id="";this.setup()},buildForm:function(){var a=this.defaultNote();this.contentRoot.update(FreshbooksHelper.SUBMIT_FORM.evaluate({widget_id:this.id,default_note:a,ticket_id:this.ticket_id}));this.loadClients(1,[])},buildApiUrl:function(){var c="/proxy/direct?&url=#{url}&timeout=10";var a=new Template(c);return a.evaluate({url:this.url})},defaultNote:function(){var c={id:this.ticket_id,title:this.subject};var a={ticket:c,ticket_id:this.ticket_id};return Zd.Util.parseTemplate(this.default_note,a)},loadStaff:function(){var a="body="+FreshbooksHelper.getStaffRequest();new Ajax.Request(this.apiUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(c){if(FreshbooksHelper.checkStatus(c.responseXML)){this.showStaff(c.responseXML)}}.bind(this),onFailure:function(){alert("Failed to retrieve Freshbooks staff list.")}})},loadClients:function(f,c){var a=FreshbooksHelper.getClientsRequest(f);var d=this;var e=Base64.encode(this.apikey+":x");$j.ajax({type:"POST",beforeSend:function(g){g.setRequestHeader("Authorization","Basic "+e)},url:this.apiUrl,data:a,success:function(g){d.handleLoadClients(c,g)}})},handleLoadClients:function(c,e){var d=parseInt($j(e).find("clients").attr("page"));var a=parseInt($j(e).find("clients").attr("pages"));$j.merge(c,$j(e).find("client"));if(d<a){this.loadClients(d+1,c)}else{this.clients=FreshbooksHelper.buildClientList(c);this.loadProjects(1,[])}},loadProjects:function(f,e){var a=FreshbooksHelper.getProjectsRequest(f);var c=this;$j("#freshbooks-project-spinner").show();var d=Base64.encode(this.apikey+":x");$j.ajax({type:"POST",beforeSend:function(g){g.setRequestHeader("Authorization","Basic "+d)},url:this.apiUrl,data:a,success:function(g){c.handleLoadProjects(e,g)}})},handleLoadProjects:function(c,e){var d=parseInt($j(e).find("projects").attr("page"));var a=parseInt($j(e).find("projects").attr("pages"));$j.merge(c,$j(e).find("project"));if(d<a){this.loadProjects(d+1,c)}else{FreshbooksHelper.populateProjects(c,this.clients)}},projectsSelector:function(a){this.loadTasks(a)},staffSelector:function(a){if($("freshbooks-form-staff-id").value>""){$("freshbooks-submit").enable()}else{$("freshbooks-submit").disable()}},saveStaffId:function(a){Zendesk.SettingsCookie.set("freshbooks_staff_id",$("freshbooks-form-staff-id").value);this.setup()},loadTasks:function(c){var a="body="+FreshbooksHelper.getTasksRequest(c);$j("#freshbooks-form-tasks").text("");$j("#freshbooks-task-spinner").show();new Ajax.Request(this.apiUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(d){if(FreshbooksHelper.checkStatus(d.responseXML)){this.showTasks(d.responseXML)}}.bind(this),onFailure:function(){alert("Failed")}})},tasksSelector:function(a){$("freshbooks-form-notes").enable();$("freshbooks-form-hours").enable();$("freshbooks-form-submit").enable()},showStaff:function(c){if($("freshbooks-form-staff-id").options.length==0){var a=FreshbooksHelper.getRecords(c,"member");FreshbooksHelper.populateStaff(a)}},showTasks:function(c){var a=FreshbooksHelper.getRecords(c,"task");FreshbooksHelper.populateTasks(a)},submitTimeSpent:function(c){var d=parseFloat(c["freshbooks-form-hours"].value);if(isNaN(d)){alert("Please enter a valid value for hours");return false}var a="body="+FreshbooksHelper.postHoursRequest(this.staff_id,$("freshbooks-form-projects").value,$("freshbooks-form-tasks").value,$("freshbooks-form-notes").value,$("freshbooks-form-hours").value);new Ajax.Request(this.apiUrl,{method:"post",postBody:a,requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(this.apikey+":x")},onSuccess:function(e){if(FreshbooksHelper.checkStatus(e.responseXML)){this.resetForm()}}.bind(this),onFailure:function(){alert("Failed")}});return false},resetForm:function(){var a=this.defaultNote();$("freshbooks-form-hours").value="";$("freshbooks-form-notes").value=a;$("freshbooks-form-notes").focus()}});var HighriseWidget=Class.create(Widget,{initialize:function($super,K){$super(K);var F=K.email;var u=K.domain;var C=K.username;var c="X";var a=K.use_ssl;var w="http"+((a=="true")?"s":"")+"://"+u;var N=10;var s=K.name.split(" ");var l={first_name:s[0],last_name:s.slice(1).join(" "),email:K.email,organization:K.organization_name||"",phone:K.phone||""};var h;var H=function(){return'<form id="highrise-login-form" class="form"><label>Enter your highrise token</label><input type="text" class="text" id="username"/><input type="hidden" name="password" value="X"/><input type="submit" name="submit" class="button primary" value="Login" ></form>'};var I=function(){return'<div id="highrise-display"></div><div id="highrise-status"></div><div id="highrise-search">'+E()+"</div>"};var y=function(P){$("highrise-display").update(P)};var r=function(P){$("highrise-status").update(P)};var e=function(Q){D();var P=$("highrise-login-form");var S=$("highrise-search-form");if(S){S.observe("submit",function(T){T.stop();f()})}if(!F){y(v());return}if(P){P.observe("submit",function(T){T.stop();B.submit_credentials(this)})}var R=Q.people;if(!R){d()}else{if(R.length===1){q(R.first())}else{list_contact_data=function(T){var U=T.collect(function(V){return G(V)});return'<div id="multi-match">We found <strong>'+U.length+'</strong> profiles with this email:<ul id="highrise-people-list" class="options"><li class="user">'+U.join("</li><li>")+"</li></ul><em>Tip: consider merging in Highrise</em></div>"};y(list_contact_data(R))}}};var q=function(P){h=new J(P,L);h.redraw()};var d=function(){y(g(F));$("highrise-create-contact-link").observe("click",function(P){P.preventDefault();new O(l.first_name,l.last_name,l.organization,l.email,l.phone)})};var G=function(P){return'<li class="user">'+m(P.first_name+(P.last_name?" "+P.last_name:""),w+"/people/"+P.id)+"</li>"};var j=function(P,Q,R){return(!R?"&":"")+encodeURIComponent(P)+"="+encodeURIComponent(Q)};var L=function(P){y(o(P));$("highrise-addnote-link").observe("click",function(Q){Q.preventDefault();$("highrise-addnote-form").show();$("highrise-addnote-text").focus()});$("highrise-addnote-form").observe("reset",function(Q){$("highrise-addnote-form").hide()});$("highrise-addnote-form").observe("submit",function(S){S.stop();var Q=encodeURI("/proxy.js");var T=$F("highrise-addnote-text");if(T==""){r("Note body is empty!");return}var R=j("domain",B.options.domain,true)+j("use_ssl",B.options.use_ssl)+j("resource","people/"+P.id+"/notes.xml")+j("media_type","application/xml")+j("pluck_param","note")+j("note[body]",T);new Ajax.Request(Q,{method:"post",requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(B.options.user+":"+B.options.pass)},parameters:R,onSuccess:function(U){$("highrise-addnote-link").update("<strong>Note Added</strong> - Create another");this.reset();this.hide()}.bind(this),onFailure:function(U){r("Note creation failed!")}})})};var v=function(){var P='<p class="center">No requester on this page</p>';return P};var g=function(Q){var P='<p class="center">No contact found for this email</p>';P+='<p class="center"><a id="highrise-create-contact-link">Add this Zendesk user to Highrise</a></p>';return P};var E=function(){return'<form id="highrise-search-form" class="form"><div id="highrise-search-box"><label for="highrise-search-box-field" class="overlabel">Find a Contact or Company</label><input id="highrise-search-box-field" type="text" name="search" title="Find a Contact or Company" value="" tabindex="1" /></div><input type="submit" id="submit" class="button small primary wide" value="Search in Highrise" /></form>'};var f=function(){var R=$("highrise-search-form");var S=R.search;var P=$F(S);if(P===""){r("Search is empty")}else{var Q=new k(P);Q.searchNext()}};var M=function(P){return"window.open('"+P+"', '_new')"};var p=function(Q,P){return'<span class="link" onclick="'+P+'">'+Q+"</span>"};var m=function(Q,P){return'<a class="link" href="'+P+'" target="_blank">'+Q+"</a>"};var o=function(R){var W=w;var X="";var P=m(R.first_name+(R.last_name?" "+R.last_name:""),W+"/people/"+R.id);if(R.title){P+="<br />("+R.title+")"}if(R.company_name){var U=m(R.company_name,W+"/companies/"+R.company_id)}var S;if(R.contact_data.email_addresses){S=R.contact_data.email_addresses.collect(function(Y){return m(Y.address,"mailto:"+Y.address)+" ("+Y.location+")"})}var Q;if(R.contact_data.phone_numbers){Q=R.contact_data.phone_numbers.collect(function(Y){return Y.number+"("+Y.location+")"})}var T;if(R.contact_data.twitter_accounts){T=R.contact_data.twitter_accounts.collect(function(Y){return m("@"+Y.username,Y.url)+" ("+Y.location+")"})}var V='<form id="highrise-addnote-form" style="display: none;"><textarea id="highrise-addnote-text"></textarea><div style="clear:both;"><input type="reset" class="button small left" value="Cancel" id="highrise-addnote-cancel"><input type="submit" value="Save note" id="highrise-addnote-submit" class="button small primary right"></div><div class="clear"></div></form>';X+='<ul class="options">';if(P){X+='<li class="user">'+P+"</li>"}if(U){X+="<li>"+U+"</li>"}if(S){X+='<li class="email">'+S.join('</li><li class="email">')+"</li>"}if(Q){X+='<li class="phone">'+Q.join('</li><li class="phone">')+"</li>"}if(T){X+='<li class="twitter">'+T.join('</li><li class="twitter">')+"</li>"}X+='<li class="add-link"><a id="highrise-addnote-link"><strong>Add a note to '+R.first_name+"</strong></a></li>";X+="</ul>";X+=V;return X};var k=Class.create({initialize:function(P){this.searching=true;this.encodedSearchTerm=encodeURI(P);this.searchTerm=P;this.searchFields=["name","title","email","city","state","country","zip","street","phone","background"];this.searchResults={};this.searchResultsOrder=[];this.maxResults=N;this.page=0},searchNext:function(){var Q=function(R){var S=/\d/g;return S.test(R)};this.page=0;if(this.searchFields.length>0){this.currentSearchField=this.searchFields.shift();if(this.currentSearchField=="phone"&&!Q(this.searchTerm)){this.searchNext()}var P="parties/search.xml?"+this.currentSearchField+"="+this.encodedSearchTerm;B.request({resource:P,on_success:this.onSearchResponse.bind(this)})}else{this.cleanUp()}},searchPaginated:function(){this.page++;var P="parties/search.xml?n="+this.page+"&"+this.currentSearchField+"="+this.encodedSearchTerm;B.request({resource:P,on_success:this.onSearchResponse.bind(this)})},onSearchResponse:function(P){var Q=$A(P.parties);if(!this.searching){return}if(Q){if(Q.length>0){Q.each(function(R){if(!Object.isUndefined(R.id)&&Object.isUndefined(this.searchResults[R.id])){this.searchResults[R.id]=R;this.searchResultsOrder.push(R.id)}},this);this.updateSearchOutput()}if(Q.length==25){this.searchPaginated()}else{this.searchNext()}}else{this.searchNext()}},updateSearchOutput:function(){if(this.searchResults){var P=[];var Q=$("highrise-search-box-field");this.searchResultsOrder.each(function(S){var R=this.searchResults[S];if(P.length<this.maxResults){if(R.first_name){P.push(G(R))}else{if(R.name){P.push('<li class="organisation">'+m(R.name,w+"/companies/"+R.id)+"</li>")}}}},this);y('<div id="results"><p>Search results <strong>('+this.searchResultsOrder.length+')</strong></p><ul class="options">'+P.join("")+"</ul>"+((P.length<this.maxResults)?"":"<div>Only showing "+this.maxResults+" of "+this.searchResultsOrder.length+" results.</div>")+'<p><a id="highrise-search-back">&larr; Back</a></p>');Q.focus();$("highrise-search-back").observe("click",function(R){R.preventDefault();this.cleanUp("");t();Q.focus();Q.value=""}.bind(this))}},cleanUp:function(P){this.searching=false;r(P)}});var t=function(){B.request({resource:"people/search.xml?criteria[email]="+encodeURI(F),on_success:e})};var J=Class.create({initialize:function(P,Q){this.person=P;this.render=Q},getCompany:function(){if(Object.isUndefined(this.person.company_id)||this.person.company_id==null){this.person.company_name=""}else{B.request({resource:"companies/"+this.person.company_id+".xml",on_success:(function(P){this.person.company_name=P.name;this.redraw()}).bind(this)})}},redraw:function(){this.render(this.person)}});var O=Class.create({initialize:function(T,S,P,R,Q){this.firstName=T;this.lastName=S;this.company=P;this.email=R;this.phoneNumber=Q;this.makeApiRequest()},makeApiRequest:function(){var P=encodeURI("/proxy.js");var Q=j("domain",B.options.domain,true)+j("use_ssl",B.options.use_ssl)+j("resource","people.xml")+j("media_type","application/xml")+j("pluck_param","person")+j("person[first-name]",this.firstName)+j("person[last-name]",this.lastName)+j("person[company-name]",this.company)+j("person[contact-data][email-addresses][email-address][address]",this.email)+j("person[contact-data][email-addresses][email-address][location]","Work")+j("person[contact-data][phone-numbers][phone-number][number]",this.phoneNumber)+j("person[contact-data][phone-numbers][phone-number][location]","Work");new Ajax.Request(P,{method:"post",requestHeaders:{Accept:"application/xml",Authorization:"Basic "+Base64.encode(B.options.user+":"+B.options.pass)},parameters:Q,onSuccess:function(R){q(R.responseText.evalJSON().response.person)},onFailure:function(R){r("Error: Could not create user!")}})}});var D=function(){var S,R,Q;S=document.getElementsByTagName("label");for(var P=0;P<S.length;P++){if(S[P].className=="overlabel"){R=S[P].htmlFor||S[P].getAttribute("for");if(!R||!(Q=document.getElementById(R))){continue}S[P].className="overlabel-apply";if(Q.value!==""){z(Q.getAttribute("id"),true)}Q.onfocus=function(){z(this.getAttribute("id"),true)};Q.onblur=function(){if(this.value===""){z(this.getAttribute("id"),false)}};S[P].onclick=function(){var U,T;U=this.getAttribute("for");if(U&&(T=$(U))){T.focus()}}}}};var z=function(R,Q){var S;var T=document.getElementsByTagName("label");for(var P=0;P<T.length;P++){S=T[P].htmlFor||T[P].getAttribute("for");if(S==R){T[P].style.display=(Q)?"none":"";return true}}};var n=function(R,Q){for(var P in R){if(Q){var S=Q+"."+P+"\n"+R[P]}else{var S=P+"\n"+R[P]}if(!confirm(S)){return}if(typeof R[P]=="object"){if(Q){n(R[P],Q+"."+P)}else{n(R[P],P)}}}};if(!F){var B=new Zendesk.Resource({anchor:"highrise-lookup",domain:u,user:C,pass:c,use_ssl:a,application_content:I,login_content:H,application_resources:[]});e()}else{var B=new Zendesk.Resource({anchor:"highrise-lookup",domain:u,user:C,pass:c,use_ssl:a,application_content:I,login_content:H,application_resources:[{resource:"people/search.xml?criteria[email]="+encodeURI(F),on_success:e}]})}var A=$("highrise-login-form");if(A){A.observe("submit",function(P){P.stop();B.submit_credentials(this)})}}});var LogMeInWidget=Class.create(Widget,{initialize:function($super,a){$super(a);this.SSOID=a.SSOID;this.SSOpwd=a.SSOpwd;this.SSOcompid=a.SSOcompid;this.ticket_id=a.ticket_id?a.ticket_id:"";this.ticket_token=a.token?a.token:"";this.widget_id=a.widget_id;this.cookie_name="logmein_auth_"+this.widget_id;this.secret=a.secret;this.subdomain=a.subdomain;this.cfield_values=a.cfield_values;this.newTicket=a.newTicket;logmein=this;this.getLoginTicket()},isError:function(c,a){return jQuery.inArray(c,a)>=0},setExternalLink:function(){if(this.newTicket){$j.ajax({type:"get",dataType:"html",url:"/integrations/logmein_rescue/get_token.js",success:function(a){$j("#ticket-chat").append("<input name='ticket[external_links][][type]' id='external_link_type' type='hidden' value='LogMeInRescueSession' />");$j("#ticket-chat").append("<input name='ticket[external_links][][session_id]' id='external_link_session' type='hidden' value='"+a+"' />");this.ticket_token=a}})}},getLoginTicket:function(){$j("#loading_area").show();var a="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/sso/getloginticket.aspx?ssoid="+this.SSOID+"&password="+this.SSOpwd+"&companyid="+this.SSOcompid);$j.ajax({type:"get",dataType:"html",url:a,success:function(d){$j("#loading_area").hide();if(d.split(":")[0]=="OK"){var c=d.substring(3);$j("span#tech_console_link").html('<br/><a href="'+c+'" target="_blank"><strong>Launch Technician Console</strong></a>');$j("#tech_console_area").show();if(!Zendesk.SettingsCookie.get(this.cookie_name)){$j("#login_area").show()}else{$j("#pin_area").show()}}else{errors=d.split(":");$j("#tech_console_area").hide();if(this.isError("INVALIDSSOID",errors)){logmein.err("Your Rescue Single Sign-On ID must match your Zendesk primary email address.")}else{if(this.isError("INVALID",errors)){logmein.err("You are not authorized to login.")}else{if(this.isError("INVALIDPASSWORD",errors)){logmein.err("Invalid single sign-on password.")}else{logmein.err("Error accessing the Technician Console single sign-on link.")}}}$j("error_area").show()}}.bind(this)})},checkAuth:function(){var a,d;logmein.err(false);$j("#ticket_place").html("");$j("#pin").text("");if(Zendesk.SettingsCookie.get(this.cookie_name)){this.getPIN(Zendesk.SettingsCookie.get(this.cookie_name));return}else{a=document.getElementById("logmein_username").value;d=document.getElementById("logmein_password").value;if(a==""&&d==""){logmein.err("Please enter the username and password");$j("#login_area").show();return}}var c="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/api/requestauthcode.aspx?email="+a+"&pwd="+d);$j.ajax({type:"get",dataType:"html",url:c,success:function(f){f=f.split(":");if(f[0]=="ERROR"||f[0]=="INVALID"){logmein.err("The username and/or password you've entered is incorrect.");return}else{var e=f[1];Zendesk.SettingsCookie.set(this.cookie_name,e);$j("#login_area").hide();$j("#pin_area").show();return}}.bind(this)})},getPIN:function(c){$j("#pin").hide();$j("#pin_placeholder").hide();$j("#pin_loader").show();fields=this.widget_id+"|"+this.ticket_id+"|"+this.ticket_token+"|"+this.subdomain+"|"+this.secret;this.setExternalLink();var a="/proxy/direct?url="+encodeURIComponent("https://secure.logmeinrescue.com/api/requestpincode.aspx?notechconsole=1&authcode="+c+"&tracking0="+fields+"&"+this.cfield_values);$j.ajax({url:a,type:"get",dataType:"html",success:function(e){$j("#pin_loader").hide();e=e.split(":");if(e[0].replace(/^\s*|\s*$|\n*/g,"")=="OKPINCODE"){$j("#pin").text(e[1]);$j("#pin").show();$j("#login_area").hide();var d="https://secure.logmeinrescue.com/Customer/Code.aspx?Code="+e[1];$j("#ticket_place").html("<a href='javascript:void(0)' onclick='logmein.comment_update(\"Click this link to launch a remote session: "+d+"\")' ><strong>&laquo;</strong> Copy to ticket</a>");logmein.err(false);$j("#submit_type").val("")}else{switch(e[0]){case"ERROR":logmein.err("There was an error trying to get the PIN, please try again or contact the admin if the problem persists.");break;case"NOTLOGGEDIN":logmein.err("Unable to login, please verify your username and password.");break;case"NOTECHCONSOLERUNNING":logmein.err("Please run the Technician Console before requesting a PIN.");break;case"OUTOFPINCODES":logmein.err("LogMeIn Rescue is out of PIN codes.");break;case"INVALID_SECRETAUTHCODE":logmein.err("The authentication code you've obtained is invalid or has expired, try logging in again.");Zendesk.SettingsCookie.erase(this.cookie_name);$j("#pin_area").hide();$j("#login_area").show();break;case"USER_IS_DELETED":logmein.err("This user has been deleted.");break;case"TECHNICIAN_NOT_EXISTS":logmein.err("This technician does not exist.");break;case"USER_DELETED_OR_DISABLED":logmein.err("This user has been deleted or disabled.");break;default:logmein.err("Error when requesting a PIN.");break}}}.bind(this)})},err:function(a){$j("#error_area").show();a?$j("#error_area").text("Error: "+a):$j("#error_area").text("")},comment_update:function(a){old_msg=$j("#comment_value").val();$j("#comment_value").val(old_msg+" "+a)}});if(!Zd){var Zd={}}Zd.Util={parseTemplate:function(d,c){var e=this.rubyStyle(d,c);var a=this.mustacheStyle(e,c);return a},rubyStyle:function(c,a){var d=new Template(c);return d.evaluate(a)},mustacheStyle:function(d,c){var a=/(^|.|\r|\n)(\{\{\s*([\w\\.]+)\s*\}\})/;var e=new Template(d,a);return e.evaluate(c)},pluralize:function(c,a){if(a==1){return c}return c+"s"}};Zendesk.NS("Forums.Search.Autocomplete",this.jQuery,function(w){var d={autocomplete:false},v=this;var j={ENTER:13,ESC:27,DOWN:40,UP:38};function e(y,z){return j[z]===y.keyCode}function h(y){y.stopPropagation();y.preventDefault();return true}var u,n;function m(){return w("#"+u)}function c(){return w("#"+u+" input#"+n)}function s(){return w("#"+a)}function r(){return d.autocomplete&&c().length>0}var a="forum_search_autocomplete";function p(){w("<div/>").attr("id",a).addClass("autocomplete").hide().appendTo(c().parent())}function k(){p();v.currentAutocompleter=new Autocompleter.Json(n,a,g.curry(new Autocompleter.RateLimiting()),{frequency:0.2,minChars:1,choices:5,updateElement:function(y){var z=c();if(y){z.val(y.textContent||y.innerText)}m().submit()}});o.call(v.currentAutocompleter)}function g(z,y,A){z.schedule(t,y,A);v.currentAutocompleter.query=y}var q;function t(y,z){q=y;w.ajax({url:"/search/typeahead?query="+y}).done(function(A){if(q!==y){return}z(A.pluck("value"));f(y)})}function f(y){w("#"+a).find("ul li").each(function(){var B=w(this),z=B.text(),A;A=z.replace(y,"<b>"+y.escapeHTML()+"</b>");B.html(A)})}function o(){this.updateChoices=function(A){if(!this.changed&&this.hasFocus){this.update.innerHTML=A;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var y=0;y<this.entryCount;y++){var z=this.getEntry(y);z.autocompleteIndex=y;this.addObservers(z)}}else{this.entryCount=0}this.stopIndicator();this.update.scrollTop=0;this.index=null;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}};this.render=function(){if(this.entryCount>0){for(var y=0;y<this.entryCount;y++){Element.removeClassName(this.getEntry(y),"selected");if(this.index!==null&&this.index===y){Element.addClassName(this.getEntry(y),"selected")}}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}};this.markPrevious=function(){if(this.index===null){this.index=this.entryCount-1}else{if(this.index>0){this.index--}else{this.index=null}}this.previewSuggestion()};this.markNext=function(){if(this.index===null){this.index=0}else{if(this.index<this.entryCount-1){this.index++}else{this.index=null}}this.previewSuggestion()};this.previewSuggestion=function(){var z=this.getCurrentEntry(),y=this.element;if(z){y.value=z.textContent||z.innerText}else{y.value=this.query}}}function l(y){d=y;if(d.forumsSearch){u="searchform";n="query"}else{if(d.homePageSearch){u="suggest_form";n="suggestions_query"}}if(!r()){return}k()}this.isActive=r;this.setup=l});Zendesk.NS("Forums.Search.Instant",this.jQuery,this.I18n,function(k,d){var n={perPage:5,focusOnLoad:false,searchScopes:[],tracking:true};var f={ENTER:13,ESC:27,DOWN:40,UP:38};function g(o,p){return f[p]===o.keyCode}function h(o){o.stopPropagation();o.preventDefault();return true}var j={element:function(){return this.form().find("#query")},val:function(){return this.element().val()},form:function(){return k("#searchform")},searchUrl:function(){return this.form().attr("action")},icon:function(){return this.form().find("#icon")},scopeSelector:function(){return this.form().find("div.search_scope_selector")},setup:function(){k(window).bind("keydown",this.onWindowKeyDown.bind(this));var o=this.element();o.keydown(this.onInputKeyDown.bind(this));o.keyup(this.onInputKeyUp.bind(this));o.attr("autocomplete","off");this.addIcon();if(this.searchScopes().length>0){this.addScopeSelector()}if(n.focusOnLoad){o.focus()}(function(){j.fixInputLayout()}).delay(0.2);(function(){j.fixInputLayout()}).delay(1);k(window).resize(function(p){j.fixInputLayout()})},offset:function(){return 5},addIcon:function(){var o=this.element(),p=k('<div id="icon" title="Press <ESC> to clear input."/>');o.after(p);p.css({marginLeft:-p.width()+"px",left:-1*this.offset()+"px"}).addClass("clear_icon").hide();p.bind("click",this.resetInput.bind(this))},addScopeSelector:function(){var o=k('<div class="search_scope_selector">  <span class="scope_text"></span>  <span class="arrow">▾</span>  <ul class="dropdown"/></div>');this.icon().after(o);o.attr("tabindex",0).keydown(this.onScopeSelectorKeyDown.bind(this)).keyup(this.onScopeSelectorKeyUp.bind(this)).click(function(p){j.openSearchScopeMenu("true");h(p)}).hover(function(){j.openSearchScopeMenu()},function(){j.closeSearchScopeMenu()}).focus(function(){j.openSearchScopeMenu();j.selectSearchScopeMenuItem(0)}).blur(function(){j.closeSearchScopeMenu()});o.find(".arrow").css({position:"absolute",right:"0px"});o.find("span").hover(function(){j.selectSearchScopeMenuItem(0)});this.populateScopeItems()},populateScopeItems:function(){var r=this.searchUrl(),q=this.searchScopes(),s=q.detect(function(t){return t.url===r});var o=this.scopeSelector().find(".arrow").width()+3*this.offset(),p=q.inject(0,function(u,t){this.setScope(t);return Math.max(u,this.scopeSelector().find(".scope_text").width())},this);this.scopeSelector().css({width:p+o+"px"});if(!s){return}this.setScope(s);this.setScopeList(q.without(s))},setScope:function(o){this.scopeSelector().find(".scope_text").text(d.t("txt.instant_search.in_forum_name",{forum_name:o.name})).data("searchScope",o)},setScopeList:function(o){var p=this.scopeSelectorMenu();this.closeSearchScopeMenu();p.find("li").remove();o.forEach(function(r,q){k("<li>"+d.t("txt.instant_search.in_forum_name",{forum_name:r.name})+"</li>").appendTo(p).data("searchScope",o[q]).click(function(s){j.changeScope(k(this).data("searchScope"),true);p.hide();h(s)}).hover(function(){j.selectSearchScopeMenuItem(q+1)})})},scopeSelectorMenu:function(){return this.scopeSelector().find(".dropdown")},scopeSelectorMenuItems:function(){return this.scopeSelector().find(".scope_text, li")},hasSelectedSearchScopeMenuItem:function(){return this.getSelectedSearchScopeMenuItem().length>0},getSelectedSearchScopeMenuItem:function(){return this.scopeSelectorMenuItems().filter(".selected")},openSearchScopeMenu:function(){this.scopeSelectorMenu().show()},closeSearchScopeMenu:function(){this.scopeSelectorMenu().hide();this.deselectAllSearchScopeMenuItems()},selectSearchScopeMenuItem:function(o){this.deselectAllSearchScopeMenuItems();var p=this.scopeSelectorMenuItems();o=Math.abs(o)%p.length;this.selectSearchScopeElement(k(p.get(o)))},selectSearchScopeElement:function(o){if(o.hasClass("scope_text")){o=o.add(o.parent())}o.addClass("selected")},selectNextSearchScopeMenuItem:function(p){var o=this.scopeSelectorMenuItems().index(this.getSelectedSearchScopeMenuItem());this.selectSearchScopeMenuItem(o+(p?1:-1))},deselectAllSearchScopeMenuItems:function(){this.form().find(".selected").removeClass("selected")},getSelectedSearchScope:function(){return this.getSelectedSearchScopeMenuItem().data("searchScope")},searchScopes:function(){return n.searchScopes},changeScope:function(p,o){this.form().attr("action",p.url);this.populateScopeItems();this.fixInputLayout();this.element().focus();a.searchNow()},fixInputLayout:function(){var r=this.icon(),p=this.element(),s=this.form(),q=s.find("#buttonsubmit"),o=this.scopeSelector();if(o.length>0){this.layoutScopeSelector(o,p,r)}this.layoutInput(p,s,q)},layoutScopeSelector:function(p,q,s){var r=p.width();p.css({marginLeft:-1*r+"px",marginRight:-3*this.offset()+"px",left:-3*this.offset()+"px",paddingLeft:2*this.offset()+"px"});p.find(".arrow").css({marginRight:this.offset()+"px"});var o=p.bounds(true).width(),u=p.find(".dropdown");u.css({left:"0px",width:o+"px"});s.css({left:-1*(r+s.width()+this.offset())+"px"});var t=o+s.width()+2*this.offset();q.css({paddingRight:t+"px"})},layoutInput:function(q,t,r){q.css({width:"20px"});var v=q.add(r).bounds(true),p=t.bounds(true),u=t.parent().bounds(true),s=p.left-u.left,o=p.width()-v.width()-s;q.css({width:q.width()+o+"px"})},updateIcon:function(){if(!a.searchInitiated){this.toggleClearIconDisplay();return}if(this.val().length>0){this.signalLoading()}else{this.stopSignalLoading()}},toggleClearIconDisplay:function(){var o=this.icon();o.removeClass("loading_icon");if(this.val()===""){o.removeClass("clear_icon");o.hide()}else{o.addClass("clear_icon");o.show()}},resetInput:function(o){this.element().val("");this.updateIcon();c.removeIncrementalSearchResults()},signalLoading:function(){j.icon().show().removeClass("clear_icon").addClass("loading_icon")},stopSignalLoading:function(){j.icon().addClass("clear_icon").removeClass("loading_icon");this.toggleClearIconDisplay()},onInputKeyDown:function(o){this.prevVal=this.val();if(!g(o,"ESC")){return undefined}var p=this.element();if(this.val()===""){p.blur()}else{this.resetInput();if(k.browser.msie){window.setTimeout((function(){p.focus()}).bind(this),400)}}return h(o)},onInputKeyUp:function(o){if(g(o,"ENTER")){var q=c.selectedResultItem();if(q&&this.hasSelectedSearchScopeMenuItem()){c.visitResultItem(q);return h(o)}}if(g(o,"ESC")){return h(o)}if(!g(o,"UP")&&!g(o,"DOWN")){var p=this;_.delay(function(){if(p.prevVal===p.val()&&p.prevVal!==""){return}a.initSearchRequest()})}return undefined},onScopeSelectorKeyUp:function(o){if(g(o,"ESC")){this.element().focus(0);return h(o)}return undefined},onScopeSelectorKeyDown:function(o){if(g(o,"ENTER")){this.changeScope(this.getSelectedSearchScope());this.closeSearchScopeMenu();return h(o)}if(g(o,"DOWN")||g(o,"UP")){this.selectNextSearchScopeMenuItem(g(o,"DOWN"));return h(o)}return undefined},onWindowKeyDown:function(o){if(this.hasSelectedSearchScopeMenuItem()){return undefined}if(g(o,"UP")||g(o,"DOWN")){c.changeSelection(g(o,"DOWN")?1:-1);return h(o)}if(g(o,"ENTER")){var p=c.selectedResultItem();if(p){c.visitResultItem(p);return h(o)}}return undefined}};var c={container:function(){return k("#incremental_search")},notFoundElement:function(){return k("#not_found_hint")},output:function(){return k("#incremental_search_result")},hasResults:function(o){return o.find(".item-info").length>0},resultItems:function(){return this.output().find(".item")},result_snippets:function(){return this.output().find(".item_search_snippet")},selectedResultItem:function(){return this.resultItems()[this.selectedResultItem_idx]},result_titles:function(o){return o.find("a[title]")},resultDataSelector:".item, #show_more",loadMoreScriptSelector:".search_results_data",resultSelector:function(){return this.resultDataSelector+". "+this.loadMoreScriptSelector},notFoundText:d.t("txt.search.we_could_find_results"),setup:function(){this.showExistingResultsIfPresent()},visitURL:function(o){document.location=o},visitResultItem:function(p,o){if(p){this.visitURL(k(p).find(".item-info a").attr("href"))}},prepareHtml:function(o,p){m.paginate(o);this.highlight(o,p);this.prepareResultItemsForSelection()},highlight:function(p,q){if(!q){return}var r=c.result_titles(p),o=c.result_snippets(p);r.removeHighlight();o.removeHighlight();q.split(" ").forEach(function(s){r.highlight(s);o.highlight(s)})},processResult:function(q,p){this.container().show();var r=k(p);if(!this.hasResults(r)){this.removeIncrementalSearchResults();this.showNotFoundHint();return}this.notFoundElement().hide();this.output().show();var o=this.findElementsToAnimate(this.output(),r);o.slideDown.hide();if(o.slideUp.length>0){o.slideUp.slideUp("fast",this.embedNew.bind(this).curry(o,q))}else{this.embedNew(o,q)}},embedNew:function(p,r){var o=this.output();this.container().show();if(p.replaceOld.length===0){o.append(p.replaceNew)}else{p.replaceOld.replaceWith(p.replaceNew)}p.slideUp.remove();var s=o.find(".item").last(),q=o.find(":first-child").first();if(s.length>0){p.slideDown.insertAfter(s)}else{if(q.length>0){p.slideDown.insertBefore(q)}else{p.slideDown.appendTo(o)}}p.slideDown.slideDown("fast",this.prepareHtml.bind(this).curry(o,r));this.prepareHtml(o,r)},removeIncrementalSearchResults:function(){var o=this.output();o.hide("fast","swing",function(){o.html("")})},showExistingResultsIfPresent:function(){var o=k(".hidden_incremental_search_results");if(o.length===0){return}if(!this.hasResults(o)){this.showNotFoundHint()}var p=this.findElementsToAnimate(null,o,true);this.embedNew(p,this.getQuery());j.updateIcon()},showNotFoundHint:function(){var o=this.notFoundElement();if(o.length===0){o=k('<div id="not_found_hint"><h2>'+this.notFoundText+"</h2></div>");this.container().find("#incremental_search_result").after(o)}return o.show()},getQuery:function(){return j.element().val()},parseResults:function(p){var o=k(p);return{items:o.filterOrFind(".item"),moreButton:o.filterOrFind("#show_more"),paginatorScript:o.filterOrFind(".search_results_data")}},findElementsToAnimate:function(q,s,p){var o=this.parseResults(q),r=this.parseResults(s);if(p){return{remove:o.paginatorScript,slideUp:k(),slideDown:k(),replaceOld:o.items.add(o.moreButton),replaceNew:r.paginatorScript.add(r.items).add(r.moreButton)}}return{remove:o.paginatorScript,slideUp:o.items.slice(r.items.length),slideDown:r.items.slice(o.items.length),replaceOld:o.items.slice(0,r.items.length).add(o.moreButton),replaceNew:r.paginatorScript.add(r.items.slice(0,o.items.length)).add(r.moreButton)}},prepareResultItemsForSelection:function(){this.selectedResultItem_idx=-1;var o=this,p=this.resultItems();p.bind("mousemove",function(){var q=p.index(this);if(q!==-1){o.selectResultItem(q)}});p.bind("click",function(){o.visitResultItem(this,true)})},changeSelection:function(o){this.selectResultItem(this.selectedResultItem_idx+o)},selectResultItem:function(o){if(m.is_loading_more){return}var s=this.resultItems(),q=s.length;s.removeClass("selected");if(q===0){return}var r=o===q;if(r&&m.next_page()){m.load_next_page_select_idx=o;m.loadNextPage();return}if(o<0){o=q-1}else{if(o>=q){o=0}}var p=s.get(o);if(p.scrollIntoViewIfNeeded){p.scrollIntoViewIfNeeded()}k(p).addClass("selected");this.selectedResultItem_idx=o}};var m={itemsPerPage:function(){return n.perPage},paginator:function(){return c.output().data("resultsPaginator")},setup:function(){var o=Zendesk.ResultsPaginator.prototype;o.onContentRetrievedCallback=function(q,p){this.slide_in_paginator_content(q,p);this.on_paginator_page_load(q);c.prepareResultItemsForSelection();this.is_loading_more=false;if(this.load_next_page_select_idx){c.selectResultItem(this.load_next_page_select_idx);delete this.load_next_page_select_idx}}.bind(this)},reset_paginator:function(){c.output().data("resultsPaginator",null)},paginate:function(o){this.reset_paginator();o.paginateResults();var p=this.paginator();if(p&&p.nextPage===2){p.nextPage=Zendesk.ResultsPaginator.parseNextPageFrom(o)}},slide_in_paginator_content:function(p,o){o=k(o).hide();p.$container.append(o);o.each(function(q){k(this).slideDown("fast")})},on_paginator_page_load:function(p){var o=a.last_query;if(o){c.highlight(p.$container,o)}},next_page:function(){var o=this.paginator();return o&&o.nextPage},loadNextPage:function(){var o=this.paginator();if(o&&o.nextPage){this.is_loading_more=true;o.loadMore(true)}}};var a={searchDelay:370,initSearchRequest:function(){this.searchInitiated=true;j.updateIcon();if(!this.searchLater){this.searchLater=_.debounce(this.searchNow.bind(this),this.searchDelay)}this.searchLater()},searchNow:function(){var o=this.createSearchQuery(j.val());if(o&&o.length>0){this.searchInitiated=true;this.doIncrementalSearch(j.searchUrl(),o)}else{this.searchInitiated=false;c.removeIncrementalSearchResults()}j.updateIcon()},createSearchQuery:function(p){var o="[\\.,\\+]";return p.replace(new RegExp("^"+o+"|"+o+"$"),"").replace(new RegExp(o)," ").replace(/\s+/," ")},processResult:function(p,o){p=p||this.last_query;this.last_query=p;this.searchInitiated=false;j.updateIcon();return c.processResult(p,o)},doIncrementalSearch:function(o,p){k.ajax({url:o,data:{query:p,incremental:true,format:"html",page:1,per_page:m.itemsPerPage(),xhr:true}}).done(this.processResult.bind(this).curry(p))}};var l={trackingModule:"Incremental Forum Search",track:function(o){Zendesk.Instrumentation.ToTango.track(o,this.trackingModule)},setupTracking:function(){var p=Zendesk.Instrumentation;p.on(a,"searchNow","search activated",this.trackingModule);p.on(c,"visitResultItem",function(t,s){return"topic selected by "+(s?"mouse":"key:enter")},this.trackingModule);p.on(j,"resetInput",function(s){return"clear search by "+(s?"mouse":"key:esc")},this.trackingModule);var r=j.form(),q="search submitted by mouse",o="search submitted by key:enter";r.addClass("tracked").data("tracking-activity",q).data("tracking-module",this.trackingModule).instrumentTracking().keydown(function(s){if(g(s,"ENTER")){j.form().data("tracking-activity",o)}}).keyup(function(s){if(g(s,"ENTER")){j.form().data("tracking-activity",q)}});k(".deflect.tickets").add(".deflect.ideas").add(".deflect.questions").addClass("tracked").data("tracking-module",this.trackingModule).instrumentTracking();k(".deflect.tickets").data("tracking-activity","'Get in touch' selected");k(".deflect.ideas").data("tracking-activity","'Submit an idea' selected");k(".deflect.questions").data("tracking-activity","'Ask a question' selected");p.on(j,"openSearchScopeMenu",function(s){return"scope selector: opened by "+(s?"mouse":"key:tab")},this.trackingModule);p.on(j,"changeScope",function(t,s){return"scope selector: new scope selected by "+(s?"mouse":"key:tab")},this.trackingModule);p.on(Zendesk.ResultsPaginator.prototype,"loadMore",function(s){return"see more button selected by "+(s?"key":"mouse")},this.trackingModule);p.on(c,"embedNew",function(s){var t=s.replaceNew.filterOrFind(".show_more_bar").add(s.slideDown.filterOrFind(".show_more_bar")).length>0;return t?"see more button visible":null},this.trackingModule);if(n.searchScopes&&n.searchScopes.length>0){this.track("scope selector visible")}}};function e(o){n.instantSearchEnabled=c.container().length>0;if(o&&o.per_page){n.perPage=o.per_page}if(o&&o.focus){n.focusOnLoad=o.focus}if(o&&o.search_scopes){n.searchScopes=o.search_scopes;if(o.model_name){n.searchScopes.push({name:o.model_name,url:j.searchUrl()})}}if(o&&o.tracking!==undefined){n.tracking=o.tracking}}this.inputController=j;this.resultController=c;this.paginatorController=m;this.searchController=a;this.trackingController=l;this.setup=function(o){e(o);if(!n.instantSearchEnabled){return}k(function(){m.setup();j.setup();c.setup();if(n.tracking){l.setupTracking()}})}});Zendesk.NS("Stats");Zendesk.Stats.ForumUI=(function(){this._statsInfo=function(a){return{statsObject:a,objectType:a.attr("object_type"),objectId:a.attr("object_id"),windowStart:a.attr("window_start"),pageType:a.attr("page_type")}};this.setup=function(d,c){c=c||{};var a=c.container;$j("#detailed_stats_graph_container",a).hide();this._drawSparklines(c);this._bindSparklineHandlers(d,c)};this._bindSparklineHandlers=function(e,d){d=d||{};var c=d.container,a=(d.statsURL||"#stats")+"/";$j(".sparkline",c).click(function(){if($j(this).hasClass("active")){return false}e.setLocation(a+$j(this).attr("id"))})},this._drawSparklines=function(d){d=d||{};var a=d.container,g=Zendesk.Stats.ForumUI._statsInfo($j("#stats_object",a));var f=[{div:"#forum_entry_create_sparkline",statName:"entry_create"},{div:"#forum_entry_view_sparkline",statName:"entry_view"},{div:"#forum_post_create_sparkline",statName:"post_create"},{div:"#forum_watching_entry_create_sparkline",statName:"watching_entry_create"},{div:"#forum_vote_create_sparkline",statName:"vote_create"}];if($j("#stats_summary_container",a).exists()){for(var e=0;e<f.length;e++){if(g.pageType=="entry"&&f[e]["statName"]=="entry_create"){continue}else{var c=new Zendesk.Stats.Graph($j(f[e]["div"],a),{graphType:"sparkline",resource:"forum",objectType:g.objectType,objectId:g.objectId,statName:f[e]["statName"],start:g.windowStart,totalCountDiv:$j(f[e]["div"],a).parent().parent().find(".stat_total")});c.draw()}}}},this.showDetailGraph=function(c,d){d=d||{};var a=d.container,e=$j(c,a).attr("id"),h=Zendesk.Stats.ForumUI._statsInfo($j("#stats_object",a));$j("#comments_section",a).hide();$j("#stats_summary_container",a).show();$j(".sparkline.active",a).removeClass("active");$j(c,a).addClass("active");var g=new Zendesk.Stats.Graph($j("#detailed_stats_graph",a),{graphType:"area",resource:"forum",objectType:h.objectType,objectId:h.objectId,statName:e,start:h.windowStart});g.draw();$j(window).resize(function(){g.draw()});$j("#detailed_stats_graph_container",a).show();if(h.objectType!="entry"){var f={start:h.windowStart,stat_name:e};f[h.objectType+"_id"]=h.objectId;$j("#content_entries .frame:first",a).html('<div id="topic_search_loading" class="loading"></div>');$j.ajax({url:"/entries/top_entries_by_stat",data:f}).done(function(j){$j("#content_entries .frame:first",a).html(j)})}if(h.objectType!="account"){$j.ajax({url:"/api/v1/stats/aggregate_average/account/0/forum_stats_by_"+h.objectType+"/"+e+"?start="+h.windowStart}).done(function(k){var j=Zendesk.Stats.formatNumber("0,0",k);$j("#account_wide_total_section",a).html(I18n.t("txt.admin.public.javascript.stats.forum_stats.vs_for_average_topic",{total_stats:'<span id="account_wide_total">'+j+"</span>"}))})}$j("#forum_nav_comments",a).click(function(){$j("#detailed_stats_graph_container",a).hide()})};return this})();Zendesk.NS("Stats");Zendesk.Stats.SearchStatsOptions=function(a){if((a===undefined)||(a.divTable===undefined)||(a.statsType===undefined)){throw"Expected both divTable & statsType options."}if((a.statsType!="all"&&a.statsType!="feedback_tab"&&a.statsType!="portal_tab")){throw"Unknown handle type: "+a.statsType}this.divTable=a.divTable;this.statsType=a.statsType;this.orderField=a.orderField;this.fieldSorts={searches:true,string:true,avg_results:false,ctr:false,tickets:true};this.appendData=a.appendData||false;this.container=a.container;this.divPaginationTotal=a.divPaginationTotal;this.page=a.currentPage||1;this.pageSize=a.pageSize||15;this.searchStatsTemplate=a.searchStatsTemplate};Zendesk.Stats.SearchStatsOptions.prototype={getStatsAPIEndpoint:function(d){var f="/api/v1/stats/search/account/search_stats";var c={all:"all",feedback_tab:"dropbox",portal_tab:"portal"}[this.statsType];var e;var a;if(d===undefined){e=this.page;a=this.pageSize}else{e=d.page||this.page;a=d.pageSize||this.pageSize}f+="?origin="+c+"&page="+e+"&per_page="+a+"&duration=2592000";if(this.orderField!==undefined){f+="&order="+this.orderField;f+="&desc="+this.fieldSorts[this.orderField]}return f}};Zendesk.Stats.SearchStatsTable=function(a){this.statOptions=new Zendesk.Stats.SearchStatsOptions(a)};Zendesk.Stats.SearchStatsTable.prototype={$:function(a){return $j(a,this.statOptions.container)},_saveOptions:function(a){$j.extend(this.statOptions,a)},displayFirstPage:function(a){this._saveOptions(a);this._fetchData(this.statOptions.getStatsAPIEndpoint())},nextPage:function(){this.statOptions.appendData=true;return(this.statOptions.page+=1)},setSort:function(a,d){var c=this.statOptions,e=(d==="desc");c.fieldSorts[a]=e;c.orderField=a},_getSortDirection:function(a){return(a===false?"asc":"desc")},getCurrentSortDirection:function(c){var d=this.statOptions,a=d.fieldSorts[c];return this._getSortDirection(a)},getNextSortDirection:function(c){var d=this.statOptions,a=d.fieldSorts[c];if(d.orderField===c){a=!a}return this._getSortDirection(a)},modifyDisplayed:function(c,d,f){this._saveOptions(c||{});var e;if(this.statOptions.appendData===true){e=this.statOptions.getStatsAPIEndpoint()}else{var a=this.statOptions.pageSize*this.statOptions.page;e=this.statOptions.getStatsAPIEndpoint({page:1,pageSize:a})}this._fetchData(e,this.statOptions.orderField,d,f)},_fetchData:function(c,d,e,f){var a=this;$j.ajax({url:c,dataType:"json",success:function(g){if(g.data.length>0){a._fetchTopEntries(g,d,e,f)}else{a.statOptions.appendData=false}}})},_fetchTopEntries:function(a,d,j,e){var k=this;var c=a.data;var f=[];$j.each(c,function(l,m){if(m.top_entry_id!==null){f.push(m.top_entry_id)}});var h=f.join(",");var g="/api/v1/entries/show_many/";$j.ajax({type:"POST",url:g,data:{ids:h,only:"title"},dataType:"json",success:function(m){k._mergeData(m,c);var l=k.$(k.statOptions.divTable+" #show_more");if(a.page<a.total_pages){l.show()}else{l.hide()}if(e){e.call(j,d)}k._displayTotal(a.page,a.total_entries)}})},_mergeData:function(d,a){var c={};$j.each(a,function(e,f){if(c[f.top_entry_id]===undefined){c[f.top_entry_id]=[]}c[f.top_entry_id].push(e);var g=f.string;if(g!==null&&g.length>=26){f.string=g.substring(0,23)+"..."}f.escaped_string=encodeURIComponent(g);f.searches=Zendesk.Stats.formatNumber("0",f.searches);f.ctr=f.ctr*100;if(f.ctr>100){f.ctr=100}f.ctr=Zendesk.Stats.formatNumber("0.0",f.ctr);f.avg_results=Zendesk.Stats.formatNumber("0,0.0",f.avg_results);f.tickets=Zendesk.Stats.formatNumber("0",f.tickets)});$j.each(d,function(e,g){var h=c[g.id];var f=g.title;if(f!==null&&f.length>=26){f=f.substring(0,23)+"..."}$j.each(h,function(j,l){var k=a[l];if(k!==undefined){k.title=g.title;k.link=f}})});this._displayTable({statEntries:a})},_displayTable:function(e){var d=this.$(this.statOptions.divTable+" tbody");var c=this.$(this.statOptions.searchStatsTemplate).html();var a=$j.mustache(c,e);if(this.statOptions.appendData===false){d.empty()}else{this.statOptions.appendData=false}d.append(a)},_displayTotal:function(e,d){var a=this.$("table.tickets tbody tr:visible").length;var g=this.$(this.statOptions.divPaginationTotal);var f=(a===0?"0":"1");var c=(this.$(".active").attr("id")==="searches")?d:a;g.html($j.mustache(I18n.t("txt.admin.views.search.stats_summary.currently_displayed_search_results_out_of_total"),{from:f,currentDisplayedRows:a,total:c}))},isFeedbackData:function(c,d){var a=new Zendesk.Stats.SearchStatsOptions({divTable:"search_string_stats",statsType:"feedback_tab"});$j.ajax({url:a.getStatsAPIEndpoint(),dataType:"json",success:function(e){d.call(c,e.data.length>0)}})}};Zendesk.NS("Stats");Zendesk.Stats.Graph=function(a,d){this.graphData={};this.container=$j(a);this.searchStatURL=d.searchStatURL;this.resource=d.resource;this.statName=d.statName;this.objectId=d.objectId||0;this.objectType=d.objectType||"account";this.graphType=d.graphType;this.totalCountDiv=d.totalCountDiv;this.nocache=d.nocache;this.data=d.data;if(d.start){this.startTime=d.start}else{var c=parseInt(new Date()/1000);this.startTime=c-(60*60*24*30)}this.statsURL=this._statsURL();this.flotOptions=Zendesk.Stats.FlotOptions[this.graphType]};Zendesk.Stats.Graph.prototype={_statsURL:function(){if(this.data){return false}if(this.searchStatURL){return"/api/v1/stats/graph_data"+this.searchStatURL+"/"+this.statName}var a="/api/v1/stats/graph_data/"+this.objectType+"/";if(this.objectId){a+=this.objectId+"/"}a+=this.resource+"_stats_by_"+this.objectType;a+="/"+this.statName;return a},draw:function(){if(this.graphData[this.statsURL]||this.data){this._updateDetailGraphTitle();this._render();this._addPlotHover()}else{var a={start:this.startTime,interval:86400};if(this.nocache){a.nocache=this.nocache}$j.getJSON(this.statsURL,a).done($j.proxy(this._onFetchGraphData,this,this.statsURL))}},_render:function(){var a=this.data||this.graphData[this.statsURL].data;$j.plot(this.container,[{data:a}],this.flotOptions)},_onFetchGraphData:function(a,c){for(i=0;i<c.data.length;i++){point=c.data[i];if(point[1]==null){point[1]=0}}this.container.data("graph_data",c);this.graphData[a]=c;this._updateTotalCount(a);this._updateDetailGraphTitle();this._render();this._addPlotHover()},_updateDetailGraphTitle:function(){var a=$j(".sparkline.active").parent().children(".sparkline_title").html();$j("#detailed_stats_graph_title").html(a)},_updateTotalCount:function(c){if($j(this.totalCountDiv).is(":empty")){var d=this.graphData[this.statsURL].data,a;a=_.inject(d,function(e,f){return e+f[1]},0);$j(this.totalCountDiv).append(Zendesk.Stats.formatNumber("0,0",a))}},_addPlotHover:function(){var c=null,a=this;$j(this.container).bind("plothover",function(f,g,e){if(e){if(c!==(e.pageX*e.datapoint[1])){c=e.pageX*e.datapoint[1];$j("#stats_point_value").remove();var d=Zendesk.Stats.formatNumber("0,0",e.datapoint[1]);a._displayPointValue(e.pageX,e.pageY,d)}}else{$j("#stats_point_value").remove();c=null}})},_displayPointValue:function(a,d,c){$j('<div id="stats_point_value">'+c+"</div>").css({position:"absolute",display:"none",top:d-29,left:a-9,border:"2px solid #000","-webkit-border-radius":"2px","-moz-border-radius":"2px","font-size":"12px",padding:"4px",color:"#fff","background-color":"#000",opacity:0.8}).appendTo("body").fadeIn(200)}};Zendesk.Stats.FlotOptions={area:{colors:["#137ac6"],grid:{backgroundColor:"#fff",borderWidth:0,hoverable:true,mouseActiveRadius:"240",autoHighlight:false,minBorderMargin:"20"},yaxis:{min:0,tickFormatter:function(c,a){return Zendesk.Stats.formatNumber("0,0",Math.round(c))},maxFloor:5},xaxis:{mode:"time",monthNames:I18n.t("date.abbr_month_names").slice(1),timeformat:I18n.t("date.formats.short")},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:"1"},points:{show:true,fill:true,fillColor:"#137ac6",radius:"1.5",symbol:"circle"},shadowSize:0}},percentage:{colors:["#137ac6"],grid:{backgroundColor:"#fff",borderWidth:0,hoverable:true,mouseActiveRadius:"240",autoHighlight:false,minBorderMargin:"20"},yaxis:{min:0,maxFloor:100,tickSize:25,tickFormatter:function(c,a){return String(c)+"%"}},xaxis:{mode:"time"},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:"1"},points:{show:true,fill:true,fillColor:"#137ac6",radius:"1.5",symbol:"circle"},shadowSize:0}},sparkline:{colors:["#137ac6"],shadowSize:0,grid:{show:false},yaxis:{min:0},xaxis:{mode:"time"},legend:{show:false},series:{lines:{show:true,fill:true,fillColor:"#e6f2fa",lineWidth:1}}}};Zendesk.Stats.formatNumber=function(o,k){if(typeof o!=="string"){return("")}if(k===null||typeof k==="undefined"){k=0}var c=-1<o.indexOf(","),a=o.split(".");if(1<a.length){k=k.toFixed(a[1].length)}else{if(2<a.length){throw ("NumberFormatException: invalid format, formats should have no more than 1 period: "+o)}else{k=k.toFixed(0)}}var p=k.toString();if(c){a=p.split(".");var l=a[0],f=[],g=l.length,e=Math.floor(g/3),d=l.length%3||3;for(var h=0;h<g;h+=d){if(h!==0){d=3}f[f.length]=l.substr(h,d);e-=1}p=f.join(",");if(a[1]){p+="."+a[1]}}return o.replace(/[\d,?\.?]+/,p)};(function(c){var d=false;function e(){this.reset();this.elId="#suggest"}e.prototype.reset=e.prototype.update=function(f){var g=this.active;this.selected=0;this.items=f||[];this.active=!!(this.items.length>0);if(g!=this.active){if(!this.active){this.hide()}else{this.activated()}}};e.prototype.keyMap={tab:9,enter:13,esc:27,up:38,down:40};e.prototype.keyMapReverse=[9,13,27,38,40];e.prototype.attach=function(g){var f=this;if(!d){c("body").append('<div id="suggest"></div>');d=true}c(g).unbind(".selectable").bind("keydown.selectable",function(h){f.keyDown(this,h)})};e.prototype.detach=function(f){c(f).unbind(".selectable");this.reset();this.hide()};e.prototype.keyDown=function(h,j){if(!this.active){return}var f=true,g=e.prototype.keyMap;switch(j.keyCode){case g.up:this.selected=Math.max(this.selected-1,0);break;case g.down:this.selected=Math.min(this.selected+1,this.items.length-1);break;case g.tab:case g.enter:this.complete();break;case g.esc:this.reset();break;default:f=false}if(f){j.preventDefault();this.render()}};e.prototype.isNavigationEvent=function(f){return(c.inArray(f.keyCode,e.prototype.keyMapReverse)>-1)};e.prototype.render=function(){if(!this.items){return}var h=this.selected,g=this.selected+5;if(h>0){h--;g--}var f=c.map(this.items,this.renderItem).slice(h,g);c(this.elId).html("<ul>"+f.join("")+"</ul>");return this};e.prototype.hide=function(){this.active=false;c(this.elId).hide();return this};e.prototype.show=function(){c(this.elId).show();return this};e.prototype.move=function(f){c(this.elId).css(f);return this};function a(){var f=this;this.re=new RegExp("^{{.*");this.suggestions={};this.lastToken="";this.selectable=new e();this.selectable.complete=function(){f.complete()};this.selectable.renderItem=function(h,g){return'<li class="suggest-li '+(g==f.selectable.selected?"suggest-li-focus":"")+'">'+h+'<div class="suggest-detail">'+f.suggestions[h]+"</div></li>"};this.selectable.activated=function(){var g=f.getTokenPos(f.getText(),f.getCaretPos()),j=f.getTextAreaCoordsByIndex(f.textArea,g.start),h=c(f.textArea).position();f.selectable.move({top:j.top+h.top,left:j.left+h.left}).show()}}a.prototype.match=function(h){var f=[];if(!this.re.test(h)){return[]}for(var g in this.suggestions){if(h.length<g.length&&this.suggestions.hasOwnProperty(g)&&g.substr(0,h.length)==h){f.push(g)}}return f};a.prototype.getToken=function(){var f=this.getText(),g=this.getTokenPos(f,this.getCaretPos());return f.substring(g.start,g.end)};a.prototype.getTokenPos=function(j,h){var k=/\s/,f=j.length,l=h,g=h-1;for(;l>0;l--){if(k.test(j[l-1])){break}}for(;g<f;g++){if(k.test(j[g+1])){break}}return{start:l,end:g+1}};a.prototype.keyUp=function(g,h){var f=this.getToken();if(this.lastToken!=f){this.selectable.update(this.match(f));this.selectable.render();this.lastToken=f}};a.prototype.complete=function(){var f=this.getText(),g=this.getTokenPos(f,this.getCaretPos());this.textArea.value=f.substr(0,g.start)+this.selectable.items[this.selectable.selected]+" "+f.substr(g.end);this.selectable.reset()};a.prototype.attach=function(g){var f=this;c(g).unbind(".suggest").bind("keyup.suggest",function(h){f.keyUp(this,h)});this.textArea=g;this.selectable.attach(g)};a.prototype.detach=function(f){c(f).unbind(".suggest");this.textArea=null;this.selectable.detach(f)};a.prototype.getText=function(){return this.textArea.value};a.prototype.getCaretPos=function(){return this.textArea.selectionEnd};a.prototype.getTextAreaCoordsByIndex=function(o,j){var l=["height","width","padding-top","padding-right","padding-bottom","padding-left","lineHeight","textDecoration","letterSpacing","font-family","font-size","font-style","font-variant","font-weight"],f={position:"absolute",overflow:"auto","white-space":"pre-wrap",top:0,left:-9999},k,g,n,m;if(!c(o).is("textarea")||j==null){return}for(var h=0,k=l.length;h<k;h++){f[l[h]]=c(o).css(l[h])}n=document.createElement("span");n.innerHTML="&nbsp;";g=document.createElement("div");c(g).css(f).text(o.value.substring(0,j)).insertAfter(o);g.scrollTop=g.scrollHeight;g.appendChild(n);m=c(n).position();c(g).remove();return m};window.Suggest=a})(jQuery);Zendesk.NS("Screenr");Zendesk.Screenr.Helper={urlToScreenrLibray:function(a){return(Zendesk.Screenr.Helper._host_with_protocol(a)+"/api/recorder")},_host_with_protocol:function(c){var a=c.replace(/.*?:\/\//g,""),d=(("https:"==Zendesk.Screenr.Helper._protocol())?"https://":"http://");return d+a},_protocol:function(){return document.location.protocol},_tenant_domain:function(a){return a.match(/([^.]+)/g)[0]},publicUrlToTenantStatus:function(d,c,a){return this._host_with_protocol(a)+"/tenants/"+this._tenant_domain(c)+"/recorders/"+d+"?callback=?"}};(function(a){Zendesk.NS("Screenr");Zendesk.Screenr.BaseRecorder={recorder:null,screencasts:null,counter:0,domainUrl:null,removeI18n:"",screencastI18nName:"",SCREENCAST_IFRAME_WIDTH:570,SCREENCAST_IFRAME_HEIGHT:340,COLORBOX_WIDTH:620,COLORBOX_HEIGHT:425,COMMENT_HEIGHT:115,init:function(f,e,c,d){this.domainUrl=e;this.screencasts=[];this.screencastI18nName=c;this.removeI18n=d;this._retrieveScreencastsPreviouslyRecorded();a.getScript(Zendesk.Screenr.Helper.urlToScreenrLibray(e)).done(this._onScreenrLoadedFunction(f));a("a[href='javascript:void']").click(function(g){g.preventDefault();g.returnValue=false});this.afterInit()},_retrieveScreencastsPreviouslyRecorded:function(){var c=this,d=Zendesk.Screenr.RecordedScreencastsOnFailedValidation;if(d!=null){a.each(d,function(e,f){c._onRecordingCompleted({id:f.id,position:f.position,embedUrl:f.url,thumbnailUrl:f.thumbnail})})}},_onScreenrLoadedFunction:function(d){var c=this;return function(e,f){c.setUpScreenr(d)}},setUpScreenr:function(e){var c,d={id:e,hideAllFields:true,scrollToTop:true};c=Screenr.Recorder(a.extend(d,this._extraParamsForScreenr()));c.attachTo("screenr_link");c.setUserName("",false);c.setUserEmail("",false);c.setSubject("",false);c.setDescription("",false);c.setOnCancel(function(f){});c.setOnComplete(function(f){this._onRecordingCompleted(f)}.bind(this));this.recorder=c},_onRecordingCompleted:function(d){var g,f,c;this.counter++;c={id:d.id,url:d.embedUrl,thumbnail:d.thumbnailUrl,position:this.counter};this.screencasts.push(c);f=this._UIstyledListItemButton(c,null,true);f.appendTo(a("#screencasts_list"));try{f.effect("highlight",{},800)}catch(e){}},_UIstyledListItemButton:function(c,j,g){var h=c.id,e=a("<li/>"),d=a('<a href="javascript:void" class="screencast_preview"/>'),f=a('<a href="javascript:void" class="remove"/>');g=g||false;e.attr("id","screencast-"+h);e.append(d);d.text(this.screencastI18nName+c.position).click(function(k){this.showScreencast(c.url,j)}.bind(this));if(g){f.html(this.removeI18n).click(function(k){this.removeScreencast(h)}.bind(this));e.append(f)}return e},removeScreencast:function(d){var c=[];a.each(this.screencasts,function(e,f){if(f.id!=d){c.push(f)}});this.screencasts=c;a("#screencast-"+d).remove()},_injectScreencasts:function(e){var d="ticket[screencasts][]",c=Array("position","id","url","thumbnail");a.each(this.screencasts,function(f,g){a.each(c,function(h,j){a('<input type="hidden" />').attr("name",d+"["+j+"]").attr("value",g[j]).appendTo(e)})})},_screenrBaseDomain:function(){return(this.domainUrl.replace(/^[^.]+./g,""))},_extraParamsForScreenr:function(){return{}},afterInit:function(){},showScreencast:function(c,d){}}}(jQuery));(function(a){Zendesk.NS("Screenr");Zendesk.Screenr.TicketRecorder=a.extend({},Zendesk.Screenr.BaseRecorder,{afterInit:function(){var c=submitTicketForm;submitTicketForm=function(){Zendesk.Screenr.TicketRecorder._injectScreencasts(a("#ticket-chat"));c()};var d=submitRequestForm;submitRequestForm=function(){Zendesk.Screenr.TicketRecorder._injectScreencasts(a("#ticketform"));d()};a("#screenr_link").bind("click",function(){Zendesk.Instrumentation.ToTango.track("New Screencast in Ticket","Screenr")})},showScreencast:function(d){var e=a('<iframe frameborder="0"/>'),h=a('<div id="screencast_preview" />'),k=a('<div id="screencast_preview_wrapper" style="display:none"/>'),f=a('<div id="comment_wrapper" />'),c=a('<div id="video_wrapper" />'),j=a("#comment_for_screencasts_list").clone().show(),g;e.attr("src",d);e.attr("width",this.SCREENCAST_IFRAME_WIDTH);e.attr("height",this.SCREENCAST_IFRAME_HEIGHT);e.attr("style","width:"+this.SCREENCAST_IFRAME_WIDTH+"px;height:"+this.SCREENCAST_IFRAME_HEIGHT+"px;");e.appendTo(c);c.appendTo(h);if(j==null){g=this.COLORBOX_HEIGHT}else{g=this.COLORBOX_HEIGHT+this.COMMENT_HEIGHT;j.appendTo(f);f.appendTo(h)}h.appendTo(k);k.appendTo(a("body"));a.colorbox({inline:true,href:"#screencast_preview",width:this.COLORBOX_WIDTH+"px",height:g+"px",onClosed:function(){a("#screencast_preview_wrapper").remove()}})}})}(jQuery));(function(){function a(h,d){for(var k=[],g=h.split("/"),c,f,j=0;f=g[j++];){".."==f?k.pop():"."!=f&&k.push(f)}k=k.join("/"),j=a,f=j.m[d||0],c=f[k+".js"]||f[k+"/index.js"]||f[k];if(f=c.c){c=j.m[d=f][h=c.m]}return c.exports||c(c,c.exports={},function(e){return j("."!=e.charAt(0)?e:h+"/../"+e,d)}),c.exports}a.m=[];a.m[0]={"browser/array.js":function(f,d,e){var c=[];f.exports={write:function(g){c.push(g)},end:function(){},get:function(){return c},empty:function(){c=[]}}},"browser/console.js":function(e,c,d){var f=/\n+$/;e.exports={write:function(l){var h=Array.prototype.slice.call(arguments),g=h.length,k=h[h.length-1];if(typeof console==="undefined"||!console.log){return}if(k&&typeof k==="string"){h[h.length-1]=k.replace(f,"")}if(console.log.apply){return console.log.apply(console,h)}if(!JSON||!JSON.stringify){return}for(var j=0;j<g;j++){h[j]=JSON.stringify(h[j])}console.log(h.join(" "))},end:function(){}}},"browser/jquery_simple.js":function(e,c,d){function f(g){this.url=g.url||"http://localhost:8080/";this.cache=[];this.timer=null;this.interval=g.interval||30*1000;this.enabled=true;this.jQuery=window.jQuery;this.extras={}}f.prototype.write=function(g){if(!this.timer){this.init()}this.cache.push(g)};f.prototype.init=function(){if(!this.enabled||!this.jQuery){return}var g=this;this.timer=setTimeout(function(){if(g.cache.length==0){return g.init()}g.extras.logs=g.cache;g.jQuery.ajax(g.url,{type:"POST",cache:false,processData:false,data:JSON.stringify(g.extras),contentType:"application/json",timeout:10000}).success(function(j,h,k){if(j.interval){g.interval=Math.max(1000,j.interval)}}).error(function(){g.interval=30000}).always(function(){g.init()});g.cache=[]},this.interval)};f.prototype.end=function(){};f.jQueryWait=function(g){if(typeof window!=="undefined"&&(window.jQuery||window.$)){return g(window.jQuery||window.$)}else{if(typeof window!=="undefined"){setTimeout(function(){f.jQueryWait(g)},200)}}};e.exports=f},"index.js":function(d,h,g){var k=g("./minilog.js");k.format(function(o,q,e){var p=[];if(o){p.push(o)}if(q){p.push(q)}return p.concat(e).join(" ")+"\n"});var m=false,f=[],n={debug:1,info:2,warn:3,error:4};function c(e,q){var o,p;for(o=0;o<f.length;o++){p=f[o];if(p.topic&&p.topic.test(e)&&(p.level==n.debug||n[q]>=p.level)){return true}}return false}k.enable=function(s){if(!m){k.pipe(g("./browser/console.js")).filter(c)}m=true;f=[];if(!s){s="*.debug"}var r=s.split(/[\s,]+/),o,q;for(o=0;o<r.length;o++){q=r[o].split(".");if(q.length>2){q=[q.slice(0,-1).join("."),q.slice(-1).join()]}f.push({topic:new RegExp("^"+q[0].replace("*",".*")),level:n[q[1]]||1})}try{window.localStorage.minilogSettings=JSON.stringify(s)}catch(p){}};if(typeof window!="undefined"){try{k.enable(JSON.parse(window.localStorage.minilogSettings))}catch(l){}if(window.location&&window.location.search){var j=RegExp("[?&]minilog=([^&]*)").exec(window.location.search);j&&k.enable(decodeURIComponent(j[1]))}}h=d.exports=k;h.backends={browser:g("./browser/console.js"),array:g("./browser/array.js"),jquery:g("./browser/jquery_simple.js")}},"minilog.js":function(f,c,d){var h=[],g={readable:true},j={format:function(){return""}};g.on=g.addListener=function(k,l){h[k]||(h[k]=[]);h[k].unshift(l);return g};g.emit=function(m){if(!h[m]){return}var k=Array.prototype.slice.call(arguments,1);for(var l=h[m].length-1;l>=0;l--){h[m][l]&&h[m][l].apply(g,k)}};g.removeListener=g.removeAllListeners=function(l,m){if(!h[l]){return}if(!m){delete h[l];return}for(var k=h[l].length-1;k>=0;k--){if(h[l][k]==m){h[l].splice(k,1)}}};g.serialize=function(l){if(!JSON||!JSON.stringify){return l}var k=[];for(var m=0;m<l.length;m++){if(l[m]&&typeof l[m]=="object"){if(l[m].constructor&&l[m].constructor.isBuffer){k[m]=l[m].toString()}else{k[m]=JSON.stringify(l[m])}}else{k[m]=l[m]}}return k};c=f.exports=function e(k){var l=function(){g.emit("item",k,undefined,Array.prototype.slice.call(arguments));return l};l.debug=function(){g.emit("item",k,"debug",Array.prototype.slice.call(arguments));return l};l.info=function(){g.emit("item",k,"info",Array.prototype.slice.call(arguments));return l};l.warn=function(){g.emit("item",k,"warn",Array.prototype.slice.call(arguments));return l};l.error=function(){g.emit("item",k,"error",Array.prototype.slice.call(arguments));return l};return l};c.format=function(k){j.format=k};c.pipe=function(l){var k={};if(l._isFormatted){g.on("item",function(o,p,n){if(k.filter&&!k.filter(o,p,n)){return}l.write((k.format?k:l).format(o,p,n))})}else{g.on("item",function(o,p,n){if(k.filter&&!k.filter(o,p,n)){return}l.write((k.format?k:j).format(o,p,g.serialize(n)))})}g.on("end",function(){!l._isStdio&&l.end()});var m={filter:function(n){k.filter=n;return m},format:function(n){k.format=n;return m},pipe:c.pipe};return m};c.end=function(){g.emit("end");h=[]}},window:{exports:window}};Minilog=a("index.js")}());(function(){var g=new Minilog.backends.jquery({interval:10000,url:"/node/log"}),c=(function(){var k=6,j=Math.pow(36,k-1),h=Math.pow(36,k);return Math.floor(Math.random()*(h-j)+j).toString(36)}()),a="",e=0,f=0;function d(){if(typeof Zendesk!=="undefined"){if(Zendesk.currentAccount&&Zendesk.currentAccount.subdomain){a=Zendesk.currentAccount.subdomain}if(Zendesk.currentUser&&Zendesk.currentUser.id){e=Zendesk.currentUser.id;f=Zendesk.currentUser.role}}if(typeof RadarClient!=="undefined"&&RadarClient._me){if(!a&&RadarClient._me.accountName){a=RadarClient._me.accountName}if(!e&&RadarClient._me.userId){e=RadarClient._me.userId}if(RadarClient._me.userType){f=RadarClient._me.userType}}g.extras.account=a;g.extras.user=e;g.extras.userType=f}g.enabled=false;g.extras.cid=c;Minilog.pipe(g).filter(function(j,l,h){if(l==="debug"){return false}if(!h){h=[]}var k=h[0];return h.length==1&&k&&k===Object(k)}).format(function(j,l,h){var k=h[0];k.t=(new Date()).valueOf();return[j,l,k]});Minilog.enableBlackbox=function(){g.enabled=true;Minilog("radar").info("Logging enabled")};setTimeout(function(){Minilog.backends.jquery.jQueryWait(function(h){g.jQuery=h;if(typeof navigator!=="undefined"&&navigator.userAgent){Minilog("radar").info("user agent: "+navigator.userAgent)}d();if(typeof LOTUS_ENV!=="undefined"){return}if(typeof Zendesk!=="undefined"&&Zendesk.currentAccount&&typeof Zendesk.currentAccount.clientSideLogging=="boolean"){g.enabled=Zendesk.currentAccount.clientSideLogging;return}h.getJSON("/api/v2/account.json",{include:"deployments,subscription"},function(j){if(j&&j.deployments&&j.deployments.client_side_logging){Minilog.enableBlackbox()}})})},100)}());(function(a){"undefined"==typeof a.fn.each2&&a.fn.extend({each2:function(f){for(var d=a([0]),c=-1,e=this.length;++c<e&&(d.context=d[0]=this[c])&&!1!==f.call(d[0],c,d);){}return this}})})(jQuery);(function(U,S){function R(f,e){var m=0,l=e.length,g;if("undefined"===typeof f){return -1}if(f.constructor===String){for(;m<l;m+=1){if(0===f.localeCompare(e[m])){return m}}}else{for(;m<l;m+=1){if(g=e[m],g.constructor===String){if(0===g.localeCompare(f)){return m}}else{if(g===f){return m}}}}return -1}function P(f,e){return f===e?!0:f===S||e===S||null===f||null===e?!1:f.constructor===String?0===f.localeCompare(e):e.constructor===String?0===e.localeCompare(f):!1}function J(f,e){var m,l,g;if(null===f||1>f.length){return[]}m=f.split(e);l=0;for(g=m.length;l<g;l+=1){m[l]=U.trim(m[l])}return m}function O(f,e,l){var l=l||S,g;return function(){var m=arguments;window.clearTimeout(g);g=window.setTimeout(function(){e.apply(l,m)},f)}}function Q(e){e.preventDefault();e.stopPropagation()}function N(f,e,l){var g=f.toUpperCase().indexOf(e.toUpperCase()),e=e.length;0>g?l.push(f):(l.push(f.substring(0,g)),l.push("<span class='select2-match'>"),l.push(f.substring(g,g+e)),l.push("</span>"),l.push(f.substring(g+e,f.length)))}function L(f){var e,m=0,l=null,g=f.quietMillis||100;return function(q){window.clearTimeout(e);e=window.setTimeout(function(){var s=m+=1,u=f.data,y=f.transport||U.ajax,w=f.traditional||!1,v=f.type||"GET",u=u.call(this,q.term,q.page,q.context);null!==l&&l.abort();l=y.call(null,{url:f.url,dataType:f.dataType,data:u,type:v,traditional:w,success:function(z){s<m||(z=f.results(z,q.page),q.callback(z))}})},g)}}function K(f){var e=f,l,g=function(m){return""+m.text};U.isArray(e)||(g=e.text,U.isFunction(g)||(l=e.text,g=function(m){return m[l]}),e=e.results);return function(m){var u=m.term,s={results:[]},q;if(u===""){m.callback({results:e})}else{q=function(v,z){var y,w,v=v[0];if(v.children){y={};for(w in v){v.hasOwnProperty(w)&&(y[w]=v[w])}y.children=[];U(v.children).each2(function(B,A){q(A,y.children)});y.children.length&&z.push(y)}else{m.matcher(u,g(v))&&z.push(v)}};U(e).each2(function(w,v){q(v,s.results)});m.callback(s)}}}function t(e){return U.isFunction(e)?e:function(f){var l=f.term,g={results:[]};U(e).each(function(){var m=this.text!==S,q=m?this.text:this;if(""===l||f.matcher(l,q)){g.results.push(m?this:{id:this,text:this})}});f.callback(g)}}function r(e){if(U.isFunction(e)){return !0}if(!e){return !1}throw Error("formatterName must be a function or a falsy value")}function o(e){return U.isFunction(e)?e():e}function p(f){var e=0;U.each(f,function(g,l){l.children?e+=p(l.children):e++});return e}function k(z,y,w,v){var u=z,q=!1,s,m,l,g;if(!v.createSearchChoice||!v.tokenSeparators||1>v.tokenSeparators.length){return S}for(;;){q=-1;m=0;for(l=v.tokenSeparators.length;m<l&&!(g=v.tokenSeparators[m],q=z.indexOf(g),0<=q);m++){}if(0>q){break}s=z.substring(0,q);z=z.substring(q+g.length);if(0<s.length&&(s=v.createSearchChoice(s,y),s!==S&&null!==s&&v.id(s)!==S&&null!==v.id(s))){q=!1;m=0;for(l=y.length;m<l;m++){if(P(v.id(s),v.id(y[m]))){q=!0;break}}q||w(s)}}if(0!=u.localeCompare(z)){return z}}function h(f,e){var g=function(){};g.prototype=new f;g.prototype.constructor=g;g.prototype.parent=f.prototype;g.prototype=U.extend(g.prototype,e);return g}if(window.Select2===S){var T,j,c,a,n,M;T={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case T.LEFT:case T.RIGHT:case T.UP:case T.DOWN:return !0}return !1},isControl:function(e){switch(e.which){case T.SHIFT:case T.CTRL:case T.ALT:return !0}return e.metaKey?!0:!1},isFunctionKey:function(e){e=e.which?e.which:e;return 112<=e&&123>=e}};var d=1;n=function(){return d++};U(document).delegate("body","mousemove",function(e){U.data(document,"select2-lastpos",{x:e.pageX,y:e.pageY})});U(document).ready(function(){U(document).delegate("body","mousedown touchend",function(f){var e=U(f.target).closest("div.select2-container").get(0),g;e?U(document).find("div.select2-container-active").each(function(){this!==e&&U(this).data("select2").blur()}):(e=U(f.target).closest("div.select2-drop").get(0),U(document).find("div.select2-drop-active").each(function(){this!==e&&U(this).data("select2").blur()}));e=U(f.target);g=e.attr("for");"LABEL"===f.target.tagName&&(g&&0<g.length)&&(e=U("#"+g),e=e.data("select2"),e!==S&&(e.focus(),f.preventDefault()))})});j=h(Object,{bind:function(f){var e=this;return function(){f.apply(e,arguments)}},init:function(g){var e,u;this.opts=g=this.prepareOpts(g);this.id=g.id;g.element.data("select2")!==S&&null!==g.element.data("select2")&&this.destroy();this.enabled=!0;this.container=this.createContainer();this.containerId="s2id_"+(g.element.attr("id")||"autogen"+n());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);var s=!1,l;this.body=function(){!1===s&&(l=g.element.closest("body"),s=!0);return l};g.element.attr("class")!==S&&this.container.addClass(g.element.attr("class").replace(/validate\[[\S ]+] ?/,""));this.container.css(o(g.containerCss));this.container.addClass(o(g.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(o(g.dropdownCssClass));this.dropdown.data("select2",this);this.results=e=this.container.find(".select2-results");this.search=u=this.container.find("input.select2-input");u.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();this.results.bind("mousemove",function(v){var f=U.data(document,"select2-lastpos");(f===S||f.x!==v.pageX||f.y!==v.pageY)&&U(v.target).trigger("mousemove-filtered",v)});this.dropdown.delegate(".select2-results","mousemove-filtered",this.bind(this.highlightUnderEvent));var m=this.results,q=O(80,function(f){m.trigger("scroll-debounced",f)});m.bind("scroll",function(f){0<=R(f.target,m.get())&&q(f)});this.dropdown.delegate(".select2-results","scroll-debounced",this.bind(this.loadMoreIfNeeded));U.fn.mousewheel&&e.mousewheel(function(f,y,w,v){y=e.scrollTop();0<v&&0>=y-v?(e.scrollTop(0),Q(f)):0>v&&e.get(0).scrollHeight-e.scrollTop()+v<=e.height()&&(e.scrollTop(e.get(0).scrollHeight-e.height()),Q(f))});u.bind("keydown",function(){U.data(u,"keyup-change-value")===S&&U.data(u,"keyup-change-value",u.val())});u.bind("keyup",function(){var f=U.data(u,"keyup-change-value");f!==S&&u.val()!==f&&(U.removeData(u,"keyup-change-value"),u.trigger("keyup-change"))});u.bind("keyup-change",this.bind(this.updateResults));u.bind("focus",function(){u.addClass("select2-focused");" "===u.val()&&u.val("")});u.bind("blur",function(){u.removeClass("select2-focused")});this.dropdown.delegate(".select2-results","mouseup",this.bind(function(f){0<U(f.target).closest(".select2-result-selectable:not(.select2-disabled)").length?(this.highlightUnderEvent(f),this.selectHighlighted(f)):this.focusSearch();Q(f)}));this.dropdown.bind("click mouseup mousedown",function(f){f.stopPropagation()});U.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource());(g.element.is(":disabled")||g.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==S&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(f){var e,l,g;e=f.element;"select"===e.get(0).tagName.toLowerCase()&&(this.select=l=f.element);l&&U.each("id multiple ajax query createSearchChoice initSelection data tags".split(" "),function(){if(this in f){throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}});f=U.extend({},{populateResults:function(m,w,u){var q,v=this.opts.id,s=this;q=function(H,G,D){var F,C,E,B,y,A,z;F=0;for(C=H.length;F<C;F=F+1){E=H[F];B=v(E)!==S;y=E.children&&E.children.length>0;A=U("<li></li>");A.addClass("select2-results-dept-"+D);A.addClass("select2-result");A.addClass(B?"select2-result-selectable":"select2-result-unselectable");y&&A.addClass("select2-result-with-children");A.addClass(s.opts.formatResultCssClass(E));B=U("<div></div>");B.addClass("select2-result-label");z=f.formatResult(E,B,u);z!==S&&B.html(s.opts.escapeMarkup(z));A.append(B);if(y){y=U("<ul></ul>");y.addClass("select2-result-sub");q(E.children,y,D+1);A.append(y)}A.data("select2-data",E);G.append(A)}};q(w,m,0)}},U.fn.select2.defaults,f);"function"!==typeof f.id&&(g=f.id,f.id=function(m){return m[g]});if(l){f.query=this.bind(function(m){var w={results:[],more:false},u=m.term,q,v,s;s=function(y,A){var z;if(y.is("option")){m.matcher(u,y.text(),y)&&A.push({id:y.attr("value"),text:y.text(),element:y.get(),css:y.attr("class")})}else{if(y.is("optgroup")){z={text:y.attr("label"),children:[],element:y.get(),css:y.attr("class")};y.children().each2(function(C,B){s(B,z.children)});z.children.length>0&&A.push(z)}}};q=e.children();if(this.getPlaceholder()!==S&&q.length>0){v=q[0];U(v).text()===""&&(q=q.not(v))}q.each2(function(z,y){s(y,w.results)});m.callback(w)}),f.id=function(m){return m.id},f.formatResultCssClass=function(m){return m.css}}else{if(!("query" in f)){if("ajax" in f){if((l=f.element.data("ajax-url"))&&0<l.length){f.ajax.url=l}f.query=L(f.ajax)}else{"data" in f?f.query=K(f.data):"tags" in f&&(f.query=t(f.tags),f.createSearchChoice=function(m){return{id:m,text:m}},f.initSelection=function(m,s){var q=[];U(J(m.val(),f.separator)).each(function(){var u=this,w=this,v=f.tags;U.isFunction(v)&&(v=v());U(v).each(function(){if(P(this.id,u)){w=this.text;return false}});q.push({id:u,text:w})});s(q)})}}}if("function"!==typeof f.query){throw"query function not defined for Select2 "+f.element.attr("id")}return f},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()}))},triggerChange:function(e){e=e||{};e=U.extend({},e,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",!0);this.opts.element.trigger(e);this.opts.element.data("select2-change-triggered",!1);this.opts.element.click();this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var y=this.container.offset(),w=this.container.outerHeight(),v=this.container.outerWidth(),u=this.dropdown.outerHeight(),m=U(window).scrollTop()+document.documentElement.clientHeight,w=y.top+w,s=y.left,m=w+u<=m,q=y.top-u>=this.body().scrollTop(),l=this.dropdown.hasClass("select2-drop-above"),e;"static"!==this.body().css("position")&&(e=this.body().offset(),w-=e.top,s-=e.left);l?(l=!0,!q&&m&&(l=!1)):(l=!1,!m&&q&&(l=!0));l?(w=y.top-u,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above"));y=U.extend({top:w,left:s,width:v},o(this.opts.dropdownCss));this.dropdown.css(y)},shouldOpen:function(){var e;if(this.opened()){return !1}e=U.Event("open");this.opts.element.trigger(e);return !e.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return !1}window.setTimeout(this.bind(this.opening),1);return !0},opening:function(){var f=this.containerId,e=this.containerSelector,l="scroll."+f,g="resize."+f;this.container.parents().each(function(){U(this).bind(l,function(){var m=U(e);0==m.length&&U(this).unbind(l);m.select2("close")})});U(window).bind(g,function(){var m=U(e);0==m.length&&U(window).unbind(g);m.select2("close")});this.clearDropdownAlignmentPreference();" "===this.search.val()&&this.search.val("");this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(!0);this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body());this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(this.opened()){var e=this;this.container.parents().each(function(){U(this).unbind("scroll."+e.containerId)});U(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(U.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var g=this.results,e,q,m,l;q=this.highlight();0>q||(0==q?g.scrollTop(0):(e=g.find(".select2-result-selectable"),m=U(e[q]),l=m.offset().top+m.outerHeight(),q===e.length-1&&(e=g.find("li.select2-more-results"),0<e.length&&(l=e.offset().top+e.outerHeight())),e=g.offset().top+g.outerHeight(),l>e&&g.scrollTop(g.scrollTop()+(l-e)),m=m.offset().top-g.offset().top,0>m&&g.scrollTop(g.scrollTop()+m)))},moveHighlight:function(f){for(var e=this.results.find(".select2-result-selectable"),l=this.highlight();-1<l&&l<e.length;){var l=l+f,g=U(e[l]);if(g.hasClass("select2-result-selectable")&&!g.hasClass("select2-disabled")){this.highlight(l);break}}},highlight:function(f){var e=this.results.find(".select2-result-selectable").not(".select2-disabled");if(0===arguments.length){return R(e.filter(".select2-highlighted")[0],e.get())}f>=e.length&&(f=e.length-1);0>f&&(f=0);e.removeClass("select2-highlighted");U(e[f]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(f){f=U(f.target).closest(".select2-result-selectable");if(0<f.length&&!f.is(".select2-highlighted")){var e=this.results.find(".select2-result-selectable");this.highlight(e.index(f))}else{0==f.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var m=this.results,l=m.find("li.select2-more-results"),w,v=this.resultsPage+1,u=this,s=this.search.val(),q=this.context;0!==l.length&&(w=l.offset().top-m.offset().top-m.height(),0>=w&&(l.addClass("select2-active"),this.opts.query({term:s,page:v,context:q,matcher:this.opts.matcher,callback:this.bind(function(e){u.opened()&&(u.opts.populateResults.call(this,m,e.results,{term:s,page:v,context:q}),!0===e.more?(l.detach().appendTo(m).text(u.opts.formatLoadMore(v+1)),window.setTimeout(function(){u.loadMoreIfNeeded()},10)):l.remove(),u.positionDropdown(),u.resultsPage=v)})})))},tokenize:function(){},updateResults:function(g){function e(){s.scrollTop(0);u.removeClass("select2-active");l.positionDropdown()}function v(f){s.html(l.opts.escapeMarkup(f));e()}var u=this.search,s=this.results,q=this.opts,m,l=this;if(!(!0!==g&&(!1===this.showSearchInput||!this.opened()))){u.addClass("select2-active");if(1<=q.maximumSelectionSize&&(m=this.data(),U.isArray(m)&&m.length>=q.maximumSelectionSize&&r(q.formatSelectionTooBig,"formatSelectionTooBig"))){v("<li class='select2-selection-limit'>"+q.formatSelectionTooBig(q.maximumSelectionSize)+"</li>");return}u.val().length<q.minimumInputLength&&r(q.formatInputTooShort,"formatInputTooShort")?v("<li class='select2-no-results'>"+q.formatInputTooShort(u.val(),q.minimumInputLength)+"</li>"):(v("<li class='select2-searching'>"+q.formatSearching()+"</li>"),m=this.tokenize(),m!=S&&null!=m&&u.val(m),this.resultsPage=1,q.query({term:u.val(),page:this.resultsPage,context:null,matcher:q.matcher,callback:this.bind(function(w){var f;this.opened()&&((this.context=w.context===S?null:w.context,this.opts.createSearchChoice&&""!==u.val()&&(f=this.opts.createSearchChoice.call(null,u.val(),w.results),f!==S&&null!==f&&l.id(f)!==S&&null!==l.id(f)&&0===U(w.results).filter(function(){return P(l.id(this),l.id(f))}).length&&w.results.unshift(f)),0===w.results.length&&r(q.formatNoMatches,"formatNoMatches"))?v("<li class='select2-no-results'>"+q.formatNoMatches(u.val())+"</li>"):(s.empty(),l.opts.populateResults.call(this,s,w.results,{term:u.val(),page:this.resultsPage,context:null}),!0===w.more&&r(q.formatLoadMore,"formatLoadMore")&&(s.append("<li class='select2-more-results'>"+l.opts.escapeMarkup(q.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){l.loadMoreIfNeeded()},10)),this.postprocessResults(w,g),e()))})}))}},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");this.search[0]===document.activeElement&&this.search.blur();this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var f=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),g=e.closest(".select2-result-selectable").data("select2-data");g&&(e.addClass("select2-disabled"),this.highlight(f),this.onSelect(g))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){var e=function(){var g,q,m,l;if("off"===this.opts.width){return null}if("element"===this.opts.width){return 0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"}if("copy"===this.opts.width||"resolve"===this.opts.width){g=this.opts.element.attr("style");if(g!==S){g=g.split(";");m=0;for(l=g.length;m<l;m+=1){if(q=g[m].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==q&&1<=q.length){return q[1]}}}return"resolve"===this.opts.width?(g=this.opts.element.css("width"),0<g.indexOf("%")?g:0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"):null}return U.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==e&&this.container.attr("style","width: "+e)}});c=h(j,{createContainer:function(){return U("<div></div>",{"class":"select2-container"}).html("    <a href='#' onclick='return false;' class='select2-choice'>   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>   <div><b></b></div></a>    <div class='select2-drop select2-offscreen'>   <div class='select2-search'>       <input type='text' autocomplete='off' class='select2-input'/>   </div>   <ul class='select2-results'>   </ul></div>")},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var f,e=this.dropdown;this.selection=f=this.container.find(".select2-choice");this.search.bind("keydown",this.bind(function(g){if(this.enabled){if(g.which===T.PAGE_UP||g.which===T.PAGE_DOWN){Q(g)}else{if(this.opened()){switch(g.which){case T.UP:case T.DOWN:this.moveHighlight(g.which===T.UP?-1:1);Q(g);break;case T.TAB:case T.ENTER:this.selectHighlighted();Q(g);break;case T.ESC:this.cancel(g),Q(g)}}else{g.which===T.TAB||T.isControl(g)||T.isFunctionKey(g)||g.which===T.ESC||!1===this.opts.openOnEnter&&g.which===T.ENTER||this.open()}}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("mousedown",this.bind(function(){this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open()}));e.bind("mousedown",this.bind(function(){this.search.focus()}));f.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));f.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));f.bind("keydown",this.bind(function(l){if(this.enabled){if(l.which===T.PAGE_UP||l.which===T.PAGE_DOWN){Q(l)}else{if(!(l.which===T.TAB||T.isControl(l)||T.isFunctionKey(l)||l.which===T.ESC)&&!(!1===this.opts.openOnEnter&&l.which===T.ENTER)){if(l.which==T.DELETE){this.opts.allowClear&&this.clear()}else{this.open();if(l.which!==T.ENTER&&!(48>l.which)){var g=String.fromCharCode(l.which).toLowerCase();l.shiftKey&&(g=g.toUpperCase());this.search.focus();this.search.val(g)}Q(l)}}}}}));f.delegate("abbr","mousedown",this.bind(function(g){this.enabled&&(this.clear(),Q(g),this.close(),this.triggerChange(),this.selection.focus())}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()){this.close(),this.setPlaceholder()}else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){f!==S&&null!==f&&(e.updateSelection(f),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,l){var g=f.find(":selected");U.isFunction(l)&&l({id:g.attr("value"),text:g.text()})});return e},setPlaceholder:function(){var e=this.getPlaceholder();""===this.opts.element.val()&&e!==S&&!(this.select&&""!==this.select.find("option:first").text())&&(this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide())},postprocessResults:function(g,e){var q=0,m=this,l=!0;this.results.find(".select2-result-selectable").each2(function(s,f){if(P(m.id(f.data("select2-data")),m.opts.element.val())){return q=s,!1}});this.highlight(q);!0===e&&(l=this.showSearchInput=p(g.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[l?"removeClass":"addClass"]("select2-search-hidden"),U(this.dropdown,this.container)[l?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(f){var e=this.opts.element.val();this.opts.element.val(this.id(f));this.updateSelection(f);this.close();this.selection.focus();P(e,this.id(f))||this.triggerChange()},updateSelection:function(f){var e=this.selection.find("span");this.selection.data("select2-data",f);e.empty();f=this.opts.formatSelection(f,e);f!==S&&e.append(this.opts.escapeMarkup(f));this.selection.removeClass("select2-default");this.opts.allowClear&&this.getPlaceholder()!==S&&this.selection.find("abbr").show()},val:function(){var f,e=null,g=this;if(0===arguments.length){return this.opts.element.val()}f=arguments[0];if(this.select){this.select.val(f).find(":selected").each2(function(l,m){e={id:m.attr("value"),text:m.text()};return !1}),this.updateSelection(e),this.setPlaceholder()}else{if(this.opts.initSelection===S){throw Error("cannot call val() if initSelection() is not defined")}f?(this.opts.element.val(f),this.opts.initSelection(this.opts.element,function(l){g.opts.element.val(!l?"":g.id(l));g.updateSelection(l);g.setPlaceholder()})):this.clear()}},clearSearch:function(){this.search.val("")},data:function(f){var e;if(0===arguments.length){return e=this.selection.data("select2-data"),e==S&&(e=null),e}!f||""===f?this.clear():(this.opts.element.val(!f?"":this.id(f)),this.updateSelection(f))}});a=h(j,{createContainer:function(){return U("<div></div>",{"class":"select2-container select2-container-multi"}).html("    <ul class='select2-choices'>  <li class='select2-search-field'>    <input type='text' autocomplete='off' class='select2-input'>  </li></ul><div class='select2-drop select2-drop-multi' style='display:none;'>   <ul class='select2-results'>   </ul></div>")},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(f,l){var g=[];f.find(":selected").each2(function(q,m){g.push({id:m.attr("value"),text:m.text()})});U.isFunction(l)&&l(g)});return e},initContainer:function(){var e;this.searchContainer=this.container.find(".select2-search-field");this.selection=e=this.container.find(".select2-choices");this.search.bind("keydown",this.bind(function(f){if(this.enabled){if(f.which===T.BACKSPACE&&""===this.search.val()){this.close();var g;g=e.find(".select2-search-choice-focus");if(0<g.length){this.unselect(g.first());this.search.width(10);Q(f);return}g=e.find(".select2-search-choice");0<g.length&&g.last().addClass("select2-search-choice-focus")}else{e.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(f.which){case T.UP:case T.DOWN:this.moveHighlight(f.which===T.UP?-1:1);Q(f);return;case T.ENTER:case T.TAB:this.selectHighlighted();Q(f);return;case T.ESC:this.cancel(f);Q(f);return}}if(!(f.which===T.TAB||T.isControl(f)||T.isFunctionKey(f)||f.which===T.BACKSPACE||f.which===T.ESC)&&!(!1===this.opts.openOnEnter&&f.which===T.ENTER)){this.open(),(f.which===T.PAGE_UP||f.which===T.PAGE_DOWN)&&Q(f)}}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(f){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();f.stopImmediatePropagation()}));this.container.delegate(".select2-choices","mousedown",this.bind(function(f){this.enabled&&!(0<U(f.target).closest(".select2-search-choice").length)&&(this.clearPlaceholder(),this.open(),this.focusSearch(),f.preventDefault())}));this.container.delegate(".select2-choices","focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}));this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){""===this.opts.element.val()&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(f){if(f!==S&&f!==null){e.updateSelection(f);e.close();e.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();e!==S&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(f){var e=[],l=[],g=this;U(f).each(function(){0>R(g.id(this),e)&&(e.push(g.id(this)),l.push(this))});f=l;this.selection.find(".select2-search-choice").remove();U(f).each(function(){g.addSelectedChoice(this)});g.postprocessResults()},tokenize:function(){var e=this.search.val(),e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts);null!=e&&e!=S&&(this.search.val(e),0<e.length&&this.open())},onSelect:function(e){this.addSelectedChoice(e);this.select&&this.postprocessResults();this.opts.closeOnSelect?(this.close(),this.search.width(10)):0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close();this.triggerChange({added:e});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(g){var e=U("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),q=this.id(g),m=this.getVal(),l;l=this.opts.formatSelection(g,e);e.find("div").replaceWith("<div>"+this.opts.escapeMarkup(l)+"</div>");e.find(".select2-search-choice-close").bind("mousedown",Q).bind("click dblclick",this.bind(function(f){this.enabled&&(U(f.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(U(f.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue(),Q(f))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}));e.data("select2-data",g);e.insertBefore(this.searchContainer);m.push(q);this.setVal(m)},unselect:function(f){var e=this.getVal(),l,g,f=f.closest(".select2-search-choice");if(0===f.length){throw"Invalid argument: "+f+". Must be .select2-search-choice"}l=f.data("select2-data");g=R(this.id(l),e);0<=g&&(e.splice(g,1),this.setVal(e),this.select&&this.postprocessResults());f.remove();this.triggerChange({removed:l})},postprocessResults:function(){var f=this.getVal(),e=this.results.find(".select2-result-selectable"),l=this.results.find(".select2-result-with-children"),g=this;e.each2(function(m,s){var q=g.id(s.data("select2-data"));0<=R(q,f)?s.addClass("select2-disabled").removeClass("select2-result-selectable"):s.removeClass("select2-disabled").addClass("select2-result-selectable")});l.each2(function(q,m){0==m.find(".select2-result-selectable").length?m.addClass("select2-disabled"):m.removeClass("select2-disabled")});e.each2(function(q,m){if(!m.hasClass("select2-disabled")&&m.hasClass("select2-result-selectable")){return g.highlight(0),!1}})},resizeSearch:function(){var g,e,q,m,l=this.search.outerWidth()-this.search.width();g=this.search;M||(q=g[0].currentStyle||window.getComputedStyle(g[0],null),M=U("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:q.fontSize,fontFamily:q.fontFamily,fontStyle:q.fontStyle,fontWeight:q.fontWeight,letterSpacing:q.letterSpacing,textTransform:q.textTransform,whiteSpace:"nowrap"}),U("body").append(M));M.text(g.val());g=M.width()+10;e=this.search.offset().left;q=this.selection.width();m=this.selection.offset().left;e=q-(e-m)-l;e<g&&(e=q-l);40>e&&(e=q-l);this.search.width(e)},getVal:function(){var e;if(this.select){return e=this.select.val(),null===e?[]:e}e=this.opts.element.val();return J(e,this.opts.separator)},setVal:function(f){var e;this.select?this.select.val(f):(e=[],U(f).each(function(){0>R(this,e)&&e.push(this)}),this.opts.element.val(0===e.length?"":e.join(this.opts.separator)))},val:function(){var f,e=[],g=this;if(0===arguments.length){return this.getVal()}if(f=arguments[0]){if(this.setVal(f),this.select){this.select.find(":selected").each(function(){e.push({id:U(this).attr("value"),text:U(this).text()})}),this.updateSelection(e)}else{if(this.opts.initSelection===S){throw Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(m){var l=U(m).map(g.id);g.setVal(l);g.updateSelection(m);g.clearSearch()})}}else{this.opts.element.val(""),this.updateSelection([])}this.clearSearch()},onSortStart:function(){if(this.select){throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var f=[],e=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){f.push(e.opts.id(U(this).data("select2-data")))});this.setVal(f);this.triggerChange()},data:function(f){var e=this,g;if(0===arguments.length){return this.selection.find(".select2-search-choice").map(function(){return U(this).data("select2-data")}).get()}f||(f=[]);g=U.map(f,function(l){return e.opts.id(l)});this.setVal(g);this.updateSelection(f);this.clearSearch()}});U.fn.select2=function(){var g=Array.prototype.slice.call(arguments,0),e,s,q,m,l="val destroy opened open close focus isFocused container onSortStart onSortEnd enable disable positionDropdown data".split(" ");this.each(function(){if(0===g.length||"object"===typeof g[0]){e=0===g.length?{}:U.extend({},g[0]),e.element=U(this),"select"===e.element.get(0).tagName.toLowerCase()?m=e.element.attr("multiple"):(m=e.multiple||!1,"tags" in e&&(e.multiple=m=!0)),s=m?new a:new c,s.init(e)}else{if("string"===typeof g[0]){if(0>R(g[0],l)){throw"Unknown method: "+g[0]}q=S;s=U(this).data("select2");if(s!==S&&(q="container"===g[0]?s.container:s[g[0]].apply(s,g.slice(1)),q!==S)){return !1}}else{throw"Invalid arguments to select2 plugin: "+g}}});return q===S?this:q};U.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(f,e,g){e=[];N(f.text,g.term,e);return e.join("")},formatSelection:function(e){return e?e.text:S},formatResultCssClass:function(){return S},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(f,e){return"Please enter "+(e-f.length)+" more characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(f,e){return 0<=e.toUpperCase().indexOf(f.toUpperCase())},separator:",",tokenSeparators:[],tokenizer:k,escapeMarkup:function(e){return e&&"string"===typeof e?e.replace(/&/g,"&amp;"):e},blurOnChange:!1};window.Select2={query:{ajax:L,local:K,tags:t},util:{debounce:O,markMatch:N},"class":{"abstract":j,single:c,multi:a}}}})(jQuery);var XRegExp;XRegExp=XRegExp||function(K){function D(e,c,d){var a;for(a in F.prototype){F.prototype.hasOwnProperty(a)&&(e[a]=F.prototype[a])}return e.xregexp={captureNames:c,isNative:!!d},e}function P(a){return(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":"")}function J(e,c,a){if(!F.isRegExp(e)){throw new TypeError("type RegExp expected")}var d=N.replace.call(P(e)+(c||""),O,"");return a&&(d=N.replace.call(d,new RegExp("["+a+"]+","g"),"")),e=e.xregexp&&!e.xregexp.isNative?D(F(e.source,d),e.xregexp.captureNames?e.xregexp.captureNames.slice(0):null):D(new RegExp(e.source,d),null,!0)}function W(d,c){var a=d.length;if(Array.prototype.lastIndexOf){return d.lastIndexOf(c)}while(a--){if(d[a]===c){return a}}return -1}function G(c,a){return Object.prototype.toString.call(c).toLowerCase()==="[object "+a+"]"}function S(a){return a=a||{},a==="all"||a.all?a={natives:!0,extensibility:!0}:G(a,"string")&&(a=F.forEach(a,/[^\s,]+/,function(c){this[c]=!0},{})),a}function A(c,r,d,p){var a=I.length,v=null,l,k;B=!0;try{while(a--){if(k=I[a],(k.scope==="all"||k.scope===d)&&(!k.trigger||k.trigger.call(p))&&(k.pattern.lastIndex=r,l=H.exec.call(k.pattern,c),l&&l.index===r)){v={output:k.handler.call(p,l,d),match:l};break}}}catch(g){throw g}finally{B=!1}return v}function V(a){F.addToken=T[a?"on":"off"],Q.extensibility=a}function j(a){RegExp.prototype.exec=(a?H:N).exec,RegExp.prototype.test=(a?H:N).test,String.prototype.match=(a?H:N).match,String.prototype.replace=(a?H:N).replace,String.prototype.split=(a?H:N).split,Q.natives=a}var F,T,E,Q={natives:!1,extensibility:!1},N={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},H={},M={},I=[],R="default",z="class",q={"default":/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/,"class":/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/},U=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,O=/([\s\S])(?=[\s\S]*\1)/g,X=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,m=N.exec.call(/()??/,"")[1]===K,L=RegExp.prototype.sticky!==K,B=!1,C="gim"+(L?"y":"");return F=function(d,t){if(F.isRegExp(d)){if(t!==K){throw new TypeError("can't supply flags when constructing one RegExp from another")}return J(d)}if(B){throw new Error("can't call the XRegExp constructor within token definition functions")}var g=[],o=R,n={hasNamedCapture:!1,captureNames:[],hasFlag:function(a){return t.indexOf(a)>-1}},h=0,k,v,e;if(d=d===K?"":String(d),t=t===K?"":String(t),N.match.call(t,O)){throw new SyntaxError("invalid duplicate regular expression flag")}for(d=N.replace.call(d,/^\(\?([\w$]+)\)/,function(c,a){if(N.test.call(/[gy]/,a)){throw new SyntaxError("can't use flag g or y in mode modifier")}return t=N.replace.call(t+a,O,""),""}),F.forEach(t,/[\s\S]/,function(a){if(C.indexOf(a[0])<0){throw new SyntaxError("invalid regular expression flag "+a[0])}});h<d.length;){k=A(d,h,o,n),k?(g.push(k.output),h+=k.match[0].length||1):(v=N.exec.call(q[o],d.slice(h)),v?(g.push(v[0]),h+=v[0].length):(e=d.charAt(h),e==="["?o=z:e==="]"&&(o=R),g.push(e),++h))}return D(new RegExp(g.join(""),N.replace.call(t,/[^gimy]+/g,"")),n.hasNamedCapture?n.captureNames:null)},T={on:function(d,a,c){c=c||{},d&&I.push({pattern:J(d,"g"+(L?"y":"")),handler:a,scope:c.scope||R,trigger:c.trigger||null}),c.customFlags&&(C=N.replace.call(C+c.customFlags,O,""))},off:function(){throw new Error("extensibility must be installed before using addToken")}},F.addToken=T.off,F.cache=function(d,a){var c=d+"/"+(a||"");return M[c]||(M[c]=F(d,a))},F.escape=function(a){return N.replace.call(a,/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},F.exec=function(k,d,c,a){var h=J(d,"g"+(a&&L?"y":""),a===!1?"y":""),g;return h.lastIndex=c=c||0,g=H.exec.call(h,k),a&&g&&g.index!==c&&(g=null),d.global&&(d.lastIndex=g?h.lastIndex:0),g},F.forEach=function(l,c,d,a){for(var h=0,k=-1,g;g=F.exec(l,c,h);){d.call(a,g,++k,l,c),h=g.index+(g[0].length||1)}return a},F.globalize=function(a){return J(a,"g")},F.install=function(a){a=S(a),!Q.natives&&a.natives&&j(!0),!Q.extensibility&&a.extensibility&&V(!0)},F.isInstalled=function(a){return !!Q[a]},F.isRegExp=function(a){return G(a,"regexp")},F.matchChain=function(d,a){return function c(r,g){for(var p=a[g].regex?a[g]:{regex:a[g]},k=[],h=function(e){k.push(p.backref?e[p.backref]||"":e[0])},l=0;l<r.length;++l){F.forEach(r[l],p.regex,h)}return g===a.length-1||!k.length?k:c(k,g+1)}([d],0)},F.replace=function(d,a,l,n){var o=F.isRegExp(a),k=a,g;return o?(n===K&&a.global&&(n="all"),k=J(a,n==="all"?"g":"",n==="all"?"":"g")):n==="all"&&(k=new RegExp(F.escape(String(a)),"g")),g=H.replace.call(String(d),k,l),o&&a.global&&(a.lastIndex=0),g},F.split=function(d,c,a){return H.split.call(d,c,a)},F.test=function(e,c,d,a){return !!F.exec(e,c,d,a)},F.uninstall=function(a){a=S(a),Q.natives&&a.natives&&j(!1),Q.extensibility&&a.extensibility&&V(!1)},F.union=function(g,p){var k=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,d=0,t,s,w=function(h,e,c){var f=s[d-t];if(e){if(++d,f){return"(?<"+f+">"}}else{if(c){return"\\"+(+c+t)}}return h},v=[],a,y;if(!(G(g,"array")&&g.length)){throw new TypeError("patterns must be a nonempty array")}for(y=0;y<g.length;++y){a=g[y],F.isRegExp(a)?(t=d,s=a.xregexp&&a.xregexp.captureNames||[],v.push(F(a.source).source.replace(k,w))):v.push(F.escape(a))}return F(v.join("|"),p)},F.version="2.0.0",H.exec=function(c){var d,g,h,k,a;if(this.global||(k=this.lastIndex),d=N.exec.apply(this,arguments),d){if(!m&&d.length>1&&W(d,"")>-1&&(h=new RegExp(this.source,N.replace.call(P(this),"g","")),N.replace.call(String(c).slice(d.index),h,function(){for(var e=1;e<arguments.length-2;++e){arguments[e]===K&&(d[e]=K)}})),this.xregexp&&this.xregexp.captureNames){for(a=1;a<d.length;++a){g=this.xregexp.captureNames[a-1],g&&(d[g]=d[a])}}this.global&&!d[0].length&&this.lastIndex>d.index&&(this.lastIndex=d.index)}return this.global||(this.lastIndex=k),d},H.test=function(a){return !!H.exec.call(this,a)},H.match=function(c){if(F.isRegExp(c)){if(c.global){var a=N.match.apply(this,arguments);return c.lastIndex=0,a}}else{c=new RegExp(c)}return H.exec.call(c,this)},H.replace=function(p,d){var k=F.isRegExp(p),a,g,c,l;return k?(p.xregexp&&(a=p.xregexp.captureNames),p.global||(l=p.lastIndex)):p+="",G(d,"function")?g=N.replace.call(String(this),p,function(){var f=arguments,e;if(a){for(f[0]=new String(f[0]),e=0;e<a.length;++e){a[e]&&(f[0][a[e]]=f[e+1])}}return k&&p.global&&(p.lastIndex=f[f.length-2]+f[0].length),d.apply(null,f)}):(c=String(this),g=N.replace.call(c,p,function(){var e=arguments;return N.replace.call(String(d),U,function(n,h,o){var s;if(h){if(s=+h,s<=e.length-3){return e[s]||""}if(s=a?W(a,h):-1,s<0){throw new SyntaxError("backreference to undefined group "+n)}return e[s+1]||""}if(o==="$"){return"$"}if(o==="&"||+o==0){return e[0]}if(o==="`"){return e[e.length-1].slice(0,e[e.length-2])}if(o==="'"){return e[e.length-1].slice(e[e.length-2]+e[0].length)}if(o=+o,!isNaN(o)){if(o>e.length-3){throw new SyntaxError("backreference to undefined group "+n)}return e[o]||""}throw new SyntaxError("invalid token "+n)})})),k&&(p.lastIndex=p.global?0:l),g},H.split=function(g,a){if(!F.isRegExp(g)){return N.split.apply(this,arguments)}var l=String(this),d=g.lastIndex,k=[],n=0,c;return a=(a===K?-1:a)>>>0,F.forEach(l,g,function(e){e.index+e[0].length>n&&(k.push(l.slice(n,e.index)),e.length>1&&e.index<l.length&&Array.prototype.push.apply(k,e.slice(1)),c=e[0].length,n=e.index+c)}),n===l.length?(!N.test.call(g,"")||c)&&k.push(""):k.push(l.slice(n)),g.lastIndex=d,k.length>a?k.slice(0,a):k},E=T.on,E(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4})|x(?![\dA-Fa-f]{2}))/,function(c,a){if(c[1]==="B"&&a===R){return c[0]}throw new SyntaxError("invalid escape "+c[0])},{scope:"all"}),E(/\[(\^?)]/,function(a){return a[1]?"[\\s\\S]":"\\b\\B"}),E(/(?:\(\?#[^)]*\))+/,function(a){return N.test.call(X,a.input.slice(a.index+a[0].length))?"":"(?:)"}),E(/\\k<([\w$]+)>/,function(d){var c=isNaN(d[1])?W(this.captureNames,d[1])+1:+d[1],a=d.index+d[0].length;if(!c||c>this.captureNames.length){throw new SyntaxError("backreference to undefined group "+d[0])}return"\\"+c+(a===d.input.length||isNaN(d.input.charAt(a))?"":"(?:)")}),E(/(?:\s+|#.*)+/,function(a){return N.test.call(X,a.input.slice(a.index+a[0].length))?"":"(?:)"},{trigger:function(){return this.hasFlag("x")},customFlags:"x"}),E(/\./,function(){return"[\\s\\S]"},{trigger:function(){return this.hasFlag("s")},customFlags:"s"}),E(/\(\?P?<([\w$]+)>/,function(a){if(!isNaN(a[1])){throw new SyntaxError("can't use integer as capture name "+a[0])}return this.captureNames.push(a[1]),this.hasNamedCapture=!0,"("}),E(/\\(\d+)/,function(c,a){if(!(a===R&&/^[1-9]/.test(c[1])&&+c[1]<=this.captureNames.length)&&c[1]!=="0"){throw new SyntaxError("can't use octal escape or backreference to undefined group "+c[0])}return c[0]},{scope:"all"}),E(/\((?!\?)/,function(){return this.hasFlag("n")?"(?:":(this.captureNames.push(null),"(")},{customFlags:"n"}),typeof exports!="undefined"&&(exports.XRegExp=F),F}();
/*!
 * XRegExp Unicode Base v1.0.0
 * (c) 2008-2012 Steven Levithan <http://xregexp.com/>
 * MIT License
 * Uses Unicode 6.1 <http://unicode.org/>
 */
(function(g){var c={};function f(l){return l.replace(/[- _]+/g,"").toLowerCase()}function k(l){return l.replace(/\w{4}/g,"\\u$&")}function j(l){while(l.length<4){l="0"+l}return l}function e(l){return parseInt(l,16)}function d(l){return parseInt(l,10).toString(16)}function a(m){var l=[],n=-1,o;g.forEach(m,/\\u(\w{4})(?:-\\u(\w{4}))?/,function(p){o=e(p[1]);if(o>(n+1)){l.push("\\u"+j(d(n+1)));if(o>(n+2)){l.push("-\\u"+j(d(o-1)))}}n=e(p[2]||p[1])});if(n<65535){l.push("\\u"+j(d(n+1)));if(n<65534){l.push("-\\uFFFF")}}return l.join("")}function h(l){return c["^"+l]||(c["^"+l]=a(c[l]))}g.install("extensibility");g.addUnicodePackage=function(m,l){var n;if(!g.isInstalled("extensibility")){throw new Error("extensibility must be installed before adding Unicode packages")}if(m){for(n in m){if(m.hasOwnProperty(n)){c[f(n)]=k(m[n])}}}if(l){for(n in l){if(l.hasOwnProperty(n)){c[f(l[n])]=c[f(n)]}}}};g.addUnicodePackage({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05270531-055605590561-058705D0-05EA05F0-05F20620-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280840-085808A008A2-08AC0904-0939093D09500958-09610971-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510C710CD10D0-10FA10FC-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11CF51CF61D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209C21022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2CF22CF32D00-2D252D272D2D2D30-2D672D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78B-A78EA790-A793A7A0-A7AAA7F8-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDAAE0-AAEAAAF2-AAF4AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC"},{L:"Letter"});g.addToken(/\\([pP]){(\^?)([^}]*)}/,function(m,n){var l=(m[1]==="P"||m[2])?"^":"",o=f(m[3]);if(m[1]==="P"&&m[2]){throw new SyntaxError("invalid double negation \\P{^")}if(!c.hasOwnProperty(o)){throw new SyntaxError("invalid or unknown Unicode property "+m[0])}return n==="class"?(l?h(o):c[o]):"["+l+c[o]+"]"},{scope:"all"})}(XRegExp));
/*!
 * XRegExp Unicode Categories v1.2.0
 * (c) 2010-2012 Steven Levithan <http://xregexp.com/>
 * MIT License
 * Uses Unicode 6.1 <http://unicode.org/>
 */
(function(a){if(!a.addUnicodePackage){throw new ReferenceError("Unicode Base must be loaded before Unicode Categories")}a.install("extensibility");a.addUnicodePackage({Ll:"0061-007A00B500DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F05210523052505270561-05871D00-1D2B1D6B-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7B2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2CF32D00-2D252D272D2DA641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA661A663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CA78EA791A793A7A1A7A3A7A5A7A7A7A9A7FAFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E05200522052405260531-055610A0-10C510C710CD1E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CED2CF2A640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA660A662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BA78DA790A792A7A0A7A2A7A4A7A6A7A8A7AAFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D6A1D781D9B-1DBF2071207F2090-209C2C7C2C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A7F8A7F9A9CFAA70AADDAAF3AAF4FF70FF9EFF9F",Lo:"00AA00BA01BB01C0-01C3029405D0-05EA05F0-05F20620-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150840-085808A008A2-08AC0904-0939093D09500958-09610972-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA10FD-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF11CF51CF62135-21382D30-2D672D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCAAE0-AAEAAAF2AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0903093A-093C093E-094F0951-0957096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F8D-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135D-135F1712-17141732-1734175217531772177317B4-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAD1BE6-1BF31C24-1C371CD0-1CD21CD4-1CE81CED1CF2-1CF41DC0-1DE61DFC-1DFF20D0-20F02CEF-2CF12D7F2DE0-2DFF302A-302F3099309AA66F-A672A674-A67DA69FA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAEB-AAEFAAF5AAF6ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0902093A093C0941-0948094D0951-095709620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F8D-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135D-135F1712-17141732-1734175217531772177317B417B517B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91BAB1BE61BE81BE91BED1BEF-1BF11C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1CF41DC0-1DE61DFC-1DFF20D0-20DC20E120E5-20F02CEF-2CF12D7F2DE0-2DFF302A-302D3099309AA66FA674-A67DA69FA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAECAAEDAAF6ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093B093E-09400949-094C094E094F0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1BAC1BAD1BE71BEA-1BEC1BEE1BF21BF31C24-1C2B1C341C351CE11CF21CF3302E302FA823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BAAEBAAEEAAEFAAF5ABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048920DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0B72-0B770BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19D91A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90B72-0B770BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F919DA20702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100A700AB00B600B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F3A-0F3D0F850FD0-0FD40FD90FDA104A-104F10FB1360-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2D702E00-2E2E2E30-2E3B3001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A2E3A2E3B301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100A700B600B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F850FD0-0FD40FD90FDA104A-104F10FB1360-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2D702E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E30-2E393001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A600A800A900AC00AE-00B100B400B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F60482058F0606-0608060B060E060F06DE06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0D790E3F0F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-139917DB194019DE-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B9210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23F32400-24262440-244A249C-24E92500-26FF2701-27672794-27C427C7-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FBB2-FBC1FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C21182140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5058F060B09F209F309FB0AF10BF90E3F17DB20A0-20B9A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFBB2-FBC1FF3EFF40FFE3",So:"00A600A900AE00B00482060E060F06DE06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0D790F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-1399194019DE-19FF1B61-1B6A1B74-1B7C210021012103-210621082109211421162117211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23F32400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26FF2701-27672794-27BF2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-0605061C061D06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060406DD070F200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-05FF0605061C061D070E074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"},{Ll:"Lowercase_Letter",Lu:"Uppercase_Letter",Lt:"Titlecase_Letter",Lm:"Modifier_Letter",Lo:"Other_Letter",M:"Mark",Mn:"Nonspacing_Mark",Mc:"Spacing_Mark",Me:"Enclosing_Mark",N:"Number",Nd:"Decimal_Number",Nl:"Letter_Number",No:"Other_Number",P:"Punctuation",Pd:"Dash_Punctuation",Ps:"Open_Punctuation",Pe:"Close_Punctuation",Pi:"Initial_Punctuation",Pf:"Final_Punctuation",Pc:"Connector_Punctuation",Po:"Other_Punctuation",S:"Symbol",Sm:"Math_Symbol",Sc:"Currency_Symbol",Sk:"Modifier_Symbol",So:"Other_Symbol",Z:"Separator",Zs:"Space_Separator",Zl:"Line_Separator",Zp:"Paragraph_Separator",C:"Other",Cc:"Control",Cf:"Format",Co:"Private_Use",Cs:"Surrogate",Cn:"Unassigned"})}(XRegExp));